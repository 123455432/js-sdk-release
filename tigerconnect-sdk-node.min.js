module.exports=function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),global._babelPolyfill||n(125);var r="node";n(124)("./"+r);var o=n(71);t.Client=o},function(e,t){e.exports=require("babel-runtime/helpers/classCallCheck")},function(e,t){e.exports=require("babel-runtime/helpers/createClass")},function(e,t){e.exports=require("babel-runtime/core-js/object/get-prototype-of")},function(e,t){e.exports=require("babel-runtime/helpers/inherits")},function(e,t){e.exports=require("babel-runtime/helpers/possibleConstructorReturn")},function(e,t){e.exports=require("babel-runtime/core-js/object/keys")},function(e,t){e.exports=require("babel-runtime/core-js/json/stringify")},function(e,t){e.exports=require("babel-runtime/helpers/asyncToGenerator")},function(e,t){e.exports=require("babel-runtime/regenerator")},function(e,t){e.exports=require("babel-runtime/helpers/typeof")},function(e,t){e.exports=require("babel-runtime/core-js/object/get-own-property-descriptor")},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){var n=4,r=15;if(void 0===t&&(t=0),t+=1,null===e)return"null";if(void 0===e)return"void";if("string"==typeof e||"number"==typeof e||"boolean"==typeof e)return"undefined"==typeof e?"undefined":(0,v["default"])(e);if(!Array.isArray(e)){var a=(0,c["default"])(e);if(!a.length)return e.constructor&&e.constructor.name&&"Object"!==e.constructor.name?e.constructor.name:"Object";if(t>n)return"{...}";var i="  ".repeat(t-1),s=a.slice(0,r).map(function(n){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(n)?n:(0,u["default"])(n))+": "+o(e[n],t)+";"}).join("\n  "+i);return a.length>=r&&(s+="\n  "+i+"..."),e.constructor&&e.constructor.name&&"Object"!==e.constructor.name?e.constructor.name+" {\n  "+i+s+"\n"+i+"}":"{\n  "+i+s+"\n"+i+"}"}if(!(e.length>0))return"Array";var l=function(){if(t>n)return{v:"[...]"};var a=o(e[0],t);return e.every(function(e){return o(e,t)===a})?{v:a.trim()+"[]"}:{v:"["+e.slice(0,r).map(function(e){return o(e,t)}).join(", ")+(e.length>=r?", ...":"")+"]"}}();return"object"===("undefined"==typeof l?"undefined":(0,v["default"])(l))?l.v:void 0}function a(e,t){var n=4,r=15;if(void 0===t&&(t=0),t+=1,null===e)return"null";if(void 0===e)return"void";if("string"==typeof e||"number"==typeof e||"boolean"==typeof e)return"undefined"==typeof e?"undefined":(0,v["default"])(e);if(!Array.isArray(e)){var o=(0,c["default"])(e);if(!o.length)return e.constructor&&e.constructor.name&&"Object"!==e.constructor.name?e.constructor.name:"Object";if(t>n)return"{...}";var i="  ".repeat(t-1),s=o.slice(0,r).map(function(n){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(n)?n:(0,u["default"])(n))+": "+a(e[n],t)+";"}).join("\n  "+i);return o.length>=r&&(s+="\n  "+i+"..."),e.constructor&&e.constructor.name&&"Object"!==e.constructor.name?e.constructor.name+" {\n  "+i+s+"\n"+i+"}":"{\n  "+i+s+"\n"+i+"}"}if(!(e.length>0))return"Array";var l=function(){if(t>n)return{v:"[...]"};var o=a(e[0],t);return e.every(function(e){return a(e,t)===o})?{v:o.trim()+"[]"}:{v:"["+e.slice(0,r).map(function(e){return a(e,t)}).join(", ")+(e.length>=r?", ...":"")+"]"}}();return"object"===("undefined"==typeof l?"undefined":(0,v["default"])(l))?l.v:void 0}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=void 0;var i=n(7),u=r(i),s=n(6),c=r(s),l=n(44),f=r(l),d=n(38),p=r(d),y=n(39),h=r(y),g=n(10),v=r(g),m=n(17),b=r(m),w=n(1),E=r(w),x=n(2),_=r(x),k=n(34),O=r(k),I=n(27),j=r(I),T=n(16),A=function(){function e(t,n){(0,E["default"])(this,e),(0,b["default"])(this,n),this.host=t,this.config=t.config,this.httpClient=t.httpClient}return(0,_["default"])(e,[{key:"_resolveModelId",value:function(e){if(!(null==e||"string"==typeof e||null==e||e instanceof Object))throw new TypeError('Value of argument "thing" violates contract.\n\nExpected:\n?string | ?Object\n\nGot:\n'+a(e));if(!(null==e||"string"==typeof e||null==e||e instanceof Object))throw new TypeError('Value of argument "thing" violates contract.\n\nExpected:\n?string | ?Object\n\nGot:\n'+o(e));return"string"==typeof e?e:e?e.serverId||e.id||null:null}},{key:"_resolveModelIdWithTypes",value:function(e,t){if(!(null==e||"string"==typeof e||null==e||e instanceof Object))throw new TypeError('Value of argument "thing" violates contract.\n\nExpected:\n?string | ?Object\n\nGot:\n'+a(e));if(!("string"==typeof t||Array.isArray(t)&&t.every(function(e){return"string"==typeof e})))throw new TypeError('Value of argument "allowedEntityTypes" violates contract.\n\nExpected:\nstring | string[]\n\nGot:\n'+a(t));if(!(null==e||"string"==typeof e||null==e||e instanceof Object))throw new TypeError('Value of argument "thing" violates contract.\n\nExpected:\n?string | ?Object\n\nGot:\n'+o(e));if(!("string"==typeof t||Array.isArray(t)&&t.every(function(e){return"string"==typeof e})))throw new TypeError('Value of argument "allowedEntityTypes" violates contract.\n\nExpected:\nstring | string[]\n\nGot:\n'+o(t));if(!e)return null;if("string"==typeof e){var n=this._resolveEntity(e);if(!n)return e;e=n}return j["default"].oneOf("thing",e.$entityType,(0,T.arrayWrap)(t)),e.serverId||e.id||null}},{key:"_resolveEntity",value:function(e,t){if(!(null==e||"string"==typeof e||null==e||e instanceof Object))throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\n?string | ?Object\n\nGot:\n'+a(e));if(!(null==t||"string"==typeof t||null==t||Array.isArray(t)&&t.every(function(e){return"string"==typeof e})))throw new TypeError('Value of argument "types" violates contract.\n\nExpected:\n?string | ?string[]\n\nGot:\n'+a(t));if(!(null==e||"string"==typeof e||null==e||e instanceof Object))throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\n?string | ?Object\n\nGot:\n'+o(e));if(!(null==t||"string"==typeof t||null==t||Array.isArray(t)&&t.every(function(e){return"string"==typeof e})))throw new TypeError('Value of argument "types" violates contract.\n\nExpected:\n?string | ?string[]\n\nGot:\n'+o(t));if(t||(t=this.host.allModelEntityTypes),t=(0,T.arrayWrap)(t),"object"===("undefined"==typeof e?"undefined":(0,v["default"])(e)))return t.includes(e.$entityType)?e:null;if(!t||"function"!=typeof t[h["default"]]&&!Array.isArray(t))throw new TypeError("Expected types to be iterable, got "+o(t));if(!t||"function"!=typeof t[h["default"]]&&!Array.isArray(t))throw new TypeError("Expected types to be iterable, got "+a(t));var n=!0,r=!1,i=void 0;try{for(var u,s=(0,p["default"])(t);!(n=(u=s.next()).done);n=!0){var c=u.value,l=this.host.modelsByEntityType[c].get(e);if(l)return l;if(l=(0,f["default"])(this.host.modelsByEntityType[c].getAll(),{serverId:e}))return l}}catch(d){r=!0,i=d}finally{try{!n&&s["return"]&&s["return"]()}finally{if(r)throw i}}return null}},{key:"mounted",value:function(){}},{key:"dispose",value:function(){}}]),e}();t["default"]=A,(0,b["default"])(A.prototype,O["default"].prototype),e.exports=t["default"]},function(e,t){e.exports=require("class-private-method-decorator")},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]={NotSignedInError:n(85),WrongCredentialsError:n(88),NotFoundError:n(84),PermissionDeniedError:n(86),ValidationError:n(50),TargetNotSupportedError:n(87),ConnectionOfflineError:n(83)},e.exports=t["default"]},function(e,t){e.exports=require("reuse-promise")},function(e,t){"use strict";function n(){return r(this)}function r(e){return Array.isArray(e)?e:void 0!=e&&null!=e?[e]:[]}function o(e,t,n){!(n in e)&&t in e&&(e[n]=e[t],delete e[t])}Object.defineProperty(t,"__esModule",{value:!0}),t.arrayWrapBound=n,t.arrayWrap=r,t.replaceKey=o},function(e,t){e.exports=require("babel-runtime/core-js/object/assign")},function(e,t){e.exports=require("babel-runtime/helpers/extends")},function(e,t){e.exports=require("lodash/defaults")},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(){var e=arguments.length<=0||void 0===arguments[0]?{fallbackValue:null,httpStatusCodes:[404]}:arguments[0];return function(t,n,r){var o=r.value;return r.value=function(){var t=(0,s["default"])(i["default"].mark(function n(){var t,r,a,u=arguments;return i["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:for(n.prev=0,t=u.length,r=Array(t),a=0;t>a;a++)r[a]=u[a];return n.next=4,o.call.apply(o,[this].concat(r));case 4:return n.abrupt("return",n.sent);case 7:if(n.prev=7,n.t0=n["catch"](0),!n.t0.response||!e.httpStatusCodes.includes(n.t0.response.status)){n.next=13;break}return n.abrupt("return",e.fallbackValue);case 13:throw n.t0;case 14:case"end":return n.stop()}},n,this,[[0,7]])}));return function(e){return t.apply(this,arguments)}}(),r}}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=void 0;var a=n(9),i=r(a),u=n(8),s=r(u),c=n(17),l=r(c),f=n(1),d=r(f);t.recoverFromNotFound=o;var p=n(34),y=r(p),h=function g(e,t){(0,d["default"])(this,g),(0,l["default"])(this,t),this.config=e.config,this.host=e,this.httpClient=e.httpClient};t["default"]=h,(0,l["default"])(h.prototype,y["default"].prototype)},function(e,t){e.exports=require("babel-runtime/core-js/promise")},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t.ServerValueEnum=t["default"]=void 0;var o=n(151),a=r(o),i=n(35),u=r(i),s=n(3),c=r(s),l=n(5),f=r(l),d=n(4),p=r(d),y=n(128),h=r(y),g=n(18),v=r(g),m=n(1),b=r(m),w=n(2),E=r(w),x=function(){function e(t){var n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];(0,b["default"])(this,e),Array.isArray(t)&&(t=t.reduce(function(e,t){return e[t]={},e},{})),this.keys=[],this.entries=[],this.entriesByKey={},this.defaultValue=n.defaultValue||null;for(var r in t){this[r]=r;var o=(0,v["default"])({key:r},t[r]);this.entriesByKey[r]=o,this.entries.push(o),this.keys.push(r)}(0,h["default"])(this.keys),(0,h["default"])(this.entries),(0,h["default"])(this.entriesByKey)}return(0,E["default"])(e,[{key:"resolve",value:function(e){return e||this.defaultValue}},{key:"isValid",value:function(e){return!!this.entriesByKey[e]}}]),e}();t["default"]=x,t.ServerValueEnum=function(e){function t(){return(0,b["default"])(this,t),(0,f["default"])(this,(0,c["default"])(t).apply(this,arguments))}return(0,p["default"])(t,e),(0,E["default"])(t,[{key:"mapEnumKeyToServerValue",value:function(){return this._mapEnumKeyToServerValue||(this._mapEnumKeyToServerValue=(0,u["default"])(this.entries,function(e,t){return e[t.key]=t.serverValue},{}))}},{key:"mapServerValueToEnumKey",value:function(){return this._mapServerValueToEnumKey||(this._mapServerValueToEnumKey=(0,a["default"])(this.mapEnumKeyToServerValue()))}},{key:"fromServer",value:function(e){return this.mapServerValueToEnumKey()[e]}},{key:"toServer",value:function(e){return this.mapEnumKeyToServerValue()[e]||this.mapServerValueToEnumKey()[e]}},{key:"resolve",value:function(e){return(this.isValid(e)?e:this.fromServer(e))||this.defaultValue}}]),t}(x)},function(e,t){e.exports=require("autobind-decorator")},function(e,t){e.exports=require("lodash/each")},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]={MessageRecipientStatus:n(36),MessageSenderStatus:n(102),MessageDirection:n(100),PresenceStatus:n(51),GroupType:n(99),MessageType:n(103),MessagePriority:n(101)},e.exports=t["default"]},function(e,t){e.exports=require("lodash-bound/map")},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(6),a=r(o),i=n(50),u=r(i),s={isOneOf:function(e,t,n){return n.includes(t)},isNotEmpty:function(e,t){return!!t},raise:function(e){var t=arguments.length<=1||void 0===arguments[1]?"invalid":arguments[1],n=arguments[2];throw new u["default"](e,t,n)}};(0,a["default"])(s).forEach(function(e){var t=e.replace(/^is([A-Z])/,function(e,t){return t.toLowerCase()}),n=s[e];s[t]=function(e,t,r){for(var o=arguments.length,a=Array(o>3?o-3:0),i=3;o>i;i++)a[i-3]=arguments[i];n.apply(void 0,[e,t,r].concat(a))||s.raise(e,void 0,r)}}),t["default"]=s,e.exports=t["default"]},function(e,t){e.exports=require("babel-runtime/helpers/objectWithoutProperties")},function(e,t){e.exports=require("lodash-bound/filter")},function(e,t){e.exports=require("lodash/values")},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t,n){var r=arguments.length<=3||void 0===arguments[3]?{}:arguments[3],o=e.get(t);if(o)o.$placeholder?o.$$loading||o.$notFound||r.onlyPlaceholder||a(e,o,r):(r.onExists&&r.onExists(o),r.onFinish&&r.onFinish(o));else{if(n=(0,j["default"])((0,O["default"])({},e.idAttribute,t),n),r.onMissing&&r.onMissing(),o=e.createInstance(n),Object.defineProperty(o,"$placeholder",{value:!0,configurable:!0}),e.inject(o),r.onlyPlaceholder)return o;a(e,o,r)}}function a(e,t,n){var r=z(t);if(!V[r]){if(!n.placeholderEntityDelayBeforeRefreshing){var o;return T(e,t,n)["catch"]((o=console).error.bind(o))}Object.defineProperty(t,"$$loadingScheduled",{value:!0,configurable:!0}),V[r]=setTimeout(function(){return A(e,t,n)},n.placeholderEntityDelayBeforeRefreshing)}}function i(e,t){var n=t.finder,r=t.defaultPlaceholderAttrs,a=t.defaultNotFoundAttrs,i=t.placeholderEntityDelayBeforeRefreshing,u=t.placeholderEntityAllowLoading,l=t.shouldEnsure;if(null==arguments[1]||null!=arguments[1].finder&&"function"!=typeof arguments[1].finder||!(null==arguments[1].defaultPlaceholderAttrs||arguments[1].defaultPlaceholderAttrs instanceof Object)||!(null==arguments[1].defaultNotFoundAttrs||arguments[1].defaultNotFoundAttrs instanceof Object)||null!=arguments[1].placeholderEntityDelayBeforeRefreshing&&"function"!=typeof arguments[1].placeholderEntityDelayBeforeRefreshing&&null!=arguments[1].placeholderEntityDelayBeforeRefreshing&&"number"!=typeof arguments[1].placeholderEntityDelayBeforeRefreshing||null!=arguments[1].placeholderEntityAllowLoading&&"function"!=typeof arguments[1].placeholderEntityAllowLoading&&null!=arguments[1].placeholderEntityAllowLoading&&"boolean"!=typeof arguments[1].placeholderEntityAllowLoading||null!=arguments[1].shouldEnsure&&"function"!=typeof arguments[1].shouldEnsure)throw new TypeError("Value of argument 1 violates contract.\n\nExpected:\n{ finder: ?Function;\n  defaultPlaceholderAttrs: ?Object;\n  defaultNotFoundAttrs: ?Object;\n  placeholderEntityDelayBeforeRefreshing: ?Function | ?number;\n  placeholderEntityAllowLoading: ?Function | ?bool;\n  shouldEnsure: ?Function;\n}\n\nGot:\n"+c(arguments[1]));if(null==arguments[1]||null!=arguments[1].finder&&"function"!=typeof arguments[1].finder||!(null==arguments[1].defaultPlaceholderAttrs||arguments[1].defaultPlaceholderAttrs instanceof Object)||!(null==arguments[1].defaultNotFoundAttrs||arguments[1].defaultNotFoundAttrs instanceof Object)||null!=arguments[1].placeholderEntityDelayBeforeRefreshing&&"function"!=typeof arguments[1].placeholderEntityDelayBeforeRefreshing&&null!=arguments[1].placeholderEntityDelayBeforeRefreshing&&"number"!=typeof arguments[1].placeholderEntityDelayBeforeRefreshing||null!=arguments[1].placeholderEntityAllowLoading&&"function"!=typeof arguments[1].placeholderEntityAllowLoading&&null!=arguments[1].placeholderEntityAllowLoading&&"boolean"!=typeof arguments[1].placeholderEntityAllowLoading||null!=arguments[1].shouldEnsure&&"function"!=typeof arguments[1].shouldEnsure)throw new TypeError("Value of argument 1 violates contract.\n\nExpected:\n{ finder: ?Function;\n  defaultPlaceholderAttrs: ?Object;\n  defaultNotFoundAttrs: ?Object;\n  placeholderEntityDelayBeforeRefreshing: ?Function | ?number;\n  placeholderEntityAllowLoading: ?Function | ?bool;\n  shouldEnsure: ?Function;\n}\n\nGot:\n"+s(arguments[1]));e.ensureEntity=function(t){var s=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return e.shouldEnsure?("function"==typeof i&&(i=i()),"function"==typeof u&&(u=u()),o(e,t,(0,j["default"])({},r,s.attrs),(0,j["default"])({finder:n,notFoundAttributes:a,placeholderEntityDelayBeforeRefreshing:i,placeholderEntityAllowLoading:u},s))):null},e.shouldEnsure=function(t,n){var r=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];return"string"==typeof t&&(t=e.get(t)),t?l&&l(t,n,r)?!0:t.$placeholder&&!t.$$loading&&!n:!0}}function u(){(0,v["default"])(V).map(function(e){return clearTimeout(e)}),V={}}function s(e,t){var n=4,r=15;if(void 0===t&&(t=0),t+=1,null===e)return"null";if(void 0===e)return"void";if("string"==typeof e||"number"==typeof e||"boolean"==typeof e)return"undefined"==typeof e?"undefined":(0,h["default"])(e);if(!Array.isArray(e)){var o=(0,p["default"])(e);if(!o.length)return e.constructor&&e.constructor.name&&"Object"!==e.constructor.name?e.constructor.name:"Object";if(t>n)return"{...}";var a="  ".repeat(t-1),i=o.slice(0,r).map(function(n){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(n)?n:(0,f["default"])(n))+": "+s(e[n],t)+";"}).join("\n  "+a);return o.length>=r&&(i+="\n  "+a+"..."),e.constructor&&e.constructor.name&&"Object"!==e.constructor.name?e.constructor.name+" {\n  "+a+i+"\n"+a+"}":"{\n  "+a+i+"\n"+a+"}"}if(!(e.length>0))return"Array";var u=function(){if(t>n)return{v:"[...]"};var o=s(e[0],t);return e.every(function(e){return s(e,t)===o})?{v:o.trim()+"[]"}:{v:"["+e.slice(0,r).map(function(e){return s(e,t)}).join(", ")+(e.length>=r?", ...":"")+"]"}}();return"object"===("undefined"==typeof u?"undefined":(0,h["default"])(u))?u.v:void 0}function c(e,t){var n=4,r=15;if(void 0===t&&(t=0),t+=1,null===e)return"null";if(void 0===e)return"void";if("string"==typeof e||"number"==typeof e||"boolean"==typeof e)return"undefined"==typeof e?"undefined":(0,h["default"])(e);if(!Array.isArray(e)){var o=(0,p["default"])(e);if(!o.length)return e.constructor&&e.constructor.name&&"Object"!==e.constructor.name?e.constructor.name:"Object";if(t>n)return"{...}";var a="  ".repeat(t-1),i=o.slice(0,r).map(function(n){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(n)?n:(0,f["default"])(n))+": "+c(e[n],t)+";"}).join("\n  "+a);return o.length>=r&&(i+="\n  "+a+"..."),e.constructor&&e.constructor.name&&"Object"!==e.constructor.name?e.constructor.name+" {\n  "+a+i+"\n"+a+"}":"{\n  "+a+i+"\n"+a+"}"}if(!(e.length>0))return"Array";var u=function(){if(t>n)return{v:"[...]"};var o=c(e[0],t);return e.every(function(e){return c(e,t)===o})?{v:o.trim()+"[]"}:{v:"["+e.slice(0,r).map(function(e){return c(e,t)}).join(", ")+(e.length>=r?", ...":"")+"]"}}();return"object"===("undefined"==typeof u?"undefined":(0,h["default"])(u))?u.v:void 0}Object.defineProperty(t,"__esModule",{value:!0});var l=n(7),f=r(l),d=n(6),p=r(d),y=n(10),h=r(y),g=n(30),v=r(g),m=n(9),b=r(m),w=n(17),E=r(w),x=n(8),_=r(x),k=n(32),O=r(k),I=n(18),j=r(I),T=function(){var e=(0,_["default"])(b["default"].mark(function t(e,n,r){var o;return b["default"].wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(r.placeholderEntityAllowLoading){t.next=2;break}return t.abrupt("return");case 2:return Object.defineProperty(n,"$$loading",{value:!0,configurable:!0}),o=void 0,t.prev=4,t.next=7,r.finder(n.id);case 7:t.next=18;break;case 9:if(t.prev=9,t.t0=t["catch"](4),t.t0.code!==G["default"].NotFoundError.CODE){t.next=15;break}o=!0,t.next=18;break;case 15:t.next=18;break;case 18:delete n.$$loading,o?((0,E["default"])(n,r.notFoundAttributes),Object.defineProperty(n,"$notFound",{value:!0,configurable:!0}),e.touch(n),r.onNotFound&&r.onNotFound(),r.onLoad&&r.onLoad(null),r.onFinish&&r.onFinish(null)):(delete n.$placeholder,delete n.$notFound,e.touch(n),r.onSuccess&&r.onSuccess(n),r.onLoad&&r.onLoad(n),r.onFinish&&r.onFinish(n));case 20:case"end":return t.stop()}},t,this,[[4,9]])}));return function(t,n,r){return e.apply(this,arguments)}}(),A=function(){var e=(0,_["default"])(b["default"].mark(function t(e,n,r){return b["default"].wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,delete n.$$loadingScheduled,delete V[z(n)],n.$placeholder){t.next=5;break}return t.abrupt("return");case 5:return t.abrupt("return",T(e,n,r));case 8:t.prev=8,t.t0=t["catch"](0),console.error(t.t0);case 11:case"end":return t.stop()}},t,this,[[0,8]])}));return function(t,n,r){return e.apply(this,arguments)}}();t["default"]=i,t.dispose=u;var M=n(14),G=r(M),V={},z=function(e){return e.$entityType+":"+e.id}},function(e,t){e.exports=require("babel-runtime/helpers/defineProperty")},function(e,t){e.exports=require("babel-runtime/helpers/toConsumableArray")},function(e,t){e.exports=require("events")},function(e,t){e.exports=require("lodash/transform")},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(22),o=new r.ServerValueEnum({READ:{serverValue:"Read"},DELIVERED:{serverValue:"Delivered"},RECEIVED_ON_CLIENT:{serverValue:"ReceivedOnClient"},NEW:{serverValue:"New"},NA:{key:"NA"}});t["default"]=o,e.exports=t["default"]},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){return(0,f["default"])(e)?e.map(function(e){return o(e,t)}):(0,c["default"])(e)?(0,u["default"])(e,function(e,n,r){e[t(r)]=o(n,t)},{}):e}Object.defineProperty(t,"__esModule",{value:!0});var a=n(6),i=(r(a),n(35)),u=r(i),s=n(153),c=r(s),l=n(152),f=r(l),d=n(164),p=r(d),y=n(62),h=r(y),g=n(159),v=r(g),m={camelizeKey:(0,v["default"])(h["default"]),underscoreKey:(0,v["default"])(p["default"]),camelizeObject:function(e){return o(e,m.camelizeKey)},underscoreObject:function(e){return o(e,m.underscoreKey)}};t["default"]=m,e.exports=t["default"]},function(e,t){e.exports=require("babel-runtime/core-js/get-iterator")},function(e,t){e.exports=require("babel-runtime/core-js/symbol/iterator")},function(e,t){e.exports=require("lodash-bound/flatten")},function(e,t){e.exports=require("lodash-bound/orderBy")},function(e,t){e.exports=require("lodash-bound/uniq")},function(e,t){e.exports=require("lodash/filter")},function(e,t){e.exports=require("lodash/find")},function(e,t){e.exports=require("lodash/get")},function(e,t){e.exports=require("lodash/isEmpty")},function(e,t){e.exports=require("lodash/pick")},function(e,t){e.exports=require("lodash/throttle")},function(e,t){e.exports=require("moment")},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=void 0;var o,a,i=n(3),u=r(i),s=n(1),c=r(s),l=n(5),f=r(l),d=n(4),p=r(d),y=(a=o=function(e){function t(e){var n=arguments.length<=1||void 0===arguments[1]?"invalid":arguments[1],r=arguments.length<=2||void 0===arguments[2]?e+" is "+n:arguments[2];(0,c["default"])(this,t);var o=(0,f["default"])(this,(0,u["default"])(t).call(this,r));return o.code=t.CODE,o.name=e,o.reason=n,o}return(0,p["default"])(t,e),t}(Error),o.CODE="validation",a);t["default"]=y,e.exports=t["default"]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(22),o=new r.ServerValueEnum({UNKNOWN:{serverValue:"unknown"},AVAILABLE:{serverValue:"available"},UNAVAILABLE:{serverValue:"unavailable"}});t["default"]=o,e.exports=t["default"]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={Event:n(91),SearchResult:n(97)};t["default"]=r,e.exports=t["default"]},function(e,t,n){"use strict"},function(e,t,n){"use strict";!function(){try{var e=n(132).request().__proto__;e.setNoDelay||(e.setNoDelay=function(){}),e.abort||(e.abort=function(){this.xhr&&this.xhr.abort()})}catch(t){}}()},function(e,t){e.exports=require("btoa")},function(e,t){e.exports=require("file-type")},function(e,t){e.exports=require("fs")},function(e,t){e.exports=require("jshashes")},function(e,t){e.exports=require("lodash-bound/keys")},function(e,t){e.exports=require("lodash-bound/values")},function(e,t){e.exports=require("lodash-bound/without")},function(e,t){e.exports=require("lodash/camelCase")},function(e,t){e.exports=require("lodash/defaultsDeep")},function(e,t){e.exports=require("lodash/difference")},function(e,t){e.exports=require("lodash/identity")},function(e,t){e.exports=require("lodash/omit")},function(e,t){e.exports=require("lodash/sumBy")},function(e,t){e.exports=require("node-uuid")},function(e,t){e.exports=require("path")},function(e,t){e.exports=require("shallowequal")},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t,n,r,o){var a={};return Object.keys(r).forEach(function(e){a[e]=r[e]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},a),o&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(o):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}function a(e,t){var n=4,r=15;if(void 0===t&&(t=0),t+=1,null===e)return"null";if(void 0===e)return"void";if("string"==typeof e||"number"==typeof e||"boolean"==typeof e)return"undefined"==typeof e?"undefined":(0,p["default"])(e);if(!Array.isArray(e)){var o=(0,A["default"])(e);if(!o.length)return e.constructor&&e.constructor.name&&"Object"!==e.constructor.name?e.constructor.name:"Object";if(t>n)return"{...}";var i="  ".repeat(t-1),u=o.slice(0,r).map(function(n){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(n)?n:(0,f["default"])(n))+": "+a(e[n],t)+";"}).join("\n  "+i);return o.length>=r&&(u+="\n  "+i+"..."),e.constructor&&e.constructor.name&&"Object"!==e.constructor.name?e.constructor.name+" {\n  "+i+u+"\n"+i+"}":"{\n  "+i+u+"\n"+i+"}"}if(!(e.length>0))return"Array";var s=function(){if(t>n)return{v:"[...]"};var o=a(e[0],t);return e.every(function(e){return a(e,t)===o})?{v:o.trim()+"[]"}:{v:"["+e.slice(0,r).map(function(e){return a(e,t)}).join(", ")+(e.length>=r?", ...":"")+"]"}}();return"object"===("undefined"==typeof s?"undefined":(0,p["default"])(s))?s.v:void 0}function i(e,t){var n=4,r=15;if(void 0===t&&(t=0),t+=1,null===e)return"null";if(void 0===e)return"void";if("string"==typeof e||"number"==typeof e||"boolean"==typeof e)return"undefined"==typeof e?"undefined":(0,p["default"])(e);if(!Array.isArray(e)){var o=(0,A["default"])(e);if(!o.length)return e.constructor&&e.constructor.name&&"Object"!==e.constructor.name?e.constructor.name:"Object";if(t>n)return"{...}";var a="  ".repeat(t-1),u=o.slice(0,r).map(function(n){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(n)?n:(0,f["default"])(n))+": "+i(e[n],t)+";"}).join("\n  "+a);return o.length>=r&&(u+="\n  "+a+"..."),e.constructor&&e.constructor.name&&"Object"!==e.constructor.name?e.constructor.name+" {\n  "+a+u+"\n"+a+"}":"{\n  "+a+u+"\n"+a+"}"}if(!(e.length>0))return"Array";var s=function(){if(t>n)return{v:"[...]"};var o=i(e[0],t);return e.every(function(e){return i(e,t)===o})?{v:o.trim()+"[]"}:{v:"["+e.slice(0,r).map(function(e){return i(e,t)}).join(", ")+(e.length>=r?", ...":"")+"]"}}();return"object"===("undefined"==typeof s?"undefined":(0,p["default"])(s))?s.v:void 0}Object.defineProperty(t,"__esModule",{value:!0});var u,s,c,l=n(7),f=r(l),d=n(10),p=r(d),y=n(11),h=r(y),g=n(17),v=r(g),m=n(21),b=r(m),w=n(9),E=r(w),x=n(8),_=r(x),k=n(160),O=r(k),I=n(24),j=r(I),T=n(6),A=r(T),M=n(62),G=r(M),V=n(158),z=r(V),P=n(19),C=r(P),S=n(1),U=r(S),q=n(2),$=r(q),R=n(73),N=r(R),L=n(72),F=r(L),D=n(34),B=r(D),K=n(68),Z=r(K),W=n(14),H=r(W),X=n(82),Q=r(X),Y=n(118),J=r(Y),ee=n(120),te=r(ee),ne=n(25),re=r(ne),oe=n(134),ae=r(oe),ie=(n(13),n(23)),ue=r(ie),se=n(122),ce=r(se),le="UpM28mnfW65vJkbqEATtKvxm",fe={events:{autoAck:!1,isTyping:!0,multiOrg:!0,noOfflineMessages:!1,autoDeliver:!1,hidden:!1,closeAfterMessages:!1},autoAckSuccessfullyHandledEvents:!0,logLevel:"error",eventsAutoReconnect:!0,flushAckInterval:2e3,flushAckMaxEvents:500,flushSetMessageStatusInterval:1e3,flushMessageMaxCount:500,conversationReloadDelay:200,eventsAutoReconnectDelay:2e3,clearTypingStatusTimeout:15e3,organizationRostersChangeThrottleDelay:500,placeholderEntityAllowLoading:!0,placeholderEntityDelayBeforeRefreshing:100,consumerOrganizationId:le,maxMetadataKeyCount:8,pushAgent:"consumer",baseUrl:"https://developer.tigertext.me/v2",productKey:"bc1oOf3DZXbnaNZ2LCWZGvSg",version:"1.0",autoSignOutOnBrowserUnload:!1},de=(c=s=function(){function e(){var t=this,n=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];if((0,U["default"])(this,e),this.VERSION=ce["default"],this.version=ce["default"],!(null==n||n instanceof Object))throw new TypeError('Value of argument "config" violates contract.\n\nExpected:\n?Object\n\nGot:\n'+i(n));if(!(null==n||n instanceof Object))throw new TypeError('Value of argument "config" violates contract.\n\nExpected:\n?Object\n\nGot:\n'+a(n));this.config=(0,C["default"])(n,fe),this.config.autoSignOutOnBrowserUnload=!1,this.httpClient=new F["default"]({baseUrl:this.config.baseUrl,logger:new N["default"]({name:"HttpClient",level:this.config.logLevel})}),this.enums=re["default"],this.store=new te["default"](this,{logger:new N["default"]({name:"Store",level:this.config.logLevel})}),this.store.defineModels(),this.models=this.store.models,this.modelsByEntityType=(0,z["default"])(this.store.models,function(e,t){return(0,G["default"])(t)}),this.allModelEntityTypes=(0,A["default"])(this.modelsByEntityType),this.logger=new N["default"]({name:"TigerConnectClient",level:this.config.logLevel}),this.api={},(0,j["default"])(Q["default"],function(e,n){t.api[(0,G["default"])(n)]=new e(t,{logger:new N["default"]({name:e.name,level:t.config.logLevel})})}),this._services={},(0,j["default"])(J["default"],function(e,n){n=(0,G["default"])(n),t._services[n]=t[n]=new e(t,{logger:new N["default"]({name:e.name,level:t.config.logLevel})})}),(0,j["default"])(this._services,function(e){return e.mounted&&e.mounted()}),this._listenToEvents(),this._startTicker(),this.config.autoSignOutOnBrowserUnload&&this.on("browserUnload",function(e){return e(function(){return t.signOut({async:!1})},100,"signOut")}),this.currentlyServingOfflineMessages=!1}return(0,$["default"])(e,[{key:"_listenToEvents",value:function(){var e=this;this.on("signedIn",function(t,n){e.logger.info("signedIn",t.id)}).on("signedOut",function(){e.reset()}).on("signUp",function(t){var n=t.user,r=t.auth;e.logger.info("signUp",n.id),e._setCurrentUser(n,r)}),this.events.on("event",function(t){return e.emit("event",t)}),this.conversations.on("message",function(t){return e.emit("message",t)}),this.conversations.on("change",function(t){return e.emit("conversation:change",t)}),this.groups.on("membership:change",function(t){return e.emit("group:membership:change",t)}),this.presence.on("change",function(t){return e.emit("presence:change",t)}),this.typingStatus.on("change",function(t){return e.emit("typing:change",t)}),"undefined"!=typeof window&&window.addEventListener("beforeunload",this._onBrowserUnload)}},{key:"_onBrowserUnload",value:function(){var e=[],t=function(t,n,r){return e.push({fn:t,priority:n,name:r})};this.emit("browserUnload",t),(0,O["default"])(e,["priority"],["desc"]).forEach(function(e){var t=e.fn,n=e.priority,r=e.name;console.log("[unload]",n,r),t()})}},{key:"_startTicker",value:function(){this.__ticker=setInterval(this._onTick,1e3)}},{key:"_stopTicker",value:function(){clearInterval(this.__ticker)}},{key:"_onTick",value:function(){this.emit("tick")}},{key:"signIn",value:function(){function e(e,n,r){return t.apply(this,arguments)}var t=(0,_["default"])(E["default"].mark(function n(e,t){var r,o,a,i=arguments.length<=2||void 0===arguments[2]?{udid:void 0}:arguments[2];return E["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return i.udid=i.udid||(0,Z["default"])(),this.emit("signingIn"),n.prev=2,n.next=5,this.users.signIn(e,t,i);case 5:return r=n.sent,o=r.user,a=r.auth,this._setCurrentUser(o,a),n.next=11,this.users.me({bypassCache:!0});case 11:return this.emit("signedIn",o,a),n.abrupt("return",{user:o,auth:a});case 15:throw n.prev=15,n.t0=n["catch"](2),n.t0;case 19:case"end":return n.stop()}},n,this,[[2,15]])}));return e}()},{key:"signOut",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,_["default"])(E["default"].mark(function n(){var e,t,r=arguments.length<=0||void 0===arguments[0]?{async:!0}:arguments[0],o=r.async,a=void 0===o?!0:o;
return E["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(this.isSignedIn()){n.next=2;break}return n.abrupt("return",b["default"].resolve());case 2:if(this.emit("signingOut"),a||"undefined"!=typeof XMLHttpRequest){n.next=5;break}throw new Error("async: false option has to be on the browser.");case 5:if(!a){n.next=16;break}return e=this.users.signOut({async:a}),n.next=9,e;case 9:this._currentUser=null,this._auth=null,this.httpClient.removeAuth(),this.events.disconnect(),this.emit("signedOut"),n.next=22;break;case 16:return t=new XMLHttpRequest,t.open("POST",this.config.baseUrl+"/logout",!1),t.setRequestHeader("Authorization",this.httpClient.getAuthHeader()),t.send(null),this.emit("signedOut"),n.abrupt("return",b["default"].resolve());case 22:case"end":return n.stop()}},n,this)}));return e}()},{key:"wipe",value:function(){function e(){return t.apply(this,arguments)}var t=(0,_["default"])(E["default"].mark(function n(){return E["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.signOut();case 2:case"end":return e.stop()}},n,this)}));return e}()},{key:"authenticate",value:function(){function e(e,n){return t.apply(this,arguments)}var t=(0,_["default"])(E["default"].mark(function n(e,t){var r,o,a;return E["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return this._setAuth(e,t),n.prev=1,n.next=4,this.httpClient.get("/user");case 4:n.next=25;break;case 6:if(n.prev=6,n.t0=n["catch"](1),r=n.t0.response&&n.t0.response.get("TT_Log_Account_Token")){n.next=11;break}throw new H["default"].WrongCredentialsError;case 11:return n.prev=11,n.next=14,this.users.find(r);case 14:return o=n.sent,a={key:e,secret:t},this._setCurrentUser(o,a),this.emit("signedIn",o,a),n.abrupt("return",o);case 21:throw n.prev=21,n.t1=n["catch"](11),this._removeAuth(),n.t1;case 25:case"end":return n.stop()}},n,this,[[1,6],[11,21]])}));return e}()},{key:"_setCurrentUser",value:function(e,t){this._currentUser=e,this._setAuth(t.key,t.secret,t.resource)}},{key:"_setAuth",value:function(e,t,n){this._auth={key:e,secret:t,resource:n},this.httpClient.setAuth(e,t)}},{key:"_removeAuth",value:function(){this._auth=null,this.httpClient.removeAuth()}},{key:"getCurrentUser",value:function(){return this._currentUser||null}},{key:"getAuth",value:function(){return this._auth}},{key:"isSignedIn",value:function(){return null!=this.getAuth()}},{key:"requireUser",value:function(){if(!this.isSignedIn())throw new H["default"].NotSignedInError}},{key:"reactToAdvisoryEvent",value:function(e,t){switch(this.emit("advisory",{type:e,data:t}),e){case"replayStart":this.currentlyServingOfflineMessages=!0,this.emit("messages:offline:start",t);break;case"replayStop":this.currentlyServingOfflineMessages=!1,this.emit("messages:offline:stop"),this.emit("messages:new:start")}}},{key:"modelByTypeNS",value:function(e){return this.MODEL_BY_TYPE_NS[e]}},{key:"injectModel",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?e.xmlns||e.type:arguments[1],n=this.modelByTypeNS(t);return n?n.inject(e):((0,ae["default"])(n,"injectModel: Missing class for "+t),null)}},{key:"getEntity",value:function(e,t){return this.modelsByEntityType[e].get(t)}},{key:"getEntities",value:function(e){var t=this;return e.map(function(e){return t.getEntity(e.type,e.id)})}},{key:"dispose",value:function(){this._stopTicker(),(0,j["default"])(this._services,function(e){return e.dispose&&e.dispose()}),this.store&&this.store.clear()}},{key:"reset",value:function(){this.dispose(),(0,j["default"])(this._services,function(e){return e.mounted&&e.mounted()}),this._startTicker()}},{key:"configure",value:function(e){return(0,v["default"])(this.config,e),this}},{key:"setDefaultOrganization",value:function(e){return this.configure({defaultOrganizationId:e})}},{key:"currentUser",get:function(){return this.getCurrentUser()}},{key:"currentUserId",get:function(){return this.getCurrentUser()&&this.getCurrentUser().id}},{key:"MODEL_BY_TYPE_NS",get:function(){return this._MODEL_BY_TYPE_NS||(this._MODEL_BY_TYPE_NS={"tigertext:entity:account":this.models.User,"tigertext:entity:group":this.models.Group,"tigertext:entity:distribution_list":this.models.DistributionList,"tigertext:entity:list":this.models.DistributionList,"tigertext:iq:message":this.models.Message,"tigertext:iq:group_message":this.models.Message,"tigertext:iq:group:message":this.models.Message}),this._MODEL_BY_TYPE_NS}}]),e}(),s.errors=H["default"],s.VERSION=ce["default"],s.version=ce["default"],s.CONSUMER_ORGANIZATION_ID=le,u=c,o(u.prototype,"_onBrowserUnload",[ue["default"]],(0,h["default"])(u.prototype,"_onBrowserUnload"),u.prototype),o(u.prototype,"_onTick",[ue["default"]],(0,h["default"])(u.prototype,"_onTick"),u.prototype),u);(0,v["default"])(de.prototype,B["default"].prototype),t["default"]=de,e.exports=t["default"]},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e){var t=arguments.length<=1||void 0===arguments[1]?"attachment":arguments[1],r=e.name;if(!r)if("string"==typeof e)r=n(69).basename(e);else if(e instanceof Buffer){var o=(0,w["default"])(n(56)(e),"ext");r=t+"."+o}return r}function a(e,t){var n=4,r=15;if(void 0===t&&(t=0),t+=1,null===e)return"null";if(void 0===e)return"void";if("string"==typeof e||"number"==typeof e||"boolean"==typeof e)return"undefined"==typeof e?"undefined":(0,x["default"])(e);if(!Array.isArray(e)){var o=(0,l["default"])(e);if(!o.length)return e.constructor&&e.constructor.name&&"Object"!==e.constructor.name?e.constructor.name:"Object";if(t>n)return"{...}";var i="  ".repeat(t-1),u=o.slice(0,r).map(function(n){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(n)?n:(0,s["default"])(n))+": "+a(e[n],t)+";"}).join("\n  "+i);return o.length>=r&&(u+="\n  "+i+"..."),e.constructor&&e.constructor.name&&"Object"!==e.constructor.name?e.constructor.name+" {\n  "+i+u+"\n"+i+"}":"{\n  "+i+u+"\n"+i+"}"}if(!(e.length>0))return"Array";var c=function(){if(t>n)return{v:"[...]"};var o=a(e[0],t);return e.every(function(e){return a(e,t)===o})?{v:o.trim()+"[]"}:{v:"["+e.slice(0,r).map(function(e){return a(e,t)}).join(", ")+(e.length>=r?", ...":"")+"]"}}();return"object"===("undefined"==typeof c?"undefined":(0,x["default"])(c))?c.v:void 0}function i(e,t){var n=4,r=15;if(void 0===t&&(t=0),t+=1,null===e)return"null";if(void 0===e)return"void";if("string"==typeof e||"number"==typeof e||"boolean"==typeof e)return"undefined"==typeof e?"undefined":(0,x["default"])(e);if(!Array.isArray(e)){var o=(0,l["default"])(e);if(!o.length)return e.constructor&&e.constructor.name&&"Object"!==e.constructor.name?e.constructor.name:"Object";if(t>n)return"{...}";var a="  ".repeat(t-1),u=o.slice(0,r).map(function(n){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(n)?n:(0,s["default"])(n))+": "+i(e[n],t)+";"}).join("\n  "+a);return o.length>=r&&(u+="\n  "+a+"..."),e.constructor&&e.constructor.name&&"Object"!==e.constructor.name?e.constructor.name+" {\n  "+a+u+"\n"+a+"}":"{\n  "+a+u+"\n"+a+"}"}if(!(e.length>0))return"Array";var c=function(){if(t>n)return{v:"[...]"};var o=i(e[0],t);return e.every(function(e){return i(e,t)===o})?{v:o.trim()+"[]"}:{v:"["+e.slice(0,r).map(function(e){return i(e,t)}).join(", ")+(e.length>=r?", ...":"")+"]"}}();return"object"===("undefined"==typeof c?"undefined":(0,x["default"])(c))?c.v:void 0}Object.defineProperty(t,"__esModule",{value:!0});var u=n(7),s=r(u),c=n(6),l=r(c),f=n(163),d=r(f),p=n(46),y=r(p),h=n(17),g=r(h),v=n(19),m=r(v),b=n(45),w=r(b),E=n(10),x=r(E),_=n(21),k=r(_),O=n(9),I=r(O),j=n(8),T=r(j),A=n(1),M=r(A),G=n(2),V=r(G),z=n(174),P=r(z),C=n(55),S=r(C),U=n(14),q=r(U),$=n(175),R=r($),N=n(15),L=["get","post","put","patch","del"],F=function(){function e(t){(0,M["default"])(this,e),this.downloadImageAndGetURL=function(){return TargetNotSupportedError.raise()},this.downloadFileBlobAndURL=function(){return TargetNotSupportedError.raise()},this.config=t,this.logger=t.logger,this._prefixBaseUrl=(0,R["default"])(this.config.baseUrl)}return(0,V["default"])(e,[{key:"setAuth",value:function(e,t){this._key=e,this._secret=t}},{key:"removeAuth",value:function(){this._key=null,this._secret=null}},{key:"getAuthHeader",value:function(){return this.getAuthHeaderForKeyAndSecret(this._key,this._secret)}},{key:"getAuthHeaderForKeyAndSecret",value:function(e,t){return e&&t?"Basic "+(0,S["default"])(e+":"+t):null}},{key:"_contentType",value:function(e){switch(e){case"json":return"application/json";case"event-stream":return"text/event-stream";case"text":default:return"plain/text"}}},{key:"downloadFileBlob",value:function(e){if("string"!=typeof e)throw new TypeError('Value of argument "path" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));if("string"!=typeof e)throw new TypeError('Value of argument "path" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));TargetNotSupportedError.raise()}},{key:"downloadToFile",value:function(e,t){var r=this,o=function(){var o=n(57);return{v:new k["default"](function(a,i){var u=r.config.baseUrl+e;n(173)({url:u,headers:{Authorization:r.getAuthHeader()}},function(e,t){e||t.statusCode<200||t.statusCode>299?i(new Error("Failed downloading "+u+". Status = "+xhr.status)):a()}).pipe(o.createWriteStream(t))})}}();return"object"===("undefined"==typeof o?"undefined":(0,x["default"])(o))?o.v:void 0}}]),e}();L.forEach(function(e){F.prototype[e]=function(){var t=(0,T["default"])(I["default"].mark(function n(t){var r,a,i=this,u=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return I["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return u=(0,m["default"])(u||{},{reqFormat:"json",resFormat:"json"}),u.urlParams&&(t=t.replace(/:([\w\-]+)/g,function(e,t){return encodeURIComponent(u.urlParams[t])})),this.logger&&this.logger.info("start",e.toUpperCase(),t,u),r=(0,g["default"])({},u.headers),(0,y["default"])(u.files)&&(r["Content-Type"]=r["Content-Type"]||this._contentType(u.reqFormat)),r.Accept=r.Accept||this._contentType(u.resFormat),u.requestId&&(r["Request-ID"]=u.requestId),a=new k["default"](function(n,a){var s=P["default"][e](t).use(i._prefixBaseUrl).set(r).query(u.query||{});(0,y["default"])(u.files)?s=s.send(u.data||{}):(s=(0,d["default"])(u.data,function(e,t,n){return e.field(n,String(t))},s),s=(0,d["default"])(u.files,function(e,t,n,r){return e.attach(n,t,o(t,"attachment-"+r))},s),s=s.send()),i._key&&i._secret&&(s=s.auth(i._key,i._secret)),s.end(function(r,o){if(r)return i.logger&&i.logger.info("error",e.toUpperCase(),t,r),void a(r.status?401==r.status?new q["default"].WrongCredentialsError:r:new q["default"].ConnectionOfflineError);switch(u.resFormat){case"json":var s=o.body||{};"reply"in s&&(s=s.reply);var c={data:s,headers:o.headers,getHeader:function(e){return o.headers[e.toLowerCase()]},status:o.status};Object.defineProperty(c,"_origData",{get:function(){return o.body}}),i.logger&&i.logger.info("success",e.toUpperCase(),t,c),n(c);break;default:i.logger&&i.logger.info("success",e.toUpperCase(),t,o.text?o.text.substr(0,80)+"...":"[null]"),n(o.text)}})}),n.abrupt("return",a);case 9:case"end":return n.stop()}},n,this)}));return function(e,n){return t.apply(this,arguments)}}()}),!function(){var e=F.prototype.get,t=(0,N.decorator)(e);F.prototype.get=function(n){var r=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return r.reusePromise?t.call(this,n,r):e.call(this,n,r)}}(),t["default"]=F,e.exports=t["default"]},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){var n=4,r=15;if(void 0===t&&(t=0),t+=1,null===e)return"null";if(void 0===e)return"void";if("string"==typeof e||"number"==typeof e||"boolean"==typeof e)return"undefined"==typeof e?"undefined":(0,f["default"])(e);if(!Array.isArray(e)){var a=(0,c["default"])(e);if(!a.length)return e.constructor&&e.constructor.name&&"Object"!==e.constructor.name?e.constructor.name:"Object";if(t>n)return"{...}";var i="  ".repeat(t-1),s=a.slice(0,r).map(function(n){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(n)?n:(0,u["default"])(n))+": "+o(e[n],t)+";"}).join("\n  "+i);return a.length>=r&&(s+="\n  "+i+"..."),e.constructor&&e.constructor.name&&"Object"!==e.constructor.name?e.constructor.name+" {\n  "+i+s+"\n"+i+"}":"{\n  "+i+s+"\n"+i+"}"}if(!(e.length>0))return"Array";var l=function(){if(t>n)return{v:"[...]"};var a=o(e[0],t);return e.every(function(e){return o(e,t)===a})?{v:a.trim()+"[]"}:{v:"["+e.slice(0,r).map(function(e){return o(e,t)}).join(", ")+(e.length>=r?", ...":"")+"]"}}();return"object"===("undefined"==typeof l?"undefined":(0,f["default"])(l))?l.v:void 0}function a(e,t){var n=4,r=15;if(void 0===t&&(t=0),t+=1,null===e)return"null";if(void 0===e)return"void";if("string"==typeof e||"number"==typeof e||"boolean"==typeof e)return"undefined"==typeof e?"undefined":(0,f["default"])(e);if(!Array.isArray(e)){var o=(0,c["default"])(e);if(!o.length)return e.constructor&&e.constructor.name&&"Object"!==e.constructor.name?e.constructor.name:"Object";if(t>n)return"{...}";var i="  ".repeat(t-1),s=o.slice(0,r).map(function(n){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(n)?n:(0,u["default"])(n))+": "+a(e[n],t)+";"}).join("\n  "+i);return o.length>=r&&(s+="\n  "+i+"..."),e.constructor&&e.constructor.name&&"Object"!==e.constructor.name?e.constructor.name+" {\n  "+i+s+"\n"+i+"}":"{\n  "+i+s+"\n"+i+"}"}if(!(e.length>0))return"Array";var l=function(){if(t>n)return{v:"[...]"};var o=a(e[0],t);return e.every(function(e){return a(e,t)===o})?{v:o.trim()+"[]"}:{v:"["+e.slice(0,r).map(function(e){return a(e,t)}).join(", ")+(e.length>=r?", ...":"")+"]"}}();return"object"===("undefined"==typeof l?"undefined":(0,f["default"])(l))?l.v:void 0}Object.defineProperty(t,"__esModule",{value:!0});var i=n(7),u=r(i),s=n(6),c=r(s),l=n(10),f=r(l),d=n(33),p=r(d),y=n(1),h=r(y),g=n(2),v=r(g),m=function(){function e(t){var n=t.name,r=t.level;if((0,h["default"])(this,e),null==arguments[0]||"string"!=typeof arguments[0].name||"string"!=typeof arguments[0].level)throw new TypeError("Value of argument 0 violates contract.\n\nExpected:\n{ name: string;\n  level: string;\n}\n\nGot:\n"+a(arguments[0]));if(null==arguments[0]||"string"!=typeof arguments[0].name||"string"!=typeof arguments[0].level)throw new TypeError("Value of argument 0 violates contract.\n\nExpected:\n{ name: string;\n  level: string;\n}\n\nGot:\n"+o(arguments[0]));this.name=n,this.level=r}return(0,v["default"])(e,[{key:"setLevel",value:function(e){if("string"!=typeof e)throw new TypeError('Value of argument "level" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));if("string"!=typeof e)throw new TypeError('Value of argument "level" violates contract.\n\nExpected:\nstring\n\nGot:\n'+o(e));this.level=e}}]),e}(),b=["debug","log","info","warn","error"],w=b.reduce(function(e,t,n){return e[t]=n,e},{});b.forEach(function(e){var t=w[e];m.prototype[e]=function(){for(var n=arguments.length,r=Array(n),o=0;n>o;o++)r[o]=arguments[o];t<w[this.level]||(r=["["+this.name+"]"].concat((0,p["default"])(r)),Function.prototype.apply.call(console[e],console,r))}}),t["default"]=m,e.exports=t["default"]},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t,n,r,o){var a={};return Object.keys(r).forEach(function(e){a[e]=r[e]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},a),o&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(o):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}function a(e,t){var n=4,r=15;if(void 0===t&&(t=0),t+=1,null===e)return"null";if(void 0===e)return"void";if("string"==typeof e||"number"==typeof e||"boolean"==typeof e)return"undefined"==typeof e?"undefined":(0,y["default"])(e);if(!Array.isArray(e)){var o=(0,d["default"])(e);if(!o.length)return e.constructor&&e.constructor.name&&"Object"!==e.constructor.name?e.constructor.name:"Object";if(t>n)return"{...}";var i="  ".repeat(t-1),u=o.slice(0,r).map(function(n){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(n)?n:(0,l["default"])(n))+": "+a(e[n],t)+";"}).join("\n  "+i);return o.length>=r&&(u+="\n  "+i+"..."),e.constructor&&e.constructor.name&&"Object"!==e.constructor.name?e.constructor.name+" {\n  "+i+u+"\n"+i+"}":"{\n  "+i+u+"\n"+i+"}"}if(!(e.length>0))return"Array";var s=function(){if(t>n)return{v:"[...]"};var o=a(e[0],t);return e.every(function(e){return a(e,t)===o})?{v:o.trim()+"[]"}:{v:"["+e.slice(0,r).map(function(e){return a(e,t)}).join(", ")+(e.length>=r?", ...":"")+"]"}}();return"object"===("undefined"==typeof s?"undefined":(0,y["default"])(s))?s.v:void 0}function i(e,t){var n=4,r=15;if(void 0===t&&(t=0),t+=1,null===e)return"null";if(void 0===e)return"void";if("string"==typeof e||"number"==typeof e||"boolean"==typeof e)return"undefined"==typeof e?"undefined":(0,y["default"])(e);if(!Array.isArray(e)){var o=(0,d["default"])(e);if(!o.length)return e.constructor&&e.constructor.name&&"Object"!==e.constructor.name?e.constructor.name:"Object";if(t>n)return"{...}";var a="  ".repeat(t-1),u=o.slice(0,r).map(function(n){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(n)?n:(0,l["default"])(n))+": "+i(e[n],t)+";"}).join("\n  "+a);return o.length>=r&&(u+="\n  "+a+"..."),e.constructor&&e.constructor.name&&"Object"!==e.constructor.name?e.constructor.name+" {\n  "+a+u+"\n"+a+"}":"{\n  "+a+u+"\n"+a+"}"}if(!(e.length>0))return"Array";var s=function(){if(t>n)return{v:"[...]"};var o=i(e[0],t);return e.every(function(e){return i(e,t)===o})?{v:o.trim()+"[]"}:{v:"["+e.slice(0,r).map(function(e){return i(e,t)}).join(", ")+(e.length>=r?", ...":"")+"]"}}();return"object"===("undefined"==typeof s?"undefined":(0,y["default"])(s))?s.v:void 0}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=void 0;var u,s,c=n(7),l=r(c),f=n(6),d=r(f),p=n(10),y=r(p),h=n(11),g=r(h),v=n(9),m=r(v),b=n(8),w=r(b),E=n(3),x=r(E),_=n(1),k=r(_),O=n(2),I=r(O),j=n(5),T=r(j),A=n(4),M=r(A),G=n(20),V=r(G),z=(u=(0,G.recoverFromNotFound)(),s=function(e){function t(){return(0,k["default"])(this,t),(0,T["default"])(this,(0,x["default"])(t).apply(this,arguments))}return(0,M["default"])(t,e),(0,I["default"])(t,[{key:"find",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,w["default"])(m["default"].mark(function n(e){var t;return m["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof e){n.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));case 2:if("string"==typeof e){n.next=4;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));case 4:return n.next=6,this.httpClient.get("/dist_list/:id",{urlParams:{id:e}});case 6:return t=n.sent,n.abrupt("return",t.data);case 8:case"end":return n.stop()}},n,this)}));return e}()}]),t}(V["default"]),o(s.prototype,"find",[u],(0,g["default"])(s.prototype,"find"),s.prototype),s);t["default"]=z,e.exports=t["default"]},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t,n,r,o){var a={};return Object.keys(r).forEach(function(e){a[e]=r[e]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},a),o&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(o):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}function a(e,t){var n=4,r=15;if(void 0===t&&(t=0),t+=1,null===e)return"null";if(void 0===e)return"void";if("string"==typeof e||"number"==typeof e||"boolean"==typeof e)return"undefined"==typeof e?"undefined":(0,h["default"])(e);if(!Array.isArray(e)){var o=(0,p["default"])(e);if(!o.length)return e.constructor&&e.constructor.name&&"Object"!==e.constructor.name?e.constructor.name:"Object";if(t>n)return"{...}";var i="  ".repeat(t-1),u=o.slice(0,r).map(function(n){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(n)?n:(0,f["default"])(n))+": "+a(e[n],t)+";"}).join("\n  "+i);return o.length>=r&&(u+="\n  "+i+"..."),e.constructor&&e.constructor.name&&"Object"!==e.constructor.name?e.constructor.name+" {\n  "+i+u+"\n"+i+"}":"{\n  "+i+u+"\n"+i+"}"}if(!(e.length>0))return"Array";var s=function(){if(t>n)return{v:"[...]"};var o=a(e[0],t);return e.every(function(e){return a(e,t)===o})?{v:o.trim()+"[]"}:{v:"["+e.slice(0,r).map(function(e){return a(e,t)}).join(", ")+(e.length>=r?", ...":"")+"]"}}();return"object"===("undefined"==typeof s?"undefined":(0,h["default"])(s))?s.v:void 0}function i(e,t){var n=4,r=15;if(void 0===t&&(t=0),t+=1,null===e)return"null";if(void 0===e)return"void";if("string"==typeof e||"number"==typeof e||"boolean"==typeof e)return"undefined"==typeof e?"undefined":(0,h["default"])(e);if(!Array.isArray(e)){var o=(0,p["default"])(e);if(!o.length)return e.constructor&&e.constructor.name&&"Object"!==e.constructor.name?e.constructor.name:"Object";if(t>n)return"{...}";var a="  ".repeat(t-1),u=o.slice(0,r).map(function(n){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(n)?n:(0,f["default"])(n))+": "+i(e[n],t)+";"}).join("\n  "+a);return o.length>=r&&(u+="\n  "+a+"..."),e.constructor&&e.constructor.name&&"Object"!==e.constructor.name?e.constructor.name+" {\n  "+a+u+"\n"+a+"}":"{\n  "+a+u+"\n"+a+"}"}if(!(e.length>0))return"Array";var s=function(){if(t>n)return{v:"[...]"};var o=i(e[0],t);return e.every(function(e){return i(e,t)===o})?{v:o.trim()+"[]"}:{v:"["+e.slice(0,r).map(function(e){return i(e,t)}).join(", ")+(e.length>=r?", ...":"")+"]"}}();return"object"===("undefined"==typeof s?"undefined":(0,h["default"])(s))?s.v:void 0}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=void 0;var u,s,c,l=n(7),f=r(l),d=n(6),p=r(d),y=n(10),h=r(y),g=n(11),v=r(g),m=n(9),b=r(m),w=n(8),E=r(w),x=n(3),_=r(x),k=n(1),O=r(k),I=n(2),j=r(I),T=n(5),A=r(T),M=n(4),G=r(M),V=n(20),z=r(V),P=(u=(0,V.recoverFromNotFound)(),s=(0,V.recoverFromNotFound)({httpStatusCodes:[404,403]}),c=function(e){function t(){return(0,O["default"])(this,t),(0,A["default"])(this,(0,_["default"])(t).apply(this,arguments))}return(0,G["default"])(t,e),(0,j["default"])(t,[{key:"create",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,E["default"])(b["default"].mark(function n(e){var t,r,o,a,i,u,s,c=e.name,l=e.avatarFile,f=e.replayHistory,d=void 0===f?!0:f,p=e.memberIds,y=void 0===p?[]:p,h=e.organizationId;return b["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t={},r={name:c,replay_history:d,members:y.join(",")},o={},l&&(o.avatar=l),h&&(t["TT-X-Organization-Key"]=h),e.next=7,this.httpClient.post("/group",{headers:t,data:r,files:o});case 7:return a=e.sent,i=a.getHeader("TT-X-Group-Token"),u=a.getHeader("TT-X-Group-Avatar"),s={id:i,avatarUrl:u,name:c,memberIds:y,organizationId:h},e.abrupt("return",s);case 12:case"end":return e.stop()}},n,this)}));return e}()},{key:"update",value:function(){function e(e,n){return t.apply(this,arguments)}var t=(0,E["default"])(b["default"].mark(function n(e,t){var r,o,a,i,u=t.name,s=void 0===u?void 0:u,c=t.avatarFile,l=void 0===c?void 0:c,f=t.replayHistory,d=void 0===f?void 0:f,p=t.memberIds;return b["default"].wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r={},o={},"undefined"!=typeof s&&(r.name=s),"undefined"!=typeof p&&(r.members=p.join(",")),"undefined"!=typeof d&&(r.replay_history=d),l&&(o.avatar=l),t.next=8,this.httpClient.post("/group/:id",{urlParams:{id:e},data:r,files:o});case 8:return a=t.sent,i=a.getHeader("TT-X-Group-Avatar"),t.abrupt("return",{id:e,avatarUrl:i});case 11:case"end":return t.stop()}},n,this)}));return e}()},{key:"find",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,E["default"])(b["default"].mark(function n(e){var t;return b["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof e){n.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));case 2:if("string"==typeof e){n.next=4;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));case 4:return n.next=6,this.httpClient.get("/group/:id",{urlParams:{id:e}});case 6:return t=n.sent,n.abrupt("return",t.data);case 8:case"end":return n.stop()}},n,this)}));return e}()},{key:"destroy",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,E["default"])(b["default"].mark(function n(e){return b["default"].wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if("string"==typeof e){t.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));case 2:if("string"==typeof e){t.next=4;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));case 4:return t.next=6,this.httpClient.del("/group/:id",{urlParams:{id:e}});case 6:return t.abrupt("return",!0);case 7:case"end":return t.stop()}},n,this)}));return e}()},{key:"addMembers",value:function(){function e(e,n){return t.apply(this,arguments)}var t=(0,E["default"])(b["default"].mark(function n(e,t){return b["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof e){n.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));case 2:if(Array.isArray(t)&&t.every(function(e){return"string"==typeof e})){n.next=4;break}throw new TypeError('Value of argument "memberIds" violates contract.\n\nExpected:\nstring[]\n\nGot:\n'+i(t));case 4:if("string"==typeof e){n.next=6;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));case 6:if(Array.isArray(t)&&t.every(function(e){return"string"==typeof e})){n.next=8;break}throw new TypeError('Value of argument "memberIds" violates contract.\n\nExpected:\nstring[]\n\nGot:\n'+a(t));case 8:return n.next=10,this.httpClient.post("/group/:id/members",{urlParams:{id:e},data:{members:t}});case 10:case"end":return n.stop()}},n,this)}));return e}()},{key:"removeMembers",value:function(){function e(e,n){return t.apply(this,arguments)}var t=(0,E["default"])(b["default"].mark(function n(e,t){return b["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof e){n.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));case 2:if(Array.isArray(t)&&t.every(function(e){return"string"==typeof e})){n.next=4;break}throw new TypeError('Value of argument "memberIds" violates contract.\n\nExpected:\nstring[]\n\nGot:\n'+i(t));case 4:if("string"==typeof e){n.next=6;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));case 6:if(Array.isArray(t)&&t.every(function(e){return"string"==typeof e})){n.next=8;break}throw new TypeError('Value of argument "memberIds" violates contract.\n\nExpected:\nstring[]\n\nGot:\n'+a(t));case 8:return n.next=10,this.httpClient.post("/group/:id/members/remove",{urlParams:{id:e},data:{members:t}});case 10:case"end":return n.stop()}},n,this)}));return e}()}]),t}(z["default"]),o(c.prototype,"find",[u],(0,v["default"])(c.prototype,"find"),c.prototype),o(c.prototype,"destroy",[s],(0,v["default"])(c.prototype,"destroy"),c.prototype),c);t["default"]=P,e.exports=t["default"]},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){var n=4,r=15;if(void 0===t&&(t=0),t+=1,null===e)return"null";if(void 0===e)return"void";if("string"==typeof e||"number"==typeof e||"boolean"==typeof e)return"undefined"==typeof e?"undefined":(0,c["default"])(e);if(!Array.isArray(e)){var a=(0,u["default"])(e);if(!a.length)return e.constructor&&e.constructor.name&&"Object"!==e.constructor.name?e.constructor.name:"Object";if(t>n)return"{...}";var i="  ".repeat(t-1),s=a.slice(0,r).map(function(n){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(n)?n:(0,p["default"])(n))+": "+o(e[n],t)+";"}).join("\n  "+i);return a.length>=r&&(s+="\n  "+i+"..."),e.constructor&&e.constructor.name&&"Object"!==e.constructor.name?e.constructor.name+" {\n  "+i+s+"\n"+i+"}":"{\n  "+i+s+"\n"+i+"}"}if(!(e.length>0))return"Array";var l=function(){if(t>n)return{v:"[...]"};var a=o(e[0],t);return e.every(function(e){return o(e,t)===a})?{v:a.trim()+"[]"}:{v:"["+e.slice(0,r).map(function(e){return o(e,t)}).join(", ")+(e.length>=r?", ...":"")+"]"}}();return"object"===("undefined"==typeof l?"undefined":(0,c["default"])(l))?l.v:void 0}function a(e,t){var n=4,r=15;if(void 0===t&&(t=0),t+=1,null===e)return"null";if(void 0===e)return"void";if("string"==typeof e||"number"==typeof e||"boolean"==typeof e)return"undefined"==typeof e?"undefined":(0,c["default"])(e);if(!Array.isArray(e)){var o=(0,u["default"])(e);if(!o.length)return e.constructor&&e.constructor.name&&"Object"!==e.constructor.name?e.constructor.name:"Object";if(t>n)return"{...}";var i="  ".repeat(t-1),s=o.slice(0,r).map(function(n){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(n)?n:(0,p["default"])(n))+": "+a(e[n],t)+";"}).join("\n  "+i);return o.length>=r&&(s+="\n  "+i+"..."),e.constructor&&e.constructor.name&&"Object"!==e.constructor.name?e.constructor.name+" {\n  "+i+s+"\n"+i+"}":"{\n  "+i+s+"\n"+i+"}"}if(!(e.length>0))return"Array";var l=function(){if(t>n)return{v:"[...]"};var o=a(e[0],t);return e.every(function(e){return a(e,t)===o})?{v:o.trim()+"[]"}:{v:"["+e.slice(0,r).map(function(e){return a(e,t)}).join(", ")+(e.length>=r?", ...":"")+"]"}}();return"object"===("undefined"==typeof l?"undefined":(0,c["default"])(l))?l.v:void 0}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=void 0;var i=n(6),u=r(i),s=n(10),c=r(s),l=n(9),f=r(l),d=n(7),p=r(d),y=n(18),h=r(y),g=n(8),v=r(g),m=n(3),b=r(m),w=n(1),E=r(w),x=n(2),_=r(x),k=n(5),O=r(k),I=n(4),j=r(I),T=n(20),A=r(T),M=function(e){function t(){return(0,E["default"])(this,t),(0,O["default"])(this,(0,b["default"])(t).apply(this,arguments))}return(0,j["default"])(t,e),(0,_["default"])(t,[{key:"send",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,v["default"])(f["default"].mark(function n(e){var t,r,i,u,s=e.counterPartyId,c=e.body,l=e.senderOrganizationId,d=e.recipientOrganizationId,y=e.attachment,g=e.metadata,v=e.priority,m=e.ttl,b=e.dor,w=e.localId,E=arguments;return f["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(null==E[0]||"string"!=typeof E[0].counterPartyId||"string"!=typeof E[0].body||"string"!=typeof E[0].senderOrganizationId||"string"!=typeof E[0].recipientOrganizationId||!(null==E[0].attachment||E[0].attachment instanceof Object||null==E[0].attachment||"string"==typeof E[0].attachment)||!(null==E[0].metadata||E[0].metadata instanceof Object)||null!=E[0].priority&&"number"!=typeof E[0].priority||null!=E[0].ttl&&"number"!=typeof E[0].ttl||null!=E[0].dor&&"boolean"!=typeof E[0].dor||"string"!=typeof E[0].localId)){e.next=2;break}throw new TypeError("Value of argument 0 violates contract.\n\nExpected:\n{ counterPartyId: string;\n  body: string;\n  senderOrganizationId: string;\n  recipientOrganizationId: string;\n  attachment: ?Object | ?string;\n  metadata: ?Object;\n  priority: ?number;\n  ttl: ?number;\n  dor: ?bool;\n  localId: string;\n}\n\nGot:\n"+a(E[0]));case 2:if(!(null==E[0]||"string"!=typeof E[0].counterPartyId||"string"!=typeof E[0].body||"string"!=typeof E[0].senderOrganizationId||"string"!=typeof E[0].recipientOrganizationId||!(null==E[0].attachment||E[0].attachment instanceof Object||null==E[0].attachment||"string"==typeof E[0].attachment)||!(null==E[0].metadata||E[0].metadata instanceof Object)||null!=E[0].priority&&"number"!=typeof E[0].priority||null!=E[0].ttl&&"number"!=typeof E[0].ttl||null!=E[0].dor&&"boolean"!=typeof E[0].dor||"string"!=typeof E[0].localId)){e.next=4;break}throw new TypeError("Value of argument 0 violates contract.\n\nExpected:\n{ counterPartyId: string;\n  body: string;\n  senderOrganizationId: string;\n  recipientOrganizationId: string;\n  attachment: ?Object | ?string;\n  metadata: ?Object;\n  priority: ?number;\n  ttl: ?number;\n  dor: ?bool;\n  localId: string;\n}\n\nGot:\n"+o(E[0]));case 4:return d||(d=l),t={recipient:s,body:c
},r={},g&&(t.data=g.map(function(e){return(0,h["default"])({},e,{payload:(0,p["default"])(e.payload)})})),l&&(t.sender_organization=l),d&&(t.recipient_organization=d),"undefined"!=typeof v&&(t.priority=v),y&&(r.attachment=y),m&&(t.ttl=m),b&&(t.dor=b),e.next=16,this.httpClient.post("/message",{data:t,files:r,requestId:w});case 16:return i=e.sent,u={serverId:i.getHeader("TT-X-Message-Id"),ttl:+i.getHeader("TT-X-Msg-Ttl")},e.abrupt("return",u);case 19:case"end":return e.stop()}},n,this)}));return e}()},{key:"destroy",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,v["default"])(f["default"].mark(function n(e){return f["default"].wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if("string"==typeof e){t.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));case 2:if("string"==typeof e){t.next=4;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+o(e));case 4:return t.prev=4,t.next=7,this.httpClient.del("/message/:id",{urlParams:{id:e}});case 7:return t.abrupt("return",!0);case 10:return t.prev=10,t.t0=t["catch"](4),t.abrupt("return",!1);case 13:case"end":return t.stop()}},n,this,[[4,10]])}));return e}()},{key:"startTyping",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,v["default"])(f["default"].mark(function n(e){return f["default"].wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if("string"==typeof e){t.next=2;break}throw new TypeError('Value of argument "recipientId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));case 2:if("string"==typeof e){t.next=4;break}throw new TypeError('Value of argument "recipientId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+o(e));case 4:return t.next=6,this.httpClient.post("/message/typing",{data:{recipient:e}});case 6:case"end":return t.stop()}},n,this)}));return e}()},{key:"stopTyping",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,v["default"])(f["default"].mark(function n(e){return f["default"].wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if("string"==typeof e){t.next=2;break}throw new TypeError('Value of argument "recipientId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));case 2:if("string"==typeof e){t.next=4;break}throw new TypeError('Value of argument "recipientId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+o(e));case 4:return t.next=6,this.httpClient.del("/message/typing/:recipientId",{urlParams:{recipientId:e}});case 6:case"end":return t.stop()}},n,this)}));return e}()},{key:"forward",value:function(){function e(e,n,r){return t.apply(this,arguments)}var t=(0,v["default"])(f["default"].mark(function n(e,t,r){var i,u,s,c=r.senderOrganizationId,l=r.recipientOrganizationId,d=r.priority,p=r.localId,y=arguments;return f["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof e){n.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));case 2:if("string"==typeof t){n.next=4;break}throw new TypeError('Value of argument "counterPartyId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));case 4:if(!(null==y[2]||null!=y[2].senderOrganizationId&&"string"!=typeof y[2].senderOrganizationId||null!=y[2].recipientOrganizationId&&"string"!=typeof y[2].recipientOrganizationId||null!=y[2].priority&&"number"!=typeof y[2].priority||"string"!=typeof y[2].localId)){n.next=6;break}throw new TypeError("Value of argument 2 violates contract.\n\nExpected:\n{ senderOrganizationId: ?string;\n  recipientOrganizationId: ?string;\n  priority: ?number;\n  localId: string;\n}\n\nGot:\n"+a(y[2]));case 6:if("string"==typeof e){n.next=8;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+o(e));case 8:if("string"==typeof t){n.next=10;break}throw new TypeError('Value of argument "counterPartyId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+o(t));case 10:if(!(null==y[2]||null!=y[2].senderOrganizationId&&"string"!=typeof y[2].senderOrganizationId||null!=y[2].recipientOrganizationId&&"string"!=typeof y[2].recipientOrganizationId||null!=y[2].priority&&"number"!=typeof y[2].priority||"string"!=typeof y[2].localId)){n.next=12;break}throw new TypeError("Value of argument 2 violates contract.\n\nExpected:\n{ senderOrganizationId: ?string;\n  recipientOrganizationId: ?string;\n  priority: ?number;\n  localId: string;\n}\n\nGot:\n"+o(y[2]));case 12:return l||(l=c),i={recipient:t},c&&(i.sender_organization=c),l&&(i.recipient_organization=l),"undefined"!=typeof d&&(i.priority=d),n.next=19,this.httpClient.post("/message/:id/forward",{urlParams:{id:e},data:i,requestId:p});case 19:return u=n.sent,s={serverId:u.getHeader("TT-X-Message-Id")},n.abrupt("return",s);case 22:case"end":return n.stop()}},n,this)}));return e}()}]),t}(A["default"]);t["default"]=M,e.exports=t["default"]},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){var n=4,r=15;if(void 0===t&&(t=0),t+=1,null===e)return"null";if(void 0===e)return"void";if("string"==typeof e||"number"==typeof e||"boolean"==typeof e)return"undefined"==typeof e?"undefined":(0,f["default"])(e);if(!Array.isArray(e)){var a=(0,c["default"])(e);if(!a.length)return e.constructor&&e.constructor.name&&"Object"!==e.constructor.name?e.constructor.name:"Object";if(t>n)return"{...}";var i="  ".repeat(t-1),s=a.slice(0,r).map(function(n){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(n)?n:(0,u["default"])(n))+": "+o(e[n],t)+";"}).join("\n  "+i);return a.length>=r&&(s+="\n  "+i+"..."),e.constructor&&e.constructor.name&&"Object"!==e.constructor.name?e.constructor.name+" {\n  "+i+s+"\n"+i+"}":"{\n  "+i+s+"\n"+i+"}"}if(!(e.length>0))return"Array";var l=function(){if(t>n)return{v:"[...]"};var a=o(e[0],t);return e.every(function(e){return o(e,t)===a})?{v:a.trim()+"[]"}:{v:"["+e.slice(0,r).map(function(e){return o(e,t)}).join(", ")+(e.length>=r?", ...":"")+"]"}}();return"object"===("undefined"==typeof l?"undefined":(0,f["default"])(l))?l.v:void 0}function a(e,t){var n=4,r=15;if(void 0===t&&(t=0),t+=1,null===e)return"null";if(void 0===e)return"void";if("string"==typeof e||"number"==typeof e||"boolean"==typeof e)return"undefined"==typeof e?"undefined":(0,f["default"])(e);if(!Array.isArray(e)){var o=(0,c["default"])(e);if(!o.length)return e.constructor&&e.constructor.name&&"Object"!==e.constructor.name?e.constructor.name:"Object";if(t>n)return"{...}";var i="  ".repeat(t-1),s=o.slice(0,r).map(function(n){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(n)?n:(0,u["default"])(n))+": "+a(e[n],t)+";"}).join("\n  "+i);return o.length>=r&&(s+="\n  "+i+"..."),e.constructor&&e.constructor.name&&"Object"!==e.constructor.name?e.constructor.name+" {\n  "+i+s+"\n"+i+"}":"{\n  "+i+s+"\n"+i+"}"}if(!(e.length>0))return"Array";var l=function(){if(t>n)return{v:"[...]"};var o=a(e[0],t);return e.every(function(e){return a(e,t)===o})?{v:o.trim()+"[]"}:{v:"["+e.slice(0,r).map(function(e){return a(e,t)}).join(", ")+(e.length>=r?", ...":"")+"]"}}();return"object"===("undefined"==typeof l?"undefined":(0,f["default"])(l))?l.v:void 0}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=void 0;var i=n(7),u=r(i),s=n(6),c=r(s),l=n(10),f=r(l),d=n(170),p=r(d),y=n(9),h=r(y),g=n(8),v=r(g),m=n(3),b=r(m),w=n(1),E=r(w),x=n(2),_=r(x),k=n(5),O=r(k),I=n(4),j=r(I),T=n(20),A=r(T),M=function(e){function t(){return(0,E["default"])(this,t),(0,O["default"])(this,(0,b["default"])(t).apply(this,arguments))}return(0,j["default"])(t,e),(0,_["default"])(t,[{key:"update",value:function(){function e(e,n,r){return t.apply(this,arguments)}var t=(0,v["default"])(h["default"].mark(function n(e,t,r){return h["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof e){n.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));case 2:if(t instanceof Object){n.next=4;break}throw new TypeError('Value of argument "data" violates contract.\n\nExpected:\nObject\n\nGot:\n'+a(t));case 4:if("string"==typeof r){n.next=6;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(r));case 6:if("string"==typeof e){n.next=8;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+o(e));case 8:if(t instanceof Object){n.next=10;break}throw new TypeError('Value of argument "data" violates contract.\n\nExpected:\nObject\n\nGot:\n'+o(t));case 10:if("string"==typeof r){n.next=12;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+o(r));case 12:return n.next=14,this.httpClient.post("/metadata/:id",{urlParams:{id:e},data:t,headers:{"TT-X-Organization-Key":r}});case 14:case"end":return n.stop()}},n,this)}));return e}()},{key:"find",value:function(){function e(e,n){return t.apply(this,arguments)}var t=(0,v["default"])(h["default"].mark(function n(e,t){var r;return h["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof e){n.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));case 2:if("string"==typeof t){n.next=4;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));case 4:if("string"==typeof e){n.next=6;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+o(e));case 6:if("string"==typeof t){n.next=8;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+o(t));case 8:return n.next=10,this.httpClient.get("/metadata/:id",{urlParams:{id:e},headers:{"TT-X-Organization-Key":t}});case 10:return r=n.sent,n.abrupt("return",r.data);case 12:case"end":return n.stop()}},n,this)}));return e}()},{key:"findMulti",value:function(){function e(e,n){return t.apply(this,arguments)}var t=(0,v["default"])(h["default"].mark(function n(e,t){var r,i;return h["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(Array.isArray(e)&&e.every(function(e){return"string"==typeof e})){n.next=2;break}throw new TypeError('Value of argument "ids" violates contract.\n\nExpected:\nstring[]\n\nGot:\n'+a(e));case 2:if("string"==typeof t){n.next=4;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));case 4:if(Array.isArray(e)&&e.every(function(e){return"string"==typeof e})){n.next=6;break}throw new TypeError('Value of argument "ids" violates contract.\n\nExpected:\nstring[]\n\nGot:\n'+o(e));case 6:if("string"==typeof t){n.next=8;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+o(t));case 8:return n.next=10,this.httpClient.post("/metadata_bulk",{data:{entities:e},headers:{"TT-X-Organization-Key":t}});case 10:return r=n.sent,i=(0,p["default"])(e,r.data),n.abrupt("return",i);case 13:case"end":return n.stop()}},n,this)}));return e}()}]),t}(A["default"]);t["default"]=M,e.exports=t["default"]},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t,n,r,o){var a={};return Object.keys(r).forEach(function(e){a[e]=r[e]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},a),o&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(o):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}function a(e,t){var n=4,r=15;if(void 0===t&&(t=0),t+=1,null===e)return"null";if(void 0===e)return"void";if("string"==typeof e||"number"==typeof e||"boolean"==typeof e)return"undefined"==typeof e?"undefined":(0,b["default"])(e);if(!Array.isArray(e)){var o=(0,v["default"])(e);if(!o.length)return e.constructor&&e.constructor.name&&"Object"!==e.constructor.name?e.constructor.name:"Object";if(t>n)return"{...}";var i="  ".repeat(t-1),u=o.slice(0,r).map(function(n){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(n)?n:(0,h["default"])(n))+": "+a(e[n],t)+";"}).join("\n  "+i);return o.length>=r&&(u+="\n  "+i+"..."),e.constructor&&e.constructor.name&&"Object"!==e.constructor.name?e.constructor.name+" {\n  "+i+u+"\n"+i+"}":"{\n  "+i+u+"\n"+i+"}"}if(!(e.length>0))return"Array";var s=function(){if(t>n)return{v:"[...]"};var o=a(e[0],t);return e.every(function(e){return a(e,t)===o})?{v:o.trim()+"[]"}:{v:"["+e.slice(0,r).map(function(e){return a(e,t)}).join(", ")+(e.length>=r?", ...":"")+"]"}}();return"object"===("undefined"==typeof s?"undefined":(0,b["default"])(s))?s.v:void 0}function i(e,t){var n=4,r=15;if(void 0===t&&(t=0),t+=1,null===e)return"null";if(void 0===e)return"void";if("string"==typeof e||"number"==typeof e||"boolean"==typeof e)return"undefined"==typeof e?"undefined":(0,b["default"])(e);if(!Array.isArray(e)){var o=(0,v["default"])(e);if(!o.length)return e.constructor&&e.constructor.name&&"Object"!==e.constructor.name?e.constructor.name:"Object";if(t>n)return"{...}";var a="  ".repeat(t-1),u=o.slice(0,r).map(function(n){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(n)?n:(0,h["default"])(n))+": "+i(e[n],t)+";"}).join("\n  "+a);return o.length>=r&&(u+="\n  "+a+"..."),e.constructor&&e.constructor.name&&"Object"!==e.constructor.name?e.constructor.name+" {\n  "+a+u+"\n"+a+"}":"{\n  "+a+u+"\n"+a+"}"}if(!(e.length>0))return"Array";var s=function(){if(t>n)return{v:"[...]"};var o=i(e[0],t);return e.every(function(e){return i(e,t)===o})?{v:o.trim()+"[]"}:{v:"["+e.slice(0,r).map(function(e){return i(e,t)}).join(", ")+(e.length>=r?", ...":"")+"]"}}();return"object"===("undefined"==typeof s?"undefined":(0,b["default"])(s))?s.v:void 0}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=void 0;var u,s,c,l,f,d,p,y=n(7),h=r(y),g=n(6),v=r(g),m=n(10),b=r(m),w=n(11),E=r(w),x=n(9),_=r(x),k=n(8),O=r(k),I=n(3),j=r(I),T=n(1),A=r(T),M=n(2),G=r(M),V=n(5),z=r(V),P=n(4),C=r(P),S=n(20),U=r(S),q=(u=(0,S.recoverFromNotFound)(),s=(0,S.recoverFromNotFound)(),c=(0,S.recoverFromNotFound)(),l=(0,S.recoverFromNotFound)(),f=(0,S.recoverFromNotFound)(),d=(0,S.recoverFromNotFound)(),p=function(e){function t(){return(0,A["default"])(this,t),(0,z["default"])(this,(0,j["default"])(t).apply(this,arguments))}return(0,C["default"])(t,e),(0,G["default"])(t,[{key:"findAll",value:function(){function e(){return t.apply(this,arguments)}var t=(0,O["default"])(_["default"].mark(function n(){var e;return _["default"].wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.httpClient.get("/mute");case 2:return e=t.sent,t.abrupt("return",e.data);case 4:case"end":return t.stop()}},n,this)}));return e}()},{key:"unmuteAll",value:function(){function e(){return t.apply(this,arguments)}var t=(0,O["default"])(_["default"].mark(function n(){return _["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.httpClient.del("/mute");case 2:case"end":return e.stop()}},n,this)}));return e}()},{key:"muteUser",value:function(){function e(e,n,r,o){return t.apply(this,arguments)}var t=(0,O["default"])(_["default"].mark(function n(e,t,r){var o=arguments.length<=3||void 0===arguments[3]?{}:arguments[3],u=o.recipientOrganizationId,s=void 0===u?r:u;return _["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof e){n.next=2;break}throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));case 2:if("number"==typeof t){n.next=4;break}throw new TypeError('Value of argument "durationInMinutes" violates contract.\n\nExpected:\nnumber\n\nGot:\n'+i(t));case 4:if("string"==typeof r){n.next=6;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(r));case 6:if("string"==typeof e){n.next=8;break}throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));case 8:if("number"==typeof t){n.next=10;break}throw new TypeError('Value of argument "durationInMinutes" violates contract.\n\nExpected:\nnumber\n\nGot:\n'+a(t));case 10:if("string"==typeof r){n.next=12;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(r));case 12:return n.next=14,this.httpClient.post("/mute/p2p",{data:{sender_token:e,sender_organization:r,receiver_organization:s,duration:t.toString()}});case 14:case"end":return n.stop()}},n,this)}));return e}()},{key:"unmuteUser",value:function(){function e(e,n,r){return t.apply(this,arguments)}var t=(0,O["default"])(_["default"].mark(function n(e,t){var r=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],o=r.recipientOrganizationId,u=void 0===o?t:o;return _["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof e){n.next=2;break}throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));case 2:if("string"==typeof t){n.next=4;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));case 4:if("string"==typeof e){n.next=6;break}throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));case 6:if("string"==typeof t){n.next=8;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));case 8:return n.next=10,this.httpClient.del("/mute/p2p",{headers:{"TT-X-Sender-Token":e,"TT-X-Sender-Organization":t,"TT-X-Receiver-Organization":u}});case 10:case"end":return n.stop()}},n,this)}));return e}()},{key:"muteGroup",value:function(){function e(e,n,r){return t.apply(this,arguments)}var t=(0,O["default"])(_["default"].mark(function n(e,t,r){return _["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof e){n.next=2;break}throw new TypeError('Value of argument "groupId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));case 2:if("number"==typeof t){n.next=4;break}throw new TypeError('Value of argument "durationInMinutes" violates contract.\n\nExpected:\nnumber\n\nGot:\n'+i(t));case 4:if("string"==typeof r){n.next=6;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(r));case 6:if("string"==typeof e){n.next=8;break}throw new TypeError('Value of argument "groupId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));case 8:if("number"==typeof t){n.next=10;break}throw new TypeError('Value of argument "durationInMinutes" violates contract.\n\nExpected:\nnumber\n\nGot:\n'+a(t));case 10:if("string"==typeof r){n.next=12;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(r));case 12:return n.next=14,this.httpClient.post("/mute/group/:groupId",{urlParams:{groupId:e},data:{duration:t.toString(),receiver_organization:r}});case 14:case"end":return n.stop()}},n,this)}));return e}()},{key:"unmuteGroup",value:function(){function e(e,n){return t.apply(this,arguments)}var t=(0,O["default"])(_["default"].mark(function n(e,t){return _["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof e){n.next=2;break}throw new TypeError('Value of argument "groupId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));case 2:if("string"==typeof t){n.next=4;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));case 4:if("string"==typeof e){n.next=6;break}throw new TypeError('Value of argument "groupId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));case 6:if("string"==typeof t){n.next=8;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));case 8:return n.next=10,this.httpClient.del("/mute/group/:groupId",{urlParams:{groupId:e},headers:{"TT-X-Receiver-Organization":t}});case 10:case"end":return n.stop()}},n,this)}));return e}()},{key:"muteOrganization",value:function(){function e(e,n){return t.apply(this,arguments)}var t=(0,O["default"])(_["default"].mark(function n(e,t){return _["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof e){n.next=2;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));case 2:if("number"==typeof t){n.next=4;break}throw new TypeError('Value of argument "durationInMinutes" violates contract.\n\nExpected:\nnumber\n\nGot:\n'+i(t));case 4:if("string"==typeof e){n.next=6;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));case 6:if("number"==typeof t){n.next=8;break}throw new TypeError('Value of argument "durationInMinutes" violates contract.\n\nExpected:\nnumber\n\nGot:\n'+a(t));case 8:return n.next=10,this.httpClient.post("/mute/organization/:organizationId",{urlParams:{organizationId:e},data:{duration:t.toString(),receiver_organization:e}});case 10:case"end":return n.stop()}},n,this)}));return e}()},{key:"unmuteOrganization",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,O["default"])(_["default"].mark(function n(e){return _["default"].wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if("string"==typeof e){t.next=2;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));case 2:if("string"==typeof e){t.next=4;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));case 4:return t.next=6,this.httpClient.del("/mute/organization/:organizationId",{urlParams:{organizationId:e},headers:{"TT-X-Receiver-Organization":e}});case 6:case"end":return t.stop()}},n,this)}));return e}()}]),t}(U["default"]),o(p.prototype,"muteUser",[u],(0,E["default"])(p.prototype,"muteUser"),p.prototype),o(p.prototype,"unmuteUser",[s],(0,E["default"])(p.prototype,"unmuteUser"),p.prototype),o(p.prototype,"muteGroup",[c],(0,E["default"])(p.prototype,"muteGroup"),p.prototype),o(p.prototype,"unmuteGroup",[l],(0,E["default"])(p.prototype,"unmuteGroup"),p.prototype),o(p.prototype,"muteOrganization",[f],(0,E["default"])(p.prototype,"muteOrganization"),p.prototype),o(p.prototype,"unmuteOrganization",[d],(0,E["default"])(p.prototype,"unmuteOrganization"),p.prototype),p);t["default"]=q,e.exports=t["default"]},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t,n,r,o){var a={};return Object.keys(r).forEach(function(e){a[e]=r[e]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},a),o&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(o):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}function a(e,t){var n=4,r=15;if(void 0===t&&(t=0),t+=1,null===e)return"null";if(void 0===e)return"void";if("string"==typeof e||"number"==typeof e||"boolean"==typeof e)return"undefined"==typeof e?"undefined":(0,h["default"])(e);if(!Array.isArray(e)){var o=(0,p["default"])(e);if(!o.length)return e.constructor&&e.constructor.name&&"Object"!==e.constructor.name?e.constructor.name:"Object";if(t>n)return"{...}";var i="  ".repeat(t-1),u=o.slice(0,r).map(function(n){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(n)?n:(0,f["default"])(n))+": "+a(e[n],t)+";"}).join("\n  "+i);return o.length>=r&&(u+="\n  "+i+"..."),e.constructor&&e.constructor.name&&"Object"!==e.constructor.name?e.constructor.name+" {\n  "+i+u+"\n"+i+"}":"{\n  "+i+u+"\n"+i+"}"}if(!(e.length>0))return"Array";var s=function(){if(t>n)return{v:"[...]"};var o=a(e[0],t);return e.every(function(e){return a(e,t)===o})?{v:o.trim()+"[]"}:{v:"["+e.slice(0,r).map(function(e){return a(e,t)}).join(", ")+(e.length>=r?", ...":"")+"]"}}();return"object"===("undefined"==typeof s?"undefined":(0,h["default"])(s))?s.v:void 0}function i(e,t){var n=4,r=15;if(void 0===t&&(t=0),t+=1,null===e)return"null";if(void 0===e)return"void";if("string"==typeof e||"number"==typeof e||"boolean"==typeof e)return"undefined"==typeof e?"undefined":(0,h["default"])(e);if(!Array.isArray(e)){var o=(0,p["default"])(e);if(!o.length)return e.constructor&&e.constructor.name&&"Object"!==e.constructor.name?e.constructor.name:"Object";if(t>n)return"{...}";var a="  ".repeat(t-1),u=o.slice(0,r).map(function(n){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(n)?n:(0,f["default"])(n))+": "+i(e[n],t)+";"}).join("\n  "+a);return o.length>=r&&(u+="\n  "+a+"..."),e.constructor&&e.constructor.name&&"Object"!==e.constructor.name?e.constructor.name+" {\n  "+a+u+"\n"+a+"}":"{\n  "+a+u+"\n"+a+"}"}if(!(e.length>0))return"Array";var s=function(){if(t>n)return{v:"[...]"};var o=i(e[0],t);return e.every(function(e){return i(e,t)===o})?{v:o.trim()+"[]"}:{v:"["+e.slice(0,r).map(function(e){return i(e,t)}).join(", ")+(e.length>=r?", ...":"")+"]"}}();return"object"===("undefined"==typeof s?"undefined":(0,h["default"])(s))?s.v:void 0}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=void 0;var u,s,c,l=n(7),f=r(l),d=n(6),p=r(d),y=n(10),h=r(y),g=n(11),v=r(g),m=n(9),b=r(m),w=n(8),E=r(w),x=n(3),_=r(x),k=n(1),O=r(k),I=n(2),j=r(I),T=n(5),A=r(T),M=n(4),G=r(M),V=n(20),z=r(V),P=(u=(0,V.recoverFromNotFound)(),s=(0,V.recoverFromNotFound)(),c=function(e){function t(){return(0,O["default"])(this,t),(0,A["default"])(this,(0,_["default"])(t).apply(this,arguments))}return(0,G["default"])(t,e),(0,j["default"])(t,[{key:"find",value:function(){function e(e,n){return t.apply(this,arguments)}var t=(0,E["default"])(b["default"].mark(function n(e,t){var r;return b["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof e){n.next=2;break}throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));case 2:if("string"==typeof t){n.next=4;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));case 4:if("string"==typeof e){n.next=6;break}throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));case 6:if("string"==typeof t){n.next=8;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));case 8:return n.next=10,this.httpClient.get("/user/:userId/organization/:id",{urlParams:{userId:e,id:t}});case 10:return r=n.sent,n.abrupt("return",r.data);case 12:case"end":return n.stop()}},n,this)}));return e}()},{key:"findAllOfUser",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,E["default"])(b["default"].mark(function n(e){var t;return b["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof e){n.next=2;break}throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));case 2:if("string"==typeof e){n.next=4;break}throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));case 4:return n.next=6,this.httpClient.get("/user/:userId/organization",{urlParams:{userId:e}});case 6:return t=n.sent,n.abrupt("return",t.data);case 8:case"end":return n.stop()}},n,this)}));return e}()}]),t}(z["default"]),o(c.prototype,"find",[u],(0,v["default"])(c.prototype,"find"),c.prototype),o(c.prototype,"findAllOfUser",[s],(0,v["default"])(c.prototype,"findAllOfUser"),c.prototype),c);t["default"]=P,e.exports=t["default"]},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){var n=4,r=15;if(void 0===t&&(t=0),t+=1,null===e)return"null";if(void 0===e)return"void";if("string"==typeof e||"number"==typeof e||"boolean"==typeof e)return"undefined"==typeof e?"undefined":(0,f["default"])(e);if(!Array.isArray(e)){var a=(0,c["default"])(e);if(!a.length)return e.constructor&&e.constructor.name&&"Object"!==e.constructor.name?e.constructor.name:"Object";if(t>n)return"{...}";var i="  ".repeat(t-1),s=a.slice(0,r).map(function(n){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(n)?n:(0,u["default"])(n))+": "+o(e[n],t)+";"}).join("\n  "+i);return a.length>=r&&(s+="\n  "+i+"..."),e.constructor&&e.constructor.name&&"Object"!==e.constructor.name?e.constructor.name+" {\n  "+i+s+"\n"+i+"}":"{\n  "+i+s+"\n"+i+"}"}if(!(e.length>0))return"Array";var l=function(){if(t>n)return{v:"[...]"};var a=o(e[0],t);return e.every(function(e){return o(e,t)===a})?{v:a.trim()+"[]"}:{v:"["+e.slice(0,r).map(function(e){return o(e,t)}).join(", ")+(e.length>=r?", ...":"")+"]"}}();return"object"===("undefined"==typeof l?"undefined":(0,f["default"])(l))?l.v:void 0}function a(e,t){var n=4,r=15;if(void 0===t&&(t=0),t+=1,null===e)return"null";if(void 0===e)return"void";if("string"==typeof e||"number"==typeof e||"boolean"==typeof e)return"undefined"==typeof e?"undefined":(0,f["default"])(e);if(!Array.isArray(e)){var o=(0,c["default"])(e);if(!o.length)return e.constructor&&e.constructor.name&&"Object"!==e.constructor.name?e.constructor.name:"Object";if(t>n)return"{...}";var i="  ".repeat(t-1),s=o.slice(0,r).map(function(n){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(n)?n:(0,u["default"])(n))+": "+a(e[n],t)+";"}).join("\n  "+i);return o.length>=r&&(s+="\n  "+i+"..."),e.constructor&&e.constructor.name&&"Object"!==e.constructor.name?e.constructor.name+" {\n  "+i+s+"\n"+i+"}":"{\n  "+i+s+"\n"+i+"}"}if(!(e.length>0))return"Array";var l=function(){if(t>n)return{v:"[...]"};var o=a(e[0],t);return e.every(function(e){return a(e,t)===o})?{v:o.trim()+"[]"}:{v:"["+e.slice(0,r).map(function(e){return a(e,t)}).join(", ")+(e.length>=r?", ...":"")+"]"}}();return"object"===("undefined"==typeof l?"undefined":(0,f["default"])(l))?l.v:void 0}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=void 0;var i=n(7),u=r(i),s=n(6),c=r(s),l=n(10),f=r(l),d=n(150),p=r(d),y=n(9),h=r(y),g=n(8),v=r(g),m=n(3),b=r(m),w=n(1),E=r(w),x=n(2),_=r(x),k=n(5),O=r(k),I=n(4),j=r(I),T=n(20),A=r(T),M=["user","distributionList"],G=function(e){function t(){return(0,E["default"])(this,t),(0,O["default"])(this,(0,b["default"])(t).apply(this,arguments))}return(0,j["default"])(t,e),(0,_["default"])(t,[{key:"findAll",value:function(){function e(){return t.apply(this,arguments)}var t=(0,v["default"])(h["default"].mark(function n(){var e;return h["default"].wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.httpClient.get("/roster");case 2:return e=t.sent,t.abrupt("return",e.data);case 4:case"end":return t.stop()}},n,this)}));return e}()},{key:"add",value:function(){function e(e,n,r){return t.apply(this,arguments)}var t=(0,v["default"])(h["default"].mark(function n(e,t,r){var i,u;return h["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof e){n.next=2;break}throw new TypeError('Value of argument "counterPartyType" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));case 2:if("string"==typeof t){n.next=4;break}throw new TypeError('Value of argument "counterPartyId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));case 4:if("string"==typeof r){n.next=6;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(r));case 6:if("string"==typeof e){n.next=8;break}throw new TypeError('Value of argument "counterPartyType" violates contract.\n\nExpected:\nstring\n\nGot:\n'+o(e));case 8:if("string"==typeof t){n.next=10;break}throw new TypeError('Value of argument "counterPartyId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+o(t));case 10:if("string"==typeof r){n.next=12;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+o(r));case 12:if((0,p["default"])(M,e)){n.next=14;break}return n.abrupt("return");case 14:return i={},r&&(i["TT-X-Organization-Key"]=r),u=this.__typeToNS(e),n.next=19,this.httpClient.post("/roster",{headers:i,data:{entity:t,type:u}});case 19:case"end":return n.stop()}},n,this);
}));return e}()},{key:"remove",value:function(){function e(e,n,r){return t.apply(this,arguments)}var t=(0,v["default"])(h["default"].mark(function n(e,t,r){var i,u;return h["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof e){n.next=2;break}throw new TypeError('Value of argument "counterPartyType" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));case 2:if("string"==typeof t){n.next=4;break}throw new TypeError('Value of argument "counterPartyId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));case 4:if("string"==typeof r){n.next=6;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(r));case 6:if("string"==typeof e){n.next=8;break}throw new TypeError('Value of argument "counterPartyType" violates contract.\n\nExpected:\nstring\n\nGot:\n'+o(e));case 8:if("string"==typeof t){n.next=10;break}throw new TypeError('Value of argument "counterPartyId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+o(t));case 10:if("string"==typeof r){n.next=12;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+o(r));case 12:if((0,p["default"])(M,e)){n.next=14;break}return n.abrupt("return");case 14:return i={},r&&(i["TT-X-Organization-Key"]=r),u=this.__typeToNS(e),n.next=19,this.httpClient.del("/roster/:counterPartyId",{headers:i,urlParams:{counterPartyId:t},data:{type:u}});case 19:case"end":return n.stop()}},n,this)}));return e}()},{key:"__typeToNS",value:function(e){return V[e]}}]),t}(A["default"]);t["default"]=G;var V={user:"tigertext:entity:account",distributionList:"tigertext:entity:list"};e.exports=t["default"]},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t,n,r,o){var a={};return Object.keys(r).forEach(function(e){a[e]=r[e]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},a),o&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(o):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}function a(e,t){var n=4,r=15;if(void 0===t&&(t=0),t+=1,null===e)return"null";if(void 0===e)return"void";if("string"==typeof e||"number"==typeof e||"boolean"==typeof e)return"undefined"==typeof e?"undefined":(0,y["default"])(e);if(!Array.isArray(e)){var o=(0,d["default"])(e);if(!o.length)return e.constructor&&e.constructor.name&&"Object"!==e.constructor.name?e.constructor.name:"Object";if(t>n)return"{...}";var i="  ".repeat(t-1),u=o.slice(0,r).map(function(n){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(n)?n:(0,l["default"])(n))+": "+a(e[n],t)+";"}).join("\n  "+i);return o.length>=r&&(u+="\n  "+i+"..."),e.constructor&&e.constructor.name&&"Object"!==e.constructor.name?e.constructor.name+" {\n  "+i+u+"\n"+i+"}":"{\n  "+i+u+"\n"+i+"}"}if(!(e.length>0))return"Array";var s=function(){if(t>n)return{v:"[...]"};var o=a(e[0],t);return e.every(function(e){return a(e,t)===o})?{v:o.trim()+"[]"}:{v:"["+e.slice(0,r).map(function(e){return a(e,t)}).join(", ")+(e.length>=r?", ...":"")+"]"}}();return"object"===("undefined"==typeof s?"undefined":(0,y["default"])(s))?s.v:void 0}function i(e,t){var n=4,r=15;if(void 0===t&&(t=0),t+=1,null===e)return"null";if(void 0===e)return"void";if("string"==typeof e||"number"==typeof e||"boolean"==typeof e)return"undefined"==typeof e?"undefined":(0,y["default"])(e);if(!Array.isArray(e)){var o=(0,d["default"])(e);if(!o.length)return e.constructor&&e.constructor.name&&"Object"!==e.constructor.name?e.constructor.name:"Object";if(t>n)return"{...}";var a="  ".repeat(t-1),u=o.slice(0,r).map(function(n){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(n)?n:(0,l["default"])(n))+": "+i(e[n],t)+";"}).join("\n  "+a);return o.length>=r&&(u+="\n  "+a+"..."),e.constructor&&e.constructor.name&&"Object"!==e.constructor.name?e.constructor.name+" {\n  "+a+u+"\n"+a+"}":"{\n  "+a+u+"\n"+a+"}"}if(!(e.length>0))return"Array";var s=function(){if(t>n)return{v:"[...]"};var o=i(e[0],t);return e.every(function(e){return i(e,t)===o})?{v:o.trim()+"[]"}:{v:"["+e.slice(0,r).map(function(e){return i(e,t)}).join(", ")+(e.length>=r?", ...":"")+"]"}}();return"object"===("undefined"==typeof s?"undefined":(0,y["default"])(s))?s.v:void 0}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=void 0;var u,s,c=n(7),l=r(c),f=n(6),d=r(f),p=n(10),y=r(p),h=n(11),g=r(h),v=n(9),m=r(v),b=n(8),w=r(b),E=n(3),x=r(E),_=n(1),k=r(_),O=n(2),I=r(O),j=n(5),T=r(j),A=n(4),M=r(A),G=n(20),V=r(G),z=(u=(0,G.recoverFromNotFound)(),s=function(e){function t(){return(0,k["default"])(this,t),(0,T["default"])(this,(0,x["default"])(t).apply(this,arguments))}return(0,M["default"])(t,e),(0,I["default"])(t,[{key:"find",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,w["default"])(m["default"].mark(function n(e){var t;return m["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof e){n.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));case 2:if("string"==typeof e){n.next=4;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));case 4:return n.next=6,this.httpClient.get("/user/:id",{urlParams:{id:e}});case 6:return t=n.sent,n.abrupt("return",t.data);case 8:case"end":return n.stop()}},n,this)}));return e}()}]),t}(V["default"]),o(s.prototype,"find",[u],(0,g["default"])(s.prototype,"find"),s.prototype),s);t["default"]=z,e.exports=t["default"]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={Roster:n(80),Users:n(81),Groups:n(75),DistributionLists:n(74),Organizations:n(79),Messages:n(76),Metadata:n(77),Mute:n(78)};t["default"]=r,e.exports=t["default"]},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=void 0;var o,a,i=n(3),u=r(i),s=n(1),c=r(s),l=n(5),f=r(l),d=n(4),p=r(d),y=(a=o=function(e){function t(){(0,c["default"])(this,t);var e=(0,f["default"])(this,(0,u["default"])(t).call(this,"You are not connected"));return e.code=t.CODE,e}return(0,p["default"])(t,e),t}(Error),o.CODE="connection-offline",a);t["default"]=y,e.exports=t["default"]},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=void 0;var o,a,i=n(3),u=r(i),s=n(1),c=r(s),l=n(5),f=r(l),d=n(4),p=r(d),y=(a=o=function(e){function t(e,n,r){(0,c["default"])(this,t);var o=(0,f["default"])(this,(0,u["default"])(t).call(this,r));return o.code=t.CODE,o.resource=e,o.id=n,o}return(0,p["default"])(t,e),t}(Error),o.CODE="not-found",a);t["default"]=y,e.exports=t["default"]},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=void 0;var o,a,i=n(3),u=r(i),s=n(1),c=r(s),l=n(5),f=r(l),d=n(4),p=r(d),y=(a=o=function(e){function t(){var e;(0,c["default"])(this,t);for(var n=arguments.length,r=Array(n),o=0;n>o;o++)r[o]=arguments[o];var a=(0,f["default"])(this,(e=(0,u["default"])(t)).call.apply(e,[this].concat(r)));return a.code=t.CODE,a}return(0,p["default"])(t,e),t}(Error),o.CODE="not-signed-in",a);t["default"]=y,e.exports=t["default"]},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=void 0;var o,a,i=n(3),u=r(i),s=n(1),c=r(s),l=n(5),f=r(l),d=n(4),p=r(d),y=(a=o=function(e){function t(e,n,r){var o=arguments.length<=3||void 0===arguments[3]?"can't perform action "+r+" on "+(e.name||e)+" #"+n:arguments[3];(0,c["default"])(this,t);var a=(0,f["default"])(this,(0,u["default"])(t).call(this,o));return a.code=t.CODE,a.resource=e,a.action=r,a.id=n,a}return(0,p["default"])(t,e),t}(Error),o.CODE="permission-denied",a);t["default"]=y,e.exports=t["default"]},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=void 0;var o,a,i=n(3),u=r(i),s=n(1),c=r(s),l=n(2),f=r(l),d=n(5),p=r(d),y=n(4),h=r(y),g=(a=o=function(e){function t(e){return(0,c["default"])(this,t),(0,p["default"])(this,(0,u["default"])(t).call(this,"method"+(e?" "+e:"")+" not supported in target node"))}return(0,h["default"])(t,e),(0,f["default"])(t,null,[{key:"raise",value:function(e){throw new this(e)}}]),t}(Error),o.CODE="target-not-supported",a);t["default"]=g,e.exports=t["default"]},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=void 0;var o,a,i=n(3),u=r(i),s=n(1),c=r(s),l=n(5),f=r(l),d=n(4),p=r(d),y=(a=o=function(e){function t(){var e;(0,c["default"])(this,t);for(var n=arguments.length,r=Array(n),o=0;n>o;o++)r[o]=arguments[o];var a=(0,f["default"])(this,(e=(0,u["default"])(t)).call.apply(e,[this].concat(r)));return a.code=t.CODE,a}return(0,p["default"])(t,e),t}(Error),o.CODE="wrong-credentials",a);t["default"]=y,e.exports=t["default"]},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(45),a=r(o);t["default"]=function(e){var t=e.defineModel("conversation",{instanceEvents:!0,transientAttrs:["messages","timeline","lastMessage","unreadCount","unreadMessages","lastEventMessageSortNumber","_counterPartyAddedOnServer"],defaultValues:{lastEventMessageSortNumber:0,messages:[],timeline:[],unreadMessages:[],unreadCount:0},computed:{counterParty:{enumerable:!0,get:function(){return this.counterPartyType&&this.counterPartyId?e.store.get(this.counterPartyType,this.counterPartyId):null},set:function(e){if(e)switch(e.$entityType){case"user":case"group":case"distributionList":this.counterPartyId=e.id,this.counterPartyType=e.$entityType;break;default:throw new Error("unsupported counterPartyType '"+e.$entityType+"'")}else this.counterPartyId=null,this.counterPartyType=null}},lastMessageId:{enumerable:!0,get:function(){return(0,a["default"])(this.lastMessage,"id")}},muteSettings:{enumerable:!0,get:function(){return e.host.mute.getByConversationId(this.id)}},isMuted:{enumerable:!0,get:function(){return!!this.muteSettings}}},relations:{belongsTo:{organization:{type:"organization",foreignKey:"organizationId"}}}});return t};var i=n(36);r(i),e.exports=t["default"]},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=function(e,t){var n=e.defineModel("distributionList",{replaceKeys:{organizationKey:"organizationId",totalMembers:"memberCount",avatar:"avatarUrl",displayName:"name"},defaultValues:{memberCount:0},computed:{displayName:{configurable:!0,enumerable:!0,get:function(){return this.name},set:function(e){return this.name=e}}},relations:{belongsTo:{organization:{type:"organization",foreignKey:"organizationId"}}}});return(0,a["default"])(n,{finder:function(){var e;return(e=t.host.distributionLists).find.apply(e,arguments)},placeholderEntityDelayBeforeRefreshing:function(){return e.host.config.placeholderEntityDelayBeforeRefreshing},placeholderEntityAllowLoading:function(){return e.host.config.placeholderEntityAllowLoading},defaultPlaceholderAttrs:{name:"Loading Distribution List..."},defaultNotFoundAttrs:{name:"<Distribution List Not Found>"}}),n};var o=n(31),a=r(o);e.exports=t["default"]},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=void 0;var o=n(17),a=r(o),i=n(28),u=r(i),s=n(1),c=r(s),l=n(2),f=r(l),d=function(){function e(t,n,r,o){var i=this;(0,c["default"])(this,e),this.id=t,this.type=n,this.data=r,o&&!function(){var e=o._origData,t=(0,u["default"])(o,["_origData"]);Object.defineProperty(i,"_origData",{get:function(){return e}}),(0,a["default"])(i,t)}()}return(0,f["default"])(e,null,[{key:"is",value:function(e){return e instanceof this}}]),e}();t["default"]=d,e.exports=t["default"]},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(45),a=r(o);t["default"]=function(e,t){function n(e,n){n&&t.host.groups.ensureMembersWithIds(e,n,{onlyPlaceholder:!0})}var r=e.defineModel("group",{replaceKeys:{organizationKey:"organizationId",createdBy:"createdByUserId",members:"memberIds",avatar:"avatarUrl",displayName:"name",numMembers:"__memberCount",createdTime:"createdAt"},transientAttrs:["__memberCount"],defaultValues:{memberIds:[],memberCount:0,groupType:s.GroupType.GROUP},validate:function(){l["default"].notEmpty("groupType",this.groupType)},__extractGroupTypeFromAttrs:function(e){return e.type||e.xmlns,e.isPublic?s.GroupType.ROOM:null},parseAttrs:function(e){var t=this.__extractGroupTypeFromAttrs(e);return t&&(e.groupType=t),"createdAt"in e&&(e.createdAt=new Date(e.createdAt)),e},beforeCreateInstance:function(e){n(e.id,e.memberIds)},computed:{memberCount:{enumerable:!0,get:function(){return this.memberIds&&this.memberIds.length||this.__memberCount||0}},metadata:{enumerable:!0,get:function(){var t=e.store.get("metadata",this.id+":"+this.organizationId);return t?t.data:null}},members:{enumerable:!0,get:function(){return this.memberIds?this.memberIds.map(function(t){return e.store.get("user",t)}):[]}},conversation:{enumerable:!0,get:function(){return t.host.conversations.get("group",this.id,this.organizationId)}},conversationId:{enumerable:!0,get:function(){return(0,a["default"])(t.host.conversations.get("group",this.id,this.organizationId),"id")}},displayName:{configurable:!0,enumerable:!0,get:function(){return this.name},set:function(e){return this.name=e}}},relations:{belongsTo:{organization:{type:"organization",foreignKey:"organizationId"},createdByUser:{type:"user",foreignKey:"createdByUserId"}}}});return(0,u["default"])(r,{finder:function(){var e;return(e=t.host.groups).find.apply(e,arguments)},placeholderEntityDelayBeforeRefreshing:function(){return e.host.config.placeholderEntityDelayBeforeRefreshing},placeholderEntityAllowLoading:function(){return e.host.config.placeholderEntityAllowLoading},defaultPlaceholderAttrs:{displayName:"Loading group..."},defaultNotFoundAttrs:{displayName:"<Group Not Found>"},shouldEnsure:function(e,n,r){var o=r.groupMembersOnlyPlaceholder;return e.members.some(function(e){return t.host.models.User.shouldEnsure(e,o)})}}),r};var i=n(31),u=r(i),s=n(25),c=n(27),l=r(c);e.exports=t["default"]},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=function(e){var t=e.defineModel("message",{replaceKeys:{messageId:"id",clientId:"id",senderToken:"senderId",sender:"senderId",recipientToken:"recipientId",recipient:"recipientId",senderOrganization:"senderOrganizationId",recipientOrganization:"recipientOrganizationId",groupToken:"groupId",originalSender:"originalSenderId",originalTimestamp:"originalForwardedMessageCreatedAt",status:"recipientStatus",data:"metadata",createdTime:"createdAt"},defaultValues:{recipientStatus:o.MessageRecipientStatus.NEW,senderStatus:o.MessageRecipientStatus.NEW,sortNumber:0,messageType:o.MessageType.USER_SENT},fields:{id:{type:"string"},senderStatus:{type:"enum","enum":o.MessageSenderStatus,require:!0},recipientStatus:{type:"enum","enum":o.MessageRecipientStatus,require:!0},direction:{type:"enum","enum":o.MessageDirection,require:!0},priority:{type:"enum","enum":o.MessagePriority},counterPartyId:{type:"string",require:!0},counterPartyType:{type:"enum",values:["user","group","distributionList"],require:!0},createdAt:{type:Date,require:!0}},parseAttrs:function(e){if(e.recipientStatus&&(e.recipientStatus=o.MessageRecipientStatus.resolve(e.recipientStatus)),"attachmentName"in e){var t=e.attachmentName;delete e.attachmentName,Array.isArray(e.attachments)&&e.attachments.length>0&&t&&(e.attachments[0].name=t)}if(Array.isArray(e.attachments)&&e.attachments.forEach(function(e,t){return e.id=""+(t+1)}),"priority"in e&&(e.priority=o.MessagePriority.resolve(e.priority)),"createdAt"in e&&"string"==typeof e.createdAt&&(e.createdAt=new Date(e.createdAt)),"ttl"in e&&e.createdAt){var n=(0,i["default"])(e.createdAt).add(e.ttl,"minute").toDate().getTime();e.expiresAt=n}return e},relations:{belongsTo:{sender:{type:"user",foreignKey:"senderId"},recipient:{type:"user",foreignKey:"recipientId"},originalSender:{type:"user",foreignKey:"originalSenderId"},senderOrganization:{type:"organization",foreignKey:"senderOrganizationId"},recipientOrganization:{type:"organization",foreignKey:"recipientOrganizationId"},group:{type:"group",foreignKey:"groupId"},distributionList:{type:"distributionList",foreignKey:"distributionListId"},conversation:{type:"conversation",foreignKey:"conversationId"}},hasMany:{statusesPerRecipient:{type:"messageStatusPerRecipient",foreignKey:"messageId"}}},computed:{counterParty:{enumerable:!0,get:function(){return this.counterPartyType&&this.counterPartyId?e.store.get(this.counterPartyType,this.counterPartyId):null},set:function(e){if(e){switch(e.$entityType){case"user":this.recipientId=e.id;break;case"group":this.groupId=e.id;break;case"distributionList":this.distributionListId=e.id;break;default:throw new Error("unsupported counterPartyType '"+e.$entityType+"'")}this.counterPartyId=e.id,this.counterPartyType=e.$entityType}else this.counterPartyId=null,this.counterPartyType=null}}}});return t};var o=n(25),a=n(49),i=r(a);e.exports=t["default"]},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=function(e){var t=e.defineModel("messageStatusPerRecipient",{replaceKeys:{accountId:"userId",timestamp:"createdAt"},defaultValues:{status:a["default"].NEW},fields:{userId:{type:String,require:!0},messageId:{type:String,require:!0},recipientStatus:{type:"enum","enum":a["default"],require:!0},createdAt:{type:Date,require:!0}},parseAttrs:function(e){return e.status&&(e.status=a["default"].resolve(e.status)),e},relations:{belongsTo:{message:{type:"message",foreignKey:"messageId"},user:{type:"user",foreignKey:"userId"}}}});return t};var o=n(36),a=r(o);e.exports=t["default"]},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=function(e,t){var n=e.defineModel("metadata",{fields:{entityType:{type:"string",required:!0},entityId:{type:"string",required:!0},organizationId:{type:"string",required:!0}},relations:{belongsTo:{organization:{type:"organization",foreignKey:"organizationId"}}},parseAttrs:function(e,t){return e.data=t.data,e}});return n},e.exports=t["default"]},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=function(e,t){var n=e.defineModel("organization",{instanceEvents:!0,replaceKeys:{members:"memberCount"},fields:{},transientAttrs:["conversations","unreadCount"],defaultValues:{conversations:[]},methods:{getSettingValue:function(e){return t.host.organizations.getSettingValue(this.id,e)}}});return(0,a["default"])(n,{finder:function(){var e;return(e=t.host.organizations).find.apply(e,arguments)},placeholderEntityDelayBeforeRefreshing:function(){return e.host.config.placeholderEntityDelayBeforeRefreshing},placeholderEntityAllowLoading:function(){return e.host.config.placeholderEntityAllowLoading},defaultPlaceholderAttrs:{name:"Loading Organization..."},defaultNotFoundAttrs:{displayName:"<Organization Not Found>"}}),n};var o=n(31),a=r(o);e.exports=t["default"]},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=void 0;var o=n(1),a=r(o),i=n(2),u=r(i),s=function(){function e(t,n){(0,a["default"])(this,e),this.id="searchResult:"+n+":"+t.id,this.entityType=t.$entityType,this.entityId=t.id,this.entity=t,this.organizationId=n}return(0,u["default"])(e,null,[{key:"is",value:function(e){return e instanceof this}}]),e}();t["default"]=s,e.exports=t["default"]},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=function(e,t){var n=e.defineModel("user",{transientAttrs:[],replaceKeys:{avatar:"avatarUrl"},defaultValues:{},computed:{metadataByOrganizationId:{enumerable:!0,get:function(){var t;return(t=(t=(t=e.store.getAll("metadata"),c["default"]).call(t,{entityId:this.id}),f["default"]).call(t,"organizationId"),p["default"]).call(t,"data")}},presence:{enumerable:!0,get:function(){return e.host.presence.get(this.id)||u["default"].UNKNOWN}}}});return(0,a["default"])(n,{finder:function(){var e;return(e=t.host.users).find.apply(e,arguments)},placeholderEntityDelayBeforeRefreshing:function(){return e.host.config.placeholderEntityDelayBeforeRefreshing},placeholderEntityAllowLoading:function(){return e.host.config.placeholderEntityAllowLoading},defaultPlaceholderAttrs:{displayName:"Loading..."},defaultNotFoundAttrs:{displayName:"<User Not Found>"}}),n};var o=n(31),a=r(o),i=n(51),u=r(i),s=n(29),c=r(s),l=n(138),f=r(l),d=n(139),p=r(d);e.exports=t["default"]},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(22),a=r(o),i=new a["default"](["GROUP","ROOM"]);t["default"]=i,e.exports=t["default"]},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(22),a=r(o),i=new a["default"](["INCOMING","OUTGOING"]);t["default"]=i,e.exports=t["default"]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(22),o=new r.ServerValueEnum({LOW:{serverValue:-1},NORMAL:{serverValue:0},HIGH:{serverValue:1}},{defaultValue:"NORMAL"});t["default"]=o,e.exports=t["default"]},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(22),a=r(o),i=new a["default"](["SENDING","SENT","FAILED","NEW","NA"]);t["default"]=i,e.exports=t["default"]},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(22),a=r(o),i=new a["default"](["USER_SENT","GROUP_MEMBERSHIP_CHANGE"]);t["default"]=i,e.exports=t["default"]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={User:n(98),Group:n(92),DistributionList:n(90),Organization:n(96),Message:n(93),MessageStatusPerRecipient:n(94),Conversation:n(89),Metadata:n(95)};t["default"]=r,e.exports=t["default"]},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t,n,r,o){var a={};return Object.keys(r).forEach(function(e){a[e]=r[e]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},a),o&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(o):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}function a(e,t){var n=4,r=15;if(void 0===t&&(t=0),t+=1,null===e)return"null";if(void 0===e)return"void";if("string"==typeof e||"number"==typeof e||"boolean"==typeof e)return"undefined"==typeof e?"undefined":(0,E["default"])(e);if(!Array.isArray(e)){var o=(0,b["default"])(e);if(!o.length)return e.constructor&&e.constructor.name&&"Object"!==e.constructor.name?e.constructor.name:"Object";if(t>n)return"{...}";var i="  ".repeat(t-1),u=o.slice(0,r).map(function(n){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(n)?n:(0,v["default"])(n))+": "+a(e[n],t)+";"}).join("\n  "+i);return o.length>=r&&(u+="\n  "+i+"..."),e.constructor&&e.constructor.name&&"Object"!==e.constructor.name?e.constructor.name+" {\n  "+i+u+"\n"+i+"}":"{\n  "+i+u+"\n"+i+"}"}if(!(e.length>0))return"Array";var s=function(){if(t>n)return{v:"[...]"};var o=a(e[0],t);return e.every(function(e){return a(e,t)===o})?{v:o.trim()+"[]"}:{v:"["+e.slice(0,r).map(function(e){return a(e,t)}).join(", ")+(e.length>=r?", ...":"")+"]"}}();return"object"===("undefined"==typeof s?"undefined":(0,E["default"])(s))?s.v:void 0}function i(e,t){var n=4,r=15;if(void 0===t&&(t=0),t+=1,null===e)return"null";if(void 0===e)return"void";if("string"==typeof e||"number"==typeof e||"boolean"==typeof e)return"undefined"==typeof e?"undefined":(0,E["default"])(e);if(!Array.isArray(e)){var o=(0,b["default"])(e);if(!o.length)return e.constructor&&e.constructor.name&&"Object"!==e.constructor.name?e.constructor.name:"Object";if(t>n)return"{...}";var a="  ".repeat(t-1),u=o.slice(0,r).map(function(n){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(n)?n:(0,v["default"])(n))+": "+i(e[n],t)+";"}).join("\n  "+a);return o.length>=r&&(u+="\n  "+a+"..."),e.constructor&&e.constructor.name&&"Object"!==e.constructor.name?e.constructor.name+" {\n  "+a+u+"\n"+a+"}":"{\n  "+a+u+"\n"+a+"}"}if(!(e.length>0))return"Array";var s=function(){if(t>n)return{v:"[...]"};var o=i(e[0],t);return e.every(function(e){return i(e,t)===o})?{v:o.trim()+"[]"}:{v:"["+e.slice(0,r).map(function(e){return i(e,t)}).join(", ")+(e.length>=r?", ...":"")+"]"}}();return"object"===("undefined"==typeof s?"undefined":(0,E["default"])(s))?s.v:void 0}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=void 0;var u,s,c,l,f,d,p,y,h,g=n(7),v=r(g),m=n(6),b=r(m),w=n(10),E=r(w),x=n(11),_=r(x),k=n(21),O=r(k),I=n(24),j=r(I),T=n(156),A=r(T),M=n(43),G=r(M),V=n(47),z=r(V),P=n(28),C=r(P),S=n(63),U=r(S),q=n(9),$=r(q),R=n(19),N=r(R),L=n(8),F=r(L),D=n(48),B=r(D),K=n(3),Z=r(K),W=n(1),H=r(W),X=n(2),Q=r(X),Y=n(5),J=r(Y),ee=n(4),te=r(ee),ne=n(32),re=r(ne),oe=n(12),ae=r(oe),ie=n(15),ue=n(58),se=r(ue),ce=n(70),le=r(ce),fe=n(23),de=r(fe),pe=n(13),ye=n(25),he=n(133),ge=r(he),ve=n(27),me=r(ve),be=n(26),we=r(be),Ee=n(42),xe=r(Ee),_e=n(29),ke=r(_e),Oe=n(41),Ie=r(Oe),je=n(61),Te=r(je),Ae=n(16),Me="tigertext:entity:account",Ge=new se["default"].MD5,Ve=(u={},(0,re["default"])(u,"ADD","added"),(0,re["default"])(u,"REMOVE","removed"),(0,re["default"])(u,"LEAVE","left"),(0,re["default"])(u,"JOIN","joined"),u),ze=(s={},(0,re["default"])(s,"ADD","to"),(0,re["default"])(s,"REMOVE","from"),s),Pe=(c={},(0,re["default"])(c,"GROUP","group"),(0,re["default"])(c,"ROOM","room"),c),Ce=(l=(0,ie.decorator)(),f=(0,ie.decorator)(),d=(0,ie.decorator)(),p=(0,ie.decorator)(),(0,pe.classWithPrivateMethods)((h=function(e){function t(){var e;(0,H["default"])(this,t);for(var n=arguments.length,r=Array(n),o=0;n>o;o++)r[o]=arguments[o];var a=(0,J["default"])(this,(e=(0,Z["default"])(t)).call.apply(e,[this].concat(r)));return a._throtelled__flushConversationsToReload=a.config.conversationReloadDelay?a._throtelled__flushConversationsToReload=(0,B["default"])(a.__flushConversationsToReload,a.config.conversationReloadDelay,{leading:!1}):a.__flushConversationsToReload,a}return(0,te["default"])(t,e),(0,Q["default"])(t,[{key:"mounted",value:function(){this._fetched=!1,this.host.on("message:sending",this._onMessageSending),this.host.on("message:sent",this._onMessageSent),this.host.models.Message.on("afterInject",this._onMessageChange),this.host.models.Message.on("afterEject",this._onMessageChange),this.host.models.Group.on("afterEject",this._onGroupDelete),this.__queuedConversationsToReload=[]}},{key:"dispose",value:function(){this._fetched=!1,this.host.removeListener("message:sending",this._onMessageSending),this.host.removeListener("message:sent",this._onMessageSent),this.host.models.Message.off("afterInject",this._onMessageChange),this.host.models.Message.off("afterEject",this._onMessageChange),this.host.models.Group.off("afterEject",this._onGroupDelete),this.__queuedConversationsToReload=null,this._throtelled__flushConversationsToReload.cancel&&this._throtelled__flushConversationsToReload.cancel()}},{key:"findAll",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,F["default"])($["default"].mark(function n(){var e,t,r,o=this,a=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];return $["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(a=(0,N["default"])(a,{includeMutes:!0}),!this._fetched){n.next=3;break}return n.abrupt("return",this.getAll());case 3:return n.next=5,this.host.api.roster.findAll();case 5:if(e=n.sent,t=e.slice(),e.forEach(function(e,n){e.type===Me&&(t[n]={counterParty:o.host.injectModel(e),organizationId:e.organization_key})}),e.forEach(function(e,n){e.type!==Me&&(t[n]={counterParty:o.host.injectModel(e),organizationId:e.organization_key})}),r=t.map(function(e){var t=e.counterParty,n=e.organizationId;delete t.$placeholder;var r=o.ensureConversation(t.$entityType,t.id,n,{ensureEntities:{organization:"full"}});return r._counterPartyAddedOnServer=!0,r}),!a.includeMutes){n.next=13;break}return n.next=13,this.host.mute.findAll();case 13:return this._fetched=!0,n.abrupt("return",r);case 15:case"end":return n.stop()}},n,this)}));return e}()},{key:"find",value:function(){function e(e,n){return t.apply(this,arguments)}var t=(0,F["default"])($["default"].mark(function n(e){var t,r=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return $["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof e){n.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));case 2:if("string"==typeof e){n.next=4;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));case 4:if(r=(0,U["default"])(r,{ensureEntities:{counterParty:"full",organization:"full",messageCounterParties:"full",groupMembers:"full",touchOnRelatedEntityLoad:!1}}),t=this.getById(e),!t){n.next=10;break}return n.next=9,this.__ensureEntities(t,r.ensureEntities);case 9:return n.abrupt("return",t);case 10:return n.next=12,this.findAll();case 12:if(t=this.getById(e)){n.next=15;break}throw new errors.NotFoundError(this.host.models.Conversation.name,e);case 15:return n.next=17,this.__ensureEntities(t,r.ensureEntities);case 17:return n.abrupt("return",t);case 18:case"end":return n.stop()}},n,this)}));return e}()},{key:"refetch",value:function(){function e(){return t.apply(this,arguments)}var t=(0,F["default"])($["default"].mark(function n(){return $["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this._fetched=!1,e.abrupt("return",this.findAll());case 2:case"end":return e.stop()}},n,this)}));return e}()},{key:"add",value:function(){function e(e,n,r){return t.apply(this,arguments)}var t=(0,F["default"])($["default"].mark(function n(e,t,r){var o;return $["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof e){n.next=2;break}throw new TypeError('Value of argument "counterPartyType" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));case 2:if("string"==typeof t){n.next=4;break}throw new TypeError('Value of argument "counterPartyId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));case 4:if("string"==typeof r){n.next=6;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(r));case 6:if("string"==typeof e){n.next=8;break}throw new TypeError('Value of argument "counterPartyType" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));case 8:if("string"==typeof t){n.next=10;break}throw new TypeError('Value of argument "counterPartyId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));case 10:if("string"==typeof r){n.next=12;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(r));case 12:return o=this.ensureConversation(e,t,r),n.prev=13,n.next=16,this.host.api.roster.add(e,t,r);case 16:n.next=21;break;case 18:n.prev=18,n.t0=n["catch"](13),this.logger.warn("can't add "+t+" "+e,n.t0);case 21:o._counterPartyAddedOnServer=!0;case 22:case"end":return n.stop()}},n,this,[[13,18]])}));return e}()},{key:"remove",value:function(){
function e(e,n,r){return t.apply(this,arguments)}var t=(0,F["default"])($["default"].mark(function n(e,t,r){return $["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof e){n.next=2;break}throw new TypeError('Value of argument "counterPartyType" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));case 2:if("string"==typeof t){n.next=4;break}throw new TypeError('Value of argument "counterPartyId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));case 4:if("string"==typeof r){n.next=6;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(r));case 6:if("string"==typeof e){n.next=8;break}throw new TypeError('Value of argument "counterPartyType" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));case 8:if("string"==typeof t){n.next=10;break}throw new TypeError('Value of argument "counterPartyId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));case 10:if("string"==typeof r){n.next=12;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(r));case 12:return this.ejectConversation(e,t,r),n.prev=13,n.next=16,this.host.api.roster.remove(e,t,r);case 16:n.next=21;break;case 18:n.prev=18,n.t0=n["catch"](13),this.logger.warn("can't remove "+t+" "+e);case 21:case"end":return n.stop()}},n,this,[[13,18]])}));return e}()},{key:"ensureConversation",value:function(e,t,n){var r=arguments.length<=3||void 0===arguments[3]?{}:arguments[3];if("string"!=typeof e)throw new TypeError('Value of argument "counterPartyType" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));if("string"!=typeof t)throw new TypeError('Value of argument "counterPartyId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));if("string"!=typeof n)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(n));if("string"!=typeof e)throw new TypeError('Value of argument "counterPartyType" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));if("string"!=typeof t)throw new TypeError('Value of argument "counterPartyId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));if("string"!=typeof n)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(n));r=(0,U["default"])(r,{ensureEntities:{counterParty:!1,organization:!1,messageCounterParties:!1,groupMembers:!1,touchOnRelatedEntityLoad:!0}});var o=this.getConversationKey(e,t,n),u=this.get(e,t,n);return u?(this.__ensureEntities(u,r.ensureEntities),u):(u=this.host.models.Conversation.createInstance({id:o,counterPartyType:e,counterPartyId:t,organizationId:n,_origIndex:this.host.models.Conversation.getAll().length}),this.__ensureEntities(u,r.ensureEntities),this.host.models.Conversation.inject(u),this.__notifyOrganizationChange(u.organizationId),u)}},{key:"ejectConversation",value:function(e,t,n){if("string"!=typeof e)throw new TypeError('Value of argument "counterPartyType" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));if("string"!=typeof t)throw new TypeError('Value of argument "counterPartyId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));if("string"!=typeof n)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(n));if("string"!=typeof e)throw new TypeError('Value of argument "counterPartyType" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));if("string"!=typeof t)throw new TypeError('Value of argument "counterPartyId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));if("string"!=typeof n)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(n));var r=this.get(e,t,n);return r&&(this.host.models.Conversation.eject(r),this.__notifyOrganizationChange(r.organizationId)),r}},{key:"reactToMessageEvent",value:function(e){if(!(e instanceof Object))throw new TypeError('Value of argument "event" violates contract.\n\nExpected:\nObject\n\nGot:\n'+i(e));if(!(e instanceof Object))throw new TypeError('Value of argument "event" violates contract.\n\nExpected:\nObject\n\nGot:\n'+a(e));var t=this.host.currentUserId,n=this.host.models.Message.parseAttrs(e.data);n.messageType=ye.MessageType.USER_SENT,n.direction=n.senderId==t?ye.MessageDirection.OUTGOING:ye.MessageDirection.INCOMING,n.groupId?(n.counterPartyType="group",n.counterPartyId=n.groupId):n.recipientId&&(n.counterPartyType="user",n.counterPartyId=n.senderId==t?n.recipientId:n.senderId),n.direction==ye.MessageDirection.OUTGOING?n.senderStatus=ye.MessageSenderStatus.SENT:n.senderStatus=ye.MessageSenderStatus.NA;var r=this.host.conversations.ensureConversation(n.counterPartyType,n.counterPartyId,n.recipientOrganizationId,{ensureEntities:{counterParty:"placeholder",groupMembers:"placeholder",organization:"full"}});n.conversationId=r.id;var o=this.host.models.Message.createInstance(n),u=o.senderId==t?o.recipientId:o.senderId;u&&this.__ensureMessageCounterParty(r,u,{messageCounterParties:this.host.currentlyServingOfflineMessages?"placeholder":"full",touchOnRelatedEntityLoad:!0}),this.host.models.Message.inject(o),this.emit("message",o),this.__addConversationCounterPartyToServerRosterIfShould(r),this.__queueReload(r),r.emit("message",o),this.__notifyOrganizationChange(r.organizationId),o.senderId!=t&&o.recipientStatus!=ye.MessageRecipientStatus.READ&&o.recipientStatus!=ye.MessageRecipientStatus.DELIVERED&&this.host.messages.markAsReceived(o)}},{key:"reactToFriendsEvent",value:function(e){var t=e.data.friend,n=t.action,r=t.organization_id,o=(0,C["default"])(t,["action","organization_id"]),a=r,i=this.host.modelByTypeNS(o.xmlns);if(!i)return void this.logger.error("Class "+o.xmlns+" not found");switch(n){case"add":"group"==i.name&&(o.organizationId=a);var u=this.host.injectModel(o);this.__addedByCounterParty(u,a);break;case"del":this.__removedByCounterParty(i.name,o.token,a);break;default:this.logger.error("friends action not implemented",n,e.data)}}},{key:"_onMessageSending",value:function(e){if(!(e instanceof Object))throw new TypeError('Value of argument "message" violates contract.\n\nExpected:\nObject\n\nGot:\n'+i(e));if(!(e instanceof Object))throw new TypeError('Value of argument "message" violates contract.\n\nExpected:\nObject\n\nGot:\n'+a(e));var t=this.ensureConversation(e.counterPartyType,e.counterPartyId,e.senderOrganizationId,{ensureEntities:{counterParty:"full",organization:"full",messageCounterParties:"full",groupMembers:"full",touchOnRelatedEntityLoad:!0}});this.__addConversationCounterPartyToServerRosterIfShould(t),this.__reloadConversation(t),this.__notifyOrganizationChange(t.organizationId)}},{key:"_onMessageSent",value:function(e){if(!(e instanceof Object))throw new TypeError('Value of argument "message" violates contract.\n\nExpected:\nObject\n\nGot:\n'+i(e));if(!(e instanceof Object))throw new TypeError('Value of argument "message" violates contract.\n\nExpected:\nObject\n\nGot:\n'+a(e));var t=this.ensureConversation(e.counterPartyType,e.counterPartyId,e.senderOrganizationId);this.__reloadConversation(t),t.emit("message",e)}},{key:"_onMessageChange",value:function(e,t){t.conversation&&this.__queueReload(t.conversation)}},{key:"_onGroupDelete",value:function(e,t){this.ejectConversation("group",t.id,t.organizationId)}},{key:"__queueReload",value:function(e){!this.__queuedConversationsToReload.includes(e)&&this.__queuedConversationsToReload.push(e),this._throtelled__flushConversationsToReload()}},{key:"__flushConversationsToReload",value:function(){var e=this;this.__queuedConversationsToReload.forEach(function(t){return e.__reloadConversation(t)}),this.__queuedConversationsToReload.length=0}},{key:"__reloadConversation",value:function(e){var t,n=(0,z["default"])(e,["messages","timeline","lastMessage","unreadMessages","unreadCount","lastEventMessageSortNumber"]),r={},o=(t=(t=this.host.models.Message.getAll(),ke["default"]).call(t,{conversationId:e.id}),Ie["default"]).call(t,["sortNumber"],["asc"]),a=(0,G["default"])(o,{messageType:ye.MessageType.USER_SENT});r.timeline=o,r.messages=a,r.lastMessage=(0,A["default"])(a),r.unreadMessages=a.filter(function(e){return e.direction===ye.MessageDirection.INCOMING&&(e.recipientStatus===ye.MessageRecipientStatus.NEW||e.recipientStatus===ye.MessageRecipientStatus.DELIVERED)}),r.unreadCount=r.unreadMessages.length,r.lastEventMessageSortNumber=r.lastMessage&&r.lastMessage.sortNumber||0;var i=!1;(0,j["default"])(n,function(t,n){(0,le["default"])(t,r[n])||(e[n]=r[n],i=!0)}),i&&(this.host.models.Conversation.inject(e),e.emit("change"),this.emit("change",e))}},{key:"__notifyOrganizationChange",value:function(e){var t=this.host.models.Organization.get(e);t&&t.emit("change")}},{key:"__addConversationCounterPartyToServerRosterIfShould",value:function(e){if(!(e instanceof Object))throw new TypeError('Value of argument "conversation" violates contract.\n\nExpected:\nObject\n\nGot:\n'+i(e));if(!(e instanceof Object))throw new TypeError('Value of argument "conversation" violates contract.\n\nExpected:\nObject\n\nGot:\n'+a(e));e&&(e._counterPartyAddedOnServer||this.add(e.counterPartyType,e.counterPartyId,e.organizationId))}},{key:"addMembershipChangeLog",value:function(e){var t=void 0;if(e.actorId===this.host.currentUserId&&"LEAVE"===e.action){if(t=this.get("group",e.group.id,e.group.organizationId),!t)return}else t=this.ensureConversation("group",e.group.id,e.group.organizationId);this.host.models.Message.inject({id:e.id,conversationId:t.id,groupId:e.groupId,sortNumber:e.sortNumber,messageType:ye.MessageType.GROUP_MEMBERSHIP_CHANGE,senderId:e.actorId,recipient:this.host.currentUser,direction:ye.MessageDirection.INCOMING,groupMembersChange:{action:e.action,members:e.members,memberIds:e.memberIds},body:this.__generateGroupMembershipChangeBody(e),createdAt:e.createdAt}),this.__reloadConversation(t)}},{key:"__generateGroupMembershipChangeBody",value:function(e){var t=Ve[e.action],n=ze[e.action]||"",r=null;return"ADD"!==e.action&&"REMOVE"!==e.action||(r=(0,ge["default"])(e.members.filter(Boolean).map(function(e){return e.displayName}))),[e.actor.displayName,t,r,n,"this",Pe[e.group.groupType]].filter(Boolean).join(" ")}},{key:"getMessageConversationKey",value:function(e){if(!(e instanceof Object))throw new TypeError('Value of argument "message" violates contract.\n\nExpected:\nObject\n\nGot:\n'+i(e));if(!(e instanceof Object))throw new TypeError('Value of argument "message" violates contract.\n\nExpected:\nObject\n\nGot:\n'+a(e));if(e.groupId)return this.conversationHashForListEnityId(e.groupId);if(e.distributionListId)return this.conversationHashForListEnityId(e.distributionListId);var t=e.senderId==this.host.currentUserId?e.recipientId:e.senderId;return this.conversationHashForUserMessage(t,e.senderOrganizationId,e.recipientOrganizationId)}},{key:"getConversationKey",value:function(e,t,n){var r=arguments.length<=3||void 0===arguments[3]?n:arguments[3];if("string"!=typeof e)throw new TypeError('Value of argument "counterPartyType" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));if("string"!=typeof t)throw new TypeError('Value of argument "counterPartyId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));if(null!=n&&"string"!=typeof n)throw new TypeError('Value of argument "senderOrganizationId" violates contract.\n\nExpected:\n?string\n\nGot:\n'+i(n));if(null!=r&&"string"!=typeof r)throw new TypeError('Value of argument "recipientOrganizationId" violates contract.\n\nExpected:\n?string\n\nGot:\n'+i(r));if("string"!=typeof e)throw new TypeError('Value of argument "counterPartyType" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));if("string"!=typeof t)throw new TypeError('Value of argument "counterPartyId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));if(null!=n&&"string"!=typeof n)throw new TypeError('Value of argument "senderOrganizationId" violates contract.\n\nExpected:\n?string\n\nGot:\n'+a(n));if(null!=r&&"string"!=typeof r)throw new TypeError('Value of argument "recipientOrganizationId" violates contract.\n\nExpected:\n?string\n\nGot:\n'+a(r));switch(e){case"user":return this.conversationHashForUserMessage(t,n,r);case"group":case"distributionList":return this.conversationHashForListEnityId(t);default:throw new Error("type "+e+" not supported in conversation")}}},{key:"conversationHashForUserMessage",value:function(e,t){var n=arguments.length<=2||void 0===arguments[2]?t:arguments[2];if("string"!=typeof e)throw new TypeError('Value of argument "counterPartyId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));if("string"!=typeof t)throw new TypeError('Value of argument "senderOrganizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));if(null!=n&&"string"!=typeof n)throw new TypeError('Value of argument "recipientOrganizationId" violates contract.\n\nExpected:\n?string\n\nGot:\n'+i(n));if("string"!=typeof e)throw new TypeError('Value of argument "counterPartyId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));if("string"!=typeof t)throw new TypeError('Value of argument "senderOrganizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));if(null!=n&&"string"!=typeof n)throw new TypeError('Value of argument "recipientOrganizationId" violates contract.\n\nExpected:\n?string\n\nGot:\n'+a(n));var r=[e,t,n].join(":");return Ge.b64(r)}},{key:"conversationHashForListEnityId",value:function(e){if("string"!=typeof e)throw new TypeError('Value of argument "entityId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));if("string"!=typeof e)throw new TypeError('Value of argument "entityId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));return Ge.b64(e)}},{key:"conversationHashForGroupId",value:function(){return this.conversationHashForListEnityId.apply(this,arguments)}},{key:"conversationHashForDistributionListId",value:function(){return this.conversationHashForListEnityId.apply(this,arguments)}},{key:"looksLikeConversationId",value:function(e){if("string"!=typeof e)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));if("string"!=typeof e)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));return/^[a-zA-Z0-9\/+=]{24}$/.test(e)}},{key:"findConversationWithUser",value:function(){function e(e,n){return t.apply(this,arguments)}var t=(0,F["default"])($["default"].mark(function n(e,t){return $["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof e){n.next=2;break}throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));case 2:if("string"==typeof t){n.next=4;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));case 4:if("string"==typeof e){n.next=6;break}throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));case 6:if("string"==typeof t){n.next=8;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));case 8:return n.abrupt("return",this.get(this.host.models.User.name,e,t));case 9:case"end":return n.stop()}},n,this)}));return e}()},{key:"findConversationWithGroup",value:function(){function e(e,n){return t.apply(this,arguments)}var t=(0,F["default"])($["default"].mark(function n(e,t){return $["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof e){n.next=2;break}throw new TypeError('Value of argument "groupId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));case 2:if("string"==typeof t){n.next=4;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));case 4:if("string"==typeof e){n.next=6;break}throw new TypeError('Value of argument "groupId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));case 6:if("string"==typeof t){n.next=8;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));case 8:return n.abrupt("return",this.get(this.host.models.Group.name,e,t));case 9:case"end":return n.stop()}},n,this)}));return e}()},{key:"findAllGroupConversationsWithMembers",value:function(){function e(e,n){return t.apply(this,arguments)}var t=(0,F["default"])($["default"].mark(function n(e,t){var r,o=this;return $["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof e||Array.isArray(e)&&e.every(function(e){return"string"==typeof e})||Array.isArray(e)&&e.every(function(e){return e instanceof Object})){n.next=2;break}throw new TypeError('Value of argument "memberIds" violates contract.\n\nExpected:\nstring | string[] | Object[]\n\nGot:\n'+i(e));case 2:if("string"==typeof t){n.next=4;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));case 4:if("string"==typeof e||Array.isArray(e)&&e.every(function(e){return"string"==typeof e})||Array.isArray(e)&&e.every(function(e){return e instanceof Object})){n.next=6;break}throw new TypeError('Value of argument "memberIds" violates contract.\n\nExpected:\nstring | string[] | Object[]\n\nGot:\n'+a(e));case 6:if("string"==typeof t){n.next=8;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));case 8:return e=(0,Ae.arrayWrap)(e).map(this._resolveModelId.bind(this)),n.next=11,this.host.groups.findAllWithSpecificMembers(e,t);case 11:return r=n.sent,n.abrupt("return",r.map(function(e){return o.get(o.host.models.Group.name,e.id,t)}));case 13:case"end":return n.stop()}},n,this)}));return e}()},{key:"getWithUser",value:function(e,t,n){var r=n.createIfNotFound,o=void 0===r?!1:r;if(!("string"==typeof e||e instanceof Object))throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(e));if(!("string"==typeof t||t instanceof Object))throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(t));if(null==arguments[2]||null!=arguments[2].createIfNotFound&&"boolean"!=typeof arguments[2].createIfNotFound)throw new TypeError("Value of argument 2 violates contract.\n\nExpected:\n{ createIfNotFound: ?bool\n}\n\nGot:\n"+i(arguments[2]));if(!("string"==typeof e||e instanceof Object))throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(e));if(!("string"==typeof t||t instanceof Object))throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(t));if(null==arguments[2]||null!=arguments[2].createIfNotFound&&"boolean"!=typeof arguments[2].createIfNotFound)throw new TypeError("Value of argument 2 violates contract.\n\nExpected:\n{ createIfNotFound: ?bool\n}\n\nGot:\n"+a(arguments[2]));e=this._resolveModelId(e),t=this._resolveModelId(t);var u=this.conversationHashForUserMessage(e,t),s=this.getById(u);return!s&&o&&(s=this.ensureConversation("user",e,t)),s||null}},{key:"getWithListEntity",value:function(e,t,n){var r=n.createIfNotFound,o=void 0===r?!1:r,u=n.organizationId;if("string"!=typeof e)throw new TypeError('Value of argument "entityType" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));if(!("string"==typeof t||t instanceof Object))throw new TypeError('Value of argument "entityId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(t));if(null==arguments[2]||null!=arguments[2].createIfNotFound&&"boolean"!=typeof arguments[2].createIfNotFound||null!=arguments[2].organizationId&&"string"!=typeof arguments[2].organizationId)throw new TypeError("Value of argument 2 violates contract.\n\nExpected:\n{ createIfNotFound: ?bool;\n  organizationId: ?string;\n}\n\nGot:\n"+i(arguments[2]));if("string"!=typeof e)throw new TypeError('Value of argument "entityType" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));if(!("string"==typeof t||t instanceof Object))throw new TypeError('Value of argument "entityId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(t));if(null==arguments[2]||null!=arguments[2].createIfNotFound&&"boolean"!=typeof arguments[2].createIfNotFound||null!=arguments[2].organizationId&&"string"!=typeof arguments[2].organizationId)throw new TypeError("Value of argument 2 violates contract.\n\nExpected:\n{ createIfNotFound: ?bool;\n  organizationId: ?string;\n}\n\nGot:\n"+a(arguments[2]));t=this._resolveModelId(t);var s=this.conversationHashForListEnityId(t),c=this.getById(s);if(!c&&o){var l=this._resolveEntity(t,e);l?u=l.organizationId:me["default"].notEmpty("organizationId",u,"required when using createIfNotFound"),c=this.ensureConversation(e,t,u)}return c||null}},{key:"getWithGroup",value:function(e){return this.getWithListEntity("group",e)}},{key:"getWithDistributionList",value:function(e){return this.getWithListEntity("distributionList",e)}},{key:"get",value:function(e,t,n){if("string"!=typeof e)throw new TypeError('Value of argument "counterPartyType" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));if("string"!=typeof t)throw new TypeError('Value of argument "counterPartyId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));if("string"!=typeof n)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(n));if("string"!=typeof e)throw new TypeError('Value of argument "counterPartyType" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));if("string"!=typeof t)throw new TypeError('Value of argument "counterPartyId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));if("string"!=typeof n)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(n));var r=this.getConversationKey(e,t,n),o=this.host.models.Conversation.get(r);return o||null}},{key:"getAll",value:function(){return this.host.models.Conversation.getAll()}},{key:"getById",value:function(e){if("string"!=typeof e)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));if("string"!=typeof e)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));return this.host.models.Conversation.get(e)}},{key:"getMultiById",value:function(e){if(!Array.isArray(e)||!e.every(function(e){return"string"==typeof e}))throw new TypeError('Value of argument "ids" violates contract.\n\nExpected:\nArray<string>\n\nGot:\n'+i(e));if(!Array.isArray(e)||!e.every(function(e){return"string"==typeof e}))throw new TypeError('Value of argument "ids" violates contract.\n\nExpected:\nArray<string>\n\nGot:\n'+a(e));return this.host.models.Conversation.getMulti(e)}},{key:"__addedByCounterParty",value:function(e,t){if(!(e instanceof Object))throw new TypeError('Value of argument "counterParty" violates contract.\n\nExpected:\nObject\n\nGot:\n'+i(e));if("string"!=typeof t)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));if(!(e instanceof Object))throw new TypeError('Value of argument "counterParty" violates contract.\n\nExpected:\nObject\n\nGot:\n'+a(e));if("string"!=typeof t)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));this.ensureConversation(e.$entityType,e.id,t)}},{key:"__removedByCounterParty",value:function(e,t,n){if("string"!=typeof e)throw new TypeError('Value of argument "entityType" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));if("string"!=typeof t)throw new TypeError('Value of argument "entityId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));if("string"!=typeof n)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(n));if("string"!=typeof e)throw new TypeError('Value of argument "entityType" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));if("string"!=typeof t)throw new TypeError('Value of argument "entityId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));if("string"!=typeof n)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(n));this.ejectConversation(e,t,n)}},{key:"__ensureEntities",value:function(e){var t=this,n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];if(!(e instanceof Object))throw new TypeError('Value of argument "conversation" violates contract.\n\nExpected:\nObject\n\nGot:\n'+i(e));if(!(e instanceof Object))throw new TypeError('Value of argument "conversation" violates contract.\n\nExpected:\nObject\n\nGot:\n'+a(e));var r=[];return n.organization&&r.push(this.__ensureOrganization(e,n)),n.counterParty&&r.push(this.__ensureCounterParty(e,n)),n.messageCounterParties&&r.push(this.__ensureAllMessagesCounterParties(e,n)),r=r.filter(Boolean),r.length>0?O["default"].all(r).then(function(){n.onLoad&&n.onLoad(),t.__touch(e)})["catch"](function(e){return console.error(e)}):O["default"].resolve()}},{key:"__ensureOrganization",value:function(e){var t=this,n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];if(!(e instanceof Object))throw new TypeError('Value of argument "conversation" violates contract.\n\nExpected:\nObject\n\nGot:\n'+i(e));if(!(e instanceof Object))throw new TypeError('Value of argument "conversation" violates contract.\n\nExpected:\nObject\n\nGot:\n'+a(e));return this.host.models.Organization.shouldEnsure(e.organization,"full"!==n.organization)?new O["default"](function(r,o){t.host.models.Organization.ensureEntity(e.organizationId,{onlyPlaceholder:"placeholder"===n.organization,onMissing:function(){t.logger.info("org "+e.organizationId+" not found, created placeholder org"),e.$loadingOrganization=!0},onLoad:function(){t.logger.info("org "+e.organizationId+" loaded"),e.$loadingOrganization=!1,n.touchOnRelatedEntityLoad&&t.__touch(e)},onFinish:r})}):null}},{key:"__ensureCounterParty",value:function(e){var t=this,n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];if(!(e instanceof Object))throw new TypeError('Value of argument "conversation" violates contract.\n\nExpected:\nObject\n\nGot:\n'+i(e));if(!(e instanceof Object))throw new TypeError('Value of argument "conversation" violates contract.\n\nExpected:\nObject\n\nGot:\n'+a(e));var r=this.host.modelsByEntityType[e.counterPartyType];return r.shouldEnsure(e.counterParty,"full"!==n.counterParty,{groupMembersOnlyPlaceholder:"full"!==n.groupMembers})?new O["default"](function(o,a){var i={};switch(e.counterPartyType){case"user":break;case"group":case"distributionList":i.organizationId=e.organizationId;break;default:throw new Error("unsupported counterPartyType",e.counterPartyType)}var u=function(e){return"placeholder"!==n.counterParty&&"group"===r.name&&n.groupMembers?t.host.groups.ensureMembers(e,{onlyPlaceholder:"placeholder"===n.groupMembers}):void 0};r.ensureEntity(e.counterPartyId,{attrs:i,onlyPlaceholder:"placeholder"===n.counterParty,onMissing:function(){t.logger.info("entry "+e.counterPartyId+" not found, created placeholder on org "+e.organizationId),e.$loadingCounterParty=!0},onLoad:function(){e.$loadingCounterParty=!1,n.touchOnRelatedEntityLoad&&t.__touch(e)},onFinish:function(){var e=(0,F["default"])($["default"].mark(function n(e){return $["default"].wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=e,!t.t0){t.next=4;break}return t.next=4,u(e);case 4:o();case 5:case"end":return t.stop()}},n,t)}));return function(t){return e.apply(this,arguments)}}()})}):null}},{key:"__ensureAllMessagesCounterParties",value:function(e){var t,n=this,r=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];if(!(e instanceof Object))throw new TypeError('Value of argument "conversation" violates contract.\n\nExpected:\nObject\n\nGot:\n'+i(e));if(!(e instanceof Object))throw new TypeError('Value of argument "conversation" violates contract.\n\nExpected:\nObject\n\nGot:\n'+a(e));var o=(t=(t=(t=e.messages,we["default"]).call(t,"senderId"),xe["default"]).call(t),Te["default"]).call(t,this.host.currentUserId,e.counterPartyId);return O["default"].all(o.map(function(t){return n.__ensureMessageCounterParty(e,t,r)}))}},{key:"__ensureMessageCounterParty",value:function(e,t){var n=this,r=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];if(!(e instanceof Object))throw new TypeError('Value of argument "conversation" violates contract.\n\nExpected:\nObject\n\nGot:\n'+i(e));if("string"!=typeof t)throw new TypeError('Value of argument "messageOtherUserId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));if(!(e instanceof Object))throw new TypeError('Value of argument "conversation" violates contract.\n\nExpected:\nObject\n\nGot:\n'+a(e));if("string"!=typeof t)throw new TypeError('Value of argument "messageOtherUserId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));var o=this.host.models.User.get(t);return this.host.models.User.shouldEnsure(o,"full"!==r.messageCounterParties)?new O["default"](function(o,a){n.host.models.User.ensureEntity(t,{onlyPlaceholder:"placeholder"===r.messageCounterParties,onMissing:function(){n.logger.info("entry "+e.counterPartyId+" not found, created placeholder on org "+e.organizationId)},onLoad:function(){r.touchOnRelatedEntityLoad&&n.__touch(e)},onFinish:o})}):null}},{key:"__touch",value:function(e){this.host.models.Conversation.touch(e)}}]),t}(ae["default"]),o(h.prototype,"findAll",[l],(0,_["default"])(h.prototype,"findAll"),h.prototype),o(h.prototype,"find",[f],(0,_["default"])(h.prototype,"find"),h.prototype),o(h.prototype,"add",[d],(0,_["default"])(h.prototype,"add"),h.prototype),o(h.prototype,"remove",[p],(0,_["default"])(h.prototype,"remove"),h.prototype),o(h.prototype,"_onMessageSending",[pe.privateMethod,de["default"]],(0,_["default"])(h.prototype,"_onMessageSending"),h.prototype),o(h.prototype,"_onMessageSent",[pe.privateMethod,de["default"]],(0,_["default"])(h.prototype,"_onMessageSent"),h.prototype),o(h.prototype,"_onMessageChange",[pe.privateMethod,de["default"]],(0,_["default"])(h.prototype,"_onMessageChange"),h.prototype),o(h.prototype,"_onGroupDelete",[pe.privateMethod,de["default"]],(0,_["default"])(h.prototype,"_onGroupDelete"),h.prototype),o(h.prototype,"__queueReload",[pe.privateMethod],(0,_["default"])(h.prototype,"__queueReload"),h.prototype),o(h.prototype,"__flushConversationsToReload",[pe.privateMethod,de["default"]],(0,_["default"])(h.prototype,"__flushConversationsToReload"),h.prototype),o(h.prototype,"__reloadConversation",[pe.privateMethod],(0,_["default"])(h.prototype,"__reloadConversation"),h.prototype),o(h.prototype,"__notifyOrganizationChange",[pe.privateMethod],(0,_["default"])(h.prototype,"__notifyOrganizationChange"),h.prototype),o(h.prototype,"__addConversationCounterPartyToServerRosterIfShould",[pe.privateMethod],(0,_["default"])(h.prototype,"__addConversationCounterPartyToServerRosterIfShould"),h.prototype),o(h.prototype,"__generateGroupMembershipChangeBody",[pe.privateMethod],(0,_["default"])(h.prototype,"__generateGroupMembershipChangeBody"),h.prototype),o(h.prototype,"__addedByCounterParty",[pe.privateMethod],(0,_["default"])(h.prototype,"__addedByCounterParty"),h.prototype),o(h.prototype,"__removedByCounterParty",[pe.privateMethod],(0,_["default"])(h.prototype,"__removedByCounterParty"),h.prototype),o(h.prototype,"__ensureEntities",[pe.privateMethod],(0,_["default"])(h.prototype,"__ensureEntities"),h.prototype),o(h.prototype,"__ensureOrganization",[pe.privateMethod],(0,_["default"])(h.prototype,"__ensureOrganization"),h.prototype),o(h.prototype,"__ensureCounterParty",[pe.privateMethod],(0,_["default"])(h.prototype,"__ensureCounterParty"),h.prototype),o(h.prototype,"__ensureAllMessagesCounterParties",[pe.privateMethod],(0,_["default"])(h.prototype,"__ensureAllMessagesCounterParties"),h.prototype),o(h.prototype,"__ensureMessageCounterParty",[pe.privateMethod],(0,_["default"])(h.prototype,"__ensureMessageCounterParty"),h.prototype),o(h.prototype,"__touch",[pe.privateMethod],(0,
_["default"])(h.prototype,"__touch"),h.prototype),y=h))||y);t["default"]=Ce,e.exports=t["default"]},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t,n,r,o){var a={};return Object.keys(r).forEach(function(e){a[e]=r[e]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},a),o&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(o):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}function a(e,t){var n=4,r=15;if(void 0===t&&(t=0),t+=1,null===e)return"null";if(void 0===e)return"void";if("string"==typeof e||"number"==typeof e||"boolean"==typeof e)return"undefined"==typeof e?"undefined":(0,g["default"])(e);if(!Array.isArray(e)){var o=(0,y["default"])(e);if(!o.length)return e.constructor&&e.constructor.name&&"Object"!==e.constructor.name?e.constructor.name:"Object";if(t>n)return"{...}";var i="  ".repeat(t-1),u=o.slice(0,r).map(function(n){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(n)?n:(0,d["default"])(n))+": "+a(e[n],t)+";"}).join("\n  "+i);return o.length>=r&&(u+="\n  "+i+"..."),e.constructor&&e.constructor.name&&"Object"!==e.constructor.name?e.constructor.name+" {\n  "+i+u+"\n"+i+"}":"{\n  "+i+u+"\n"+i+"}"}if(!(e.length>0))return"Array";var s=function(){if(t>n)return{v:"[...]"};var o=a(e[0],t);return e.every(function(e){return a(e,t)===o})?{v:o.trim()+"[]"}:{v:"["+e.slice(0,r).map(function(e){return a(e,t)}).join(", ")+(e.length>=r?", ...":"")+"]"}}();return"object"===("undefined"==typeof s?"undefined":(0,g["default"])(s))?s.v:void 0}function i(e,t){var n=4,r=15;if(void 0===t&&(t=0),t+=1,null===e)return"null";if(void 0===e)return"void";if("string"==typeof e||"number"==typeof e||"boolean"==typeof e)return"undefined"==typeof e?"undefined":(0,g["default"])(e);if(!Array.isArray(e)){var o=(0,y["default"])(e);if(!o.length)return e.constructor&&e.constructor.name&&"Object"!==e.constructor.name?e.constructor.name:"Object";if(t>n)return"{...}";var a="  ".repeat(t-1),u=o.slice(0,r).map(function(n){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(n)?n:(0,d["default"])(n))+": "+i(e[n],t)+";"}).join("\n  "+a);return o.length>=r&&(u+="\n  "+a+"..."),e.constructor&&e.constructor.name&&"Object"!==e.constructor.name?e.constructor.name+" {\n  "+a+u+"\n"+a+"}":"{\n  "+a+u+"\n"+a+"}"}if(!(e.length>0))return"Array";var s=function(){if(t>n)return{v:"[...]"};var o=i(e[0],t);return e.every(function(e){return i(e,t)===o})?{v:o.trim()+"[]"}:{v:"["+e.slice(0,r).map(function(e){return i(e,t)}).join(", ")+(e.length>=r?", ...":"")+"]"}}();return"object"===("undefined"==typeof s?"undefined":(0,g["default"])(s))?s.v:void 0}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=void 0;var u,s,c,l,f=n(7),d=r(f),p=n(6),y=r(p),h=n(10),g=r(h),v=n(11),m=r(v),b=n(9),w=r(b),E=n(19),x=r(E),_=n(8),k=r(_),O=n(3),I=r(O),j=n(1),T=r(j),A=n(2),M=r(A),G=n(5),V=r(G),z=n(4),P=r(z),C=n(12),S=r(C),U=n(14),q=r(U),$=n(15),R=n(13),N=(u=(0,$.decorator)(),s=(0,$.decorator)(),(0,R.classWithPrivateMethods)((l=function(e){function t(){return(0,T["default"])(this,t),(0,V["default"])(this,(0,I["default"])(t).apply(this,arguments))}return(0,P["default"])(t,e),(0,M["default"])(t,[{key:"mounted",value:function(){this._fetched=!1}},{key:"dispose",value:function(){this._fetched=!1}},{key:"find",value:function(){function e(e,n){return t.apply(this,arguments)}var t=(0,k["default"])(w["default"].mark(function n(e){var t,r,o=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return w["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof e){n.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));case 2:if("string"==typeof e){n.next=4;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));case 4:if(o=(0,x["default"])(o,{ignoreNotFound:!1,bypassCache:!1,includeMembers:!1,includeMetadata:!1}),this.host.requireUser(),t=null,o.bypassCache){n.next=11;break}if(t=this.host.models.DistributionList.get(e),!t){n.next=11;break}return n.abrupt("return",t);case 11:return n.next=13,this.host.api.distributionLists.find(e);case 13:if(r=n.sent,!r){n.next=19;break}t=this.host.models.DistributionList.inject(r),delete t.$placeholder,n.next=21;break;case 19:if(o.ignoreNotFound){n.next=21;break}throw new q["default"].NotFoundError(this.host.models.DistributionList.name,e);case 21:return n.abrupt("return",t);case 22:case"end":return n.stop()}},n,this)}));return e}()},{key:"findAll",value:function(){function e(){return t.apply(this,arguments)}var t=(0,k["default"])(w["default"].mark(function n(){var e,t,r;return w["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!this._fetched){n.next=2;break}return n.abrupt("return",this.getAll());case 2:if(e=this.host.models.Organization.getAll(),0!=e.length){n.next=7;break}return n.next=6,this.host.organizations.findAll();case 6:e=n.sent;case 7:return n.next=9,this.host.search.query({types:["distributionList"],organizationIds:e.map(function(e){return e.id}),query:{displayName:""}});case 9:return t=n.sent,r=t.map(function(e){return e.entity}),this._fetched=!0,n.abrupt("return",r);case 13:case"end":return n.stop()}},n,this)}));return e}()},{key:"getAll",value:function(){return this.host.models.DistributionList.getAll()}},{key:"getById",value:function(e){if("string"!=typeof e)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));if("string"!=typeof e)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));return this.host.models.DistributionList.get(e)}},{key:"getMultiById",value:function(e){if(!Array.isArray(e)||!e.every(function(e){return"string"==typeof e}))throw new TypeError('Value of argument "ids" violates contract.\n\nExpected:\nArray<string>\n\nGot:\n'+i(e));if(!Array.isArray(e)||!e.every(function(e){return"string"==typeof e}))throw new TypeError('Value of argument "ids" violates contract.\n\nExpected:\nArray<string>\n\nGot:\n'+a(e));return this.host.models.DistributionList.getMulti(e)}}]),t}(S["default"]),o(l.prototype,"find",[u],(0,m["default"])(l.prototype,"find"),l.prototype),o(l.prototype,"findAll",[s],(0,m["default"])(l.prototype,"findAll"),l.prototype),c=l))||c);t["default"]=N,e.exports=t["default"]},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=void 0;var o=n(24),a=r(o),i=n(32),u=r(i),s=n(28),c=r(s),l=n(3),f=r(l),d=n(1),p=r(d),y=n(2),h=r(y),g=n(5),v=r(g),m=n(4),b=r(m),w=n(12),E=r(w),x=n(172),_=function(e){function t(e,n){var r;(0,p["default"])(this,t);var o=(0,v["default"])(this,(0,f["default"])(t).call(this,e,n));o.EVENTS=(r={},(0,u["default"])(r,"client_advisory",function(e){switch(e.data.advisory.name){case"replay_start":this.host.reactToAdvisoryEvent("replayStart",{replayMessageCount:e.data.advisory.replay_message_count});break;case"replay_stop":this.host.reactToAdvisoryEvent("replayStop")}}),(0,u["default"])(r,"message|group_message",function(e){this.host.conversations.reactToMessageEvent(e)}),(0,u["default"])(r,"message:status|group:message:status",function(e){this.host.messages.reactToMessageStatusEvent(e)}),(0,u["default"])(r,"friends",function(e){this.host.conversations.reactToFriendsEvent(e)}),(0,u["default"])(r,"presence",function(e){this.host.presence.reactToPresenceEvent(e)}),(0,u["default"])(r,"bang",function(e){this.host.groups.reactToBangEvent(e)}),(0,u["default"])(r,"update",function(e){var t=e.data,n=t.type,r=(0,c["default"])(t,["type"]);this.host.injectModel(r,n)}),(0,u["default"])(r,"account:settings",function(e){var t=this;e.data.services.forEach(function(n){switch(n.xmlns){case"tigertext:iq:update:account":var r=n.account||e.data.token;t.host.users.refresh(r);break;case"tigertext:iq:update:org_settings":t.host.organizations.refreshAll();break;default:t.logger.warn("unhandled account:settings service type "+n.xmlns)}})}),(0,u["default"])(r,"message:is_typing",function(e){this.host.typingStatus.reactToIsTypingEvent(e)}),(0,u["default"])(r,"push:credentials",function(e){}),(0,u["default"])(r,"remote_wipe",function(e){this.host.wipe()}),(0,u["default"])(r,"validated",function(e){this.logger.warn("validated not implemented")}),(0,u["default"])(r,"msg:metadata_update",function(e){this.logger.warn("msg:metadata_update not implemented")}),(0,u["default"])(r,"conversation_mute",function(e){this.host.mute.reactToMuteEvent(e)}),(0,u["default"])(r,"reconnect",function(e){this.host.events.reconnect()}),(0,u["default"])(r,"push:credentials",x.noop),(0,u["default"])(r,"sse:heartbeat",x.noop),r);var i=[];return(0,a["default"])(o.EVENTS,function(e,t){t.includes("|")&&(i.push(t),t.split("|").forEach(function(t){return o.EVENTS[t]=e}))}),i.forEach(function(e){return delete o.EVENTS[e]}),o}return(0,b["default"])(t,e),(0,h["default"])(t,[{key:"emit",value:function(e){this.EVENTS[e.type]?this.EVENTS[e.type].call(this,e):this.logger.error("unhandled event: "+e.type,e.data)}}]),t}(E["default"]);t["default"]=_,e.exports=t["default"]},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t,n,r,o){var a={};return Object.keys(r).forEach(function(e){a[e]=r[e]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},a),o&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(o):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=void 0;var a,i,u=n(11),s=r(u),c=n(9),l=r(c),f=n(8),d=r(f),p=n(33),y=r(p),h=n(6),g=r(h),v=n(21),m=r(v),b=n(65),w=r(b),E=n(48),x=r(E),_=n(3),k=r(_),O=n(1),I=r(O),j=n(2),T=r(j),A=n(5),M=r(A),G=n(4),V=r(G),z=n(12),P=r(z),C=n(131),S=r(C),U=n(13),q=n(52),$=n(140),R=r($),N=n(59),L=r(N),F=n(26),D=r(F),B=n(135),K=r(B),Z=n(16),W={isTyping:"is-typing",multiOrg:"multi-org",noOfflineMessages:"no-offline-messages",autoDeliver:"auto-deliver",hidden:"hidden",closeAfterMessages:"close-after-messages"},H=(0,U.classWithPrivateMethods)((i=function(e){function t(e,n){(0,I["default"])(this,t);var r=(0,M["default"])(this,(0,k["default"])(t).call(this,e,n));return r._throtelled_flushQueuedAcks=(0,x["default"])(r._flushQueuedAcks.bind(r),r.config.flushAckInterval,{leading:!1}),r}return(0,V["default"])(t,e),(0,T["default"])(t,[{key:"mounted",value:function(){this._queuedAcks=[]}},{key:"dispose",value:function(){this._queuedAcks=null,this._throtelled_flushQueuedAcks.cancel&&this._throtelled_flushQueuedAcks.cancel()}},{key:"connect",value:function(){var e,t=this;if(this.host.requireUser(),this.eventSource)return void this.logger.warn("already connected");var n=this.config.baseUrl+"/events";this.logger.info("connecting events");var r=(e=(e=(e=(e=this.config.events,R["default"]).call(e,w["default"]),L["default"]).call(e),D["default"]).call(e,function(e){return W[e]}),K["default"]).call(e).join(",");return this.eventSource=new S["default"](n,{headers:{Authorization:this.httpClient.getAuthHeader(),"TT-X-Features":r}}),new m["default"](function(e,n){var r=void 0;t.eventSource.once("open",function(){t.logger.info("open"),r=!0,e()}),t.eventSource.on("message",t._onEvent.bind(t)),t.eventSource.once("error",function(e){r||n(),t._onError(e)}),t.eventSource.on("close",function(){t.logger.info("close")})})}},{key:"disconnect",value:function(){this.eventSource&&this.eventSource.close(),this.eventSource=null}},{key:"reconnect",value:function(){this.eventSource&&this.disconnect(),this.connect()}},{key:"_onEvent",value:function(e){var t=this,n=e.data;if(n.includes("\n"))return void n.split("\n").forEach(function(e){return t._onEvent({data:e})});var r=n;try{n=JSON.parse(r)}catch(o){throw this.logger.error("error parsing ",r),o}var a=n.event_id,i=(0,g["default"])(n.event)[0],u=i.replace("tigertext:iq:",""),s=n.event[i];this.logger.info("incoming",u,s);var c=new q.Event(a,u,s,{_origData:r});try{this.host.eventRouter.emit(c),this.emit("event",c),this.config.autoAckSuccessfullyHandledEvents&&this.__queueAck(a)}catch(o){throw this.logger.error("error in event "+u,o,o.stack,{data:s}),o}}},{key:"_onError",value:function(e){var t=this;this.logger.warn("error",e,e.message||"",e.status||""),this.disconnect(),this.config.eventsAutoReconnect&&setTimeout(function(){t.connect()},this.config.eventsAutoReconnectDelay)}},{key:"__queueAck",value:function(e){var t;e=(0,Z.arrayWrap)(e),(t=this._queuedAcks).push.apply(t,(0,y["default"])(e)),e.length>=this.config.flushAckMaxEvents?(this.logger.log("reached "+this.config.flushAckMaxEvents+" -- flushing"),this._flushQueuedAcks()):this._throtelled_flushQueuedAcks()}},{key:"_flushQueuedAcks",value:function(){this._queuedAcks.length>0&&(this.ack(this._queuedAcks),this._queuedAcks.length=0)}},{key:"ack",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,d["default"])(l["default"].mark(function n(e){return l["default"].wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.host.requireUser(),e=(0,Z.arrayWrap)(e),this.logger.log("ack",e),t.prev=3,t.next=6,this.httpClient.post("/events/ack",{data:{events:e}});case 6:t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](3),this.logger.warn("some events not acked",e);case 11:case"end":return t.stop()}},n,this,[[3,8]])}));return e}()}]),t}(P["default"]),o(i.prototype,"_onEvent",[U.privateMethod],(0,s["default"])(i.prototype,"_onEvent"),i.prototype),o(i.prototype,"_onError",[U.privateMethod],(0,s["default"])(i.prototype,"_onError"),i.prototype),o(i.prototype,"__queueAck",[U.privateMethod],(0,s["default"])(i.prototype,"__queueAck"),i.prototype),o(i.prototype,"_flushQueuedAcks",[U.privateMethod],(0,s["default"])(i.prototype,"_flushQueuedAcks"),i.prototype),a=i))||a;t["default"]=H,e.exports=t["default"]},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t,n,r,o){var a={};return Object.keys(r).forEach(function(e){a[e]=r[e]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},a),o&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(o):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}function a(e,t){var n=4,r=15;if(void 0===t&&(t=0),t+=1,null===e)return"null";if(void 0===e)return"void";if("string"==typeof e||"number"==typeof e||"boolean"==typeof e)return"undefined"==typeof e?"undefined":(0,m["default"])(e);if(!Array.isArray(e)){var o=(0,g["default"])(e);if(!o.length)return e.constructor&&e.constructor.name&&"Object"!==e.constructor.name?e.constructor.name:"Object";if(t>n)return"{...}";var i="  ".repeat(t-1),u=o.slice(0,r).map(function(n){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(n)?n:(0,y["default"])(n))+": "+a(e[n],t)+";"}).join("\n  "+i);return o.length>=r&&(u+="\n  "+i+"..."),e.constructor&&e.constructor.name&&"Object"!==e.constructor.name?e.constructor.name+" {\n  "+i+u+"\n"+i+"}":"{\n  "+i+u+"\n"+i+"}"}if(!(e.length>0))return"Array";var s=function(){if(t>n)return{v:"[...]"};var o=a(e[0],t);return e.every(function(e){return a(e,t)===o})?{v:o.trim()+"[]"}:{v:"["+e.slice(0,r).map(function(e){return a(e,t)}).join(", ")+(e.length>=r?", ...":"")+"]"}}();return"object"===("undefined"==typeof s?"undefined":(0,m["default"])(s))?s.v:void 0}function i(e,t){var n=4,r=15;if(void 0===t&&(t=0),t+=1,null===e)return"null";if(void 0===e)return"void";if("string"==typeof e||"number"==typeof e||"boolean"==typeof e)return"undefined"==typeof e?"undefined":(0,m["default"])(e);if(!Array.isArray(e)){var o=(0,g["default"])(e);if(!o.length)return e.constructor&&e.constructor.name&&"Object"!==e.constructor.name?e.constructor.name:"Object";if(t>n)return"{...}";var a="  ".repeat(t-1),u=o.slice(0,r).map(function(n){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(n)?n:(0,y["default"])(n))+": "+i(e[n],t)+";"}).join("\n  "+a);return o.length>=r&&(u+="\n  "+a+"..."),e.constructor&&e.constructor.name&&"Object"!==e.constructor.name?e.constructor.name+" {\n  "+a+u+"\n"+a+"}":"{\n  "+a+u+"\n"+a+"}"}if(!(e.length>0))return"Array";var s=function(){if(t>n)return{v:"[...]"};var o=i(e[0],t);return e.every(function(e){return i(e,t)===o})?{v:o.trim()+"[]"}:{v:"["+e.slice(0,r).map(function(e){return i(e,t)}).join(", ")+(e.length>=r?", ...":"")+"]"}}();return"object"===("undefined"==typeof s?"undefined":(0,m["default"])(s))?s.v:void 0}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=void 0;var u,s,c,l,f,d,p=n(7),y=r(p),h=n(6),g=r(h),v=n(10),m=r(v),b=n(11),w=r(b),E=n(169),x=r(E),_=n(43),k=r(_),O=n(168),I=r(O),j=n(33),T=r(j),A=n(21),M=r(A),G=n(19),V=r(G),z=n(18),P=r(z),C=n(9),S=r(C),U=n(8),q=r(U),$=n(3),R=r($),N=n(1),L=r(N),F=n(2),D=r(F),B=n(5),K=r(B),Z=n(4),W=r(Z),H=n(12),X=r(H),Q=n(14),Y=r(Q),J=n(15),ee=n(13),te=n(26),ne=r(te),re=n(40),oe=r(re),ae=n(42),ie=r(ae),ue=n(16),se=(u=(0,J.decorator)(),s=(0,J.decorator)(),c=(0,J.decorator)(),l=(0,J.decorator)(),(0,ee.classWithPrivateMethods)((d=function(e){function t(){return(0,L["default"])(this,t),(0,K["default"])(this,(0,R["default"])(t).apply(this,arguments))}return(0,W["default"])(t,e),(0,D["default"])(t,[{key:"mounted",value:function(){this._fetched=!1}},{key:"dispose",value:function(){this._fetched=!1}},{key:"create",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,q["default"])(S["default"].mark(function n(e){var t,r,o=e.organizationId,a=e.name,i=e.avatarFile,u=e.replayHistory,s=void 0===u?!0:u,c=e.memberIds,l=void 0===c?[]:c,f=e.metadata;return S["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.host.requireUser(),o){e.next=3;break}throw new Y["default"].ValidationError("organizationId","required");case 3:return l=l.map(this._resolveModelId.bind(this)),l.includes(this.host.currentUserId)||l.unshift(this.host.currentUserId),e.next=7,this.host.api.groups.create({name:a,avatarFile:i,replayHistory:s,memberIds:l,organizationId:o});case 7:if(t=e.sent,r=this.host.models.Group.inject(t),!f){e.next=12;break}return e.next=12,this.host.metadata.update(r.id,f,o);case 12:return e.abrupt("return",r);case 13:case"end":return e.stop()}},n,this)}));return e}()},{key:"update",value:function(){function e(e,n){return t.apply(this,arguments)}var t=(0,q["default"])(S["default"].mark(function n(e,t){var r,o,u,s=t.name,c=t.avatarFile,l=t.replayHistory,f=t.memberIds,d=t.metadata;return S["default"].wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if("string"==typeof e||e instanceof Object){t.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(e));case 2:if("string"==typeof e||e instanceof Object){t.next=4;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(e));case 4:return this.host.requireUser(),e=this._resolveModelId(e),r={},"undefined"!=typeof s&&(r.name=s),"undefined"!=typeof l&&(r.replayHistory=l),"undefined"!=typeof f&&(r.memberIds=f),t.next=12,this.host.api.groups.update(e,{name:s,avatarFile:c,replayHistory:l,memberIds:f});case 12:if(o=t.sent,"undefined"!=typeof o.avatarUrl&&(r.avatarUrl=o.avatarUrl),u=this.host.models.Group.inject((0,P["default"])({id:e},r)),!d){t.next=18;break}return t.next=18,this.host.metadata.update(e,d,u.organizationId);case 18:return t.abrupt("return",u);case 19:case"end":return t.stop()}},n,this)}));return e}()},{key:"find",value:function(){function e(e,n){return t.apply(this,arguments)}var t=(0,q["default"])(S["default"].mark(function n(e){var t,r,o=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return S["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof e){n.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));case 2:if("string"==typeof e){n.next=4;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));case 4:if(o=(0,V["default"])(o,{ignoreNotFound:!1,bypassCache:!1,includeMembers:!1,includeMetadata:!1}),this.host.requireUser(),t=null,o.bypassCache){n.next=13;break}if(t=this.host.models.Group.get(e),!t||t.$placeholder){n.next=13;break}return n.next=12,this.__ensureEntitiesLoaded(t.id,o);case 12:return n.abrupt("return",t);case 13:return n.next=15,this.host.api.groups.find(e);case 15:if(r=n.sent,!r){n.next=21;break}t=this.host.models.Group.inject(r),delete t.$placeholder,n.next=23;break;case 21:if(o.ignoreNotFound){n.next=23;break}throw new Y["default"].NotFoundError(this.host.models.Group.name,e);case 23:if(!t){n.next=26;break}return n.next=26,this.__ensureEntitiesLoaded(t.id,o);case 26:return n.abrupt("return",t);case 27:case"end":return n.stop()}},n,this)}));return e}()},{key:"__ensureEntitiesLoaded",value:function(){function e(e,n){return t.apply(this,arguments)}var t=(0,q["default"])(S["default"].mark(function n(e,t){var r,o;return S["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof e){n.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));case 2:if("string"==typeof e){n.next=4;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));case 4:return r=this.host.models.Group.get(e),o=[],t.includeMetadata&&o.push(this.host.metadata.find(e,r.organizationId)),t.includeMembers&&o.push(this.ensureMembers(r)),n.next=10,M["default"].all(o);case 10:this.host.models.Group.touch(e);case 11:case"end":return n.stop()}},n,this)}));return e}()},{key:"findAll",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,q["default"])(S["default"].mark(function n(){var e,t,r,o,a,i,u,s=this,c=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],l=c.includeMembers,f=void 0===l?!1:l,d=c.includeMetadata,p=void 0===d?!1:d;return S["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!this._fetched){n.next=2;break}return n.abrupt("return",this.getAll());case 2:if(e=this.host.models.Organization.getAll(),0!=e.length){n.next=7;break}return n.next=6,this.host.organizations.findAll();case 6:e=n.sent;case 7:return n.next=9,this.host.search.query({types:["group"],organizationIds:e.map(function(e){return e.id}),query:{displayName:""},includeMetadata:p});case 9:if(t=n.sent,r=t.map(function(e){return e.entity}),!f){n.next=19;break}if(i=[],u=(o=(o=ne["default"].call(r,"memberIds"),oe["default"]).call(o),ie["default"]).call(o),(a=i).push.apply(a,(0,T["default"])(u.map(function(e){return s.host.users.find(e,{ignoreNotFound:!0})}))),i=i.filter(Boolean),!(i.length>0)){n.next=19;break}return n.next=19,M["default"].all(i);case 19:return this._fetched=!0,n.abrupt("return",r);case 21:case"end":return n.stop()}},n,this)}));return e}()},{key:"findAllWithSpecificMembers",value:function(){function e(e,n){return t.apply(this,arguments)}var t=(0,q["default"])(S["default"].mark(function n(e,t){var r;return S["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof e||Array.isArray(e)&&e.every(function(e){return"string"==typeof e})||Array.isArray(e)&&e.every(function(e){return e instanceof Object})){n.next=2;break}throw new TypeError('Value of argument "memberIds" violates contract.\n\nExpected:\nstring | string[] | Object[]\n\nGot:\n'+i(e));case 2:if("string"==typeof t||t instanceof Object){n.next=4;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(t));case 4:if("string"==typeof e||Array.isArray(e)&&e.every(function(e){return"string"==typeof e})||Array.isArray(e)&&e.every(function(e){return e instanceof Object})){n.next=6;break}throw new TypeError('Value of argument "memberIds" violates contract.\n\nExpected:\nstring | string[] | Object[]\n\nGot:\n'+a(e));case 6:if("string"==typeof t||t instanceof Object){n.next=8;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(t));case 8:if(t=this._resolveModelId(t),e=(0,ue.arrayWrap)(e).map(this._resolveModelId.bind(this)),!e.includes(this.host.currentUserId)&&e.push(this.host.currentUserId),r=this.__findAllLocalWithSpecificMembers(e,t),0!==r.length){n.next=16;break}return n.next=15,this.findAll();case 15:r=this.__findAllLocalWithSpecificMembers(e,t);case 16:return n.abrupt("return",r);case 17:case"end":return n.stop()}},n,this)}));return e}()},{key:"ensureMembers",value:function(){function e(e,n){return t.apply(this,arguments)}var t=(0,q["default"])(S["default"].mark(function n(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return S["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(e instanceof Object){n.next=2;break}throw new TypeError('Value of argument "group" violates contract.\n\nExpected:\nObject\n\nGot:\n'+i(e));case 2:if(e instanceof Object){n.next=4;break}throw new TypeError('Value of argument "group" violates contract.\n\nExpected:\nObject\n\nGot:\n'+a(e));case 4:return n.abrupt("return",this.ensureMembersWithIds(e.id,e.memberIds,t));case 5:case"end":return n.stop()}},n,this)}));return e}()},{key:"ensureMembersWithIds",value:function(){function e(e,n,r){return t.apply(this,arguments)}var t=(0,q["default"])(S["default"].mark(function n(e,t){var r=this,o=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];return S["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof e){n.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));case 2:if(Array.isArray(t)&&t.every(function(e){return"string"==typeof e})){n.next=4;break}throw new TypeError('Value of argument "memberIds" violates contract.\n\nExpected:\nstring[]\n\nGot:\n'+i(t));case 4:if("string"==typeof e){n.next=6;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));case 6:if(Array.isArray(t)&&t.every(function(e){return"string"==typeof e})){n.next=8;break}throw new TypeError('Value of argument "memberIds" violates contract.\n\nExpected:\nstring[]\n\nGot:\n'+a(t));case 8:if(this.host.requireUser(),t=(0,I["default"])(t,this.host.currentUserId),0!==t.length){n.next=12;break}return n.abrupt("return");case 12:return o=(0,V["default"])(o,{onlyPlaceholder:!1}),n.next=15,M["default"].all(t.map(function(e){return r.__ensureMember(e,o)}).filter(Boolean));case 15:this.host.models.Group.touch(e);case 16:case"end":return n.stop()}},n,this)}));return e}()},{key:"__ensureMember",value:function(e,t){var n=this;if("string"!=typeof e)throw new TypeError('Value of argument "memberId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));if("string"!=typeof e)throw new TypeError('Value of argument "memberId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));return this.host.models.User.shouldEnsure(e,t.onlyPlaceholder)?new M["default"](function(r,o){n.host.models.User.ensureEntity(e,(0,P["default"])({},t,{onFinish:r}))}):null}},{key:"getAll",value:function(){return this.host.models.Group.getAll()}},{key:"getById",value:function(e){if("string"!=typeof e)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));if("string"!=typeof e)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));return this.host.models.Group.get(e)}},{key:"getMultiById",value:function(e){if(!Array.isArray(e)||!e.every(function(e){return"string"==typeof e}))throw new TypeError('Value of argument "ids" violates contract.\n\nExpected:\nArray<string>\n\nGot:\n'+i(e));if(!Array.isArray(e)||!e.every(function(e){return"string"==typeof e}))throw new TypeError('Value of argument "ids" violates contract.\n\nExpected:\nArray<string>\n\nGot:\n'+a(e));return this.host.models.Group.getMulti(e)}},{key:"__findAllLocalWithSpecificMembers",value:function(e,t){if(!Array.isArray(e)||!e.every(function(e){return"string"==typeof e}))throw new TypeError('Value of argument "memberIds" violates contract.\n\nExpected:\nstring[]\n\nGot:\n'+i(e));if("string"!=typeof t)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));if(!Array.isArray(e)||!e.every(function(e){return"string"==typeof e}))throw new TypeError('Value of argument "memberIds" violates contract.\n\nExpected:\nstring[]\n\nGot:\n'+a(e));if("string"!=typeof t)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));var n=this.host.models.Group.getAll(),r=(0,k["default"])(n,function(n){return n.organizationId==t&&0==(0,x["default"])(n.memberIds,e).length});return r}},{key:"destroy",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,q["default"])(S["default"].mark(function n(e){var t;return S["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof e||e instanceof Object){n.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(e));case 2:if("string"==typeof e||e instanceof Object){n.next=4;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(e));case 4:return this.host.requireUser(),e=this._resolveModelId(e),n.next=8,this.host.api.groups.destroy(e);case 8:if(t=n.sent){n.next=11;break}throw new Y["default"].NotFoundError(this.host.models.Group.name,e);case 11:return this.host.models.Group.eject(e),n.abrupt("return",null);case 13:case"end":return n.stop()}},n,this)}));return e}()},{key:"findAllMemberIds",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,q["default"])(S["default"].mark(function n(e){var t;return S["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof e||e instanceof Object){n.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(e));case 2:if("string"==typeof e||e instanceof Object){n.next=4;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(e));case 4:return this.host.requireUser(),e=this._resolveModelId(e),n.next=8,this.httpClient.get("/group/:id/members",{urlParams:{id:e}});case 8:return t=n.sent,n.abrupt("return",t.data);case 10:case"end":return n.stop()}},n,this)}));return e}()},{key:"addMembers",value:function(){function e(e,n){return t.apply(this,arguments)}var t=(0,q["default"])(S["default"].mark(function n(e,t){return S["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof e||e instanceof Object){n.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(e));case 2:if("string"==typeof t||Array.isArray(t)&&t.every(function(e){return"string"==typeof e})||Array.isArray(t)&&t.every(function(e){return e instanceof Object})){n.next=4;break}throw new TypeError('Value of argument "memberIds" violates contract.\n\nExpected:\nstring | string[] | Object[]\n\nGot:\n'+i(t));case 4:if("string"==typeof e||e instanceof Object){n.next=6;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(e));case 6:if("string"==typeof t||Array.isArray(t)&&t.every(function(e){return"string"==typeof e})||Array.isArray(t)&&t.every(function(e){return e instanceof Object})){n.next=8;break}throw new TypeError('Value of argument "memberIds" violates contract.\n\nExpected:\nstring | string[] | Object[]\n\nGot:\n'+a(t));case 8:return this.host.requireUser(),e=this._resolveModelId(e),t=(0,ue.arrayWrap)(t).map(this._resolveModelId.bind(this)),n.next=13,this.host.api.groups.addMembers(e,t);case 13:case"end":return n.stop()}},n,this)}));return e}()},{
key:"removeMembers",value:function(){function e(e,n){return t.apply(this,arguments)}var t=(0,q["default"])(S["default"].mark(function n(e,t){return S["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof e||e instanceof Object){n.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(e));case 2:if("string"==typeof t||Array.isArray(t)&&t.every(function(e){return"string"==typeof e})||Array.isArray(t)&&t.every(function(e){return e instanceof Object})){n.next=4;break}throw new TypeError('Value of argument "memberIds" violates contract.\n\nExpected:\nstring | string[] | Object[]\n\nGot:\n'+i(t));case 4:if("string"==typeof e||e instanceof Object){n.next=6;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(e));case 6:if("string"==typeof t||Array.isArray(t)&&t.every(function(e){return"string"==typeof e})||Array.isArray(t)&&t.every(function(e){return e instanceof Object})){n.next=8;break}throw new TypeError('Value of argument "memberIds" violates contract.\n\nExpected:\nstring | string[] | Object[]\n\nGot:\n'+a(t));case 8:return this.host.requireUser(),e=this._resolveModelId(e),t=(0,ue.arrayWrap)(t).map(this._resolveModelId.bind(this)),n.next=13,this.host.api.groups.removeMembers(e,t);case 13:t.includes(this.host.currentUserId)&&this.host.models.Group.eject(e);case 14:case"end":return n.stop()}},n,this)}));return e}()},{key:"addMember",value:function(){function e(e,n){return t.apply(this,arguments)}var t=(0,q["default"])(S["default"].mark(function n(e,t){return S["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof e||e instanceof Object){n.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(e));case 2:if("string"==typeof t||t instanceof Object){n.next=4;break}throw new TypeError('Value of argument "memberId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(t));case 4:if("string"==typeof e||e instanceof Object){n.next=6;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(e));case 6:if("string"==typeof t||t instanceof Object){n.next=8;break}throw new TypeError('Value of argument "memberId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(t));case 8:return n.abrupt("return",this.addMembers(e,[t]));case 9:case"end":return n.stop()}},n,this)}));return e}()},{key:"removeMember",value:function(){function e(e,n){return t.apply(this,arguments)}var t=(0,q["default"])(S["default"].mark(function n(e,t){return S["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof e||e instanceof Object){n.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(e));case 2:if("string"==typeof t||t instanceof Object){n.next=4;break}throw new TypeError('Value of argument "memberId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(t));case 4:if("string"==typeof e||e instanceof Object){n.next=6;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(e));case 6:if("string"==typeof t||t instanceof Object){n.next=8;break}throw new TypeError('Value of argument "memberId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(t));case 8:return n.abrupt("return",this.removeMembers(e,[t]));case 9:case"end":return n.stop()}},n,this)}));return e}()},{key:"join",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,q["default"])(S["default"].mark(function n(e){return S["default"].wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if("string"==typeof e||e instanceof Object){t.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(e));case 2:if("string"==typeof e||e instanceof Object){t.next=4;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(e));case 4:return t.abrupt("return",this.addMembers(e,[this.host.currentUserId]));case 5:case"end":return t.stop()}},n,this)}));return e}()},{key:"leave",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,q["default"])(S["default"].mark(function n(e){var t;return S["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof e||e instanceof Object){n.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(e));case 2:if("string"==typeof e||e instanceof Object){n.next=4;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(e));case 4:if(e=this._resolveModelId(e),t=this.getById(e)){n.next=8;break}return n.abrupt("return");case 8:return n.next=10,this.host.conversations.remove("group",e,t.organizationId);case 10:return n.next=12,this.removeMember(e,this.host.currentUserId);case 12:case"end":return n.stop()}},n,this)}));return e}()},{key:"reactToBangEvent",value:function(e){switch(e.data.event){case"added":this.__addedToGroup(e);break;case"removed":this.__removedFromGroup(e)}}},{key:"__addedToGroup",value:function(e){var t=e.data.caller_entity,n=e.data.subject_entity,r=e.data.target_entity;if(t&&t.token&&r&&r.token&&n&&n.token){var o=this.host.injectModel(t),a=this.host.injectModel(n),i=this.host.models.Group.get(r.token);if(i){var u=a.id===o.id?"JOIN":"ADD",s={id:e.id,sortNumber:+e.data.sort_number,createdAt:new Date(e.data.created_on),action:u,actor:o,actorId:o.id,group:i,groupId:i.id,members:[a],memberIds:[a.id]};this.host.conversations.addMembershipChangeLog(s),i.memberIds.includes(a.id)||(this.host.models.Group.touch(i),this.emit("membership:change",s))}}}},{key:"__removedFromGroup",value:function(e){var t=e.data.caller_entity,n=e.data.subject_entity,r=e.data.target_entity;if(t&&t.token&&r&&r.token&&n&&n.token){var o=this.host.injectModel(t),a=this.host.models.Group.get(r.token);if(a&&a.memberIds){var i=this.host.injectModel(n),u=i.id===o.id?"LEAVE":"REMOVE",s={id:e.id,sortNumber:+e.data.sort_number,createdAt:new Date(e.data.created_on),action:u,actor:o,actorId:o.id,group:a,groupId:a.id,members:[i],memberIds:[i.id]};this.host.conversations.addMembershipChangeLog(s),a.memberIds.includes(i.id)&&this.emit("membership:change",s)}}}}]),t}(X["default"]),o(d.prototype,"find",[u],(0,w["default"])(d.prototype,"find"),d.prototype),o(d.prototype,"__ensureEntitiesLoaded",[s],(0,w["default"])(d.prototype,"__ensureEntitiesLoaded"),d.prototype),o(d.prototype,"findAll",[c],(0,w["default"])(d.prototype,"findAll"),d.prototype),o(d.prototype,"findAllWithSpecificMembers",[l],(0,w["default"])(d.prototype,"findAllWithSpecificMembers"),d.prototype),o(d.prototype,"__findAllLocalWithSpecificMembers",[ee.privateMethod],(0,w["default"])(d.prototype,"__findAllLocalWithSpecificMembers"),d.prototype),o(d.prototype,"__addedToGroup",[ee.privateMethod],(0,w["default"])(d.prototype,"__addedToGroup"),d.prototype),o(d.prototype,"__removedFromGroup",[ee.privateMethod],(0,w["default"])(d.prototype,"__removedFromGroup"),d.prototype),f=d))||f);t["default"]=se,e.exports=t["default"]},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t,n,r,o){var a={};return Object.keys(r).forEach(function(e){a[e]=r[e]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},a),o&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(o):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}function a(e,t){var n=4,r=15;if(void 0===t&&(t=0),t+=1,null===e)return"null";if(void 0===e)return"void";if("string"==typeof e||"number"==typeof e||"boolean"==typeof e)return"undefined"==typeof e?"undefined":(0,P["default"])(e);if(!Array.isArray(e)){var o=(0,m["default"])(e);if(!o.length)return e.constructor&&e.constructor.name&&"Object"!==e.constructor.name?e.constructor.name:"Object";if(t>n)return"{...}";var i="  ".repeat(t-1),u=o.slice(0,r).map(function(n){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(n)?n:(0,g["default"])(n))+": "+a(e[n],t)+";"}).join("\n  "+i);return o.length>=r&&(u+="\n  "+i+"..."),e.constructor&&e.constructor.name&&"Object"!==e.constructor.name?e.constructor.name+" {\n  "+i+u+"\n"+i+"}":"{\n  "+i+u+"\n"+i+"}"}if(!(e.length>0))return"Array";var s=function(){if(t>n)return{v:"[...]"};var o=a(e[0],t);return e.every(function(e){return a(e,t)===o})?{v:o.trim()+"[]"}:{v:"["+e.slice(0,r).map(function(e){return a(e,t)}).join(", ")+(e.length>=r?", ...":"")+"]"}}();return"object"===("undefined"==typeof s?"undefined":(0,P["default"])(s))?s.v:void 0}function i(e,t){var n=4,r=15;if(void 0===t&&(t=0),t+=1,null===e)return"null";if(void 0===e)return"void";if("string"==typeof e||"number"==typeof e||"boolean"==typeof e)return"undefined"==typeof e?"undefined":(0,P["default"])(e);if(!Array.isArray(e)){var o=(0,m["default"])(e);if(!o.length)return e.constructor&&e.constructor.name&&"Object"!==e.constructor.name?e.constructor.name:"Object";if(t>n)return"{...}";var a="  ".repeat(t-1),u=o.slice(0,r).map(function(n){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(n)?n:(0,g["default"])(n))+": "+i(e[n],t)+";"}).join("\n  "+a);return o.length>=r&&(u+="\n  "+a+"..."),e.constructor&&e.constructor.name&&"Object"!==e.constructor.name?e.constructor.name+" {\n  "+a+u+"\n"+a+"}":"{\n  "+a+u+"\n"+a+"}"}if(!(e.length>0))return"Array";var s=function(){if(t>n)return{v:"[...]"};var o=i(e[0],t);return e.every(function(e){return i(e,t)===o})?{v:o.trim()+"[]"}:{v:"["+e.slice(0,r).map(function(e){return i(e,t)}).join(", ")+(e.length>=r?", ...":"")+"]"}}();return"object"===("undefined"==typeof s?"undefined":(0,P["default"])(s))?s.v:void 0}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=void 0;var u,s,c,l,f,d,p,y,h=n(7),g=r(h),v=n(6),m=r(v),b=n(11),w=r(b),E=n(64),x=r(E),_=n(166),k=r(_),O=n(67),I=r(O),j=n(44),T=r(j),A=n(47),M=r(A),G=n(21),V=r(G),z=n(10),P=r(z),C=n(46),S=r(C),U=n(17),q=r(U),$=n(149),R=r($),N=n(28),L=r(N),F=n(38),D=r(F),B=n(39),K=r(B),Z=n(145),W=r(Z),H=n(9),X=r(H),Q=n(66),Y=r(Q),J=n(18),ee=r(J),te=n(8),ne=r(te),re=n(48),oe=r(re),ae=n(3),ie=r(ae),ue=n(1),se=r(ue),ce=n(2),le=r(ce),fe=n(5),de=r(fe),pe=n(4),ye=r(pe),he=n(12),ge=r(he),ve=n(49),me=r(ve),be=n(15),we=n(13),Ee=n(68),xe=r(Ee),_e=n(25),ke=n(27),Oe=r(ke),Ie=n(14),je=r(Ie),Te=n(23),Ae=r(Te),Me=n(41),Ge=r(Me),Ve=n(137),ze=r(Ve),Pe=n(136),Ce=r(Pe),Se=n(26),Ue=r(Se),qe=n(42),$e=r(qe),Re=n(29),Ne=r(Re),Le=n(16),Fe=["user","group","distributionList"],De=(u=(0,be.decorator)(),s=(0,be.decorator)(),c=(0,be.decorator)({memoize:!0}),l=(0,be.decorator)({memoize:!0}),f=(0,be.decorator)(),d=(0,be.decorator)(),(0,we.classWithPrivateMethods)((y=function(e){function t(){var e;(0,se["default"])(this,t);for(var n=arguments.length,r=Array(n),o=0;n>o;o++)r[o]=arguments[o];var a=(0,de["default"])(this,(e=(0,ie["default"])(t)).call.apply(e,[this].concat(r)));return a._throtelled_flushQueueMessageStatuses=a.config.flushSetMessageStatusInterval?(0,oe["default"])(a.__flushQueueMessageStatuses,a.config.flushSetMessageStatusInterval,{leading:!1}):a.__flushQueueMessageStatuses,a}return(0,ye["default"])(t,e),(0,le["default"])(t,[{key:"mounted",value:function(){this._queuedMessageStatuses={deliveredIds:[],readIds:[]},this.host.on("tick",this.deleteExpiredMessages)}},{key:"dispose",value:function(){this._queuedMessageStatuses=null,this.downloadAttachmentBlobAndURL&&be.decorator.clear(this.downloadAttachmentBlobAndURL),this.downloadAttachmentURL&&be.decorator.clear(this.downloadAttachmentURL),this._throtelled_flushQueueMessageStatuses.cancel&&this._throtelled_flushQueueMessageStatuses.cancel(),this.host.off("tick",this.deleteExpiredMessages)}},{key:"send",value:function(){function e(e,n,r){return t.apply(this,arguments)}var t=(0,ne["default"])(X["default"].mark(function n(e,t){var r,o,u,s=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];return X["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof e||Array.isArray(e)&&e.every(function(e){return"string"==typeof e})||e instanceof Object||Array.isArray(e)&&e.every(function(e){return e instanceof Object})){n.next=2;break}throw new TypeError('Value of argument "entityId" violates contract.\n\nExpected:\nstring | string[] | Object | Object[]\n\nGot:\n'+i(e));case 2:if("string"==typeof t){n.next=4;break}throw new TypeError('Value of argument "body" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));case 4:if(null==s||s instanceof Object){n.next=6;break}throw new TypeError('Value of argument "options" violates contract.\n\nExpected:\n?Object\n\nGot:\n'+i(s));case 6:if("string"==typeof e||Array.isArray(e)&&e.every(function(e){return"string"==typeof e})||e instanceof Object||Array.isArray(e)&&e.every(function(e){return e instanceof Object})){n.next=8;break}throw new TypeError('Value of argument "entityId" violates contract.\n\nExpected:\nstring | string[] | Object | Object[]\n\nGot:\n'+a(e));case 8:if("string"==typeof t){n.next=10;break}throw new TypeError('Value of argument "body" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));case 10:if(null==s||s instanceof Object){n.next=12;break}throw new TypeError('Value of argument "options" violates contract.\n\nExpected:\n?Object\n\nGot:\n'+a(s));case 12:if(!Array.isArray(e)){n.next=14;break}return n.abrupt("return",this.__sendToGroupOfUsers(e,t,s));case 14:return n.next=16,this.__resolveCounterPartyEntityAndOrganizationId(e,!1);case 16:if(r=n.sent,o=r.counterParty,u=r.organizationId,u&&(s=(0,ee["default"])({},(0,Y["default"])(s,"organizationId","senderOrganizationId","recipientOrganizationId"),{organizationId:u})),!o){n.next=24;break}return n.abrupt("return",this.__sendToKnownCounterParty(o.$entityType,o.serverId,t,s));case 24:return n.abrupt("return",this.__sendToUnknownCounterParty(e,t,s));case 25:case"end":return n.stop()}},n,this)}));return e}()},{key:"__resolveCounterPartyEntityAndOrganizationId",value:function(){function e(e,n){return t.apply(this,arguments)}var t=(0,ne["default"])(X["default"].mark(function n(e){var t,r,o,u=arguments.length<=1||void 0===arguments[1]?!1:arguments[1];return X["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof e||e instanceof Object){n.next=2;break}throw new TypeError('Value of argument "entityId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(e));case 2:if("boolean"==typeof u){n.next=4;break}throw new TypeError('Value of argument "fallbackRemote" violates contract.\n\nExpected:\nbool\n\nGot:\n'+i(u));case 4:if("string"==typeof e||e instanceof Object){n.next=6;break}throw new TypeError('Value of argument "entityId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(e));case 6:if("boolean"==typeof u){n.next=8;break}throw new TypeError('Value of argument "fallbackRemote" violates contract.\n\nExpected:\nbool\n\nGot:\n'+a(u));case 8:if(t=this._resolveEntity(e,[].concat(Fe,["conversation"])),r=null,t){n.next=16;break}if(!this.host.conversations.looksLikeConversationId(e)){n.next=16;break}return n.next=14,this.host.conversations.find(e);case 14:o=n.sent,o&&(t=o.counterParty,r=o.organizationId);case 16:if(t||!u){n.next=20;break}return n.next=19,this.__resolveRemoteCounterPartyEntity(e);case 19:t=n.sent;case 20:return t&&(t.organizationId&&(r=t.organizationId),"conversation"===t.$entityType&&(t=t.counterParty)),n.abrupt("return",{counterParty:t,organizationId:r});case 22:case"end":return n.stop()}},n,this)}));return e}()},{key:"__resolveRemoteCounterPartyEntity",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,ne["default"])(X["default"].mark(function n(e){var t,r,o,u,s,c,l,f,d=this;return X["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof e){n.next=2;break}throw new TypeError('Value of argument "entityId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));case 2:if("string"==typeof e){n.next=4;break}throw new TypeError('Value of argument "entityId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));case 4:if(t=null,r=(0,W["default"])([(0,ne["default"])(X["default"].mark(function p(){return X["default"].wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",d.host.users.find(e));case 1:case"end":return t.stop()}},p,d)})),(0,ne["default"])(X["default"].mark(function y(){return X["default"].wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",d.host.groups.find(e));case 1:case"end":return t.stop()}},y,d)})),(0,ne["default"])(X["default"].mark(function h(){return X["default"].wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",d.host.distributionLists.find(e));case 1:case"end":return t.stop()}},h,d)}))]),r&&("function"==typeof r[K["default"]]||Array.isArray(r))){n.next=8;break}throw new TypeError("Expected resolvers to be iterable, got "+a(r));case 8:if(r&&("function"==typeof r[K["default"]]||Array.isArray(r))){n.next=10;break}throw new TypeError("Expected resolvers to be iterable, got "+i(r));case 10:o=!0,u=!1,s=void 0,n.prev=13,c=(0,D["default"])(r);case 15:if(o=(l=c.next()).done){n.next=32;break}return f=l.value,n.prev=17,n.next=20,f();case 20:if(t=n.sent,!t){n.next=23;break}return n.abrupt("break",32);case 23:n.next=29;break;case 25:if(n.prev=25,n.t0=n["catch"](17),n.t0.code===je["default"].NotFoundError.CODE){n.next=29;break}throw n.t0;case 29:o=!0,n.next=15;break;case 32:n.next=38;break;case 34:n.prev=34,n.t1=n["catch"](13),u=!0,s=n.t1;case 38:n.prev=38,n.prev=39,!o&&c["return"]&&c["return"]();case 41:if(n.prev=41,!u){n.next=44;break}throw s;case 44:return n.finish(41);case 45:return n.finish(38);case 46:return n.abrupt("return",t);case 47:case"end":return n.stop()}},n,this,[[13,34,38,46],[17,25],[39,,41,45]])}));return e}()},{key:"__sendToKnownCounterParty",value:function(){function e(e,n,r,o){return t.apply(this,arguments)}var t=(0,ne["default"])(X["default"].mark(function n(e,t,r,o){var u,s,c,l,f=o.organizationId,d=o.senderOrganizationId,p=void 0===d?f:d,y=o.recipientOrganizationId,h=void 0===y?p:y,g=(0,L["default"])(o,["organizationId","senderOrganizationId","recipientOrganizationId"]),v=arguments;return X["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof e){n.next=2;break}throw new TypeError('Value of argument "counterPartyType" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));case 2:if("string"==typeof t){n.next=4;break}throw new TypeError('Value of argument "counterPartyId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));case 4:if("string"==typeof r){n.next=6;break}throw new TypeError('Value of argument "body" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(r));case 6:if(!(null==v[3]||null!=v[3].organizationId&&"string"!=typeof v[3].organizationId||null!=v[3].senderOrganizationId&&"string"!=typeof v[3].senderOrganizationId||null!=v[3].recipientOrganizationId&&"string"!=typeof v[3].recipientOrganizationId)&&(null==v[3].options||v[3].options instanceof Object)){n.next=8;break}throw new TypeError("Value of argument 3 violates contract.\n\nExpected:\n{ organizationId: ?string;\n  senderOrganizationId: ?string;\n  recipientOrganizationId: ?string;\n  options: ?Object;\n}\n\nGot:\n"+i(v[3]));case 8:if("string"==typeof e){n.next=10;break}throw new TypeError('Value of argument "counterPartyType" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));case 10:if("string"==typeof t){n.next=12;break}throw new TypeError('Value of argument "counterPartyId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));case 12:if("string"==typeof r){n.next=14;break}throw new TypeError('Value of argument "body" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(r));case 14:if(!(null==v[3]||null!=v[3].organizationId&&"string"!=typeof v[3].organizationId||null!=v[3].senderOrganizationId&&"string"!=typeof v[3].senderOrganizationId||null!=v[3].recipientOrganizationId&&"string"!=typeof v[3].recipientOrganizationId)&&(null==v[3].options||v[3].options instanceof Object)){n.next=16;break}throw new TypeError("Value of argument 3 violates contract.\n\nExpected:\n{ organizationId: ?string;\n  senderOrganizationId: ?string;\n  recipientOrganizationId: ?string;\n  options: ?Object;\n}\n\nGot:\n"+a(v[3]));case 16:this.host.requireUser(),Oe["default"].oneOf("counterPartyType",e,["user","group","distributionList"]),Oe["default"].notEmpty("counterPartyId",t),u=this.__getNextSortNumber(),p=this.__ensureOrganization(p),h=h||p,g=this.__normalizeSendOptions(g,p),s=this.host.conversations.ensureConversation(e,t,p),c=this.host.models.Message.createInstance({id:xe["default"].v4(),conversationId:s.id,messageType:_e.MessageType.USER_SENT,counterPartyId:t,counterPartyType:e,body:r,senderOrganizationId:p,recipientOrganizationId:h,sortNumber:u,createdAt:new Date,senderId:this.host.currentUserId,direction:_e.MessageDirection.OUTGOING,senderStatus:_e.MessageSenderStatus.SENDING,$synced:!1,serverId:null,metadata:g.metadata,priority:g.priority,dor:g.dor,ttl:g.ttl}),g.attachmentFiles&&this.__setLocalMessageAttachments(c,g.attachmentFiles),n.t0=e,n.next="group"===n.t0?29:"user"===n.t0?32:"distributionList"===n.t0?35:38;break;case 29:return c.groupId=t,c.recipientStatus=_e.MessageRecipientStatus.NA,n.abrupt("break",38);case 32:return c.recipientId=t,c.recipientStatus=_e.MessageRecipientStatus.NEW,n.abrupt("break",38);case 35:return c.distributionListId=t,c.recipientStatus=_e.MessageRecipientStatus.NA,n.abrupt("break",38);case 38:return this.host.models.Message.inject(c),this.host.emit("message:sending",c),n.next=42,this.host.api.messages.send({localId:c.id,counterPartyId:t,body:r,senderOrganizationId:p,recipientOrganizationId:h,attachment:(0,R["default"])(g.attachmentFiles),priority:"undefined"!=typeof g.priority?_e.MessagePriority.toServer(g.priority):void 0,metadata:g.metadata,ttl:g.ttl,dor:g.dor});case 42:return l=n.sent,(0,q["default"])(c,{serverId:l.serverId,ttl:l.ttl,senderStatus:_e.MessageSenderStatus.SENT,$synced:!0}),this.host.models.Message.inject(c),this.host.emit("message:sent",c),n.abrupt("return",c);case 47:case"end":return n.stop()}},n,this)}));return e}()},{key:"__sendToUnknownCounterParty",value:function(){function e(e,n,r){return t.apply(this,arguments)}var t=(0,ne["default"])(X["default"].mark(function n(e,t){var r,o,u,s,c,l,f=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],d=f.organizationId,p=f.senderOrganizationId,y=void 0===p?d:p,h=f.recipientOrganizationId,g=void 0===h?y:h,v=(0,L["default"])(f,["organizationId","senderOrganizationId","recipientOrganizationId"]);return X["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof e||e instanceof Object){n.next=2;break}throw new TypeError('Value of argument "counterPartyId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(e));case 2:if("string"==typeof t){n.next=4;break}throw new TypeError('Value of argument "body" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));case 4:if("string"==typeof e||e instanceof Object){n.next=6;break}throw new TypeError('Value of argument "counterPartyId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(e));case 6:if("string"==typeof t){n.next=8;break}throw new TypeError('Value of argument "body" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));case 8:return r=xe["default"].v4(),o=this.__getNextSortNumber(),y=this.__ensureOrganization(y),g=g||y,v=this.__normalizeSendOptions(v,y),n.next=15,this.host.api.messages.send({localId:r,counterPartyId:e,body:t,senderOrganizationId:y,recipientOrganizationId:g,attachment:(0,R["default"])(v.attachmentFiles),priority:"undefined"!=typeof v.priority?_e.MessagePriority.toServer(v.priority):void 0,metadata:v.metadata,ttl:v.ttl,dor:v.dor});case 15:return u=n.sent,n.next=18,this.__resolveRemoteCounterPartyEntity(e);case 18:return s=n.sent,c=this.host.conversations.ensureConversation(s.$entityType,s.serverId,y,{ensureEntities:{counterParty:"full",groupMembers:"full"}}),l=this.host.models.Message.inject({id:u.serverId,serverId:u.serverId,$synced:!0,conversationId:c.id,counterParty:s,messageType:_e.MessageType.USER_SENT,body:t,senderOrganizationId:y,recipientOrganizationId:g,sortNumber:o,createdAt:new Date,senderId:this.host.currentUserId,direction:_e.MessageDirection.OUTGOING,senderStatus:_e.MessageSenderStatus.SENT,recipientStatus:_e.MessageRecipientStatus.NEW,metadata:v.metadata,priority:v.priority,ttl:u.ttl,dor:v.dor}),v.attachmentFiles&&this.__setLocalMessageAttachments(l,v.attachmentFiles),this.host.emit("message:sending",l),this.host.emit("message:sent",l),n.abrupt("return",l);case 25:case"end":return n.stop()}},n,this)}));return e}()},{key:"__normalizeSendOptions",value:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],t=e.metadata,n=e.attachmentFiles,r=e.attachmentFile,o=e.priority,u=e.ttl,s=e.dor,c=arguments[1];if("string"!=typeof c)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(c));if("string"!=typeof c)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(c));return t&&(t=this.__normalizeMetadata(t)),n=this.__validateAttachments(n||r),"undefined"==typeof u&&(u=this.host.organizations.getSettingValue(c,"ttl")||-1),{metadata:t,attachmentFiles:n,priority:o,ttl:u,dor:s}}},{key:"__ensureOrganization",value:function(e){if(null!=e&&"string"!=typeof e)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\n?string\n\nGot:\n'+i(e));if(null!=e&&"string"!=typeof e)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\n?string\n\nGot:\n'+a(e));return e?e:this.host.config.defaultOrganizationId?this.host.config.defaultOrganizationId:void Oe["default"].raise("organizationId","required","Message is sent in the context of an organization. Provide `organizationId` or set a default one with client.setDefaultOrganization(...)")}},{key:"__validateAttachments",value:function(e){return e=(0,Le.arrayWrap)(e),!(0,S["default"])(e)&&e.length>1&&Oe["default"].raise("attachmentFiles","invalid","currently only a single attachment is supported"),e}},{key:"__normalizeMetadata",value:function(e){return e?(0,Le.arrayWrap)(e).map(function(e){return(0,ee["default"])({mimetype:"application/json"},e)}):null}},{key:"__getNextSortNumber",value:function(){var e,t=(e=(e=this.host.models.Message.getAll(),Ge["default"]).call(e,["sortNumber"],["desc"]),ze["default"]).call(e),n=t?t.sortNumber:0,r=n+1e-6;return r}},{key:"__setLocalMessageAttachments",value:function(e,t){if(!(e instanceof Object))throw new TypeError('Value of argument "message" violates contract.\n\nExpected:\nObject\n\nGot:\n'+i(e));if(!Array.isArray(t)||!t.every(function(e){return"string"==typeof e||e instanceof Object}))throw new TypeError('Value of argument "attachmentFiles" violates contract.\n\nExpected:\nArray<string | Object>\n\nGot:\n'+i(t));if(!(e instanceof Object))throw new TypeError('Value of argument "message" violates contract.\n\nExpected:\nObject\n\nGot:\n'+a(e));if(!Array.isArray(t)||!t.every(function(e){return"string"==typeof e||e instanceof Object}))throw new TypeError('Value of argument "attachmentFiles" violates contract.\n\nExpected:\nArray<string | Object>\n\nGot:\n'+a(t));e.attachments=t.map(this.__generateAttachmentDescriptor.bind(this))}},{key:"__generateAttachmentDescriptor",value:function(e){if(!("string"==typeof e||e instanceof Object))throw new TypeError('Value of argument "attachment" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(e));if(!("string"==typeof e||e instanceof Object))throw new TypeError('Value of argument "attachment" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(e));var t="local:"+xe["default"].v4();"string"==typeof e||e instanceof Buffer||Oe["default"].raise("attachment","invalid","attachment (string or Buffer) is invalid");var r=void 0,o=void 0,u=void 0,s=n(57),c=n(69),l=n(171),f=n(56);if("string"==typeof e)r=s.statSync(e).size,o=l.lookup(e),u=c.basename(e);else{var d=f(e);if(d){var p=d.ext,y=d.mime;u="attachment."+p,o=y}r=e.byteLength}var h={id:t,localPath:"string"==typeof e?e:null,localFile:e instanceof Buffer?e:null,name:u,size:r,contentType:o,isLocal:!0};return h}},{key:"sendToUser",value:function(e){if(!("string"==typeof e||e instanceof Object))throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(e));if(!("string"==typeof e||e instanceof Object))throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(e));for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;t>r;r++)n[r-1]=arguments[r];return this.send.apply(this,[e].concat(n))}},{key:"sendToGroup",value:function(e){if(!("string"==typeof e||e instanceof Object))throw new TypeError('Value of argument "groupId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(e));if(!("string"==typeof e||e instanceof Object))throw new TypeError('Value of argument "groupId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(e));for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;t>r;r++)n[r-1]=arguments[r];return this.send.apply(this,[e].concat(n))}},{key:"sendToConversation",value:function(e){if(!("string"==typeof e||e instanceof Object))throw new TypeError('Value of argument "conversationId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(e));if(!("string"==typeof e||e instanceof Object))throw new TypeError('Value of argument "conversationId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(e));for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;t>r;r++)n[r-1]=arguments[r];return this.send.apply(this,[e].concat(n))}},{key:"sendToDistributionList",value:function(e){if(!("string"==typeof e||e instanceof Object))throw new TypeError('Value of argument "distributionListId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(e));if(!("string"==typeof e||e instanceof Object))throw new TypeError('Value of argument "distributionListId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(e));for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;t>r;r++)n[r-1]=arguments[r];return this.send.apply(this,[e].concat(n))}},{key:"sendToNewGroup",value:function(e){if(!(Array.isArray(e)&&e.every(function(e){return"string"==typeof e})||Array.isArray(e)&&e.every(function(e){return e instanceof Object})))throw new TypeError('Value of argument "userIds" violates contract.\n\nExpected:\nstring[] | Object[]\n\nGot:\n'+i(e));if(!(Array.isArray(e)&&e.every(function(e){return"string"==typeof e})||Array.isArray(e)&&e.every(function(e){return e instanceof Object})))throw new TypeError('Value of argument "userIds" violates contract.\n\nExpected:\nstring[] | Object[]\n\nGot:\n'+a(e));for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;t>r;r++)n[r-1]=arguments[r];return this.send.apply(this,[e].concat(n))}},{key:"__sendToGroupOfUsers",value:function(){function e(e,n,r){return t.apply(this,arguments)}var t=(0,ne["default"])(X["default"].mark(function n(e,t){var r,o=this,u=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],s=u.organizationId,c=u.preferExistingGroup,l=void 0===c?!1:c,f=u.groupName,d=u.groupMetadata,p=(0,L["default"])(u,["organizationId","preferExistingGroup","groupName","groupMetadata"]);return X["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(Array.isArray(e)&&e.every(function(e){return"string"==typeof e})||Array.isArray(e)&&e.every(function(e){return e instanceof Object})){n.next=2;break}throw new TypeError('Value of argument "userIds" violates contract.\n\nExpected:\nstring[] | Object[]\n\nGot:\n'+i(e));case 2:if("string"==typeof t){n.next=4;break}throw new TypeError('Value of argument "body" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));
case 4:if(Array.isArray(e)&&e.every(function(e){return"string"==typeof e})||Array.isArray(e)&&e.every(function(e){return e instanceof Object})){n.next=6;break}throw new TypeError('Value of argument "userIds" violates contract.\n\nExpected:\nstring[] | Object[]\n\nGot:\n'+a(e));case 6:if("string"==typeof t){n.next=8;break}throw new TypeError('Value of argument "body" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));case 8:if(e=e.map(function(e){return o._resolveModelIdWithTypes(e,"user")}),0==e.length&&Oe["default"].raise("userIds","required"),r=void 0,!l){n.next=15;break}throw new Error("not implemented");case 15:return n.next=17,this.__prepareGroupForUsers(s,e,f,{groupMetadata:d});case 17:r=n.sent;case 18:return n.abrupt("return",this.sendToGroup(r,t,(0,ee["default"])({organizationId:s},p)));case 19:case"end":return n.stop()}},n,this)}));return e}()},{key:"__prepareGroupForUsers",value:function(){function e(e,n,r,o){return t.apply(this,arguments)}var t=(0,ne["default"])(X["default"].mark(function n(e,t,r){var o,a,i=this,u=arguments.length<=3||void 0===arguments[3]?{}:arguments[3],s=u.groupMetadata;return X["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return o=[this.host.currentUser].concat(t.map(function(e){return i.host.models.User.get(e)}).filter(Boolean)),r||(r=o.map(function(e){return e.displayName}).filter(Boolean).join(", ")||"Group"),n.next=4,this.host.groups.create({organizationId:e,name:r,replayHistory:!0,memberIds:t,metadata:s});case 4:return a=n.sent,n.abrupt("return",a);case 6:case"end":return n.stop()}},n,this)}));return e}()},{key:"onMessageRecalled",value:function(e){if(!("string"==typeof e||e instanceof Object))throw new TypeError('Value of argument "messageServerId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(e));if(!("string"==typeof e||e instanceof Object))throw new TypeError('Value of argument "messageServerId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(e));this.host.requireUser();var t=this._getMessageByServerId(e);t&&this._deleteLocalMessage(t)}},{key:"_deleteLocalMessage",value:function(e){if(!(e instanceof Object))throw new TypeError('Value of argument "message" violates contract.\n\nExpected:\nObject\n\nGot:\n'+i(e));if(!(e instanceof Object))throw new TypeError('Value of argument "message" violates contract.\n\nExpected:\nObject\n\nGot:\n'+a(e));this.host.models.Message.eject(e)}},{key:"recall",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,ne["default"])(X["default"].mark(function n(e){var t,r;return X["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof e||e instanceof Object||Array.isArray(e)&&e.every(function(e){return"string"==typeof e})||Array.isArray(e)&&e.every(function(e){return e instanceof Object})){n.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object | string[] | Object[]\n\nGot:\n'+i(e));case 2:if("string"==typeof e||e instanceof Object||Array.isArray(e)&&e.every(function(e){return"string"==typeof e})||Array.isArray(e)&&e.every(function(e){return e instanceof Object})){n.next=4;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object | string[] | Object[]\n\nGot:\n'+a(e));case 4:return this.host.requireUser(),t=(0,Le.arrayWrap)(e),r=t.map(this.__recallSingle.bind(this)),n.next=9,V["default"].all(r);case 9:case"end":return n.stop()}},n,this)}));return e}()},{key:"__recallSingle",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,ne["default"])(X["default"].mark(function n(e){var t;return X["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof e||e instanceof Object){n.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(e));case 2:if("string"==typeof e||e instanceof Object){n.next=4;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(e));case 4:if(t=this._resolveMessage(e),!t){n.next=17;break}if(t.senderId==this.host.currentUserId){n.next=8;break}throw new je["default"].PermissionDeniedError(t,t.serverId,"recall");case 8:if(t.$synced!==!1){n.next=12;break}this._deleteLocalMessage(t),n.next=15;break;case 12:return n.next=14,this.host.api.messages.destroy(t.serverId);case 14:this._deleteLocalMessage(t);case 15:n.next=19;break;case 17:return n.next=19,this.host.api.messages.destroy(e);case 19:case"end":return n.stop()}},n,this)}));return e}()},{key:"forward",value:function(){function e(e,n,r){return t.apply(this,arguments)}var t=(0,ne["default"])(X["default"].mark(function n(e,t){var r,o,u,s,c,l,f,d=this,p=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],y=p.organizationId,h=p.senderOrganizationId,g=void 0===h?y:h,v=p.recipientOrganizationId,m=void 0===v?g:v,b=p.priority,w=p.retrieveMessage,E=void 0===w?!1:w,x=(p.preferExistingGroup,p.groupName),_=p.groupMetadata;return X["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof e||e instanceof Object){n.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(e));case 2:if("string"==typeof t||t instanceof Object||Array.isArray(t)&&t.every(function(e){return"string"==typeof e})||Array.isArray(t)&&t.every(function(e){return e instanceof Object})){n.next=4;break}throw new TypeError('Value of argument "entityId" violates contract.\n\nExpected:\nstring | Object | string[] | Object[]\n\nGot:\n'+i(t));case 4:if("string"==typeof e||e instanceof Object){n.next=6;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(e));case 6:if("string"==typeof t||t instanceof Object||Array.isArray(t)&&t.every(function(e){return"string"==typeof e})||Array.isArray(t)&&t.every(function(e){return e instanceof Object})){n.next=8;break}throw new TypeError('Value of argument "entityId" violates contract.\n\nExpected:\nstring | Object | string[] | Object[]\n\nGot:\n'+a(t));case 8:if(this.host.requireUser(),r=this._resolveMessage(e),!Array.isArray(t)){n.next=16;break}return o=t.map(function(e){return d._resolveModelIdWithTypes(e,"user")}),n.next=14,this.__prepareGroupForUsers(y,o,x,{groupMetadata:_});case 14:u=n.sent,t=u.id;case 16:if(r){n.next=18;break}throw new je["default"].NotFoundError(this.host.models.Message.name,e);case 18:return n.next=20,this.__resolveCounterPartyEntityAndOrganizationId(t,!0);case 20:return s=n.sent,c=s.counterParty,l=s.organizationId,l&&(g=m=l),c&&(t=c.serverId),Oe["default"].notEmpty("entityId",t,"entityId not found"),n.next=28,this.host.api.messages.forward(r.serverId,t,{localId:xe["default"].v4(),senderOrganizationId:g,recipientOrganizationId:m,priority:"undefined"!=typeof b?_e.MessagePriority.toServer(b):void 0});case 28:if(f=n.sent,!E){n.next=31;break}return n.abrupt("return",this.find(f.serverId));case 31:return n.abrupt("return",null);case 32:case"end":return n.stop()}},n,this)}));return e}()},{key:"reactToMessageStatusEvent",value:function(e){if(!(e instanceof Object))throw new TypeError('Value of argument "event" violates contract.\n\nExpected:\nObject\n\nGot:\n'+i(e));if(!(e instanceof Object))throw new TypeError('Value of argument "event" violates contract.\n\nExpected:\nObject\n\nGot:\n'+a(e));var t=e.data.client_id,n=e.data.is_recalled;n?this.onMessageRecalled(t):this.__setMessageStatusPerRecipientFromServerData(t,(0,M["default"])(e.data,["status","account_id","timestamp"]))&&this.__touchMessage(t)}},{key:"__setMessageStatusPerRecipientFromServerData",value:function(e,t){if("string"!=typeof e)throw new TypeError('Value of argument "messageServerId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));if(!(t instanceof Object))throw new TypeError('Value of argument "data" violates contract.\n\nExpected:\nObject\n\nGot:\n'+i(t));if("string"!=typeof e)throw new TypeError('Value of argument "messageServerId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));if(!(t instanceof Object))throw new TypeError('Value of argument "data" violates contract.\n\nExpected:\nObject\n\nGot:\n'+a(t));var n=_e.MessageRecipientStatus.resolve(t.status),r=t.account_id,o=t.timestamp;return this.setRecipientMessageStatus(e,r,n,o)}},{key:"setRecipientMessageStatus",value:function(e,t,n,r){if(!("string"==typeof e||e instanceof Object))throw new TypeError('Value of argument "messageServerId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(e));if("string"!=typeof t)throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));if("string"!=typeof n)throw new TypeError('Value of argument "recipientStatus" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(n));if(!(null==r||"string"==typeof r||null==r||r instanceof Date))throw new TypeError('Value of argument "createdAt" violates contract.\n\nExpected:\n?string | ?Date\n\nGot:\n'+i(r));if(!("string"==typeof e||e instanceof Object))throw new TypeError('Value of argument "messageServerId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(e));if("string"!=typeof t)throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));if("string"!=typeof n)throw new TypeError('Value of argument "recipientStatus" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(n));if(!(null==r||"string"==typeof r||null==r||r instanceof Date))throw new TypeError('Value of argument "createdAt" violates contract.\n\nExpected:\n?string | ?Date\n\nGot:\n'+a(r));var o=this._getMessageByServerId(e);if(o){n=_e.MessageRecipientStatus.resolve(n),this._setSingleUserMessageRecipientMessageStatus(o,n);var u=(0,T["default"])(o.statusesPerRecipient,{userId:t});if(!u||this.__canChangeRecipientStatus(u.status,n)){var s=o.id+":"+t;return this.host.models.MessageStatusPerRecipient.inject({id:s,messageId:o.id,userId:t,status:n,createdAt:r})}}}},{key:"__touchMessage",value:function(e){if(!("string"==typeof e||e instanceof Object))throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(e));if(!("string"==typeof e||e instanceof Object))throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(e));var t=this._resolveMessage(e);this.host.models.Message.touch(t)}},{key:"_resolveMessage",value:function(e){if(!("string"==typeof e||e instanceof Object))throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(e));if(!("string"==typeof e||e instanceof Object))throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(e));return this.host.models.Message.is(e)?e:this.host.models.Message.get(e)||this._getMessageByServerId(e)}},{key:"_getMessageByServerId",value:function(e){var t;if(!("string"==typeof e||e instanceof Object))throw new TypeError('Value of argument "serverId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(e));if(!("string"==typeof e||e instanceof Object))throw new TypeError('Value of argument "serverId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(e));return this.host.models.Message.is(e)?e:(t=this.host.models.Message.getAll(),Ce["default"]).call(t,{serverId:e})}},{key:"_setSingleUserMessageRecipientMessageStatus",value:function(e,t){if(!(e instanceof Object))throw new TypeError('Value of argument "message" violates contract.\n\nExpected:\nObject\n\nGot:\n'+i(e));if("string"!=typeof t)throw new TypeError('Value of argument "recipientStatus" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));if(!(e instanceof Object))throw new TypeError('Value of argument "message" violates contract.\n\nExpected:\nObject\n\nGot:\n'+a(e));if("string"!=typeof t)throw new TypeError('Value of argument "recipientStatus" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));this.__canChangeRecipientStatus(e.recipientStatus,t)&&this.host.models.Message.inject({id:e.id,recipientStatus:t})}},{key:"__canChangeRecipientStatus",value:function(e,t){if("string"!=typeof e)throw new TypeError('Value of argument "fromStatus" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));if("string"!=typeof t)throw new TypeError('Value of argument "toStatus" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));if("string"!=typeof e)throw new TypeError('Value of argument "fromStatus" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));if("string"!=typeof t)throw new TypeError('Value of argument "toStatus" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));return e===t?!1:e!==_e.MessageRecipientStatus.READ||t!=_e.MessageRecipientStatus.DELIVERED}},{key:"find",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,ne["default"])(X["default"].mark(function n(e){var t,r,o,u,s;return X["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof e){n.next=2;break}throw new TypeError('Value of argument "serverId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));case 2:if("string"==typeof e){n.next=4;break}throw new TypeError('Value of argument "serverId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));case 4:return this.host.requireUser(),n.next=7,this.httpClient.get("/message/:id",{urlParams:{id:e}});case 7:return t=n.sent,r=t.data,o=t.data.recipient_token,n.next=12,this.__lookupCounterParty(o);case 12:if(u=n.sent,!u){n.next=17;break}r.counterParty=u,n.next=18;break;case 17:return n.abrupt("return",null);case 18:return s=this.host.models.Message.inject(r),n.next=21,this.findStatusesPerRecipient(s);case 21:return n.abrupt("return",s);case 22:case"end":return n.stop()}},n,this)}));return e}()},{key:"getById",value:function(e){if("string"!=typeof e)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));if("string"!=typeof e)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));return this.host.models.Message.get(e)}},{key:"getMultiById",value:function(e){if(!Array.isArray(e)||!e.every(function(e){return"string"==typeof e}))throw new TypeError('Value of argument "ids" violates contract.\n\nExpected:\nArray<string>\n\nGot:\n'+i(e));if(!Array.isArray(e)||!e.every(function(e){return"string"==typeof e}))throw new TypeError('Value of argument "ids" violates contract.\n\nExpected:\nArray<string>\n\nGot:\n'+a(e));return this.host.models.Message.getMulti(e)}},{key:"__lookupCounterParty",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,ne["default"])(X["default"].mark(function n(e){var t,r,o,u,s,c,l,f,d,p,y,h,g,v,m,b;return X["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof e){n.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));case 2:if("string"==typeof e){n.next=4;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));case 4:if(r=[{model:this.host.models.User,finder:(t=this.host.users).find.bind(t)},{model:this.host.models.Group,finder:(t=this.host.groups).find.bind(t)}],r&&("function"==typeof r[K["default"]]||Array.isArray(r))){n.next=7;break}throw new TypeError("Expected counterPartyTypesAndFinders to be iterable, got "+a(r));case 7:if(r&&("function"==typeof r[K["default"]]||Array.isArray(r))){n.next=9;break}throw new TypeError("Expected counterPartyTypesAndFinders to be iterable, got "+i(r));case 9:o=!0,u=!1,s=void 0,n.prev=12,c=(0,D["default"])(r);case 14:if(o=(l=c.next()).done){n.next=22;break}if(f=l.value.model,d=f.get(e),!d){n.next=19;break}return n.abrupt("return",d);case 19:o=!0,n.next=14;break;case 22:n.next=28;break;case 24:n.prev=24,n.t0=n["catch"](12),u=!0,s=n.t0;case 28:n.prev=28,n.prev=29,!o&&c["return"]&&c["return"]();case 31:if(n.prev=31,!u){n.next=34;break}throw s;case 34:return n.finish(31);case 35:return n.finish(28);case 36:if(r&&("function"==typeof r[K["default"]]||Array.isArray(r))){n.next=38;break}throw new TypeError("Expected counterPartyTypesAndFinders to be iterable, got "+a(r));case 38:if(r&&("function"==typeof r[K["default"]]||Array.isArray(r))){n.next=40;break}throw new TypeError("Expected counterPartyTypesAndFinders to be iterable, got "+i(r));case 40:p=!0,y=!1,h=void 0,n.prev=43,g=(0,D["default"])(r);case 45:if(p=(v=g.next()).done){n.next=62;break}return m=v.value.finder,n.prev=47,n.next=50,m(e);case 50:if(b=n.sent,!b){n.next=53;break}return n.abrupt("return",b);case 53:n.next=59;break;case 55:if(n.prev=55,n.t1=n["catch"](47),n.t1.code==je["default"].NotFoundError.CODE){n.next=59;break}throw n.t1;case 59:p=!0,n.next=45;break;case 62:n.next=68;break;case 64:n.prev=64,n.t2=n["catch"](43),y=!0,h=n.t2;case 68:n.prev=68,n.prev=69,!p&&g["return"]&&g["return"]();case 71:if(n.prev=71,!y){n.next=74;break}throw h;case 74:return n.finish(71);case 75:return n.finish(68);case 76:return n.abrupt("return",null);case 77:case"end":return n.stop()}},n,this,[[12,24,28,36],[29,,31,35],[43,64,68,76],[47,55],[69,,71,75]])}));return e}()},{key:"downloadAttachmentURL",value:function(e,t){if(!("string"==typeof e||e instanceof Object))throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(e));if("string"!=typeof t&&"number"!=typeof t)throw new TypeError('Value of argument "attachmentId" violates contract.\n\nExpected:\nstring | number\n\nGot:\n'+i(t));if(!("string"==typeof e||e instanceof Object))throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(e));if("string"!=typeof t&&"number"!=typeof t)throw new TypeError('Value of argument "attachmentId" violates contract.\n\nExpected:\nstring | number\n\nGot:\n'+a(t));throw new Error("method not supported in target node")}},{key:"downloadAttachmentBlobAndURL",value:function(){function e(e,n){return t.apply(this,arguments)}var t=(0,ne["default"])(X["default"].mark(function n(e,t){return X["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof e||e instanceof Object){n.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(e));case 2:if("string"==typeof t||"number"==typeof t){n.next=4;break}throw new TypeError('Value of argument "attachmentId" violates contract.\n\nExpected:\nstring | number\n\nGot:\n'+i(t));case 4:if("string"==typeof e||e instanceof Object){n.next=6;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(e));case 6:if("string"==typeof t||"number"==typeof t){n.next=8;break}throw new TypeError('Value of argument "attachmentId" violates contract.\n\nExpected:\nstring | number\n\nGot:\n'+a(t));case 8:n.next=14;break;case 14:throw new Error("method not supported in target node");case 15:case"end":return n.stop()}},n,this)}));return e}()},{key:"downloadAttachmentToFile",value:function(){function e(e,n,r){return t.apply(this,arguments)}var t=(0,ne["default"])(X["default"].mark(function n(e,t,r){var o;return X["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof e||e instanceof Object){n.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(e));case 2:if("string"==typeof t||"number"==typeof t){n.next=4;break}throw new TypeError('Value of argument "attachmentId" violates contract.\n\nExpected:\nstring | number\n\nGot:\n'+i(t));case 4:if("string"==typeof r){n.next=6;break}throw new TypeError('Value of argument "dest" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(r));case 6:if("string"==typeof e||e instanceof Object){n.next=8;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(e));case 8:if("string"==typeof t||"number"==typeof t){n.next=10;break}throw new TypeError('Value of argument "attachmentId" violates contract.\n\nExpected:\nstring | number\n\nGot:\n'+a(t));case 10:if("string"==typeof r){n.next=12;break}throw new TypeError('Value of argument "dest" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(r));case 12:return o=this._resolveMessage(e),t=t.toString(),n.abrupt("return",this.httpClient.downloadToFile("/message/"+o.serverId+"/attachment/"+t,r));case 18:throw new Error("method not supported in target node");case 19:case"end":return n.stop()}},n,this)}));return e}()},{key:"destroy",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,ne["default"])(X["default"].mark(function n(e){return X["default"].wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if("string"==typeof e){t.next=2;break}throw new TypeError('Value of argument "serverId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));case 2:if("string"==typeof e){t.next=4;break}throw new TypeError('Value of argument "serverId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));case 4:return this.host.requireUser(),t.next=7,this.httpClient["delete"]("/message/:id",{urlParams:{id:e}});case 7:return t.abrupt("return",null);case 8:case"end":return t.stop()}},n,this)}));return e}()},{key:"getMessageCount",value:function(){return this.host.models.Message.getAll().length}},{key:"getTotalUnreadCount",value:function(){return(0,I["default"])(this.host.models.Conversation.getAll(),"unreadCount")}},{key:"markAsRead",value:function(){function e(e,n){return t.apply(this,arguments)}var t=(0,ne["default"])(X["default"].mark(function n(e){var t,r=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],o=r.queue,u=void 0===o?this.host.currentlyServingOfflineMessages:o;return X["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof e||e instanceof Object||Array.isArray(e)&&e.every(function(e){return"string"==typeof e||e instanceof Object})){n.next=2;break}throw new TypeError('Value of argument "ids" violates contract.\n\nExpected:\nstring | Object | Array<string | Object>\n\nGot:\n'+i(e));case 2:if("string"==typeof e||e instanceof Object||Array.isArray(e)&&e.every(function(e){return"string"==typeof e||e instanceof Object})){n.next=4;break}throw new TypeError('Value of argument "ids" violates contract.\n\nExpected:\nstring | Object | Array<string | Object>\n\nGot:\n'+a(e));case 4:if(e=(t=(t=(t=e,Le.arrayWrapBound).call(t),Ue["default"]).call(t,this._resolveModelId.bind(this)),$e["default"]).call(t),0!==e.length){n.next=7;break}return n.abrupt("return");case 7:if(!u){n.next=11;break}return n.abrupt("return",this.__queueMessageStatuses({readIds:e}));case 11:return n.abrupt("return",this.__setMessagesStatus({readIds:e}));case 12:case"end":return n.stop()}},n,this)}));return e}()},{key:"markAsDelivered",value:function(){function e(e,n){return t.apply(this,arguments)}var t=(0,ne["default"])(X["default"].mark(function n(e){var t,r=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],o=r.queue,u=void 0===o?this.host.currentlyServingOfflineMessages:o;return X["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof e||e instanceof Object||Array.isArray(e)&&e.every(function(e){return"string"==typeof e||e instanceof Object})){n.next=2;break}throw new TypeError('Value of argument "ids" violates contract.\n\nExpected:\nstring | Object | Array<string | Object>\n\nGot:\n'+i(e));case 2:if("string"==typeof e||e instanceof Object||Array.isArray(e)&&e.every(function(e){return"string"==typeof e||e instanceof Object})){n.next=4;break}throw new TypeError('Value of argument "ids" violates contract.\n\nExpected:\nstring | Object | Array<string | Object>\n\nGot:\n'+a(e));case 4:if(e=(t=(t=(t=e,Le.arrayWrapBound).call(t),Ue["default"]).call(t,this._resolveModelId.bind(this)),$e["default"]).call(t),0!==e.length){n.next=7;break}return n.abrupt("return");case 7:if(!u){n.next=11;break}return n.abrupt("return",this.__queueMessageStatuses({deliveredIds:e}));case 11:return n.abrupt("return",this.__setMessagesStatus({deliveredIds:e}));case 12:case"end":return n.stop()}},n,this)}));return e}()},{key:"markAsReceived",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,ne["default"])(X["default"].mark(function n(){var e=arguments;return X["default"].wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.markAsDelivered.apply(this,e));case 1:case"end":return t.stop()}},n,this)}));return e}()},{key:"__queueMessageStatuses",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,ne["default"])(X["default"].mark(function n(e){var t,r=e.deliveredIds,o=e.readIds,u=arguments;return X["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=u[0]&&(null==u[0].deliveredIds||Array.isArray(u[0].deliveredIds)&&u[0].deliveredIds.every(function(e){return"string"==typeof e}))&&(null==u[0].readIds||Array.isArray(u[0].readIds)&&u[0].readIds.every(function(e){return"string"==typeof e}))){e.next=2;break}throw new TypeError("Value of argument 0 violates contract.\n\nExpected:\n{ deliveredIds: ?Array<string>;\n  readIds: ?Array<string>;\n}\n\nGot:\n"+i(u[0]));case 2:if(null!=u[0]&&(null==u[0].deliveredIds||Array.isArray(u[0].deliveredIds)&&u[0].deliveredIds.every(function(e){return"string"==typeof e}))&&(null==u[0].readIds||Array.isArray(u[0].readIds)&&u[0].readIds.every(function(e){return"string"==typeof e}))){e.next=4;break}throw new TypeError("Value of argument 0 violates contract.\n\nExpected:\n{ deliveredIds: ?Array<string>;\n  readIds: ?Array<string>;\n}\n\nGot:\n"+a(u[0]));case 4:if(r&&(this._queuedMessageStatuses.deliveredIds=(0,k["default"])(this._queuedMessageStatuses.deliveredIds,r)),o&&(this._queuedMessageStatuses.readIds=(0,k["default"])(this._queuedMessageStatuses.readIds,o)),t=this._queuedMessageStatuses.deliveredIds.length+this._queuedMessageStatuses.readIds.length,!(t>=this.config.flushMessageMaxCount)){e.next=12;break}return this.logger.log("reached "+this.config.flushMessageMaxCount+" -- flushing"),e.abrupt("return",this.__flushQueueMessageStatuses());case 12:this._throtelled_flushQueueMessageStatuses();case 13:case"end":return e.stop()}},n,this)}));return e}()},{key:"__flushQueueMessageStatuses",value:function(){var e=this._queuedMessageStatuses.deliveredIds.length+this._queuedMessageStatuses.readIds.length;e>0&&(this.__setMessagesStatus(this._queuedMessageStatuses),this._queuedMessageStatuses.deliveredIds=[],this._queuedMessageStatuses.readIds=[])}},{key:"__setMessagesStatus",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,ne["default"])(X["default"].mark(function n(e){var t,r,o,a,i=this,u=e.deliveredIds,s=void 0===u?[]:u,c=e.readIds,l=void 0===c?[]:c;return X["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.host.requireUser(),s=(t=(t=s,Ue["default"]).call(t,this._resolveModelId.bind(this)),$e["default"]).call(t),l=(t=(t=l,Ue["default"]).call(t,this._resolveModelId.bind(this)),$e["default"]).call(t),r=s.map(this._resolveMessage).filter(Boolean),o=l.map(this._resolveMessage).filter(Boolean),l=(0,x["default"])(l,(t=Ne["default"].call(o,function(e){return e.recipientStatus===_e.MessageRecipientStatus.READ}),Ue["default"]).call(t,"id")),s=(0,x["default"])(s,l,(t=Ne["default"].call(r,function(e){return e.recipientStatus===_e.MessageRecipientStatus.DELIVERED||e.recipientStatus===_e.MessageRecipientStatus.READ}),Ue["default"]).call(t,"id")),a={},s.length&&(a.delivered=s),l.length&&(a.read=l,o.forEach(function(e){return i.host.models.Message.inject({id:e.id,recipientStatus:_e.MessageRecipientStatus.READ,recipientStatusMarkingAsRead:!0})})),!(0,S["default"])(a.delivered)||!(0,S["default"])(a.read)){e.next=12;break}return e.abrupt("return",!1);case 12:return e.next=14,this.httpClient.post("/message/status",{data:a});case 14:l.length&&(a.read=l,o.forEach(function(e){return i.host.models.Message.inject({id:e.id,recipientStatus:_e.MessageRecipientStatus.READ,recipientStatusMarkingAsRead:!1})}),this.__checkForDeleteOnReadMessages(o)),s.length&&r.forEach(function(e){return i.host.models.Message.inject({id:e.id,recipientStatus:_e.MessageRecipientStatus.DELIVERED})});case 16:case"end":return e.stop()}},n,this)}));return e}()},{key:"__checkForDeleteOnReadMessages",value:function(e){var t=this;if(!Array.isArray(e)||!e.every(function(e){return e instanceof Object}))throw new TypeError('Value of argument "messages" violates contract.\n\nExpected:\nObject[]\n\nGot:\n'+i(e));if(!Array.isArray(e)||!e.every(function(e){return e instanceof Object}))throw new TypeError('Value of argument "messages" violates contract.\n\nExpected:\nObject[]\n\nGot:\n'+a(e));Ne["default"].call(e,{dor:!0}).forEach(function(e){return t.setMessageTTLInMinutes(e,1)})}},{key:"setMessageTTLInMinutes",value:function(e,t){if(!("string"==typeof e||e instanceof Object))throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(e));if("number"!=typeof t)throw new TypeError('Value of argument "ttl" violates contract.\n\nExpected:\nnumber\n\nGot:\n'+i(t));if(!("string"==typeof e||e instanceof Object))throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(e));if("number"!=typeof t)throw new TypeError('Value of argument "ttl" violates contract.\n\nExpected:\nnumber\n\nGot:\n'+a(t));var n=this._resolveMessage(e);if(n){var r=(0,me["default"])().add(1,"minute").toDate().getTime();this.host.models.Message.inject({id:n.id,ttl:t,expiresAt:r})}}},{key:"deleteExpiredMessages",value:function(){var e=this,t=arguments.length<=0||void 0===arguments[0]?Date.now():arguments[0];t.getTime&&(t=t.getTime()),this.host.models.Message.getAll().filter(function(e){return e.expiresAt&&e.expiresAt<t}).forEach(function(t){return e.host.models.Message.eject(t)})}},{key:"findStatusesPerRecipient",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,ne["default"])(X["default"].mark(function n(e){var t,r,o,u,s=this;return X["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof e||e instanceof Object){n.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(e));case 2:if("string"==typeof e||e instanceof Object){n.next=4;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(e));case 4:if(this.host.requireUser(),t=this._resolveMessage(e)){n.next=8;break}return n.abrupt("return",null);case 8:return n.next=10,this.httpClient.get("/message/:id/status",{urlParams:{id:t.serverId}});case 10:if(r=n.sent,o=r.data,!o.is_recalled){n.next=15;break}return this.onMessageRecalled(t.serverId),n.abrupt("return");case 15:return u=o.statuses.map(function(e){return s.__setMessageStatusPerRecipientFromServerData(t.serverId,e)}).some(function(e){return e}),u&&this.__touchMessage(t),n.abrupt("return",t.statusesPerRecipient);case 18:case"end":return n.stop()}},n,this)}));return e}()}]),t}(ge["default"]),o(y.prototype,"__resolveCounterPartyEntityAndOrganizationId",[we.privateMethod],(0,w["default"])(y.prototype,"__resolveCounterPartyEntityAndOrganizationId"),y.prototype),o(y.prototype,"__resolveRemoteCounterPartyEntity",[we.privateMethod],(0,w["default"])(y.prototype,"__resolveRemoteCounterPartyEntity"),y.prototype),o(y.prototype,"__sendToKnownCounterParty",[we.privateMethod],(0,w["default"])(y.prototype,"__sendToKnownCounterParty"),y.prototype),o(y.prototype,"__sendToUnknownCounterParty",[we.privateMethod],(0,w["default"])(y.prototype,"__sendToUnknownCounterParty"),y.prototype),o(y.prototype,"__normalizeSendOptions",[we.privateMethod],(0,w["default"])(y.prototype,"__normalizeSendOptions"),y.prototype),o(y.prototype,"__ensureOrganization",[we.privateMethod],(0,w["default"])(y.prototype,"__ensureOrganization"),y.prototype),o(y.prototype,"__validateAttachments",[we.privateMethod],(0,w["default"])(y.prototype,"__validateAttachments"),y.prototype),o(y.prototype,"__normalizeMetadata",[we.privateMethod],(0,w["default"])(y.prototype,"__normalizeMetadata"),y.prototype),
o(y.prototype,"__getNextSortNumber",[we.privateMethod],(0,w["default"])(y.prototype,"__getNextSortNumber"),y.prototype),o(y.prototype,"__setLocalMessageAttachments",[we.privateMethod],(0,w["default"])(y.prototype,"__setLocalMessageAttachments"),y.prototype),o(y.prototype,"__generateAttachmentDescriptor",[we.privateMethod],(0,w["default"])(y.prototype,"__generateAttachmentDescriptor"),y.prototype),o(y.prototype,"__prepareGroupForUsers",[we.privateMethod,u],(0,w["default"])(y.prototype,"__prepareGroupForUsers"),y.prototype),o(y.prototype,"_deleteLocalMessage",[we.privateMethod],(0,w["default"])(y.prototype,"_deleteLocalMessage"),y.prototype),o(y.prototype,"__recallSingle",[we.privateMethod],(0,w["default"])(y.prototype,"__recallSingle"),y.prototype),o(y.prototype,"__setMessageStatusPerRecipientFromServerData",[we.privateMethod],(0,w["default"])(y.prototype,"__setMessageStatusPerRecipientFromServerData"),y.prototype),o(y.prototype,"__touchMessage",[we.privateMethod],(0,w["default"])(y.prototype,"__touchMessage"),y.prototype),o(y.prototype,"_resolveMessage",[we.privateMethod,Ae["default"]],(0,w["default"])(y.prototype,"_resolveMessage"),y.prototype),o(y.prototype,"_getMessageByServerId",[we.privateMethod],(0,w["default"])(y.prototype,"_getMessageByServerId"),y.prototype),o(y.prototype,"_setSingleUserMessageRecipientMessageStatus",[we.privateMethod],(0,w["default"])(y.prototype,"_setSingleUserMessageRecipientMessageStatus"),y.prototype),o(y.prototype,"__canChangeRecipientStatus",[we.privateMethod],(0,w["default"])(y.prototype,"__canChangeRecipientStatus"),y.prototype),o(y.prototype,"find",[s],(0,w["default"])(y.prototype,"find"),y.prototype),o(y.prototype,"__lookupCounterParty",[we.privateMethod],(0,w["default"])(y.prototype,"__lookupCounterParty"),y.prototype),o(y.prototype,"downloadAttachmentURL",[c],(0,w["default"])(y.prototype,"downloadAttachmentURL"),y.prototype),o(y.prototype,"downloadAttachmentBlobAndURL",[l],(0,w["default"])(y.prototype,"downloadAttachmentBlobAndURL"),y.prototype),o(y.prototype,"destroy",[f],(0,w["default"])(y.prototype,"destroy"),y.prototype),o(y.prototype,"__queueMessageStatuses",[we.privateMethod],(0,w["default"])(y.prototype,"__queueMessageStatuses"),y.prototype),o(y.prototype,"__flushQueueMessageStatuses",[we.privateMethod,Ae["default"]],(0,w["default"])(y.prototype,"__flushQueueMessageStatuses"),y.prototype),o(y.prototype,"__setMessagesStatus",[we.privateMethod],(0,w["default"])(y.prototype,"__setMessagesStatus"),y.prototype),o(y.prototype,"__checkForDeleteOnReadMessages",[we.privateMethod],(0,w["default"])(y.prototype,"__checkForDeleteOnReadMessages"),y.prototype),o(y.prototype,"deleteExpiredMessages",[Ae["default"]],(0,w["default"])(y.prototype,"deleteExpiredMessages"),y.prototype),o(y.prototype,"findStatusesPerRecipient",[d],(0,w["default"])(y.prototype,"findStatusesPerRecipient"),y.prototype),p=y))||p);t["default"]=De,e.exports=t["default"]},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t,n,r,o){var a={};return Object.keys(r).forEach(function(e){a[e]=r[e]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},a),o&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(o):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}function a(e,t){var n=4,r=15;if(void 0===t&&(t=0),t+=1,null===e)return"null";if(void 0===e)return"void";if("string"==typeof e||"number"==typeof e||"boolean"==typeof e)return"undefined"==typeof e?"undefined":(0,g["default"])(e);if(!Array.isArray(e)){var o=(0,L["default"])(e);if(!o.length)return e.constructor&&e.constructor.name&&"Object"!==e.constructor.name?e.constructor.name:"Object";if(t>n)return"{...}";var i="  ".repeat(t-1),u=o.slice(0,r).map(function(n){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(n)?n:(0,y["default"])(n))+": "+a(e[n],t)+";"}).join("\n  "+i);return o.length>=r&&(u+="\n  "+i+"..."),e.constructor&&e.constructor.name&&"Object"!==e.constructor.name?e.constructor.name+" {\n  "+i+u+"\n"+i+"}":"{\n  "+i+u+"\n"+i+"}"}if(!(e.length>0))return"Array";var s=function(){if(t>n)return{v:"[...]"};var o=a(e[0],t);return e.every(function(e){return a(e,t)===o})?{v:o.trim()+"[]"}:{v:"["+e.slice(0,r).map(function(e){return a(e,t)}).join(", ")+(e.length>=r?", ...":"")+"]"}}();return"object"===("undefined"==typeof s?"undefined":(0,g["default"])(s))?s.v:void 0}function i(e,t){var n=4,r=15;if(void 0===t&&(t=0),t+=1,null===e)return"null";if(void 0===e)return"void";if("string"==typeof e||"number"==typeof e||"boolean"==typeof e)return"undefined"==typeof e?"undefined":(0,g["default"])(e);if(!Array.isArray(e)){var o=(0,L["default"])(e);if(!o.length)return e.constructor&&e.constructor.name&&"Object"!==e.constructor.name?e.constructor.name:"Object";if(t>n)return"{...}";var a="  ".repeat(t-1),u=o.slice(0,r).map(function(n){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(n)?n:(0,y["default"])(n))+": "+i(e[n],t)+";"}).join("\n  "+a);return o.length>=r&&(u+="\n  "+a+"..."),e.constructor&&e.constructor.name&&"Object"!==e.constructor.name?e.constructor.name+" {\n  "+a+u+"\n"+a+"}":"{\n  "+a+u+"\n"+a+"}"}if(!(e.length>0))return"Array";var s=function(){if(t>n)return{v:"[...]"};var o=i(e[0],t);return e.every(function(e){return i(e,t)===o})?{v:o.trim()+"[]"}:{v:"["+e.slice(0,r).map(function(e){return i(e,t)}).join(", ")+(e.length>=r?", ...":"")+"]"}}();return"object"===("undefined"==typeof s?"undefined":(0,g["default"])(s))?s.v:void 0}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=void 0;var u,s,c,l,f,d,p=n(7),y=r(p),h=n(10),g=r(h),v=n(11),m=r(v),b=n(130),w=r(b),E=n(38),x=r(E),_=n(39),k=r(_),O=n(127),I=r(O),j=n(33),T=r(j),A=n(143),M=r(A),G=n(21),V=r(G),z=n(144),P=r(z),C=n(167),S=r(C),U=n(17),q=r(U),$=n(9),R=r($),N=n(6),L=r(N),F=n(8),D=r(F),B=n(3),K=r(B),Z=n(1),W=r(Z),H=n(2),X=r(H),Q=n(5),Y=r(Q),J=n(4),ee=r(J),te=n(12),ne=r(te),re=n(14),oe=r(re),ae=n(15),ie=n(13),ue=n(16),se=(u=(0,ae.decorator)(),s=(0,ae.decorator)(),(0,ie.classWithPrivateMethods)((d=f=function(e){function t(){return(0,W["default"])(this,t),(0,Y["default"])(this,(0,K["default"])(t).apply(this,arguments))}return(0,ee["default"])(t,e),(0,X["default"])(t,[{key:"fullUpdate",value:function(){function e(e,n,r){return t.apply(this,arguments)}var t=(0,D["default"])(R["default"].mark(function n(e,t,r){return R["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof e||e instanceof Object){n.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(e));case 2:if(t instanceof Object){n.next=4;break}throw new TypeError('Value of argument "entireData" violates contract.\n\nExpected:\nObject\n\nGot:\n'+i(t));case 4:if("string"==typeof r){n.next=6;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(r));case 6:if("string"==typeof e||e instanceof Object){n.next=8;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(e));case 8:if(t instanceof Object){n.next=10;break}throw new TypeError('Value of argument "entireData" violates contract.\n\nExpected:\nObject\n\nGot:\n'+a(t));case 10:if("string"==typeof r){n.next=12;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(r));case 12:if(r){n.next=14;break}throw new oe["default"].ValidationError("organizationId","required");case 14:if(!(this.host.config.maxMetadataKeyCount>0&&(0,L["default"])(t).length>this.host.config.maxMetadataKeyCount)){n.next=16;break}throw new oe["default"].ValidationError("entireData","invalid","Total number of metadata keys is "+(0,L["default"])(t)+" and should not exceed "+this.host.config.maxMetadataKeyCount);case 16:return this.host.requireUser(),e=this._resolveModelId(e),n.prev=18,n.next=21,this.host.api.metadata.update(e,t,r);case 21:return this.__injectMetadata(e,r,t),n.abrupt("return",t);case 25:if(n.prev=25,n.t0=n["catch"](18),!n.t0.response||404!=n.t0.response.status){n.next=31;break}throw new oe["default"].NotFoundError("metadata",e);case 31:throw n.t0;case 32:case"end":return n.stop()}},n,this,[[18,25]])}));return e}()},{key:"update",value:function(){function e(e,n,r){return t.apply(this,arguments)}var t=(0,D["default"])(R["default"].mark(function n(e,t,r){var o,u;return R["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof e||e instanceof Object){n.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(e));case 2:if(t instanceof Object){n.next=4;break}throw new TypeError('Value of argument "partialData" violates contract.\n\nExpected:\nObject\n\nGot:\n'+i(t));case 4:if("string"==typeof r){n.next=6;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(r));case 6:if("string"==typeof e||e instanceof Object){n.next=8;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(e));case 8:if(t instanceof Object){n.next=10;break}throw new TypeError('Value of argument "partialData" violates contract.\n\nExpected:\nObject\n\nGot:\n'+a(t));case 10:if("string"==typeof r){n.next=12;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(r));case 12:if(r){n.next=14;break}throw new oe["default"].ValidationError("organizationId","required");case 14:return n.next=16,this.find(e,r);case 16:return o=n.sent,u=(0,q["default"])({},o,t),n.abrupt("return",this.fullUpdate(e,u,r));case 19:case"end":return n.stop()}},n,this)}));return e}()},{key:"find",value:function(){function e(e,n){return t.apply(this,arguments)}var t=(0,D["default"])(R["default"].mark(function n(e,t){var r;return R["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof e||e instanceof Object){n.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(e));case 2:if("string"==typeof t){n.next=4;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));case 4:if("string"==typeof e||e instanceof Object){n.next=6;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(e));case 6:if("string"==typeof t){n.next=8;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));case 8:if(t){n.next=10;break}throw new oe["default"].ValidationError("organizationId","required");case 10:return this.host.requireUser(),e=this._resolveModelId(e),n.prev=12,n.next=15,this.host.api.metadata.find(e,t);case 15:return r=n.sent,this.__injectMetadata(e,t,r),n.abrupt("return",r);case 20:if(n.prev=20,n.t0=n["catch"](12),!n.t0.response||404!=n.t0.response.status){n.next=26;break}throw new oe["default"].NotFoundError("metadata",e);case 26:throw n.t0;case 27:case"end":return n.stop()}},n,this,[[12,20]])}));return e}()},{key:"findMulti",value:function(){function e(e,n){return t.apply(this,arguments)}var t=(0,D["default"])(R["default"].mark(function n(e,t){var r,o,u,s,c=this;return R["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(Array.isArray(e)&&e.every(function(e){return"string"==typeof e||e instanceof Object})){n.next=2;break}throw new TypeError('Value of argument "ids" violates contract.\n\nExpected:\nArray<string | Object>\n\nGot:\n'+i(e));case 2:if("string"==typeof t){n.next=4;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));case 4:if(Array.isArray(e)&&e.every(function(e){return"string"==typeof e||e instanceof Object})){n.next=6;break}throw new TypeError('Value of argument "ids" violates contract.\n\nExpected:\nArray<string | Object>\n\nGot:\n'+a(e));case 6:if("string"==typeof t){n.next=8;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));case 8:if(t){n.next=10;break}throw new oe["default"].ValidationError("organizationId","required");case 10:return this.host.requireUser(),e=(0,S["default"])((0,ue.arrayWrap)(e).map(this._resolveModelId.bind(this))),r=(0,P["default"])(e,20),o=r.map(function(e){return c.__findMultiPaged(e,t)}),n.next=16,V["default"].all(o);case 16:return u=n.sent,s=M["default"].apply(void 0,[{}].concat((0,T["default"])(u))),n.abrupt("return",s);case 19:case"end":return n.stop()}},n,this)}));return e}()},{key:"__findMultiPaged",value:function(){function e(e,n){return t.apply(this,arguments)}var t=(0,D["default"])(R["default"].mark(function n(e,t){var r,o,u,s,c,l,f,d,p,y,h,g,v,m,b,E;return R["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(Array.isArray(e)&&e.every(function(e){return"string"==typeof e})){n.next=2;break}throw new TypeError('Value of argument "ids" violates contract.\n\nExpected:\nstring[]\n\nGot:\n'+i(e));case 2:if("string"==typeof t){n.next=4;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));case 4:if(Array.isArray(e)&&e.every(function(e){return"string"==typeof e})){n.next=6;break}throw new TypeError('Value of argument "ids" violates contract.\n\nExpected:\nstring[]\n\nGot:\n'+a(e));case 6:if("string"==typeof t){n.next=8;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));case 8:return n.prev=8,n.next=11,this.host.api.metadata.findMulti(e,t);case 11:if(r=n.sent,f=(0,I["default"])(r),f&&("function"==typeof f[k["default"]]||Array.isArray(f))){n.next=15;break}throw new TypeError("Expected _Object$entries to be iterable, got "+a(f));case 15:if(f&&("function"==typeof f[k["default"]]||Array.isArray(f))){n.next=17;break}throw new TypeError("Expected _Object$entries to be iterable, got "+i(f));case 17:for(o=!0,u=!1,s=void 0,n.prev=20,c=(0,x["default"])(f);!(o=(l=c.next()).done);o=!0)d=(0,w["default"])(l.value,2),p=d[0],y=d[1],y&&this.__injectMetadata(p,t,y);n.next=28;break;case 24:n.prev=24,n.t0=n["catch"](20),u=!0,s=n.t0;case 28:n.prev=28,n.prev=29,!o&&c["return"]&&c["return"]();case 31:if(n.prev=31,!u){n.next=34;break}throw s;case 34:return n.finish(31);case 35:return n.finish(28);case 36:return n.abrupt("return",r);case 39:if(n.prev=39,n.t1=n["catch"](8),!n.t1.response||404!=n.t1.response.status){n.next=84;break}if(h={},e&&("function"==typeof e[k["default"]]||Array.isArray(e))){n.next=45;break}throw new TypeError("Expected ids to be iterable, got "+a(e));case 45:if(e&&("function"==typeof e[k["default"]]||Array.isArray(e))){n.next=47;break}throw new TypeError("Expected ids to be iterable, got "+i(e));case 47:g=!0,v=!1,m=void 0,n.prev=50,b=(0,x["default"])(e);case 52:if(g=(E=b.next()).done){n.next=67;break}return p=E.value,n.prev=54,n.next=57,this.find(p,t);case 57:h[p]=n.sent,n.next=64;break;case 60:if(n.prev=60,n.t2=n["catch"](54),n.t2.code==oe["default"].NotFoundError.CODE){n.next=64;break}throw n.t2;case 64:g=!0,n.next=52;break;case 67:n.next=73;break;case 69:n.prev=69,n.t3=n["catch"](50),v=!0,m=n.t3;case 73:n.prev=73,n.prev=74,!g&&b["return"]&&b["return"]();case 76:if(n.prev=76,!v){n.next=79;break}throw m;case 79:return n.finish(76);case 80:return n.finish(73);case 81:return n.abrupt("return",h);case 84:throw n.t1;case 85:case"end":return n.stop()}},n,this,[[8,39],[20,24,28,36],[29,,31,35],[50,69,73,81],[54,60],[74,,76,80]])}));return e}()},{key:"__injectMetadata",value:function(e,t,n){if("string"!=typeof e)throw new TypeError('Value of argument "entityId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));if("string"!=typeof t)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));if(!(n instanceof Object))throw new TypeError('Value of argument "data" violates contract.\n\nExpected:\nObject\n\nGot:\n'+i(n));if("string"!=typeof e)throw new TypeError('Value of argument "entityId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));if("string"!=typeof t)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));if(!(n instanceof Object))throw new TypeError('Value of argument "data" violates contract.\n\nExpected:\nObject\n\nGot:\n'+a(n));var r=e+":"+t;this.host.models.Metadata.inject({id:r,data:n,entityId:e,organizationId:t})}}]),t}(ne["default"]),f.METADTA_TYPES=["user","group"],l=d,o(l.prototype,"find",[u],(0,m["default"])(l.prototype,"find"),l.prototype),o(l.prototype,"findMulti",[s],(0,m["default"])(l.prototype,"findMulti"),l.prototype),o(l.prototype,"__findMultiPaged",[ie.privateMethod],(0,m["default"])(l.prototype,"__findMultiPaged"),l.prototype),o(l.prototype,"__injectMetadata",[ie.privateMethod],(0,m["default"])(l.prototype,"__injectMetadata"),l.prototype),c=l))||c);t["default"]=se,e.exports=t["default"]},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t,n,r,o){var a={};return Object.keys(r).forEach(function(e){a[e]=r[e]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},a),o&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(o):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}function a(e,t){var n=4,r=15;if(void 0===t&&(t=0),t+=1,null===e)return"null";if(void 0===e)return"void";if("string"==typeof e||"number"==typeof e||"boolean"==typeof e)return"undefined"==typeof e?"undefined":(0,p["default"])(e);if(!Array.isArray(e)){var o=(0,z["default"])(e);if(!o.length)return e.constructor&&e.constructor.name&&"Object"!==e.constructor.name?e.constructor.name:"Object";if(t>n)return"{...}";var i="  ".repeat(t-1),u=o.slice(0,r).map(function(n){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(n)?n:(0,f["default"])(n))+": "+a(e[n],t)+";"}).join("\n  "+i);return o.length>=r&&(u+="\n  "+i+"..."),e.constructor&&e.constructor.name&&"Object"!==e.constructor.name?e.constructor.name+" {\n  "+i+u+"\n"+i+"}":"{\n  "+i+u+"\n"+i+"}"}if(!(e.length>0))return"Array";var s=function(){if(t>n)return{v:"[...]"};var o=a(e[0],t);return e.every(function(e){return a(e,t)===o})?{v:o.trim()+"[]"}:{v:"["+e.slice(0,r).map(function(e){return a(e,t)}).join(", ")+(e.length>=r?", ...":"")+"]"}}();return"object"===("undefined"==typeof s?"undefined":(0,p["default"])(s))?s.v:void 0}function i(e,t){var n=4,r=15;if(void 0===t&&(t=0),t+=1,null===e)return"null";if(void 0===e)return"void";if("string"==typeof e||"number"==typeof e||"boolean"==typeof e)return"undefined"==typeof e?"undefined":(0,p["default"])(e);if(!Array.isArray(e)){var o=(0,z["default"])(e);if(!o.length)return e.constructor&&e.constructor.name&&"Object"!==e.constructor.name?e.constructor.name:"Object";if(t>n)return"{...}";var a="  ".repeat(t-1),u=o.slice(0,r).map(function(n){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(n)?n:(0,f["default"])(n))+": "+i(e[n],t)+";"}).join("\n  "+a);return o.length>=r&&(u+="\n  "+a+"..."),e.constructor&&e.constructor.name&&"Object"!==e.constructor.name?e.constructor.name+" {\n  "+a+u+"\n"+a+"}":"{\n  "+a+u+"\n"+a+"}"}if(!(e.length>0))return"Array";var s=function(){if(t>n)return{v:"[...]"};var o=i(e[0],t);return e.every(function(e){return i(e,t)===o})?{v:o.trim()+"[]"}:{v:"["+e.slice(0,r).map(function(e){return i(e,t)}).join(", ")+(e.length>=r?", ...":"")+"]"}}();return"object"===("undefined"==typeof s?"undefined":(0,p["default"])(s))?s.v:void 0}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=void 0;var u,s,c,l=n(7),f=r(l),d=n(10),p=r(d),y=n(11),h=r(y),g=n(9),v=r(g),m=n(8),b=r(m),w=n(3),E=r(w),x=n(1),_=r(x),k=n(2),O=r(k),I=n(5),j=r(I),T=n(4),A=r(T),M=n(30),G=r(M),V=n(6),z=r(V),P=n(129),C=r(P),S=n(12),U=r(S),q=n(141),$=r(q),R=n(13),N=n(15),L=n(27),F=r(L),D=n(23),B=r(D),K=n(49),Z=r(K),W={account:"user",group:"group"},H=new C["default"]((0,z["default"])(W)),X=(0,G["default"])(W).concat(["conversation"]),Q=525600,Y=(u=(0,N.decorator)(),(0,R.classWithPrivateMethods)((c=function(e){function t(){return(0,_["default"])(this,t),(0,j["default"])(this,(0,E["default"])(t).apply(this,arguments))}return(0,A["default"])(t,e),(0,O["default"])(t,[{key:"mounted",value:function(){this._muteEntriesByConversationId={},this._fetched=!1}},{key:"dispose",value:function(){this._muteEntriesByConversationId=null,this._fetched=!1}},{key:"findAll",value:function(){function e(){return t.apply(this,arguments)}var t=(0,b["default"])(v["default"].mark(function n(){var e,t;return v["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(this._fetched){n.next=6;break}return n.next=3,this.host.api.mute.findAll();case 3:t=n.sent,(e=t.filter(function(e){return H.has(e.sender_type)}).map(this._parseMuteEntry),$["default"]).call(e,this._isExpired).forEach(this._addEntry),this._fetched=!0;case 6:return n.abrupt("return",(0,G["default"])(this._muteEntriesByConversationId));case 7:case"end":return n.stop()}},n,this)}));return e}()},{key:"_parseMuteEntry",value:function(e){var t=+e.mute_duration,n=new Date(1e3*+e.mute_start).getTime(),r=(0,Z["default"])(n).add(t,"minute").toDate().getTime(),o=W[e.sender_type],a=e.caller_organization||e.organization_id,i=e.sender_token,u=this.host.conversations.getConversationKey(o,i,a);return{conversationId:u,durationInMinutes:t,startedAt:n,expiresAt:r,organizationId:a,entityId:i,entityType:o}}},{key:"_isExpired",value:function(e){if(!(e instanceof Object))throw new TypeError('Value of argument "entry" violates contract.\n\nExpected:\nObject\n\nGot:\n'+i(e));if(!(e instanceof Object))throw new TypeError('Value of argument "entry" violates contract.\n\nExpected:\nObject\n\nGot:\n'+a(e));return e.expiresAt<Date.now()}},{key:"_addEntry",value:function(e){var t=e.conversationId,n=e.entityType,r=e.entityId,o=e.organizationId,a=e.durationInMinutes,i=e.startedAt;t=t||this.host.conversations.getConversationKey(n,r,o),i=i||Date.now();var u=(0,Z["default"])(i).add(a,"minute").toDate().getTime(),s={conversationId:t,durationInMinutes:a,startedAt:i,expiresAt:u,organizationId:o,entityId:r,entityType:n};return this.host.models.Conversation.touch(t),this._muteEntriesByConversationId[t]=s,s}},{key:"_removeEntry",value:function(e){var t=e.conversationId,n=e.entityType,r=e.entityId,o=e.organizationId;t=t||this.host.conversations.getConversationKey(n,r,o),delete this._muteEntriesByConversationId[t],this.host.models.Conversation.touch(t)}},{key:"_removeAllEntries",value:function(){var e=this;(0,G["default"])(this._muteEntriesByConversationId).forEach(function(t){return e._removeEntry(t)})}},{key:"getByConversationId",value:function(e){if("string"!=typeof e)throw new TypeError('Value of argument "conversationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));if("string"!=typeof e)throw new TypeError('Value of argument "conversationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));var t=this._muteEntriesByConversationId[e];return t?this._isExpired(t)?(delete this._muteEntriesByConversationId[e],null):t:null}},{key:"unmuteAll",value:function(){function e(){return t.apply(this,arguments)}var t=(0,b["default"])(v["default"].mark(function n(){return v["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.host.api.mute.unmuteAll();case 2:this._removeAllEntries();case 3:case"end":return e.stop()}},n,this)}));return e}()},{key:"mute",value:function(){function e(e,n,r){return t.apply(this,arguments)}var t=(0,b["default"])(v["default"].mark(function n(e,t,r){var o;return v["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof e||e instanceof Object){n.next=2;break}throw new TypeError('Value of argument "entityId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(e));case 2:if("number"==typeof t){n.next=4;break}throw new TypeError('Value of argument "durationInMinutes" violates contract.\n\nExpected:\nnumber\n\nGot:\n'+i(t));case 4:if(null==r||"string"==typeof r){n.next=6;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\n?string\n\nGot:\n'+i(r));case 6:if("string"==typeof e||e instanceof Object){n.next=8;break}throw new TypeError('Value of argument "entityId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(e));case 8:if("number"==typeof t){n.next=10;break}throw new TypeError('Value of argument "durationInMinutes" violates contract.\n\nExpected:\nnumber\n\nGot:\n'+a(t));case 10:if(null==r||"string"==typeof r){n.next=12;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\n?string\n\nGot:\n'+a(r));case 12:if(o=this._resolveEntity(e,X)){n.next=15;break}throw new Error("entity "+e+" not found");case 15:n.t0=o.$entityType,n.next="conversation"===n.t0?18:"user"===n.t0?19:"group"===n.t0?21:"organization"===n.t0?22:23;break;case 18:return n.abrupt("return",this.mute(o.counterParty,t,o.organizationId));case 19:return F["default"].notEmpty("organizationId",r),n.abrupt("return",this.muteUser(o,t,r));case 21:return n.abrupt("return",this.muteGroup(o,t));case 22:return n.abrupt("return",this.muteOrganization(o,t));case 23:case"end":return n.stop()}},n,this)}));return e}()},{key:"unmute",value:function(){function e(e,n){return t.apply(this,arguments)}var t=(0,b["default"])(v["default"].mark(function n(e,t){var r;return v["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof e||e instanceof Object){n.next=2;break}throw new TypeError('Value of argument "entityId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(e));case 2:if(null==t||"string"==typeof t){n.next=4;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\n?string\n\nGot:\n'+i(t));case 4:if("string"==typeof e||e instanceof Object){n.next=6;break}throw new TypeError('Value of argument "entityId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(e));case 6:if(null==t||"string"==typeof t){n.next=8;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\n?string\n\nGot:\n'+a(t));case 8:if(r=this._resolveEntity(e,X)){n.next=11;break}throw new Error("entity "+e+" not found");case 11:n.t0=r.$entityType,n.next="conversation"===n.t0?14:"user"===n.t0?15:"group"===n.t0?17:"organization"===n.t0?18:19;break;case 14:return n.abrupt("return",this.unmute(r.counterParty,r.organizationId));case 15:return F["default"].notEmpty("organizationId",t),n.abrupt("return",this.unmuteUser(r,t));case 17:return n.abrupt("return",this.unmuteGroup(r));case 18:return n.abrupt("return",this.unmuteOrganization(r));case 19:case"end":return n.stop()}},n,this)}));return e}()},{key:"muteUser",value:function(){function e(e,n,r){return t.apply(this,arguments)}var t=(0,b["default"])(v["default"].mark(function n(e,t,r){return v["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof e||e instanceof Object){n.next=2;break}throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(e));case 2:if("number"==typeof t){n.next=4;break}throw new TypeError('Value of argument "durationInMinutes" violates contract.\n\nExpected:\nnumber\n\nGot:\n'+i(t));case 4:if("string"==typeof r||r instanceof Object){n.next=6;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(r));case 6:if("string"==typeof e||e instanceof Object){n.next=8;break}throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(e));case 8:if("number"==typeof t){n.next=10;break}throw new TypeError('Value of argument "durationInMinutes" violates contract.\n\nExpected:\nnumber\n\nGot:\n'+a(t));case 10:if("string"==typeof r||r instanceof Object){n.next=12;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(r));case 12:return this.__validateDurationInMinutes(t),e=this._resolveModelIdWithTypes(e,"user"),r=this._resolveModelId(r),n.next=17,this.host.api.mute.muteUser(e,t,r,{recipientOrganizationId:r});case 17:this._addEntry({entityType:"user",entityId:e,organizationId:r,durationInMinutes:t});case 18:case"end":return n.stop()}},n,this)}));return e}()},{key:"unmuteUser",value:function(){function e(e,n){return t.apply(this,arguments)}var t=(0,b["default"])(v["default"].mark(function n(e,t){return v["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof e||e instanceof Object){n.next=2;break}throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(e));case 2:if("string"==typeof t||t instanceof Object){n.next=4;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(t));case 4:if("string"==typeof e||e instanceof Object){n.next=6;break}throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(e));case 6:if("string"==typeof t||t instanceof Object){n.next=8;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(t));case 8:return e=this._resolveModelIdWithTypes(e,"user"),t=this._resolveModelId(t),n.next=12,this.host.api.mute.unmuteUser(e,t,{recipientOrganizationId:t});case 12:this._removeEntry({entityType:"user",entityId:e,organizationId:t});case 13:case"end":return n.stop()}},n,this)}));return e}()},{key:"muteGroup",value:function(){function e(e,n,r){return t.apply(this,arguments)}var t=(0,b["default"])(v["default"].mark(function n(e,t,r){var o;return v["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof e||e instanceof Object){n.next=2;break}throw new TypeError('Value of argument "groupId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(e));case 2:if("number"==typeof t){n.next=4;break}throw new TypeError('Value of argument "durationInMinutes" violates contract.\n\nExpected:\nnumber\n\nGot:\n'+i(t));case 4:if(null==r||"string"==typeof r||null==r||r instanceof Object){n.next=6;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\n?string | ?Object\n\nGot:\n'+i(r));case 6:if("string"==typeof e||e instanceof Object){n.next=8;break}throw new TypeError('Value of argument "groupId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(e));case 8:if("number"==typeof t){n.next=10;break}throw new TypeError('Value of argument "durationInMinutes" violates contract.\n\nExpected:\nnumber\n\nGot:\n'+a(t));case 10:if(null==r||"string"==typeof r||null==r||r instanceof Object){n.next=12;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\n?string | ?Object\n\nGot:\n'+a(r));case 12:return this.__validateDurationInMinutes(t),o=this._resolveEntity(e,"group"),o?(e=o.id,r=o.organizationId):r=this._resolveModelId(r),F["default"].notEmpty("organizationId",r),n.next=18,this.host.api.mute.muteGroup(e,t,r);case 18:this._addEntry({entityType:"group",entityId:e,organizationId:r,durationInMinutes:t});case 19:case"end":return n.stop()}},n,this)}));return e}()},{key:"unmuteGroup",value:function(){function e(e,n){return t.apply(this,arguments)}var t=(0,b["default"])(v["default"].mark(function n(e,t){var r;return v["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof e||e instanceof Object){n.next=2;break}throw new TypeError('Value of argument "groupId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(e));case 2:if(null==t||"string"==typeof t||null==t||t instanceof Object){n.next=4;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\n?string | ?Object\n\nGot:\n'+i(t));
case 4:if("string"==typeof e||e instanceof Object){n.next=6;break}throw new TypeError('Value of argument "groupId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(e));case 6:if(null==t||"string"==typeof t||null==t||t instanceof Object){n.next=8;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\n?string | ?Object\n\nGot:\n'+a(t));case 8:return r=this._resolveEntity(e,"group"),r?(e=r.id,t=r.organizationId):(F["default"].notEmpty("organizationId",t),t=this._resolveModelId(t)),n.next=12,this.host.api.mute.unmuteGroup(e,t);case 12:this._removeEntry({entityType:"group",entityId:e,organizationId:t});case 13:case"end":return n.stop()}},n,this)}));return e}()},{key:"reactToMuteEvent",value:function(e){if(e.data.token==this.host.currentUser.id){var t=e.data.action;if("clear"===t)return void this._removeAllEntries();var n=this._parseMuteEntry(e.data);switch(t){case"add":this._muteEntriesByConversationId[n.conversationId]=n;break;case"del":delete this._muteEntriesByConversationId[n.conversationId]}}}},{key:"__validateDurationInMinutes",value:function(e){if("number"!=typeof e)throw new TypeError('Value of argument "durationInMinutes" violates contract.\n\nExpected:\nnumber\n\nGot:\n'+i(e));if("number"!=typeof e)throw new TypeError('Value of argument "durationInMinutes" violates contract.\n\nExpected:\nnumber\n\nGot:\n'+a(e));(0>e||e>Q||e%1!==0)&&F["default"].raise("durationInMinutes","invalid","should be a positive integer from 1 to "+Q+" (1 year)")}}]),t}(U["default"]),o(c.prototype,"findAll",[u],(0,h["default"])(c.prototype,"findAll"),c.prototype),o(c.prototype,"_parseMuteEntry",[R.privateMethod,B["default"]],(0,h["default"])(c.prototype,"_parseMuteEntry"),c.prototype),o(c.prototype,"_addEntry",[R.privateMethod,B["default"]],(0,h["default"])(c.prototype,"_addEntry"),c.prototype),o(c.prototype,"_removeEntry",[R.privateMethod,B["default"]],(0,h["default"])(c.prototype,"_removeEntry"),c.prototype),o(c.prototype,"_removeAllEntries",[R.privateMethod],(0,h["default"])(c.prototype,"_removeAllEntries"),c.prototype),o(c.prototype,"__validateDurationInMinutes",[R.privateMethod],(0,h["default"])(c.prototype,"__validateDurationInMinutes"),c.prototype),s=c))||s);t["default"]=Y,e.exports=t["default"]},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t,n,r,o){var a={};return Object.keys(r).forEach(function(e){a[e]=r[e]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},a),o&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(o):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}function a(e,t){var n=4,r=15;if(void 0===t&&(t=0),t+=1,null===e)return"null";if(void 0===e)return"void";if("string"==typeof e||"number"==typeof e||"boolean"==typeof e)return"undefined"==typeof e?"undefined":(0,g["default"])(e);if(!Array.isArray(e)){var o=(0,y["default"])(e);if(!o.length)return e.constructor&&e.constructor.name&&"Object"!==e.constructor.name?e.constructor.name:"Object";if(t>n)return"{...}";var i="  ".repeat(t-1),u=o.slice(0,r).map(function(n){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(n)?n:(0,d["default"])(n))+": "+a(e[n],t)+";"}).join("\n  "+i);return o.length>=r&&(u+="\n  "+i+"..."),e.constructor&&e.constructor.name&&"Object"!==e.constructor.name?e.constructor.name+" {\n  "+i+u+"\n"+i+"}":"{\n  "+i+u+"\n"+i+"}"}if(!(e.length>0))return"Array";var s=function(){if(t>n)return{v:"[...]"};var o=a(e[0],t);return e.every(function(e){return a(e,t)===o})?{v:o.trim()+"[]"}:{v:"["+e.slice(0,r).map(function(e){return a(e,t)}).join(", ")+(e.length>=r?", ...":"")+"]"}}();return"object"===("undefined"==typeof s?"undefined":(0,g["default"])(s))?s.v:void 0}function i(e,t){var n=4,r=15;if(void 0===t&&(t=0),t+=1,null===e)return"null";if(void 0===e)return"void";if("string"==typeof e||"number"==typeof e||"boolean"==typeof e)return"undefined"==typeof e?"undefined":(0,g["default"])(e);if(!Array.isArray(e)){var o=(0,y["default"])(e);if(!o.length)return e.constructor&&e.constructor.name&&"Object"!==e.constructor.name?e.constructor.name:"Object";if(t>n)return"{...}";var a="  ".repeat(t-1),u=o.slice(0,r).map(function(n){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(n)?n:(0,d["default"])(n))+": "+i(e[n],t)+";"}).join("\n  "+a);return o.length>=r&&(u+="\n  "+a+"..."),e.constructor&&e.constructor.name&&"Object"!==e.constructor.name?e.constructor.name+" {\n  "+a+u+"\n"+a+"}":"{\n  "+a+u+"\n"+a+"}"}if(!(e.length>0))return"Array";var s=function(){if(t>n)return{v:"[...]"};var o=i(e[0],t);return e.every(function(e){return i(e,t)===o})?{v:o.trim()+"[]"}:{v:"["+e.slice(0,r).map(function(e){return i(e,t)}).join(", ")+(e.length>=r?", ...":"")+"]"}}();return"object"===("undefined"==typeof s?"undefined":(0,g["default"])(s))?s.v:void 0}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=void 0;var u,s,c,l,f=n(7),d=r(f),p=n(6),y=r(p),h=n(10),g=r(h),v=n(11),m=r(v),b=n(24),w=r(b),E=n(67),x=r(E),_=n(47),k=r(_),O=n(44),I=r(O),j=n(19),T=r(j),A=n(165),M=r(A),G=n(43),V=r(G),z=n(18),P=r(z),C=n(9),S=r(C),U=n(8),q=r(U),$=n(3),R=r($),N=n(1),L=r(N),F=n(2),D=r(F),B=n(5),K=r(B),Z=n(4),W=r(Z),H=n(12),X=r(H),Q=n(15),Y=n(14),J=r(Y),ee=n(29),te=r(ee),ne=n(41),re=r(ne),oe=n(37),ae=r(oe),ie=n(70),ue=r(ie),se=n(23),ce=r(se),le=n(13),fe=(u=(0,Q.decorator)({memoize:!0}),s=(0,Q.decorator)(),(0,le.classWithPrivateMethods)((l=function(e){function t(){return(0,L["default"])(this,t),(0,K["default"])(this,(0,R["default"])(t).apply(this,arguments))}return(0,W["default"])(t,e),(0,D["default"])(t,[{key:"mounted",value:function(){this.host.models.Conversation.on("afterInject",this._onConversationChange),this.host.models.Conversation.on("afterEject",this._onConversationChange)}},{key:"dispose",value:function(){this.host.models.Conversation.off("afterInject",this._onConversationChange),this.host.models.Conversation.off("afterEject",this._onConversationChange),Q.decorator.clear(this.findAll)}},{key:"create",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,q["default"])(S["default"].mark(function n(){var e=this,t=arguments.length<=0||void 0===arguments[0]?{name:void 0,ttl:void 0,dor:void 0,allowPublicGroups:void 0,pinLock:void 0,settingsRestricted:void 0,autologoutTime:void 0,lifecycleCallback:void 0,groupLifespan:void 0,welcomeEmailSettings:void 0}:arguments[0];return S["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return this.host.requireUser(),n.abrupt("return",this.httpClient.post("/organization",{data:t}).then(function(n){var r=n.getHeader("TT-X-Organization-Key"),o=e.host.models.Organization.inject({id:r,name:t.name});return o}));case 2:case"end":return n.stop()}},n,this)}));return e}()},{key:"update",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,q["default"])(S["default"].mark(function n(){var e,t=this,r=arguments.length<=0||void 0===arguments[0]?{id:void 0,name:void 0,ttl:void 0,dor:void 0,allowPublicGroups:void 0,pinLock:void 0,settingsRestricted:void 0,autologoutTime:void 0,lifecycleCallback:void 0,groupLifespan:void 0,welcomeEmailSettings:void 0,welcomeEmailLogo:void 0,autoSendWelcomeEmail:void 0}:arguments[0];return S["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return this.host.requireUser(),e=ae["default"].underscoreObject({name:r.name,ttl:r.ttl,dor:r.dor,allowPublicGroups:r.allowPublicGroups,pinLock:r.pinLock,settingsRestricted:r.settingsRestricted,autologoutTime:r.autologoutTime,lifecycleCallback:r.lifecycleCallback,groupLifespan:r.groupLifespan,welcomeEmailSettings:r.welcomeEmailSettings,welcomeEmailLogo:r.welcomeEmailLogo,autoSendWelcomeEmail:r.autoSendWelcomeEmail}),n.abrupt("return",this.httpClient.post("/organization/:id",{urlParams:{id:r.id},data:e}).then(function(n){var o=t.host.models.Organization.inject((0,P["default"])({id:r.id},e));return o}));case 3:case"end":return n.stop()}},n,this)}));return e}()},{key:"findAll",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,q["default"])(S["default"].mark(function n(){var e,t=this,r=arguments.length<=0||void 0===arguments[0]?{onlyApproved:!1}:arguments[0];return S["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return this.host.requireUser(),n.next=3,this._findAll();case 3:return e=n.sent,r.onlyApproved&&(e=(0,V["default"])(e,{pending:!1})),e=(0,M["default"])(e,function(e){return e.name.toLowerCase()}),e.forEach(function(e){return t.__reloadConversations(e)}),n.abrupt("return",e);case 8:case"end":return n.stop()}},n,this)}));return e}()},{key:"refreshAll",value:function(){function e(){return t.apply(this,arguments)}var t=(0,q["default"])(S["default"].mark(function n(){return S["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._findAll();case 2:case"end":return e.stop()}},n,this)}));return e}()},{key:"_findAll",value:function(){function e(){return t.apply(this,arguments)}var t=(0,q["default"])(S["default"].mark(function n(){var e,t=this;return S["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.host.api.organizations.findAllOfUser(this.host.currentUserId);case 2:return e=n.sent,e=e.map(function(e){return t.host.models.Organization.inject(e)}),n.abrupt("return",e);case 5:case"end":return n.stop()}},n,this)}));return e}()},{key:"find",value:function(){function e(e,n){return t.apply(this,arguments)}var t=(0,q["default"])(S["default"].mark(function n(e){var t,r,o=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return S["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof e){n.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));case 2:if("string"==typeof e){n.next=4;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));case 4:if(o=(0,T["default"])(o,{ignoreNotFound:!1,bypassCache:!1}),this.host.requireUser(),t=void 0,o.bypassCache){n.next=11;break}if(t=this.host.models.Organization.get(e),!t||t.$placeholder){n.next=11;break}return n.abrupt("return",t);case 11:return n.next=13,this.host.api.organizations.find(this.host.currentUserId,e);case 13:if(r=n.sent,!r){n.next=19;break}t=this.host.models.Organization.inject(r),this.__reloadConversations(t),n.next=21;break;case 19:if(o.ignoreNotFound){n.next=21;break}throw new J["default"].NotFoundError(this.host.models.Organization.name,e);case 21:return n.abrupt("return",t);case 22:case"end":return n.stop()}},n,this)}));return e}()},{key:"getSettingValue",value:function(e,t){if("string"!=typeof e)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));if("string"!=typeof t)throw new TypeError('Value of argument "key" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));if("string"!=typeof e)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));if("string"!=typeof t)throw new TypeError('Value of argument "key" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));e=this._resolveModelId(e);var n=this.getById(e);if(!n||!n.settings)return null;var r=(0,I["default"])(n.settings,{name:t});return r?isFinite(r.value)?+r.value:r.value:null}},{key:"getById",value:function(e){if("string"!=typeof e)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));if("string"!=typeof e)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));return this.host.models.Organization.get(e)}},{key:"getMultiById",value:function(e){if(!Array.isArray(e)||!e.every(function(e){return"string"==typeof e}))throw new TypeError('Value of argument "ids" violates contract.\n\nExpected:\nArray<string>\n\nGot:\n'+i(e));if(!Array.isArray(e)||!e.every(function(e){return"string"==typeof e}))throw new TypeError('Value of argument "ids" violates contract.\n\nExpected:\nArray<string>\n\nGot:\n'+a(e));return this.host.models.Organization.getMulti(e)}},{key:"_onConversationChange",value:function(e,t){this.__reloadConversations(t.organization)}},{key:"__reloadConversations",value:function(e){var t;if(e){var n=(0,k["default"])(e,["conversations","unreadCount"]),r=(t=(t=this.host.models.Conversation.getAll(),te["default"]).call(t,{organizationId:e.id}),re["default"]).call(t,["lastEventMessageSortNumber","_origIndex"],["desc","asc"]),o=(0,x["default"])(r,"unreadCount"),a={conversations:r,unreadCount:o},i=!1;(0,w["default"])(n,function(t,n){(0,ue["default"])(t,a[n])||(e[n]=a[n],i=!0)}),i&&this.host.models.Organization.inject(e)}}}]),t}(X["default"]),o(l.prototype,"findAll",[u],(0,m["default"])(l.prototype,"findAll"),l.prototype),o(l.prototype,"refreshAll",[Q.decorator],(0,m["default"])(l.prototype,"refreshAll"),l.prototype),o(l.prototype,"_findAll",[le.privateMethod],(0,m["default"])(l.prototype,"_findAll"),l.prototype),o(l.prototype,"find",[s],(0,m["default"])(l.prototype,"find"),l.prototype),o(l.prototype,"_onConversationChange",[le.privateMethod,ce["default"]],(0,m["default"])(l.prototype,"_onConversationChange"),l.prototype),o(l.prototype,"__reloadConversations",[le.privateMethod],(0,m["default"])(l.prototype,"__reloadConversations"),l.prototype),c=l))||c);t["default"]=fe,e.exports=t["default"]},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=void 0;var o,a=n(3),i=r(a),u=n(1),s=r(u),c=n(2),l=r(c),f=n(5),d=r(f),p=n(4),y=r(p),h=n(12),g=r(h),v=n(25),m=n(13),b=n(23),w=(r(b),(0,m.classWithPrivateMethods)(o=function(e){function t(e,n){return(0,s["default"])(this,t),(0,d["default"])(this,(0,i["default"])(t).call(this,e,n))}return(0,y["default"])(t,e),(0,l["default"])(t,[{key:"mounted",value:function(){this._data={}}},{key:"dispose",value:function(){this._data=null}},{key:"reactToPresenceEvent",value:function(e){this.set(e.data.from,v.PresenceStatus.resolve(e.data.type))}},{key:"set",value:function(e,t){var n=this._data[e]!==t;if(n){var r=this.host.models.User.get(e);this._data[e]=t,this.emit("change",{userId:e,presence:t,user:r})}}},{key:"get",value:function(e){return e==this.host.currentUserId?v.PresenceStatus.AVAILABLE:this._data[e]||null}}]),t}(g["default"]))||o);t["default"]=w,e.exports=t["default"]},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t,n,r,o){var a={};return Object.keys(r).forEach(function(e){a[e]=r[e]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},a),o&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(o):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=void 0;var a,i,u=n(11),s=r(u),c=n(9),l=r(c),f=n(21),d=r(f),p=n(24),y=r(p),h=n(157),g=r(h),v=n(154),m=r(v),b=n(148),w=r(b),E=n(35),x=r(E),_=n(6),k=r(_),O=n(64),I=r(O),j=n(8),T=r(j),A=n(3),M=r(A),G=n(1),V=r(G),z=n(2),P=r(z),C=n(5),S=r(C),U=n(4),q=r(U),$=n(30),R=r($),N=n(12),L=r(N),F=n(15),D=n(14),B=r(D),K=n(37),Z=r(K),W=n(52),H=n(16),X={user:"account",distributionList:"distribution_list",group:"group",organization:"organization",room:"public_group"},Q=(0,R["default"])(X),Y=(a=(0,F.decorator)(),i=function(e){function t(){return(0,V["default"])(this,t),(0,S["default"])(this,(0,M["default"])(t).apply(this,arguments))}return(0,q["default"])(t,e),(0,P["default"])(t,[{key:"query",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,T["default"])(l["default"].mark(function n(e){var t,r,o,a,i,u,s=this,c=e.types,f=void 0===c?[]:c,p=e.query,h=void 0===p?{}:p,v=e.continuation,b=void 0===v?null:v,E=e.includeDisabled,_=void 0===E?!1:E,O=e.excludeIds,j=void 0===O?[]:O,T=e.excludeSelf,A=void 0===T?!1:T,M=e.resultsFormat,G=void 0===M?"entities":M,V=e.organizationId,z=void 0===V?null:V,P=e.organizationIds,C=void 0===P?[]:P,S=e.sort,U=void 0===S?[]:S,q=e.includeMetadata,$=void 0===q?!1:q;return l["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(0!=f.length){e.next=2;break}throw new B["default"].ValidationError("types","required","no types specified");case 2:if(f=f.map(function(e){return X[e]}),t=(0,I["default"])(f,Q),!(t.length>0)){e.next=6;break}throw new B["default"].ValidationError("types","invalid","invalid types: "+t.join(", "));case 6:if(z&&(C=[z]),0!=C.length){e.next=9;break}throw new B["default"].ValidationError("organizationIds","invalid","search must be done in a context of an organization");case 9:return"ids"===G&&(G="tokens"),r={type:f,include_disabled:_,directory:C,results_format:G},b&&(r.continuation=b),U&&U.length&&(r.sort=U),j=(0,H.arrayWrap)(j),h&&(0,k["default"])(h).length>0&&(r.bool={must:Z["default"].underscoreObject(h)}),e.next=17,this.httpClient.post("/search",{data:r});case 17:if(o=e.sent,a=o.data.results,i=this.host.currentUser.id,u=(0,x["default"])(a,function(e,t){var n=t.type,r=t.entity,o=t.organization_id;if(0!=(0,k["default"])(r).length){"tigertext:entity:account"===n&&(0,H.replaceKey)(r,"status","account_status");var a=s.host.injectModel(r,n);if(!(j.length&&j.includes(a.id)||A&&a.id===i)){if(!a)return void s.logger.warn("no entity for ",t);var u=new W.SearchResult(a,o);e.push(u)}}},[]),!$){e.next=23;break}return e.delegateYield(l["default"].mark(function n(){var e,t,r;return l["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(e=(0,w["default"])(u,"organizationId"),t=(0,m["default"])(u,"entityId"),r=(0,x["default"])(e,function(e,n,r){e.push(s.host.metadata.findMulti((0,g["default"])(n,"entityId"),r).then(function(e){(0,y["default"])(e,function(e,n){return t[n].metadata=e})}))},[]),!(r.length>0)){n.next=6;break}return n.next=6,d["default"].all(r);case 6:case"end":return n.stop()}},n,s)})(),"t0",23);case 23:return e.abrupt("return",u);case 24:case"end":return e.stop()}},n,this)}));return e}()}]),t}(L["default"]),o(i.prototype,"query",[a],(0,s["default"])(i.prototype,"query"),i.prototype),i);t["default"]=Y,e.exports=t["default"]},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t,n,r,o){var a={};return Object.keys(r).forEach(function(e){a[e]=r[e]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},a),o&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(o):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}function a(e,t){var n=4,r=15;if(void 0===t&&(t=0),t+=1,null===e)return"null";if(void 0===e)return"void";if("string"==typeof e||"number"==typeof e||"boolean"==typeof e)return"undefined"==typeof e?"undefined":(0,y["default"])(e);if(!Array.isArray(e)){var o=(0,d["default"])(e);if(!o.length)return e.constructor&&e.constructor.name&&"Object"!==e.constructor.name?e.constructor.name:"Object";if(t>n)return"{...}";var i="  ".repeat(t-1),u=o.slice(0,r).map(function(n){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(n)?n:(0,l["default"])(n))+": "+a(e[n],t)+";"}).join("\n  "+i);return o.length>=r&&(u+="\n  "+i+"..."),e.constructor&&e.constructor.name&&"Object"!==e.constructor.name?e.constructor.name+" {\n  "+i+u+"\n"+i+"}":"{\n  "+i+u+"\n"+i+"}"}if(!(e.length>0))return"Array";var s=function(){if(t>n)return{v:"[...]"};var o=a(e[0],t);return e.every(function(e){return a(e,t)===o})?{v:o.trim()+"[]"}:{v:"["+e.slice(0,r).map(function(e){return a(e,t)}).join(", ")+(e.length>=r?", ...":"")+"]"}}();return"object"===("undefined"==typeof s?"undefined":(0,y["default"])(s))?s.v:void 0}function i(e,t){var n=4,r=15;if(void 0===t&&(t=0),t+=1,null===e)return"null";if(void 0===e)return"void";if("string"==typeof e||"number"==typeof e||"boolean"==typeof e)return"undefined"==typeof e?"undefined":(0,y["default"])(e);if(!Array.isArray(e)){var o=(0,d["default"])(e);if(!o.length)return e.constructor&&e.constructor.name&&"Object"!==e.constructor.name?e.constructor.name:"Object";if(t>n)return"{...}";var a="  ".repeat(t-1),u=o.slice(0,r).map(function(n){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(n)?n:(0,l["default"])(n))+": "+i(e[n],t)+";"}).join("\n  "+a);return o.length>=r&&(u+="\n  "+a+"..."),e.constructor&&e.constructor.name&&"Object"!==e.constructor.name?e.constructor.name+" {\n  "+a+u+"\n"+a+"}":"{\n  "+a+u+"\n"+a+"}"}if(!(e.length>0))return"Array";var s=function(){if(t>n)return{v:"[...]"};var o=i(e[0],t);return e.every(function(e){return i(e,t)===o})?{v:o.trim()+"[]"}:{v:"["+e.slice(0,r).map(function(e){return i(e,t)}).join(", ")+(e.length>=r?", ...":"")+"]"}}();return"object"===("undefined"==typeof s?"undefined":(0,y["default"])(s))?s.v:void 0}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=void 0;var u,s,c=n(7),l=r(c),f=n(6),d=r(f),p=n(10),y=r(p),h=n(11),g=r(h),v=n(18),m=r(v),b=n(9),w=r(b),E=n(8),x=r(E),_=n(30),k=r(_),O=n(3),I=r(O),j=n(1),T=r(j),A=n(2),M=r(A),G=n(5),V=r(G),z=n(4),P=r(z),C=n(12),S=r(C),U=n(60),q=r(U),$=n(40),R=r($),N=n(26),L=r(N),F=n(23),D=r(F),B=n(13),K="global",Z=(0,B.classWithPrivateMethods)((s=function(e){function t(){return(0,T["default"])(this,t),(0,V["default"])(this,(0,I["default"])(t).apply(this,arguments))}return(0,P["default"])(t,e),(0,M["default"])(t,[{key:"mounted",value:function(){this._typers={},this._currentUserTyping={},this.host.on("message:sending",this._onMessageSending)}},{key:"dispose",value:function(){var e;(e=(e=(e=(e=this._typers,q["default"]).call(e),L["default"]).call(e,k["default"]),R["default"]).call(e),L["default"]).call(e,"timer").forEach(function(e){return clearTimeout(e)}),(e=(e=this._currentUserTyping,q["default"]).call(e),L["default"]).call(e,"timer").forEach(function(e){return clearTimeout(e)}),this._typers=null,this.host.removeListener("message:sending",this._onMessageSending)}},{key:"reactToIsTypingEvent",value:function(e){if(!(e instanceof Object))throw new TypeError('Value of argument "event" violates contract.\n\nExpected:\nObject\n\nGot:\n'+i(e));if(!(e instanceof Object))throw new TypeError('Value of argument "event" violates contract.\n\nExpected:\nObject\n\nGot:\n'+a(e));this.host.requireUser();var t=e.data.sender_token;if(t!==this.host.currentUserId){var n=e.data.group_token,r=n||K,o="typing"===e.data.status;this.host.models.User.ensureEntity(t,{onlyPlaceholder:!1}),this._setTypingStatusOfUser(r,t,o)}}},{key:"startTyping",value:function(){function e(e,n){return t.apply(this,arguments)}var t=(0,x["default"])(w["default"].mark(function n(e){var t=arguments.length<=1||void 0===arguments[1]?!0:arguments[1];return w["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof e||e instanceof Object){n.next=2;break}throw new TypeError('Value of argument "counterPartyId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(e));case 2:if("string"==typeof e||e instanceof Object){n.next=4;break}throw new TypeError('Value of argument "counterPartyId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(e));case 4:return e=this._resolveModelId(e),this.host.requireUser(),n.next=8,this.host.api.messages.startTyping(e);case 8:e in this._currentUserTyping&&clearTimeout(this._currentUserTyping[e].timer),this._currentUserTyping[e]={},t&&(this._currentUserTyping[e].timer=this._createClearTimerForCurrentUser(e,"number"==typeof t?t:void 0));case 11:case"end":return n.stop()}},n,this)}));return e}()},{key:"stopTyping",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,x["default"])(w["default"].mark(function n(e){return w["default"].wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if("string"==typeof e||e instanceof Object){t.next=2;break}throw new TypeError('Value of argument "counterPartyId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(e));case 2:if("string"==typeof e||e instanceof Object){t.next=4;break}throw new TypeError('Value of argument "counterPartyId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(e));case 4:return e=this._resolveModelId(e),this.host.requireUser(),e in this._currentUserTyping&&(clearTimeout(this._currentUserTyping[e].timer),delete this._currentUserTyping[e]),t.next=9,this.host.api.messages.stopTyping(e);case 9:case"end":return t.stop()}},n,this)}));return e}()},{key:"_setTypingStatusOfUser",value:function(e,t,n){var r=arguments.length<=3||void 0===arguments[3]?!1:arguments[3];if("string"!=typeof e)throw new TypeError('Value of argument "contextId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));if("string"!=typeof t)throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));if("boolean"!=typeof n)throw new TypeError('Value of argument "isTyping" violates contract.\n\nExpected:\nbool\n\nGot:\n'+i(n));if("string"!=typeof e)throw new TypeError('Value of argument "contextId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));if("string"!=typeof t)throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));if("boolean"!=typeof n)throw new TypeError('Value of argument "isTyping" violates contract.\n\nExpected:\nbool\n\nGot:\n'+a(n));if(n){this._typers[e]||(this._typers[e]={});var o=t in this._typers[e];if(o&&clearTimeout(this._typers[e][t].timer),this._typers[e][t]={timer:this._createClearTimerForOtherUser(e,t)},o)return}else{if(!this._typers[e]||!this._typers[e][t])return;clearTimeout(this._typers[e][t].timer),delete this._typers[e][t]}var u=(0,m["default"])({userId:t},e!==K?{groupId:e}:null,{isTyping:n,timedOut:r});this.emit("change",u)}},{key:"_createClearTimerForOtherUser",value:function(e,t){var n=this;if("string"!=typeof e)throw new TypeError('Value of argument "contextId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));if("string"!=typeof t)throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));if("string"!=typeof e)throw new TypeError('Value of argument "contextId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));if("string"!=typeof t)throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));return setTimeout(function(){n.logger.info("auto stop typing for other typer",e,t),n._setTypingStatusOfUser(e,t,!1,!0)},this.host.config.clearTypingStatusTimeout)}},{key:"_createClearTimerForCurrentUser",value:function(e,t){var n=this;if("string"!=typeof e)throw new TypeError('Value of argument "counterPartyId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));if(null!=t&&"number"!=typeof t)throw new TypeError('Value of argument "timeout" violates contract.\n\nExpected:\n?number\n\nGot:\n'+i(t));if("string"!=typeof e)throw new TypeError('Value of argument "counterPartyId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));if(null!=t&&"number"!=typeof t)throw new TypeError('Value of argument "timeout" violates contract.\n\nExpected:\n?number\n\nGot:\n'+a(t));return setTimeout(function(){n.logger.info("auto stop typing for current user",e),n.stopTyping(e)},"number"==typeof t?t:this.host.config.clearTypingStatusTimeout)}},{key:"isUserTyping",value:function(e){if(!(e instanceof Object||"string"==typeof e))throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nObject | string\n\nGot:\n'+i(e));if(!(e instanceof Object||"string"==typeof e))throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nObject | string\n\nGot:\n'+a(e));return e=this._resolveModelId(e),this._isUserTypingInContext(K,e)}},{key:"isCurrentUserTyping",value:function(e){if(!(e instanceof Object||"string"==typeof e))throw new TypeError('Value of argument "counterPartyId" violates contract.\n\nExpected:\nObject | string\n\nGot:\n'+i(e));if(!(e instanceof Object||"string"==typeof e))throw new TypeError('Value of argument "counterPartyId" violates contract.\n\nExpected:\nObject | string\n\nGot:\n'+a(e));return e=this._resolveModelId(e),e in this._currentUserTyping}},{key:"isUserTypingInGroup",value:function(e,t){if(!(e instanceof Object||"string"==typeof e))throw new TypeError('Value of argument "groupId" violates contract.\n\nExpected:\nObject | string\n\nGot:\n'+i(e));if(!(t instanceof Object||"string"==typeof t))throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nObject | string\n\nGot:\n'+i(t));if(!(e instanceof Object||"string"==typeof e))throw new TypeError('Value of argument "groupId" violates contract.\n\nExpected:\nObject | string\n\nGot:\n'+a(e));if(!(t instanceof Object||"string"==typeof t))throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nObject | string\n\nGot:\n'+a(t));return t=this._resolveModelId(t),e=this._resolveModelId(e),this._isUserTypingInContext(e,t)}},{key:"_isUserTypingInContext",value:function(e,t){if("string"!=typeof e)throw new TypeError('Value of argument "contextId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));if("string"!=typeof t)throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));if("string"!=typeof e)throw new TypeError('Value of argument "contextId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));if("string"!=typeof t)throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));return this._typers[e]?t in this._typers[e]:!1}},{key:"_onMessageSending",value:function(e){this.stopTyping(e.counterPartyId)}}]),t}(S["default"]),o(s.prototype,"_setTypingStatusOfUser",[B.privateMethod],(0,g["default"])(s.prototype,"_setTypingStatusOfUser"),s.prototype),o(s.prototype,"_createClearTimerForOtherUser",[B.privateMethod],(0,g["default"])(s.prototype,"_createClearTimerForOtherUser"),s.prototype),o(s.prototype,"_createClearTimerForCurrentUser",[B.privateMethod],(0,g["default"])(s.prototype,"_createClearTimerForCurrentUser"),s.prototype),o(s.prototype,"_isUserTypingInContext",[B.privateMethod],(0,g["default"])(s.prototype,"_isUserTypingInContext"),s.prototype),o(s.prototype,"_onMessageSending",[B.privateMethod,D["default"]],(0,g["default"])(s.prototype,"_onMessageSending"),s.prototype),u=s))||u;t["default"]=Z,e.exports=t["default"]},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t,n,r,o){var a={};return Object.keys(r).forEach(function(e){a[e]=r[e]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},a),o&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(o):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}function a(e,t){var n=4,r=15;if(void 0===t&&(t=0),t+=1,null===e)return"null";if(void 0===e)return"void";if("string"==typeof e||"number"==typeof e||"boolean"==typeof e)return"undefined"==typeof e?"undefined":(0,g["default"])(e);if(!Array.isArray(e)){var o=(0,y["default"])(e);if(!o.length)return e.constructor&&e.constructor.name&&"Object"!==e.constructor.name?e.constructor.name:"Object";if(t>n)return"{...}";var i="  ".repeat(t-1),u=o.slice(0,r).map(function(n){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(n)?n:(0,d["default"])(n))+": "+a(e[n],t)+";"}).join("\n  "+i);return o.length>=r&&(u+="\n  "+i+"..."),e.constructor&&e.constructor.name&&"Object"!==e.constructor.name?e.constructor.name+" {\n  "+i+u+"\n"+i+"}":"{\n  "+i+u+"\n"+i+"}"}if(!(e.length>0))return"Array";var s=function(){if(t>n)return{v:"[...]"};var o=a(e[0],t);return e.every(function(e){return a(e,t)===o})?{v:o.trim()+"[]"}:{v:"["+e.slice(0,r).map(function(e){return a(e,t)}).join(", ")+(e.length>=r?", ...":"")+"]"}}();return"object"===("undefined"==typeof s?"undefined":(0,g["default"])(s))?s.v:void 0}function i(e,t){var n=4,r=15;if(void 0===t&&(t=0),t+=1,null===e)return"null";if(void 0===e)return"void";if("string"==typeof e||"number"==typeof e||"boolean"==typeof e)return"undefined"==typeof e?"undefined":(0,
g["default"])(e);if(!Array.isArray(e)){var o=(0,y["default"])(e);if(!o.length)return e.constructor&&e.constructor.name&&"Object"!==e.constructor.name?e.constructor.name:"Object";if(t>n)return"{...}";var a="  ".repeat(t-1),u=o.slice(0,r).map(function(n){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(n)?n:(0,d["default"])(n))+": "+i(e[n],t)+";"}).join("\n  "+a);return o.length>=r&&(u+="\n  "+a+"..."),e.constructor&&e.constructor.name&&"Object"!==e.constructor.name?e.constructor.name+" {\n  "+a+u+"\n"+a+"}":"{\n  "+a+u+"\n"+a+"}"}if(!(e.length>0))return"Array";var s=function(){if(t>n)return{v:"[...]"};var o=i(e[0],t);return e.every(function(e){return i(e,t)===o})?{v:o.trim()+"[]"}:{v:"["+e.slice(0,r).map(function(e){return i(e,t)}).join(", ")+(e.length>=r?", ...":"")+"]"}}();return"object"===("undefined"==typeof s?"undefined":(0,g["default"])(s))?s.v:void 0}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=void 0;var u,s,c,l,f=n(7),d=r(f),p=n(6),y=r(p),h=n(10),g=r(h),v=n(11),m=r(v),b=n(19),w=r(b),E=n(9),x=r(E),_=n(8),k=r(_),O=n(3),I=r(O),j=n(1),T=r(j),A=n(2),M=r(A),G=n(5),V=r(G),z=n(4),P=r(z),C=n(55),S=r(C),U=n(58),q=r(U),$=n(12),R=r($),N=n(14),L=r(N),F=n(15),D=new q["default"].MD5,B=(u=(0,F.decorator)(),s=(0,F.decorator)(),c=(0,F.decorator)(),l=function(e){function t(){return(0,T["default"])(this,t),(0,V["default"])(this,(0,I["default"])(t).apply(this,arguments))}return(0,P["default"])(t,e),(0,M["default"])(t,[{key:"signIn",value:function(){function e(e,n,r){return t.apply(this,arguments)}var t=(0,k["default"])(x["default"].mark(function n(e,t){var r,o,u,s,c,l=arguments.length<=2||void 0===arguments[2]?{udid:void 0}:arguments[2];return x["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof e){n.next=2;break}throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));case 2:if("string"==typeof t){n.next=4;break}throw new TypeError('Value of argument "password" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));case 4:if("string"==typeof e){n.next=6;break}throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));case 6:if("string"==typeof t){n.next=8;break}throw new TypeError('Value of argument "password" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));case 8:return r={Authorization:this.getSignInAuthHeader(e,t)},o={user_id:e,password:t,push_routing:this.config.pushAgent,version:this.config.version,device_id:l.udid,metadata:{tt_product_version:"tigerconnect_"+this.config.version,user_agent:global.navigator&&global.navigator.userAgent}},n.next=12,this.httpClient.post("/login",{headers:r,data:o});case 12:return u=n.sent,s=this.host.models.User.inject(u.data.user),c=u.data.auth,n.abrupt("return",{user:s,auth:c});case 16:case"end":return n.stop()}},n,this)}));return e}()},{key:"getSignInAuthHeader",value:function(e,t){if("string"!=typeof e)throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));if("string"!=typeof t)throw new TypeError('Value of argument "password" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));if("string"!=typeof e)throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));if("string"!=typeof t)throw new TypeError('Value of argument "password" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));return this.constructor.getSignInAuthHeader(this.config.productKey,e,t)}},{key:"signUp",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,k["default"])(x["default"].mark(function n(){var e,t,r,o,a,i,u,s,c,l,f,d,p,y,h,g=arguments.length<=0||void 0===arguments[0]?{udid:void 0,email:void 0,password:void 0,countryCode:void 0,version:void 0}:arguments[0];return x["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return e=this.config.signUpHashKey,t=this.config.signUpHashSalt,r=g.udid,o=[e,t,r].join(":"),a=D.hex(o),i=[a.substr(0,2),a.substr(a.length-2)].join(""),u=[this.config.productKey,e,t,r,i].join(":"),s=(0,S["default"])(u),c="XMPP-Anonymous "+s,l={Authorization:c},f={primary_email:g.email,unique_id:g.email,password:g.password,push_routing:this.config.pushAgent,product:this.config.productKey,country_code:g.countryCode,device_id:g.udid,version:this.config.version},n.next=13,this.httpClient.post("/signup",{headers:l,data:f});case 13:return d=n.sent,p=this.host.models.User.inject(d.data.user),y=d.data.auth,h={user:p,auth:y},this.host.emit("signUp",h),n.abrupt("return",h);case 19:case"end":return n.stop()}},n,this)}));return e}()},{key:"signOut",value:function(){function e(){return t.apply(this,arguments)}var t=(0,k["default"])(x["default"].mark(function n(){return x["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.httpClient.post("/logout"));case 1:case"end":return e.stop()}},n,this)}));return e}()},{key:"me",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,k["default"])(x["default"].mark(function n(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];return x["default"].wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.host.requireUser(),t.abrupt("return",this.find(this.host.currentUserId,e));case 2:case"end":return t.stop()}},n,this)}));return e}()},{key:"find",value:function(){function e(e,n){return t.apply(this,arguments)}var t=(0,k["default"])(x["default"].mark(function n(e){var t,r,o=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return x["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof e){n.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));case 2:if("string"==typeof e){n.next=4;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));case 4:if(o=(0,w["default"])(o,{ignoreNotFound:!1,bypassCache:!1}),this.host.requireUser(),t=null,o.bypassCache){n.next=11;break}if(t=this.host.models.User.get(e),!t||t.$placeholder){n.next=11;break}return n.abrupt("return",t);case 11:return n.next=13,this.host.api.users.find(e);case 13:if(r=n.sent,!r){n.next=19;break}t=this.host.models.User.inject(r),delete t.$placeholder,n.next=21;break;case 19:if(o.ignoreNotFound){n.next=21;break}throw new L["default"].NotFoundError(this.host.models.User.name,e);case 21:return n.abrupt("return",t);case 22:case"end":return n.stop()}},n,this)}));return e}()},{key:"refresh",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,k["default"])(x["default"].mark(function n(e){return x["default"].wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.find(e,{ignoreNotFound:!0,bypassCache:!0});case 2:case"end":return t.stop()}},n,this)}));return e}()},{key:"getById",value:function(e){if("string"!=typeof e)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));if("string"!=typeof e)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));return this.host.models.User.get(e)}},{key:"getMultiById",value:function(e){if(!Array.isArray(e)||!e.every(function(e){return"string"==typeof e}))throw new TypeError('Value of argument "ids" violates contract.\n\nExpected:\nArray<string>\n\nGot:\n'+i(e));if(!Array.isArray(e)||!e.every(function(e){return"string"==typeof e}))throw new TypeError('Value of argument "ids" violates contract.\n\nExpected:\nArray<string>\n\nGot:\n'+a(e));return this.host.models.User.getMulti(e)}}],[{key:"getSignInAuthHeader",value:function(e,t,n){if("string"!=typeof e)throw new TypeError('Value of argument "productKey" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));if("string"!=typeof t)throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));if("string"!=typeof n)throw new TypeError('Value of argument "password" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(n));if("string"!=typeof e)throw new TypeError('Value of argument "productKey" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));if("string"!=typeof t)throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));if("string"!=typeof n)throw new TypeError('Value of argument "password" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(n));var r=[e,t,n].join(":"),o=(0,S["default"])(r),u="XMPP-Simple "+o;return u}}]),t}(R["default"]),o(l.prototype,"me",[u],(0,m["default"])(l.prototype,"me"),l.prototype),o(l.prototype,"find",[s],(0,m["default"])(l.prototype,"find"),l.prototype),o(l.prototype,"refresh",[c],(0,m["default"])(l.prototype,"refresh"),l.prototype),l);t["default"]=B,e.exports=t["default"]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={Users:n(117),EventRouter:n(107),Events:n(108),Messages:n(110),Groups:n(109),DistributionLists:n(106),Organizations:n(113),Conversations:n(105),Presence:n(114),Metadata:n(111),Search:n(115),TypingStatus:n(116),Mute:n(112)};t["default"]=r,e.exports=t["default"]},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){var n=4,r=15;if(void 0===t&&(t=0),t+=1,null===e)return"null";if(void 0===e)return"void";if("string"==typeof e||"number"==typeof e||"boolean"==typeof e)return"undefined"==typeof e?"undefined":(0,f["default"])(e);if(!Array.isArray(e)){var a=(0,c["default"])(e);if(!a.length)return e.constructor&&e.constructor.name&&"Object"!==e.constructor.name?e.constructor.name:"Object";if(t>n)return"{...}";var i="  ".repeat(t-1),s=a.slice(0,r).map(function(n){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(n)?n:(0,u["default"])(n))+": "+o(e[n],t)+";"}).join("\n  "+i);return a.length>=r&&(s+="\n  "+i+"..."),e.constructor&&e.constructor.name&&"Object"!==e.constructor.name?e.constructor.name+" {\n  "+i+s+"\n"+i+"}":"{\n  "+i+s+"\n"+i+"}"}if(!(e.length>0))return"Array";var l=function(){if(t>n)return{v:"[...]"};var a=o(e[0],t);return e.every(function(e){return o(e,t)===a})?{v:a.trim()+"[]"}:{v:"["+e.slice(0,r).map(function(e){return o(e,t)}).join(", ")+(e.length>=r?", ...":"")+"]"}}();return"object"===("undefined"==typeof l?"undefined":(0,f["default"])(l))?l.v:void 0}function a(e,t){var n=4,r=15;if(void 0===t&&(t=0),t+=1,null===e)return"null";if(void 0===e)return"void";if("string"==typeof e||"number"==typeof e||"boolean"==typeof e)return"undefined"==typeof e?"undefined":(0,f["default"])(e);if(!Array.isArray(e)){var o=(0,c["default"])(e);if(!o.length)return e.constructor&&e.constructor.name&&"Object"!==e.constructor.name?e.constructor.name:"Object";if(t>n)return"{...}";var i="  ".repeat(t-1),s=o.slice(0,r).map(function(n){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(n)?n:(0,u["default"])(n))+": "+a(e[n],t)+";"}).join("\n  "+i);return o.length>=r&&(s+="\n  "+i+"..."),e.constructor&&e.constructor.name&&"Object"!==e.constructor.name?e.constructor.name+" {\n  "+i+s+"\n"+i+"}":"{\n  "+i+s+"\n"+i+"}"}if(!(e.length>0))return"Array";var l=function(){if(t>n)return{v:"[...]"};var o=a(e[0],t);return e.every(function(e){return a(e,t)===o})?{v:o.trim()+"[]"}:{v:"["+e.slice(0,r).map(function(e){return a(e,t)}).join(", ")+(e.length>=r?", ...":"")+"]"}}();return"object"===("undefined"==typeof l?"undefined":(0,f["default"])(l))?l.v:void 0}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=void 0;var i=n(7),u=r(i),s=n(6),c=r(s),l=n(10),f=r(l),d=n(30),p=r(d),y=n(24),h=r(y),g=n(46),v=r(g),m=n(9),b=r(m),w=n(8),E=r(w),x=n(18),_=r(x),k=n(66),O=r(k),I=n(161),j=r(I),T=n(146),A=r(T),M=n(32),G=r(M),V=n(162),z=r(V),P=n(126),C=r(P),S=n(19),U=r(S),q=n(155),$=r(q),R=n(147),N=r(R),L=n(35),F=r(L),D=n(17),B=r(D),K=n(63),Z=r(K),W=n(1),H=r(W),X=n(2),Q=r(X),Y=n(65),J=r(Y),ee=n(59),te=r(ee),ne=n(61),re=r(ne),oe=n(26),ae=r(oe),ie=n(142),ue=r(ie),se=n(60),ce=r(se),le=n(40),fe=r(le),de=n(29),pe=r(de),ye=(n(16),n(34)),he=r(ye),ge=n(121),ve=r(ge);he["default"].prototype.off=he["default"].prototype.removeListener;var me={idAttribute:"id",parseAttrs:J["default"],relations:{belongsTo:{},hasMany:{}},defaultValues:null,computed:{},methods:{}},be=function(){function e(t,n){var r,o=this,a=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];(0,H["default"])(this,e),this.options=(0,Z["default"])({},a,me),this.idAttribute=this.options.idAttribute,this.name=n,this.store=t,this.entitiesById={},this.entitiesList=[],this.transientAttrsStore={},this.options.relations&&this.__initRelations(),this.__initTransientAttrs(),(0,B["default"])(this.options.computed,{$entityType:{enumerable:!0,get:function(){return n}},$entityClass:{enumerable:!1,get:function(){return o}}}),this.options.computed=(0,F["default"])(this.options.computed,function(e,t,n){"function"==typeof t?e[n]={get:t,enumerable:!1}:e[n]=t},{}),this._computedKeys=(r=(r=this.options.computed,te["default"]).call(r),re["default"]).call(r,"$entityType","$entityClass","$$transientAttrs"),this._writablePropertyKeys=(r=(r=(r=this.options.computed,ue["default"]).call(r),pe["default"]).call(r,function(e){return e[1].set}),ae["default"]).call(r,N["default"]),this._relationKeys=(r=(r=(r=this.options.relations,ce["default"]).call(r),ae["default"]).call(r,$["default"]),fe["default"]).call(r)}return(0,Q["default"])(e,null,[{key:"create",value:function(e,t,n){return new this(e,t,n)}}]),(0,Q["default"])(e,[{key:"__initRelations",value:function(){var e=this,t=(0,F["default"])(this.options.relations.belongsTo,function(t,n,r){t[r]={get:function(){return e.store.get(n.type,this[n.foreignKey])},set:function(t){this[n.foreignKey]=e.store.resolveId(n.type,t)}}},{});(0,B["default"])(this.options.computed,t);var n=(0,F["default"])(this.options.relations.hasMany,function(t,n,r){t[r]={get:function(){var t=this;if(this.$$transientAttrs.relations||(this.$$transientAttrs.relations={},this.$$transientAttrs.relationsCreated={}),this.$$transientAttrs.relations[r])return this.$$transientAttrs.relations[r];var o=e.store.getAll(n.type).filter(function(r){return r[n.foreignKey]==t[e.options.idAttribute]});return this.$$transientAttrs.relations[r]=o,this.$$transientAttrs.relationsCreated[r]=!0,o},set:function(e){}}},{});(0,B["default"])(this.options.computed,n)}},{key:"__initTransientAttrs",value:function(){var e=this,t=this,n={$$transientAttrs:{enumerable:!1,get:function(){var e=this[t.options.idAttribute];return t.transientAttrsStore[e]||(t.transientAttrsStore[e]={})}}},r={};this.options.transientAttrs&&this.options.transientAttrs.forEach(function(t){e.options.defaultValues&&t in e.options.defaultValues&&(r[t]=(0,ve["default"])(e.options.defaultValues[t]),delete e.options.defaultValues[t]),n[t]={get:function(){return t in this.$$transientAttrs?this.$$transientAttrs[t]:t in r?this.$$transientAttrs[t]=r[t]:void 0},set:function(e){this.$$transientAttrs[t]=e}}}),(0,B["default"])(this.options.computed,n)}},{key:"createInstance",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?!0:arguments[1],n=this;t&&(e=this.parseAttrs(e)),this.options.defaultValues&&(0,U["default"])(e,(0,ve["default"])(this.options.defaultValues));var r={};return this._writablePropertyKeys.forEach(function(t){t in e&&(r[t]=e[t],delete e[t])}),(0,C["default"])(e,this.options.computed),(0,B["default"])(e,r),this.options.instanceEvents&&(0,B["default"])(e,he["default"].prototype),(0,B["default"])(e,this.options.methods),(0,B["default"])(e,{toPlainObject:function(e){var t=this,r={};n._computedKeys.forEach(function(e){return r[e]=t[e]});var o=(0,B["default"])({},this,r);return delete o.toPlainObject,delete o.setMaxListeners,delete o.emit,delete o.addListener,delete o.on,delete o.once,delete o.removeListener,delete o.removeAllListeners,delete o.listeners,delete o.listenerCount,delete o.off,delete o.toPlainObject,delete o._events,delete o._maxListeners,o}}),this.options.beforeCreateInstance&&this.options.beforeCreateInstance(e),e}},{key:"inject",value:function(e){var t=void 0,n=!0,r=this.is(e);if(r){if(t=e,this.entitiesById[this.resolveId(t)])return this.options.beforeInject&&this.options.beforeInject(t),this.emit("beforeInject",this,t),this.options.afterInject&&this.options.afterInject(t),this.emit("afterInject",this,t),t;n=!1}n&&(e=this.parseAttrs(e));var o=void 0,a=this.resolveId(e);if(!this.isValidId(a))throw new Error("'"+this.options.idAttribute+"' is required");return t=this.entitiesById[a],t?(this.options.beforeInject&&this.options.beforeInject(e),this.emit("beforeInject",this,e),(0,B["default"])(t,e)):(o=!0,t=r?e:this.createInstance(e,!1),this.options.beforeInject&&this.options.beforeInject(e),this.emit("beforeInject",this,e),this.entitiesById[a]=t,this.entitiesList.push(t)),this.__addToHasManyRelationships(t),this.options.afterInject&&this.options.afterInject(t),this.emit("afterInject",this,t),o&&(this.options.afterCreate&&this.options.afterCreate(t),this.emit("afterCreate",this,t)),t}},{key:"eject",value:function(e){e=this.resolveId(e);var t=this.entitiesById[e];t&&(this.__removeFromHasManyRelationships(t),delete this.entitiesById[e],(0,z["default"])(this.entitiesList,t),e in this.transientAttrsStore&&delete this.transientAttrsStore[e],this.emit("afterEject",this,t))}},{key:"touch",value:function(e){e=this.resolveId(e);var t=this.entitiesById[e];t&&this.inject((0,G["default"])({},this.options.idAttribute,e))}},{key:"__addToHasManyRelationships",value:function(e){this.__updateRelationsIfNeeded(e,"add")}},{key:"__removeFromHasManyRelationships",value:function(e){this.__updateRelationsIfNeeded(e,"remove")}},{key:"__updateRelationsIfNeeded",value:function(e,t){var n=this,r=this.store.getParentRelationshipsOfModel(this.name);r&&r.forEach(function(r){var o=n.store.get(r.parent,e[r.foreignKey]);o&&o.$$transientAttrs.relationsCreated&&o.$$transientAttrs.relationsCreated[r.relationKey]&&("add"==t?o[r.relationKey].includes(e)||o[r.relationKey].push(e):"remove"==t&&(0,z["default"])(o[r.relationKey],e))})}},{key:"ejectAll",value:function(){var e=this;(0,A["default"])(this.entitiesList,function(t){return e.eject(t)})}},{key:"parseAttrs",value:function(e){var t=this,n=(0,j["default"])(e,function(e){return t.store.isEntity(e)||t.store.isEntityArray(e)}),r=(0,O["default"])(e,(0,$["default"])(n)),o=this.options.parseAttrs((0,ve["default"])(r)),a=(0,_["default"])({},o,n);return a}},{key:"get",value:function(e){return this.entitiesById[e]||null}},{key:"getAll",value:function(){return this.entitiesList}},{key:"getMulti",value:function(e){return e.map(this.get.bind(this))}},{key:"resolveId",value:function(e){return this.isValidId(e)?e:e[this.options.idAttribute]}},{key:"isValidId",value:function(e){return"string"==typeof e||"number"==typeof e}},{key:"is",value:function(e){return e&&e.$entityClass==this}},{key:"find",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,E["default"])(b["default"].mark(function n(e){return b["default"].wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if("string"==typeof e){t.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));case 2:if("string"==typeof e){t.next=4;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+o(e));case 4:throw new"not implemented find";case 5:case"end":return t.stop()}},n,this)}));return e}()},{key:"refresh",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,E["default"])(b["default"].mark(function n(e){return b["default"].wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if("string"==typeof e||e instanceof Object){t.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(e));case 2:if("string"==typeof e||e instanceof Object){t.next=4;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+o(e));case 4:throw e=this.resolveId(e),new"not implemented refresh";case 6:case"end":return t.stop()}},n,this)}));return e}()}]),e}();(0,B["default"])(be.prototype,he["default"].prototype);var we=function(){function e(){var t=this,n=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];(0,H["default"])(this,e),this.options=n,this.models={},this.__relationsOfHasManyByContainedItem={},["inject","get","getAll","filter","resolveId","is","find","refresh"].forEach(function(e){t[e]=function(n){for(var r,o=arguments.length,a=Array(o>1?o-1:0),i=1;o>i;i++)a[i-1]=arguments[i];return(r=t.models[n])[e].apply(r,a)}})}return(0,Q["default"])(e,[{key:"defineModel",value:function(e){var t=this,n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];if(this.models[e])throw new Error(e+" already defined");n=(0,_["default"])({},this.options,n),this.models[e]=be.create(this,e,n);var r=this.models[e].options.relations.hasMany;return(0,v["default"])(r)||(0,h["default"])(r,function(n,r){t.__relationsOfHasManyByContainedItem[n.type]||(t.__relationsOfHasManyByContainedItem[n.type]=[]),t.__relationsOfHasManyByContainedItem[n.type].push((0,_["default"])({},n,{relationKey:r,parent:e}))}),this.models[e]}},{key:"getParentRelationshipsOfModel",value:function(e){return this.__relationsOfHasManyByContainedItem[e]}},{key:"isEntity",value:function(e){return e&&e.$entityClass&&e.$entityClass.constructor===be}},{key:"isEntityArray",value:function(e){return e&&Array.isArray(e)&&e.some(this.isEntity)}},{key:"clear",value:function(){(0,p["default"])(this.models).forEach(function(e){return e.ejectAll()})}}]),e}();t["default"]=we,e.exports=t["default"]},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=void 0;var o=n(19),a=r(o),i=n(24),u=r(i),s=n(18),c=r(s),l=n(28),f=r(l),d=n(1),p=r(d),y=n(2),h=r(y),g=n(16),v=n(119),m=r(v),b=n(104),w=r(b),E=n(37),x=r(E),_=function(){function e(t){var n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],r=n.logger,o=(0,f["default"])(n,["logger"]);(0,p["default"])(this,e),this.host=t,this.options=o,this.logger=r,this.store=new m["default"]((0,c["default"])({},o,{host:t,logger:r})),this.store.host=t}return(0,h["default"])(e,[{key:"defineModels",value:function(){var e=this,t={},n=(0,c["default"])({},this.options,{host:this.host,logger:this.logger});(0,u["default"])(w["default"],function(r,o){t[o]=r(e,n)}),this.models=t}},{key:"defineModel",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];t.replaceKeys=t.replaceKeys||{},(0,a["default"])(t.replaceKeys,{token:"id"});var n=(this.store,this.store.defineModel(e,(0,c["default"])({},t,{beforeCreateInstance:function(e){!e[n.idAttribute]||"serverId"in e||(e.serverId=e[n.idAttribute]),t.beforeCreateInstance&&t.beforeCreateInstance(e)},beforeInject:function(e){var r=n.get(e[n.idAttribute]);!r||"serverId"in e||(e.serverId=r.serverId),t.beforeInject&&t.beforeInject(e)},afterInject:function(e){var n=Date.now();e.$lastModified==n&&(n+=1e-5),e.$lastModified=n,t.afterInject&&t.afterInject(e)},parseAttrs:function(e){var n=x["default"].camelizeObject(e);return(0,u["default"])(t.replaceKeys,function(e,t){(0,g.replaceKey)(n,t,e)}),t.parseAttrs&&(n=t.parseAttrs(n,e)),n}})));return n}},{key:"clear",value:function(){this.store.clear()}}]),e}();t["default"]=_,e.exports=t["default"]},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(7),a=r(o),i=function(e){return JSON.parse((0,a["default"])(e))};t["default"]=i,e.exports=t["default"]},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(123),a=r(o),i=a["default"].version;i=i.replace("-dev",""),t["default"]=i,e.exports=t["default"]},function(e,t){e.exports={name:"tigerconnect","private":!0,version:"0.1.11-dev",description:"JS (web and node) SDK for TigerText",homepage:"",repository:"tigerconnect/js-sdk",author:{name:"Elad Ossadon",email:"elad@tigertext.com",url:""},main:"lib/index.js",keywords:["tigertext"],scripts:{test:"NODE_TARGET=node mocha","watch:test":"npm test -- -w","build:clean":"rimraf lib dist","build:js":"babel -d lib/ src/","build:webpack":"webpack","build:webpack:node":"webpack --target node",build:"npm run build:clean && parallelshell 'npm run build:js' 'npm run build:webpack'","build:node":"npm run build:webpack:node","watch:js":"npm run build:js -- -w","watch:webpack":"webpack --watch",watch:"npm run build:clean && parallelshell 'npm run watch:js' 'npm run watch:webpack'","debug:test":"iron-node node_modules/mocha/bin/_mocha",postinstall:"npm run build"},dependencies:{"autobind-decorator":"^1.3.3","babel-polyfill":"^6.9.1","babel-runtime":"^6.9.2",btoa:"^1.1.2",bunyan:"^1.8.1","class-private-method-decorator":"^2.0.1",eventsource:"^0.2.1","file-type":"^3.8.0","humanize-list":"^1.0.1",invariant:"^2.2.1",jshashes:"^1.0.5",lodash:"^4.13.1","lodash-bound":"^1.1.1",mime:"^1.3.4",moment:"^2.13.0","node-noop":"^1.0.0","node-uuid":"^1.4.7",request:"^2.72.0","reuse-promise":"^1.0.1",shallowequal:"^0.2.2",superagent:"^2.0.0","superagent-prefix":"0.0.2"},devDependencies:{"assets-webpack-plugin":"^3.4.0","babel-cli":"^6.10.1","babel-core":"^6.9.1","babel-loader":"^6.2.4","babel-plugin-add-module-exports":"^0.2.1","babel-plugin-conditional-compilation":"0.0.1","babel-plugin-flow-comments":"^6.3.19","babel-plugin-import-asserts":"^2.1.0","babel-plugin-lodash":"^3.2.0","babel-plugin-macros":"^1.0.15","babel-plugin-syntax-flow":"^6.8.0","babel-plugin-transform-class-properties":"^6.9.1","babel-plugin-transform-decorators-legacy":"^1.3.4","babel-plugin-transform-flow-strip-types":"^6.8.0","babel-plugin-transform-runtime":"^6.9.0","babel-plugin-typecheck":"^3.9.0","babel-preset-es2015":"^6.9.0","babel-preset-stage-0":"^6.5.0",chai:"^3.5.0",decache:"^3.1.0","dom-storage":"^2.0.2",expect:"^1.20.1","expect.js":"^0.3.1",gulp:"^3.9.1","gulp-debug":"^2.1.2","gulp-exec":"^2.1.2","gulp-file":"^0.3.0","gulp-load-plugins":"^1.2.4","gulp-uglify":"^1.5.3","gulp-util":"^3.0.7","json-loader":"^0.5.4","lodash-webpack-plugin":"^0.9.1",mocha:"^2.5.3","mocha-babel":"^3.0.3","mocha-clean":"^1.0.0",nock:"^8.0.0",parallelshell:"^2.0.0","performance-now":"^0.2.0","require-dir":"^0.3.0",rimraf:"^2.5.2",sinon:"^1.17.4",sleep:"^3.0.1","strip-loader":"^0.1.2",timekeeper:"0.1.1",tmatch:"^2.0.1",watch:"^0.18.0",webpack:"^1.13.1","webpack-node-externals":"^1.2.0",yargs:"^4.7.1"},license:{type:"Commercial",url:"http://www.tigertext.com/developer-terms-of-use/"}}},function(e,t,n){function r(e){return n(o(e))}function o(e){return a[e]||function(){throw new Error("Cannot find module '"+e+"'.")}()}var a={"./node":53,"./node.js":53,"./web":54,"./web.js":54};r.keys=function(){return Object.keys(a)},r.resolve=o,e.exports=r,r.id=124},function(e,t){e.exports=require("babel-polyfill")},function(e,t){e.exports=require("babel-runtime/core-js/object/define-properties")},function(e,t){e.exports=require("babel-runtime/core-js/object/entries")},function(e,t){e.exports=require("babel-runtime/core-js/object/freeze")},function(e,t){e.exports=require("babel-runtime/core-js/set")},function(e,t){e.exports=require("babel-runtime/helpers/slicedToArray")},function(e,t){e.exports=require("eventsource")},function(e,t){e.exports=require("http")},function(e,t){e.exports=require("humanize-list")},function(e,t){e.exports=require("invariant")},function(e,t){e.exports=require("lodash-bound/compact")},function(e,t){e.exports=require("lodash-bound/find")},function(e,t){e.exports=require("lodash-bound/first")},function(e,t){e.exports=require("lodash-bound/keyBy")},function(e,t){e.exports=require("lodash-bound/mapValues")},function(e,t){e.exports=require("lodash-bound/pickBy")},function(e,t){e.exports=require("lodash-bound/reject")},function(e,t){e.exports=require("lodash-bound/toPairs")},function(e,t){e.exports=require("lodash/assign")},function(e,t){e.exports=require("lodash/chunk")},function(e,t){e.exports=require("lodash/compact")},function(e,t){e.exports=require("lodash/eachRight")},function(e,t){e.exports=require("lodash/first")},function(e,t){e.exports=require("lodash/groupBy")},function(e,t){e.exports=require("lodash/head")},function(e,t){e.exports=require("lodash/includes")},function(e,t){e.exports=require("lodash/invert")},function(e,t){e.exports=require("lodash/isArray")},function(e,t){e.exports=require("lodash/isObject")},function(e,t){e.exports=require("lodash/keyBy")},function(e,t){e.exports=require("lodash/keys")},function(e,t){e.exports=require("lodash/last")},function(e,t){e.exports=require("lodash/map")},function(e,t){e.exports=require("lodash/mapKeys")},function(e,t){e.exports=require("lodash/memoize")},function(e,t){e.exports=require("lodash/orderBy")},function(e,t){e.exports=require("lodash/pickBy")},function(e,t){e.exports=require("lodash/pull")},function(e,t){e.exports=require("lodash/reduce")},function(e,t){e.exports=require("lodash/snakeCase")},function(e,t){e.exports=require("lodash/sortBy")},function(e,t){e.exports=require("lodash/union")},function(e,t){e.exports=require("lodash/uniq")},function(e,t){e.exports=require("lodash/without")},function(e,t){e.exports=require("lodash/xor")},function(e,t){e.exports=require("lodash/zipObject")},function(e,t){e.exports=require("mime")},function(e,t){e.exports=require("node-noop")},function(e,t){e.exports=require("request")},function(e,t){e.exports=require("superagent")},function(e,t){e.exports=require("superagent-prefix")}]);