module.exports=function(t){function e(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return t[r].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){"use strict";e.__esModule=!0,global._babelPolyfill||n(125);var r="node";n(124)("./"+r);var o=n(71),a=e.Client=o;a.Client=a,e["default"]=a,t.exports=a},function(t,e){t.exports=require("babel-runtime/helpers/classCallCheck")},function(t,e){t.exports=require("babel-runtime/helpers/inherits")},function(t,e){t.exports=require("babel-runtime/helpers/possibleConstructorReturn")},function(t,e){t.exports=require("babel-runtime/core-js/object/keys")},function(t,e){t.exports=require("babel-runtime/core-js/json/stringify")},function(t,e){t.exports=require("babel-runtime/helpers/asyncToGenerator")},function(t,e){t.exports=require("babel-runtime/regenerator")},function(t,e){t.exports=require("babel-runtime/helpers/typeof")},function(t,e){t.exports=require("babel-runtime/core-js/object/get-own-property-descriptor")},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){var n=4,r=15;if(void 0===e&&(e=0),e+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return"undefined"==typeof t?"undefined":(0,h["default"])(t);if(!Array.isArray(t)){var a=(0,c["default"])(t);if(!a.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(e>n)return"{...}";var i="  ".repeat(e-1),u=a.slice(0,r).map(function(n){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(n)?n:(0,s["default"])(n))+": "+o(t[n],e)+";"}).join("\n  "+i);return a.length>=r&&(u+="\n  "+i+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+i+u+"\n"+i+"}":"{\n  "+i+u+"\n"+i+"}"}if(!(t.length>0))return"Array";var f=function(){if(e>n)return{v:"[...]"};var a=o(t[0],e);return t.every(function(t){return o(t,e)===a})?{v:a.trim()+"[]"}:{v:"["+t.slice(0,r).map(function(t){return o(t,e)}).join(", ")+(t.length>=r?", ...":"")+"]"}}();return"object"===("undefined"==typeof f?"undefined":(0,h["default"])(f))?f.v:void 0}function a(t,e){var n=4,r=15;if(void 0===e&&(e=0),e+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return"undefined"==typeof t?"undefined":(0,h["default"])(t);if(!Array.isArray(t)){var o=(0,c["default"])(t);if(!o.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(e>n)return"{...}";var i="  ".repeat(e-1),u=o.slice(0,r).map(function(n){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(n)?n:(0,s["default"])(n))+": "+a(t[n],e)+";"}).join("\n  "+i);return o.length>=r&&(u+="\n  "+i+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+i+u+"\n"+i+"}":"{\n  "+i+u+"\n"+i+"}"}if(!(t.length>0))return"Array";var f=function(){if(e>n)return{v:"[...]"};var o=a(t[0],e);return t.every(function(t){return a(t,e)===o})?{v:o.trim()+"[]"}:{v:"["+t.slice(0,r).map(function(t){return a(t,e)}).join(", ")+(t.length>=r?", ...":"")+"]"}}();return"object"===("undefined"==typeof f?"undefined":(0,h["default"])(f))?f.v:void 0}e.__esModule=!0,e["default"]=void 0;var i=n(5),s=r(i),u=n(4),c=r(u),f=n(38),l=r(f),d=n(39),p=r(d),y=n(8),h=r(y),g=n(16),v=r(g),m=n(1),b=r(m),w=n(65),E=r(w),x=n(27),_=r(x),I=n(25),O=r(I),T=n(15),j=function(){function t(e,n){(0,b["default"])(this,t),(0,v["default"])(this,n),this.host=e,this.config=e.config,this.httpClient=e.httpClient}return t.prototype._resolveModelId=function(t){if(!(null==t||"string"==typeof t||null==t||t instanceof Object))throw new TypeError('Value of argument "thing" violates contract.\n\nExpected:\n?string | ?Object\n\nGot:\n'+a(t));if(!(null==t||"string"==typeof t||null==t||t instanceof Object))throw new TypeError('Value of argument "thing" violates contract.\n\nExpected:\n?string | ?Object\n\nGot:\n'+o(t));return"string"==typeof t?t:t?t.serverId||t.id||null:null},t.prototype._resolveModelIdWithTypes=function(t,e){if(!(null==t||"string"==typeof t||null==t||t instanceof Object))throw new TypeError('Value of argument "thing" violates contract.\n\nExpected:\n?string | ?Object\n\nGot:\n'+a(t));if(!("string"==typeof e||Array.isArray(e)&&e.every(function(t){return"string"==typeof t})))throw new TypeError('Value of argument "allowedEntityTypes" violates contract.\n\nExpected:\nstring | string[]\n\nGot:\n'+a(e));if(!(null==t||"string"==typeof t||null==t||t instanceof Object))throw new TypeError('Value of argument "thing" violates contract.\n\nExpected:\n?string | ?Object\n\nGot:\n'+o(t));if(!("string"==typeof e||Array.isArray(e)&&e.every(function(t){return"string"==typeof t})))throw new TypeError('Value of argument "allowedEntityTypes" violates contract.\n\nExpected:\nstring | string[]\n\nGot:\n'+o(e));if(!t)return null;if("string"==typeof t){var n=this._resolveEntity(t);if(!n)return t;t=n}return O["default"].oneOf("thing",t.$entityType,(0,T.arrayWrap)(e)),t.serverId||t.id||null},t.prototype._resolveEntity=function(t,e){if(!(null==t||"string"==typeof t||null==t||t instanceof Object))throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\n?string | ?Object\n\nGot:\n'+a(t));if(!(null==e||"string"==typeof e||null==e||Array.isArray(e)&&e.every(function(t){return"string"==typeof t})))throw new TypeError('Value of argument "types" violates contract.\n\nExpected:\n?string | ?string[]\n\nGot:\n'+a(e));if(!(null==t||"string"==typeof t||null==t||t instanceof Object))throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\n?string | ?Object\n\nGot:\n'+o(t));if(!(null==e||"string"==typeof e||null==e||Array.isArray(e)&&e.every(function(t){return"string"==typeof t})))throw new TypeError('Value of argument "types" violates contract.\n\nExpected:\n?string | ?string[]\n\nGot:\n'+o(e));if(e||(e=this.host.allModelEntityTypes),e=(0,T.arrayWrap)(e),"object"===("undefined"==typeof t?"undefined":(0,h["default"])(t)))return e.includes(t.$entityType)?t:null;if(!e||"function"!=typeof e[p["default"]]&&!Array.isArray(e))throw new TypeError("Expected types to be iterable, got "+o(e));if(!e||"function"!=typeof e[p["default"]]&&!Array.isArray(e))throw new TypeError("Expected types to be iterable, got "+a(e));for(var n=e,r=Array.isArray(n),i=0,n=r?n:(0,l["default"])(n);;){var s;if(r){if(i>=n.length)break;s=n[i++]}else{if(i=n.next(),i.done)break;s=i.value}var u=s,c=this.host.modelsByEntityType[u].get(t);if(c)return c;if(c=(0,E["default"])(this.host.modelsByEntityType[u].getAll(),{serverId:t}))return c}return null},t.prototype.mounted=function(){},t.prototype.dispose=function(){},t}();e["default"]=j,(0,v["default"])(j.prototype,_["default"].prototype),t.exports=e["default"]},function(t,e){t.exports=require("babel-runtime/helpers/extends")},function(t,e){t.exports=require("class-private-method-decorator")},function(t,e,n){"use strict";e.__esModule=!0,e["default"]={NotSignedInError:n(85),WrongCredentialsError:n(88),NotFoundError:n(84),PermissionDeniedError:n(86),ValidationError:n(48),TargetNotSupportedError:n(87),ConnectionUnavailableError:n(83)},t.exports=e["default"]},function(t,e){t.exports=require("reuse-promise")},function(t,e){"use strict";function n(){return r(this)}function r(t){return Array.isArray(t)?t:void 0!=t&&null!=t?[t]:[]}function o(t,e,n){!(n in t)&&e in t&&(t[n]=t[e],delete t[e])}e.__esModule=!0,e.arrayWrapBound=n,e.arrayWrap=r,e.replaceKey=o},function(t,e){t.exports=require("babel-runtime/core-js/object/assign")},function(t,e){t.exports=require("babel-runtime/core-js/promise")},function(t,e){t.exports=require("lodash/defaults")},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function o(){var t=arguments.length<=0||void 0===arguments[0]?{fallbackValue:null,httpStatusCodes:[404]}:arguments[0];return function(e,n,r){var o=r.value;return r.value=function(){var e=(0,u["default"])(i["default"].mark(function n(){var e,r,a,s=arguments;return i["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:for(n.prev=0,e=s.length,r=Array(e),a=0;a<e;a++)r[a]=s[a];return n.next=4,o.call.apply(o,[this].concat(r));case 4:return n.abrupt("return",n.sent);case 7:if(n.prev=7,n.t0=n["catch"](0),!n.t0.response||!t.httpStatusCodes.includes(n.t0.response.status)){n.next=13;break}return n.abrupt("return",t.fallbackValue);case 13:throw n.t0;case 14:case"end":return n.stop()}},n,this,[[0,7]])}));return function(t){return e.apply(this,arguments)}}(),r}}e.__esModule=!0,e["default"]=void 0;var a=n(7),i=r(a),s=n(6),u=r(s),c=n(16),f=r(c),l=n(1),d=r(l);e.recoverFromNotFound=o;var p=n(27),y=r(p),h=function g(t,e){(0,d["default"])(this,g),(0,f["default"])(this,e),this.config=t.config,this.host=t,this.httpClient=t.httpClient};e["default"]=h,(0,f["default"])(h.prototype,y["default"].prototype)},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}e.__esModule=!0,e.ServerValueEnum=e["default"]=void 0;var o=n(3),a=r(o),i=n(2),s=r(i),u=n(129),c=r(u),f=n(11),l=r(f),d=n(1),p=r(d),y=n(151),h=r(y),g=n(35),v=r(g),m=function(){function t(e){var n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];(0,p["default"])(this,t),Array.isArray(e)&&(e=e.reduce(function(t,e){return t[e]={},t},{})),this.keys=[],this.entries=[],this.entriesByKey={},this.defaultValue=n.defaultValue||null;for(var r in e){this[r]=r;var o=(0,l["default"])({key:r},e[r]);this.entriesByKey[r]=o,this.entries.push(o),this.keys.push(r)}(0,c["default"])(this.keys),(0,c["default"])(this.entries),(0,c["default"])(this.entriesByKey)}return t.prototype.resolve=function(t){return t||this.defaultValue},t.prototype.isValid=function(t){return!!this.entriesByKey[t]},t}();e["default"]=m,e.ServerValueEnum=function(t){function e(){return(0,p["default"])(this,e),(0,a["default"])(this,t.apply(this,arguments))}return(0,s["default"])(e,t),e.prototype.mapEnumKeyToServerValue=function(){return this._mapEnumKeyToServerValue||(this._mapEnumKeyToServerValue=(0,v["default"])(this.entries,function(t,e){return t[e.key]=e.serverValue},{}))},e.prototype.mapServerValueToEnumKey=function(){return this._mapServerValueToEnumKey||(this._mapServerValueToEnumKey=(0,h["default"])(this.mapEnumKeyToServerValue()))},e.prototype.fromServer=function(t){return this.mapServerValueToEnumKey()[t]},e.prototype.toServer=function(t){return this.mapEnumKeyToServerValue()[t]||this.mapServerValueToEnumKey()[t]},e.prototype.resolve=function(t){return(this.isValid(t)?t:this.fromServer(t))||this.defaultValue},e}(m)},function(t,e){t.exports=require("autobind-decorator")},function(t,e){t.exports=require("lodash/each")},function(t,e,n){"use strict";e.__esModule=!0,e["default"]={MessageRecipientStatus:n(37),MessageSenderStatus:n(102),MessageDirection:n(100),PresenceStatus:n(49),GroupType:n(99),MessageType:n(103),MessagePriority:n(101)},t.exports=e["default"]},function(t,e){t.exports=require("lodash-bound/map")},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}e.__esModule=!0;var o=n(4),a=r(o),i=n(48),s=r(i),u={isOneOf:function(t,e,n){return n.includes(e)},isNotEmpty:function(t,e){return!!e},raise:function(t){var e=arguments.length<=1||void 0===arguments[1]?"invalid":arguments[1],n=arguments[2];throw new s["default"](t,e,n)}};(0,a["default"])(u).forEach(function(t){var e=t.replace(/^is([A-Z])/,function(t,e){return e.toLowerCase()}),n=u[t];u[e]=function(t,e,r){for(var o=arguments.length,a=Array(o>3?o-3:0),i=3;i<o;i++)a[i-3]=arguments[i];n.apply(void 0,[t,e,r].concat(a))||u.raise(t,void 0,r)}}),e["default"]=u,t.exports=e["default"]},function(t,e){t.exports=require("babel-runtime/helpers/objectWithoutProperties")},function(t,e){t.exports=require("events")},function(t,e){t.exports=require("lodash-bound/filter")},function(t,e){t.exports=require("lodash/pick")},function(t,e){t.exports=require("lodash/values")},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function o(t,e,n){var r=arguments.length<=3||void 0===arguments[3]?{}:arguments[3],o=t.get(e);if(o)o.$placeholder?o.$$loading||o.$notFound||r.onlyPlaceholder||a(t,o,r):(r.onExists&&r.onExists(o),r.onFinish&&r.onFinish(o));else{var i;if(n=(0,_["default"])((i={},i[t.idAttribute]=e,i),n),r.onMissing&&r.onMissing(),o=t.createInstance(n),Object.defineProperty(o,"$placeholder",{value:!0,configurable:!0}),t.inject(o),r.onlyPlaceholder)return o;a(t,o,r)}}function a(t,e,n){var r=G(e);if(!M[r]){if(!n.placeholderEntityDelayBeforeRefreshing){var o;return T(t,e,n)["catch"]((o=console).error.bind(o))}Object.defineProperty(e,"$$loadingScheduled",{value:!0,configurable:!0}),M[r]=setTimeout(function(){return j(t,e,n)},n.placeholderEntityDelayBeforeRefreshing)}}function i(t,e){var n=e.finder,r=e.defaultPlaceholderAttrs,a=e.defaultNotFoundAttrs,i=e.placeholderEntityDelayBeforeRefreshing,s=e.placeholderEntityAllowLoading,f=e.shouldEnsure;if(null==arguments[1]||null!=arguments[1].finder&&"function"!=typeof arguments[1].finder||!(null==arguments[1].defaultPlaceholderAttrs||arguments[1].defaultPlaceholderAttrs instanceof Object)||!(null==arguments[1].defaultNotFoundAttrs||arguments[1].defaultNotFoundAttrs instanceof Object)||null!=arguments[1].placeholderEntityDelayBeforeRefreshing&&"function"!=typeof arguments[1].placeholderEntityDelayBeforeRefreshing&&null!=arguments[1].placeholderEntityDelayBeforeRefreshing&&"number"!=typeof arguments[1].placeholderEntityDelayBeforeRefreshing||null!=arguments[1].placeholderEntityAllowLoading&&"function"!=typeof arguments[1].placeholderEntityAllowLoading&&null!=arguments[1].placeholderEntityAllowLoading&&"boolean"!=typeof arguments[1].placeholderEntityAllowLoading||null!=arguments[1].shouldEnsure&&"function"!=typeof arguments[1].shouldEnsure)throw new TypeError("Value of argument 1 violates contract.\n\nExpected:\n{\n  finder: ?Function;\n  defaultPlaceholderAttrs: ?Object;\n  defaultNotFoundAttrs: ?Object;\n  placeholderEntityDelayBeforeRefreshing: ?Function | ?number;\n  placeholderEntityAllowLoading: ?Function | ?bool;\n  shouldEnsure: ?Function;\n}\n\nGot:\n"+c(arguments[1]));if(null==arguments[1]||null!=arguments[1].finder&&"function"!=typeof arguments[1].finder||!(null==arguments[1].defaultPlaceholderAttrs||arguments[1].defaultPlaceholderAttrs instanceof Object)||!(null==arguments[1].defaultNotFoundAttrs||arguments[1].defaultNotFoundAttrs instanceof Object)||null!=arguments[1].placeholderEntityDelayBeforeRefreshing&&"function"!=typeof arguments[1].placeholderEntityDelayBeforeRefreshing&&null!=arguments[1].placeholderEntityDelayBeforeRefreshing&&"number"!=typeof arguments[1].placeholderEntityDelayBeforeRefreshing||null!=arguments[1].placeholderEntityAllowLoading&&"function"!=typeof arguments[1].placeholderEntityAllowLoading&&null!=arguments[1].placeholderEntityAllowLoading&&"boolean"!=typeof arguments[1].placeholderEntityAllowLoading||null!=arguments[1].shouldEnsure&&"function"!=typeof arguments[1].shouldEnsure)throw new TypeError("Value of argument 1 violates contract.\n\nExpected:\n{\n  finder: ?Function;\n  defaultPlaceholderAttrs: ?Object;\n  defaultNotFoundAttrs: ?Object;\n  placeholderEntityDelayBeforeRefreshing: ?Function | ?number;\n  placeholderEntityAllowLoading: ?Function | ?bool;\n  shouldEnsure: ?Function;\n}\n\nGot:\n"+u(arguments[1]));t.ensureEntity=function(e){var u=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return t.shouldEnsure?("function"==typeof i&&(i=i()),"function"==typeof s&&(s=s()),o(t,e,(0,_["default"])({},r,u.attrs),(0,_["default"])({finder:n,notFoundAttributes:a,placeholderEntityDelayBeforeRefreshing:i,placeholderEntityAllowLoading:s},u))):null},t.shouldEnsure=function(e,n){var r=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];return"string"==typeof e&&(e=t.get(e)),!e||!(!f||!f(e,n,r))||!(!e.$placeholder||e.$$loading||n)}}function s(){(0,O["default"])(M).map(function(t){return clearTimeout(t)}),M={}}function u(t,e){var n=4,r=15;if(void 0===e&&(e=0),e+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return"undefined"==typeof t?"undefined":(0,h["default"])(t);if(!Array.isArray(t)){var o=(0,p["default"])(t);if(!o.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(e>n)return"{...}";var a="  ".repeat(e-1),i=o.slice(0,r).map(function(n){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(n)?n:(0,l["default"])(n))+": "+u(t[n],e)+";"}).join("\n  "+a);return o.length>=r&&(i+="\n  "+a+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+a+i+"\n"+a+"}":"{\n  "+a+i+"\n"+a+"}"}if(!(t.length>0))return"Array";var s=function(){if(e>n)return{v:"[...]"};var o=u(t[0],e);return t.every(function(t){return u(t,e)===o})?{v:o.trim()+"[]"}:{v:"["+t.slice(0,r).map(function(t){return u(t,e)}).join(", ")+(t.length>=r?", ...":"")+"]"}}();return"object"===("undefined"==typeof s?"undefined":(0,h["default"])(s))?s.v:void 0}function c(t,e){var n=4,r=15;if(void 0===e&&(e=0),e+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return"undefined"==typeof t?"undefined":(0,h["default"])(t);if(!Array.isArray(t)){var o=(0,p["default"])(t);if(!o.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(e>n)return"{...}";var a="  ".repeat(e-1),i=o.slice(0,r).map(function(n){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(n)?n:(0,l["default"])(n))+": "+c(t[n],e)+";"}).join("\n  "+a);return o.length>=r&&(i+="\n  "+a+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+a+i+"\n"+a+"}":"{\n  "+a+i+"\n"+a+"}"}if(!(t.length>0))return"Array";var s=function(){if(e>n)return{v:"[...]"};var o=c(t[0],e);return t.every(function(t){return c(t,e)===o})?{v:o.trim()+"[]"}:{v:"["+t.slice(0,r).map(function(t){return c(t,e)}).join(", ")+(t.length>=r?", ...":"")+"]"}}();return"object"===("undefined"==typeof s?"undefined":(0,h["default"])(s))?s.v:void 0}e.__esModule=!0;var f=n(5),l=r(f),d=n(4),p=r(d),y=n(8),h=r(y),g=n(7),v=r(g),m=n(16),b=r(m),w=n(6),E=r(w),x=n(11),_=r(x),I=n(30),O=r(I),T=function(){var t=(0,E["default"])(v["default"].mark(function e(t,n,r){var o;return v["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r.placeholderEntityAllowLoading){e.next=2;break}return e.abrupt("return");case 2:return Object.defineProperty(n,"$$loading",{value:!0,configurable:!0}),o=void 0,e.prev=4,e.next=7,r.finder(n.id);case 7:e.next=18;break;case 9:if(e.prev=9,e.t0=e["catch"](4),e.t0.code!==k["default"].NotFoundError.CODE){e.next=15;break}o=!0,e.next=18;break;case 15:e.next=18;break;case 18:delete n.$$loading,o?((0,b["default"])(n,r.notFoundAttributes),Object.defineProperty(n,"$notFound",{value:!0,configurable:!0}),t.touch(n),r.onNotFound&&r.onNotFound(),r.onLoad&&r.onLoad(null),r.onFinish&&r.onFinish(null)):(delete n.$placeholder,delete n.$notFound,t.touch(n),r.onSuccess&&r.onSuccess(n),r.onLoad&&r.onLoad(n),r.onFinish&&r.onFinish(n));case 20:case"end":return e.stop()}},e,this,[[4,9]])}));return function(e,n,r){return t.apply(this,arguments)}}(),j=function(){var t=(0,E["default"])(v["default"].mark(function e(t,n,r){return v["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,delete n.$$loadingScheduled,delete M[G(n)],n.$placeholder){e.next=5;break}return e.abrupt("return");case 5:return e.abrupt("return",T(t,n,r));case 8:e.prev=8,e.t0=e["catch"](0),console.error(e.t0);case 11:case"end":return e.stop()}},e,this,[[0,8]])}));return function(e,n,r){return t.apply(this,arguments)}}();e["default"]=i,e.dispose=s;var A=n(13),k=r(A),M={},G=function(t){return t.$entityType+":"+t.id}},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){return(0,l["default"])(t)?t.map(function(t){return o(t,e)}):(0,c["default"])(t)?(0,s["default"])(t,function(t,n,r){t[e(r)]=o(n,e)},{}):t}e.__esModule=!0;var a=n(4),i=(r(a),n(35)),s=r(i),u=n(153),c=r(u),f=n(152),l=r(f),d=n(165),p=r(d),y=n(62),h=r(y),g=n(159),v=r(g),m={camelizeKey:(0,v["default"])(h["default"]),underscoreKey:(0,v["default"])(p["default"]),camelizeObject:function(t){return o(t,m.camelizeKey)},underscoreObject:function(t){return o(t,m.underscoreKey)}};e["default"]=m,t.exports=e["default"]},function(t,e){t.exports=require("lodash/get")},function(t,e){t.exports=require("lodash/isEmpty")},function(t,e){t.exports=require("lodash/transform")},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}e.__esModule=!0;var o=n(20),a=r(o),i=new a["default"](["ONLINE","OFFLINE","CONNECTING","UNREACHABLE"]);e["default"]=i,t.exports=e["default"]},function(t,e,n){"use strict";e.__esModule=!0;var r=n(20),o=new r.ServerValueEnum({READ:{serverValue:"Read"},DELIVERED:{serverValue:"Delivered"},RECEIVED_ON_CLIENT:{serverValue:"ReceivedOnClient"},NEW:{serverValue:"New"},NA:{key:"NA"}});e["default"]=o,t.exports=e["default"]},function(t,e){t.exports=require("babel-runtime/core-js/get-iterator")},function(t,e){t.exports=require("babel-runtime/core-js/symbol/iterator")},function(t,e){t.exports=require("btoa")},function(t,e){t.exports=require("lodash-bound/flatten")},function(t,e){t.exports=require("lodash-bound/orderBy")},function(t,e){t.exports=require("lodash-bound/uniq")},function(t,e){t.exports=require("lodash/filter")},function(t,e){t.exports=require("lodash/omit")},function(t,e){t.exports=require("lodash/throttle")},function(t,e){t.exports=require("moment")},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}e.__esModule=!0,e["default"]=void 0;var o,a,i=n(1),s=r(i),u=n(3),c=r(u),f=n(2),l=r(f),d=(a=o=function(t){function e(n){var r=arguments.length<=1||void 0===arguments[1]?"invalid":arguments[1],o=arguments.length<=2||void 0===arguments[2]?n+" is "+r:arguments[2];(0,s["default"])(this,e);var a=(0,c["default"])(this,t.call(this,o));return a.code=e.CODE,a.name=n,a.reason=r,a}return(0,l["default"])(e,t),e}(Error),o.CODE="validation",a);e["default"]=d,t.exports=e["default"]},function(t,e,n){"use strict";e.__esModule=!0;var r=n(20),o=new r.ServerValueEnum({UNKNOWN:{serverValue:"unknown"},AVAILABLE:{serverValue:"available"},UNAVAILABLE:{serverValue:"unavailable"}});e["default"]=o,t.exports=e["default"]},function(t,e,n){"use strict";e.__esModule=!0;var r={Event:n(91),SearchResult:n(97)};e["default"]=r,t.exports=e["default"]},function(t,e,n){},function(t,e,n){"use strict";!function(){try{var t=n(133).request().constructor.prototype;t.setNoDelay||(t.setNoDelay=function(){}),t.abort||(t.abort=function(){this.xhr&&this.xhr.abort()})}catch(e){}}()},function(t,e){t.exports=require("file-type")},function(t,e){t.exports=require("fs")},function(t,e){t.exports=require("jshashes")},function(t,e){t.exports=require("lodash-bound/keyBy")},function(t,e){t.exports=require("lodash-bound/keys")},function(t,e){t.exports=require("lodash-bound/mapValues")},function(t,e){t.exports=require("lodash-bound/omitBy")},function(t,e){t.exports=require("lodash-bound/values")},function(t,e){t.exports=require("lodash-bound/without")},function(t,e){t.exports=require("lodash/camelCase")},function(t,e){t.exports=require("lodash/defaultsDeep")},function(t,e){t.exports=require("lodash/difference")},function(t,e){t.exports=require("lodash/find")},function(t,e){t.exports=require("lodash/identity")},function(t,e){t.exports=require("lodash/sumBy")},function(t,e){t.exports=require("node-uuid")},function(t,e){t.exports=require("path")},function(t,e){t.exports=require("shallowequal")},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function o(t,e,n,r,o){var a={};return Object.keys(r).forEach(function(t){a[t]=r[t]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=n.slice().reverse().reduce(function(n,r){return r(t,e,n)||n},a),o&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(o):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(t,e,a),a=null),a}function a(t,e){var n=4,r=15;if(void 0===e&&(e=0),e+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return"undefined"==typeof t?"undefined":(0,p["default"])(t);if(!Array.isArray(t)){var o=(0,O["default"])(t);if(!o.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(e>n)return"{...}";var i="  ".repeat(e-1),s=o.slice(0,r).map(function(n){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(n)?n:(0,l["default"])(n))+": "+a(t[n],e)+";"}).join("\n  "+i);return o.length>=r&&(s+="\n  "+i+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+i+s+"\n"+i+"}":"{\n  "+i+s+"\n"+i+"}"}if(!(t.length>0))return"Array";var u=function(){if(e>n)return{v:"[...]"};var o=a(t[0],e);return t.every(function(t){return a(t,e)===o})?{v:o.trim()+"[]"}:{v:"["+t.slice(0,r).map(function(t){return a(t,e)}).join(", ")+(t.length>=r?", ...":"")+"]"}}();return"object"===("undefined"==typeof u?"undefined":(0,p["default"])(u))?u.v:void 0}function i(t,e){var n=4,r=15;if(void 0===e&&(e=0),e+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return"undefined"==typeof t?"undefined":(0,p["default"])(t);if(!Array.isArray(t)){var o=(0,O["default"])(t);if(!o.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(e>n)return"{...}";var a="  ".repeat(e-1),s=o.slice(0,r).map(function(n){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(n)?n:(0,l["default"])(n))+": "+i(t[n],e)+";"}).join("\n  "+a);return o.length>=r&&(s+="\n  "+a+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+a+s+"\n"+a+"}":"{\n  "+a+s+"\n"+a+"}"}if(!(t.length>0))return"Array";var u=function(){if(e>n)return{v:"[...]"};var o=i(t[0],e);return t.every(function(t){return i(t,e)===o})?{v:o.trim()+"[]"}:{v:"["+t.slice(0,r).map(function(t){return i(t,e)}).join(", ")+(t.length>=r?", ...":"")+"]"}}();return"object"===("undefined"==typeof u?"undefined":(0,p["default"])(u))?u.v:void 0}e.__esModule=!0;var s,u,c,f=n(5),l=r(f),d=n(8),p=r(d),y=n(9),h=r(y),g=n(16),v=r(g),m=n(17),b=r(m),w=n(7),E=r(w),x=n(6),_=r(x),I=n(4),O=r(I),T=n(11),j=r(T),A=n(1),k=r(A),M=n(131),G=r(M),V=n(161),z=r(V),C=n(22),S=r(C),P=n(62),N=r(P),R=n(158),U=r(R),q=n(18),F=r(q),$=n(73),L=r($),D=n(72),B=r(D),K=n(27),Z=r(K),W=n(68),H=r(W),X=n(13),Q=r(X),Y=n(82),J=r(Y),tt=n(118),et=r(tt),nt=n(120),rt=r(nt),ot=n(23),at=r(ot),it=n(135),st=r(it),ut=(n(12),n(21)),ct=r(ut),ft=n(122),lt=r(ft),dt=n(36),pt=r(dt),yt="UpM28mnfW65vJkbqEATtKvxm",ht={production:"https://developer.tigertext.me/v2",uat:"https://uat-devapi.tigertext.me/v2",qa:"https://qa-devapi.tigertext.me/v2",productionOauth:"http://52.41.133.15:8000/tigertextapi/v2"},gt={events:{autoAck:!1,isTyping:!0,multiOrg:!0,noOfflineMessages:!1,autoDeliver:!1,hidden:!1,closeAfterMessages:!1},autoAckSuccessfullyHandledEvents:!0,logLevel:"error",serviceLogLevels:{},eventsAutoReconnect:!0,flushAckInterval:2e3,flushAckMaxEvents:500,flushSetMessageStatusInterval:1e3,flushMessageMaxCount:500,conversationReloadDelay:200,eventsAutoReconnectDelay:2e3,clearTypingStatusTimeout:15e3,organizationRostersChangeThrottleDelay:500,placeholderEntityAllowLoading:!0,placeholderEntityDelayBeforeRefreshing:100,consumerOrganizationId:yt,maxMetadataKeyCount:8,pushAgent:"consumer",baseUrl:null,apiEnv:"production",productKey:"bc1oOf3DZXbnaNZ2LCWZGvSg",version:"1.0",autoSignOutOnBrowserUnload:!1,authStrategy:"basic"},vt=(c=u=function(){function t(){var e=this,n=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];if((0,k["default"])(this,t),this.VERSION=lt["default"],this.version=lt["default"],!(null==n||n instanceof Object))throw new TypeError('Value of argument "config" violates contract.\n\nExpected:\n?Object\n\nGot:\n'+i(n));if(!(null==n||n instanceof Object))throw new TypeError('Value of argument "config" violates contract.\n\nExpected:\n?Object\n\nGot:\n'+a(n));this.config=(0,F["default"])(n,gt),this.config.baseUrl||(this.config.baseUrl=ht[this.config.apiEnv]),this.config.autoSignOutOnBrowserUnload=!1,this.httpClient=new B["default"]({baseUrl:this.config.baseUrl,authStrategy:this.config.authStrategy,logger:new L["default"]({name:"HttpClient",level:this.config.logLevel})}),this.enums=(0,j["default"])({},at["default"],{NetworkStatus:pt["default"]}),this.store=new rt["default"](this,{logger:new L["default"]({name:"Store",level:this.config.logLevel})}),this.store.defineModels(),this.models=this.store.models,this.modelsByEntityType=(0,U["default"])(this.store.models,function(t,e){return(0,N["default"])(e)}),this.allModelEntityTypes=(0,O["default"])(this.modelsByEntityType),this.logger=new L["default"]({name:"TigerConnectClient",level:this.config.logLevel}),this.api={},(0,S["default"])(J["default"],function(t,n){e.api[(0,N["default"])(n)]=new t(e,{logger:new L["default"]({name:t.name,level:e.config.logLevel})})}),this._services={},(0,S["default"])(et["default"],function(t,n){n=(0,N["default"])(n),e._services[n]=e[n]=new t(e,{logger:new L["default"]({name:t.name,level:e.config.serviceLogLevels[n]||e.config.logLevel})})}),(0,S["default"])(this._services,function(t){return t.mounted&&t.mounted()}),this._listenToEvents(),this._startTicker(),this.config.autoSignOutOnBrowserUnload&&this.on("browserUnload",function(t){return t(function(){e.config.autoSignOutOnBrowserUnload&&e.signOut({async:!1,resetClient:!1})},100,"signOut")}),this.currentlyServingOfflineMessages=!1}return t.prototype._listenToEvents=function(){var t=this;this.httpClient.on("networkStatus:change",function(e){var n=e.networkStatus;t.emit("networkStatus:change",{networkStatus:n})}),this.on("signedIn",function(e,n){t.logger.info("signedIn",e.id)}).on("signedOut",function(e){var n=e.resetClient;n&&t.reset()}).on("signUp",function(e){var n=e.user,r=e.auth;t.logger.info("signUp",n.id),t._setCurrentUser(n,r)}),this.events.on("event",function(e){return t.emit("event",e)}),this.conversations.on("message",function(e){return t.emit("message",e)}),this.conversations.on("change",function(e){return t.emit("conversation:change",e)}),this.groups.on("membership:change",function(e){return t.emit("group:membership:change",e)}),this.presence.on("change",function(e){return t.emit("presence:change",e)}),this.typingStatus.on("change",function(e){return t.emit("typing:change",e)}),"undefined"!=typeof window&&window.addEventListener("beforeunload",this._onBrowserUnload)},t.prototype._onBrowserUnload=function(){var t=[],e=function(e,n,r){return t.push({fn:e,priority:n,name:r})};this.emit("browserUnload",e),(0,z["default"])(t,["priority"],["desc"]).forEach(function(t){var e=t.fn,n=t.priority,r=t.name;console.log("[unload]",n,r),e()})},t.prototype._startTicker=function(){this.__ticker=setInterval(this._onTick,1e3)},t.prototype._stopTicker=function(){clearInterval(this.__ticker)},t.prototype._onTick=function(){this.emit("tick")},t.prototype.signIn=function(){function t(t,n,r){return e.apply(this,arguments)}var e=(0,_["default"])(E["default"].mark(function n(t,e){var r,o,a,i=arguments.length<=2||void 0===arguments[2]?{udid:void 0}:arguments[2];return E["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return i.udid=i.udid||(0,H["default"])(),this.emit("signingIn"),n.prev=2,n.next=5,this.users.signIn(t,e,i);case 5:return r=n.sent,o=r.user,a=r.auth,this._setCurrentUser(o,a),n.next=11,this.users.findMe({bypassCache:!0});case 11:return this.emit("signedIn",o,a),n.abrupt("return",{user:o,auth:a});case 15:throw n.prev=15,n.t0=n["catch"](2),n.t0;case 19:case"end":return n.stop()}},n,this,[[2,15]])}));return t}(),t.prototype.signOut=function(){var t=this,e=arguments.length<=0||void 0===arguments[0]?{async:!0,resetClient:!0}:arguments[0],n=e.async,r=void 0===n||n,o=e.resetClient,a=void 0===o||o;
if(!this.isSignedIn)return b["default"].resolve();if(this.emit("signingOut"),!r&&"undefined"==typeof XMLHttpRequest)throw new Error("async: false option has to be on the browser.");if(r)return this.users.signOut({async:r}).then(function(){t._currentUser=null,t._auth=null,t.httpClient.removeAuth(),t.events.disconnect(),t.emit("signedOut",{resetClient:a})});var i=new XMLHttpRequest;return i.open("POST",this.config.baseUrl+"/logout",!1),i.setRequestHeader("Authorization",this.httpClient.getAuthHeader()),i.send(null),this.emit("signedOut",{resetClient:a}),b["default"].resolve()},t.prototype.wipe=function(){function t(){return e.apply(this,arguments)}var e=(0,_["default"])(E["default"].mark(function n(){return E["default"].wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.signOut();case 2:case"end":return t.stop()}},n,this)}));return t}(),t.prototype.authenticate=function(){function t(t,n){return e.apply(this,arguments)}var e=(0,_["default"])(E["default"].mark(function n(t,e){var r,o;return E["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return this._setAuth(t,e),n.prev=1,n.next=4,this.users.findMe();case 4:return r=n.sent,o={key:t,secret:e},this._setCurrentUser(r,o),this.emit("signedIn",r,o),n.abrupt("return",r);case 11:throw n.prev=11,n.t0=n["catch"](1),this._removeAuth(),this._currentUser=null,n.t0;case 16:case"end":return n.stop()}},n,this,[[1,11]])}));return t}(),t.prototype._setCurrentUser=function(t,e){this._currentUser=t,this._setAuth(e.key,e.secret,e.resource)},t.prototype._setAuth=function(t,e,n){this._auth={key:t,secret:e,resource:n},this.httpClient.setAuth(t,e)},t.prototype._removeAuth=function(){this._auth=null,this.httpClient.removeAuth()},t.prototype.getCurrentUser=function(){return this._currentUser||null},t.prototype.getAuth=function(){return this._auth},t.prototype.requireUser=function(){if(!this.isSignedIn)throw new Q["default"].NotSignedInError},t.prototype.reactToAdvisoryEvent=function(t,e){switch(this.emit("advisory",{type:t,data:e}),t){case"replayStart":this.currentlyServingOfflineMessages=!0,this.emit("messages:offline:start",e);break;case"replayStop":this.currentlyServingOfflineMessages=!1,this.emit("messages:offline:stop"),this.emit("messages:new:start")}},t.prototype.modelByTypeNS=function(t){return this.MODEL_BY_TYPE_NS[t]},t.prototype.injectModel=function(t){var e=arguments.length<=1||void 0===arguments[1]?t.xmlns||t.type:arguments[1],n=this.modelByTypeNS(e);return n?n.inject(t):((0,st["default"])(n,"injectModel: Missing class for "+e),null)},t.prototype.getEntity=function(t,e){return this.modelsByEntityType[t].get(e)},t.prototype.getEntities=function(t){var e=this;return t.map(function(t){return e.getEntity(t.type,t.id)})},t.prototype.dispose=function(){this._stopTicker(),(0,S["default"])(this._services,function(t){return t.dispose&&t.dispose()}),this.store&&this.store.clear()},t.prototype.reset=function(){this.dispose(),(0,S["default"])(this._services,function(t){return t.mounted&&t.mounted()}),this._startTicker()},t.prototype.configure=function(t){return(0,v["default"])(this.config,t),this},t.prototype.setDefaultOrganization=function(t){return this.configure({defaultOrganizationId:t})},(0,G["default"])(t,[{key:"currentUser",get:function(){return this.getCurrentUser()}},{key:"currentUserId",get:function(){return this.getCurrentUser()&&this.getCurrentUser().id}},{key:"isSignedIn",get:function(){return null!=this.getAuth()}},{key:"MODEL_BY_TYPE_NS",get:function(){return this._MODEL_BY_TYPE_NS||(this._MODEL_BY_TYPE_NS={"tigertext:entity:account":this.models.User,"tigertext:entity:group":this.models.Group,"tigertext:entity:distribution_list":this.models.DistributionList,"tigertext:entity:list":this.models.DistributionList,"tigertext:iq:message":this.models.Message,"tigertext:iq:group_message":this.models.Message,"tigertext:iq:group:message":this.models.Message}),this._MODEL_BY_TYPE_NS}},{key:"networkStatus",get:function(){return this.httpClient.networkStatus}}]),t}(),u.errors=Q["default"],u.VERSION=lt["default"],u.version=lt["default"],u.CONSUMER_ORGANIZATION_ID=yt,s=c,o(s.prototype,"_onBrowserUnload",[ct["default"]],(0,h["default"])(s.prototype,"_onBrowserUnload"),s.prototype),o(s.prototype,"_onTick",[ct["default"]],(0,h["default"])(s.prototype,"_onTick"),s.prototype),s);(0,v["default"])(vt.prototype,Z["default"].prototype),e["default"]=vt,t.exports=e["default"]},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function o(t){var e=arguments.length<=1||void 0===arguments[1]?"attachment":arguments[1],r=t.name;if(!r)if("string"==typeof t)r=n(69).basename(t);else if(t instanceof Buffer){var o=(0,M["default"])(n(53)(t),"ext");r=e+"."+o}return r}function a(t,e){var n=4,r=15;if(void 0===e&&(e=0),e+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return"undefined"==typeof t?"undefined":(0,y["default"])(t);if(!Array.isArray(t)){var o=(0,f["default"])(t);if(!o.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(e>n)return"{...}";var i="  ".repeat(e-1),s=o.slice(0,r).map(function(n){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(n)?n:(0,u["default"])(n))+": "+a(t[n],e)+";"}).join("\n  "+i);return o.length>=r&&(s+="\n  "+i+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+i+s+"\n"+i+"}":"{\n  "+i+s+"\n"+i+"}"}if(!(t.length>0))return"Array";var c=function(){if(e>n)return{v:"[...]"};var o=a(t[0],e);return t.every(function(t){return a(t,e)===o})?{v:o.trim()+"[]"}:{v:"["+t.slice(0,r).map(function(t){return a(t,e)}).join(", ")+(t.length>=r?", ...":"")+"]"}}();return"object"===("undefined"==typeof c?"undefined":(0,y["default"])(c))?c.v:void 0}function i(t,e){var n=4,r=15;if(void 0===e&&(e=0),e+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return"undefined"==typeof t?"undefined":(0,y["default"])(t);if(!Array.isArray(t)){var o=(0,f["default"])(t);if(!o.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(e>n)return"{...}";var a="  ".repeat(e-1),s=o.slice(0,r).map(function(n){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(n)?n:(0,u["default"])(n))+": "+i(t[n],e)+";"}).join("\n  "+a);return o.length>=r&&(s+="\n  "+a+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+a+s+"\n"+a+"}":"{\n  "+a+s+"\n"+a+"}"}if(!(t.length>0))return"Array";var c=function(){if(e>n)return{v:"[...]"};var o=i(t[0],e);return t.every(function(t){return i(t,e)===o})?{v:o.trim()+"[]"}:{v:"["+t.slice(0,r).map(function(t){return i(t,e)}).join(", ")+(t.length>=r?", ...":"")+"]"}}();return"object"===("undefined"==typeof c?"undefined":(0,y["default"])(c))?c.v:void 0}e.__esModule=!0;var s=n(5),u=r(s),c=n(4),f=r(c),l=n(16),d=r(l),p=n(8),y=r(p),h=n(17),g=r(h),v=n(7),m=r(v),b=n(6),w=r(b),E=n(1),x=r(E),_=n(164),I=r(_),O=n(34),T=r(O),j=n(18),A=r(j),k=n(33),M=r(k),G=n(160),V=r(G),z=n(175),C=r(z),S=n(40),P=r(S),N=n(13),R=r(N),U=n(176),q=r(U),F=n(14),$=n(27),L=r($),D=n(132),B=r(D),K=n(36),Z=r(K);n(177)(C["default"]);var W=["get","post","put","patch","del"],H=function(){function t(e){(0,x["default"])(this,t),this.downloadImageAndGetURL=function(){return TargetNotSupportedError.raise()},this.downloadFileBlobAndURL=function(){return TargetNotSupportedError.raise()},this.config=e,this.logger=e.logger,this._prefixBaseUrl=(0,q["default"])(this.config.baseUrl),this._watchNetworkConnection()}return t.prototype.setAuth=function(t,e){if("string"!=typeof t)throw new TypeError('Value of argument "key" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));if(null!=e&&"string"!=typeof e)throw new TypeError('Value of argument "secret" violates contract.\n\nExpected:\n?string\n\nGot:\n'+i(e));if("string"!=typeof t)throw new TypeError('Value of argument "key" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));if(null!=e&&"string"!=typeof e)throw new TypeError('Value of argument "secret" violates contract.\n\nExpected:\n?string\n\nGot:\n'+a(e));this._key=t,this._secret=e},t.prototype.removeAuth=function(){this._key=null,this._secret=null},t.prototype.getAuthHeader=function(){return this.getAuthHeaderForKeyAndSecret(this._key,this._secret)},t.prototype.getAuthHeaderForKeyAndSecret=function(t,e){if("string"!=typeof t)throw new TypeError('Value of argument "key" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));if(null!=e&&"string"!=typeof e)throw new TypeError('Value of argument "secret" violates contract.\n\nExpected:\n?string\n\nGot:\n'+i(e));if("string"!=typeof t)throw new TypeError('Value of argument "key" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));if(null!=e&&"string"!=typeof e)throw new TypeError('Value of argument "secret" violates contract.\n\nExpected:\n?string\n\nGot:\n'+a(e));if(!t)return null;switch(this.config.authStrategy){case"basic":return e?"Basic "+(0,P["default"])(t+":"+e):null;case"oauth":return"Bearer "+t}},t.prototype._contentType=function(t){switch(t){case"json":return"application/json";case"event-stream":return"text/event-stream";case"text":default:return"plain/text"}},t.prototype.downloadFileBlob=function(t){if("string"!=typeof t)throw new TypeError('Value of argument "path" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));if("string"!=typeof t)throw new TypeError('Value of argument "path" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));TargetNotSupportedError.raise()},t.prototype.downloadToFile=function(t,e){var r=this,o=function(){var o=n(54);return{v:new g["default"](function(a,i){var s=r.config.baseUrl+t;n(174)({url:s,headers:{Authorization:r.getAuthHeader()}},function(t,e){t||e.statusCode<200||e.statusCode>299?i(new Error("Failed downloading "+s+". Status = "+xhr.status)):a()}).pipe(o.createWriteStream(e))})}}();if("object"===("undefined"==typeof o?"undefined":(0,y["default"])(o)))return o.v},t.prototype._watchNetworkConnection=function(){this.networkStatus=Z["default"].ONLINE},t.prototype._setNetworkStatus=function(t){t!==this.networkStatus&&(t===Z["default"].UNREACHABLE&&this.networkStatus===Z["default"].OFFLINE||(this.networkStatus=t,this.emit("networkStatus:change",{networkStatus:this.networkStatus})))},t.prototype.createEventSource=function(t,e){var n=this,r=e.headers,o=e.onOpen,s=e.onMessage,u=e.onError,c=e.onClose;if("string"!=typeof t)throw new TypeError('Value of argument "path" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));if(null==arguments[1]||!(null==arguments[1].headers||arguments[1].headers instanceof Object)||null!=arguments[1].onOpen&&"function"!=typeof arguments[1].onOpen||null!=arguments[1].onMessage&&"function"!=typeof arguments[1].onMessage||null!=arguments[1].onError&&"function"!=typeof arguments[1].onError||null!=arguments[1].onClose&&"function"!=typeof arguments[1].onClose)throw new TypeError("Value of argument 1 violates contract.\n\nExpected:\n{\n  headers: ?Object;\n  onOpen: ?Function;\n  onMessage: ?Function;\n  onError: ?Function;\n  onClose: ?Function;\n}\n\nGot:\n"+i(arguments[1]));if("string"!=typeof t)throw new TypeError('Value of argument "path" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));if(null==arguments[1]||!(null==arguments[1].headers||arguments[1].headers instanceof Object)||null!=arguments[1].onOpen&&"function"!=typeof arguments[1].onOpen||null!=arguments[1].onMessage&&"function"!=typeof arguments[1].onMessage||null!=arguments[1].onError&&"function"!=typeof arguments[1].onError||null!=arguments[1].onClose&&"function"!=typeof arguments[1].onClose)throw new TypeError("Value of argument 1 violates contract.\n\nExpected:\n{\n  headers: ?Object;\n  onOpen: ?Function;\n  onMessage: ?Function;\n  onError: ?Function;\n  onClose: ?Function;\n}\n\nGot:\n"+a(arguments[1]));r=r||{},r.Authorization=r.Authorization||this.getAuthHeader(),o=o||V["default"],s=s||V["default"],u=u||V["default"],c=c||V["default"];var f=new B["default"](this.config.baseUrl+t,{headers:r});return f.once("open",function(){n._setNetworkStatus(Z["default"].ONLINE),o()}),f.on("message",s),f.once("error",function(t){t&&0===t.status&&n._setNetworkStatus(Z["default"].UNREACHABLE),u(t)}),f.once("close",c),f},t}();W.forEach(function(t){H.prototype[t]=function(){var e=(0,w["default"])(m["default"].mark(function n(e){var r,a,i=this,s=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return m["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return s=(0,A["default"])(s||{},{reqFormat:"json",resFormat:"json"}),s.urlParams&&(e=e.replace(/:([\w\-]+)/g,function(t,e){return encodeURIComponent(s.urlParams[e])})),this.logger&&this.logger.info("start",t.toUpperCase(),e,s),r=(0,d["default"])({},s.headers),(0,T["default"])(s.files)&&(r["Content-Type"]=r["Content-Type"]||this._contentType(s.reqFormat)),r.Accept=r.Accept||this._contentType(s.resFormat),s.requestId&&(r["Request-ID"]=s.requestId),a=new g["default"](function(n,a){var u=C["default"][t](e).use(i._prefixBaseUrl).set(r).query(s.query||{});s.retry!==!1&&(u=u.retry(s.retryCount||3)),s.timeout!==!1&&(u=u.timeout(s.timeout===!0?5e3:s.timeout));var c=!(0,T["default"])(s.files);if(c?(u=(0,I["default"])(s.data,function(t,e,n){return t.field(n,String(e))},u),u=(0,I["default"])(s.files,function(t,e,n,r){return e?t.attach(n,e,o(e,"attachment-"+r)):t.field(n,"")},u),u=u.send()):u=u.send(s.data||{}),!("Authorization"in r))switch(i.config.authStrategy){case"basic":i._key&&i._secret&&(u=u.auth(i._key,i._secret));break;case"oauth":u=u.set("Authorization",i.getAuthHeader())}u.end(function(r,o){if(r)return i.logger&&i.logger.info("error",t.toUpperCase(),e,r),void(r.status?a(401==r.status?new R["default"].WrongCredentialsError:r):(i._setNetworkStatus(Z["default"].UNREACHABLE),a(new R["default"].ConnectionUnavailableError)));switch(i._setNetworkStatus(Z["default"].ONLINE),s.resFormat){case"json":var u=o.body||{};"reply"in u&&(u=u.reply);var c={data:u,headers:o.headers,getHeader:function(t){return o.headers[t.toLowerCase()]},status:o.status};Object.defineProperty(c,"_origData",{get:function(){return o.body}}),i.logger&&i.logger.info("success",t.toUpperCase(),e,c),n(c);break;default:i.logger&&i.logger.info("success",t.toUpperCase(),e,o.text?o.text.substr(0,80)+"...":"[null]"),n(o.text)}})}),n.abrupt("return",a);case 9:case"end":return n.stop()}},n,this)}));return function(t,n){return e.apply(this,arguments)}}()}),!function(){var t=H.prototype.get,e=(0,F.decorator)(t);H.prototype.get=function(n){var r=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return r.reusePromise?e.call(this,n,r):t.call(this,n,r)}}(),(0,d["default"])(H.prototype,L["default"].prototype),e["default"]=H,t.exports=e["default"]},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){var n=4,r=15;if(void 0===e&&(e=0),e+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return"undefined"==typeof t?"undefined":(0,l["default"])(t);if(!Array.isArray(t)){var a=(0,c["default"])(t);if(!a.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(e>n)return"{...}";var i="  ".repeat(e-1),u=a.slice(0,r).map(function(n){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(n)?n:(0,s["default"])(n))+": "+o(t[n],e)+";"}).join("\n  "+i);return a.length>=r&&(u+="\n  "+i+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+i+u+"\n"+i+"}":"{\n  "+i+u+"\n"+i+"}"}if(!(t.length>0))return"Array";var f=function(){if(e>n)return{v:"[...]"};var a=o(t[0],e);return t.every(function(t){return o(t,e)===a})?{v:a.trim()+"[]"}:{v:"["+t.slice(0,r).map(function(t){return o(t,e)}).join(", ")+(t.length>=r?", ...":"")+"]"}}();return"object"===("undefined"==typeof f?"undefined":(0,l["default"])(f))?f.v:void 0}function a(t,e){var n=4,r=15;if(void 0===e&&(e=0),e+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return"undefined"==typeof t?"undefined":(0,l["default"])(t);if(!Array.isArray(t)){var o=(0,c["default"])(t);if(!o.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(e>n)return"{...}";var i="  ".repeat(e-1),u=o.slice(0,r).map(function(n){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(n)?n:(0,s["default"])(n))+": "+a(t[n],e)+";"}).join("\n  "+i);return o.length>=r&&(u+="\n  "+i+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+i+u+"\n"+i+"}":"{\n  "+i+u+"\n"+i+"}"}if(!(t.length>0))return"Array";var f=function(){if(e>n)return{v:"[...]"};var o=a(t[0],e);return t.every(function(t){return a(t,e)===o})?{v:o.trim()+"[]"}:{v:"["+t.slice(0,r).map(function(t){return a(t,e)}).join(", ")+(t.length>=r?", ...":"")+"]"}}();return"object"===("undefined"==typeof f?"undefined":(0,l["default"])(f))?f.v:void 0}e.__esModule=!0,e["default"]=void 0;var i=n(5),s=r(i),u=n(4),c=r(u),f=n(8),l=r(f),d=n(1),p=r(d),y=function(){function t(e){var n=e.name,r=e.level;if((0,p["default"])(this,t),null==arguments[0]||"string"!=typeof arguments[0].name||"string"!=typeof arguments[0].level)throw new TypeError("Value of argument 0 violates contract.\n\nExpected:\n{\n  name: string;\n  level: string;\n}\n\nGot:\n"+a(arguments[0]));if(null==arguments[0]||"string"!=typeof arguments[0].name||"string"!=typeof arguments[0].level)throw new TypeError("Value of argument 0 violates contract.\n\nExpected:\n{\n  name: string;\n  level: string;\n}\n\nGot:\n"+o(arguments[0]));this.name=n,this.level=r}return t.prototype.setLevel=function(t){if("string"!=typeof t)throw new TypeError('Value of argument "level" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));if("string"!=typeof t)throw new TypeError('Value of argument "level" violates contract.\n\nExpected:\nstring\n\nGot:\n'+o(t));if(this.level=t.toLowerCase(),"string"!=typeof this.level)throw new TypeError('Value of "this.level" violates contract.\n\nExpected:\nstring\n\nGot:\n'+o(this.level))},t}();e["default"]=y;var h=["debug","log","info","warn","error"],g=h.reduce(function(t,e,n){return t[e]=n,t},{});h.forEach(function(t){var e=g[t];y.prototype[t]=function(){for(var n=arguments.length,r=Array(n),o=0;o<n;o++)r[o]=arguments[o];e>=g[this.level]&&(r=["["+this.name+"]"].concat(r),Function.prototype.apply.call(console[t],console,r))}}),t.exports=e["default"]},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function o(t,e,n,r,o){var a={};return Object.keys(r).forEach(function(t){a[t]=r[t]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=n.slice().reverse().reduce(function(n,r){return r(t,e,n)||n},a),o&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(o):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(t,e,a),a=null),a}function a(t,e){var n=4,r=15;if(void 0===e&&(e=0),e+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return"undefined"==typeof t?"undefined":(0,y["default"])(t);if(!Array.isArray(t)){var o=(0,d["default"])(t);if(!o.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(e>n)return"{...}";var i="  ".repeat(e-1),s=o.slice(0,r).map(function(n){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(n)?n:(0,f["default"])(n))+": "+a(t[n],e)+";"}).join("\n  "+i);return o.length>=r&&(s+="\n  "+i+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+i+s+"\n"+i+"}":"{\n  "+i+s+"\n"+i+"}"}if(!(t.length>0))return"Array";var u=function(){if(e>n)return{v:"[...]"};var o=a(t[0],e);return t.every(function(t){return a(t,e)===o})?{v:o.trim()+"[]"}:{v:"["+t.slice(0,r).map(function(t){return a(t,e)}).join(", ")+(t.length>=r?", ...":"")+"]"}}();return"object"===("undefined"==typeof u?"undefined":(0,y["default"])(u))?u.v:void 0}function i(t,e){var n=4,r=15;if(void 0===e&&(e=0),e+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return"undefined"==typeof t?"undefined":(0,y["default"])(t);if(!Array.isArray(t)){var o=(0,d["default"])(t);if(!o.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(e>n)return"{...}";var a="  ".repeat(e-1),s=o.slice(0,r).map(function(n){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(n)?n:(0,f["default"])(n))+": "+i(t[n],e)+";"}).join("\n  "+a);return o.length>=r&&(s+="\n  "+a+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+a+s+"\n"+a+"}":"{\n  "+a+s+"\n"+a+"}"}if(!(t.length>0))return"Array";var u=function(){if(e>n)return{v:"[...]"};var o=i(t[0],e);return t.every(function(t){return i(t,e)===o})?{v:o.trim()+"[]"}:{v:"["+t.slice(0,r).map(function(t){return i(t,e)}).join(", ")+(t.length>=r?", ...":"")+"]"}}();return"object"===("undefined"==typeof u?"undefined":(0,y["default"])(u))?u.v:void 0}e.__esModule=!0,e["default"]=void 0;var s,u,c=n(5),f=r(c),l=n(4),d=r(l),p=n(8),y=r(p),h=n(9),g=r(h),v=n(7),m=r(v),b=n(6),w=r(b),E=n(1),x=r(E),_=n(3),I=r(_),O=n(2),T=r(O),j=n(19),A=r(j),k=(s=(0,j.recoverFromNotFound)(),u=function(t){function e(){return(0,x["default"])(this,e),(0,I["default"])(this,t.apply(this,arguments))}return(0,T["default"])(e,t),e.prototype.find=function(){function t(t){return e.apply(this,arguments)}var e=(0,w["default"])(m["default"].mark(function n(t){var e;return m["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof t){n.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));case 2:if("string"==typeof t){n.next=4;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));case 4:return n.next=6,this.httpClient.get("/dist_list/:id",{urlParams:{id:t}});case 6:return e=n.sent,n.abrupt("return",e.data);case 8:case"end":return n.stop()}},n,this)}));return t}(),e}(A["default"]),o(u.prototype,"find",[s],(0,g["default"])(u.prototype,"find"),u.prototype),u);e["default"]=k,t.exports=e["default"]},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function o(t,e,n,r,o){var a={};return Object.keys(r).forEach(function(t){a[t]=r[t]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=n.slice().reverse().reduce(function(n,r){return r(t,e,n)||n},a),o&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(o):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(t,e,a),a=null),a}function a(t,e){var n=4,r=15;if(void 0===e&&(e=0),e+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return"undefined"==typeof t?"undefined":(0,h["default"])(t);if(!Array.isArray(t)){var o=(0,p["default"])(t);if(!o.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(e>n)return"{...}";var i="  ".repeat(e-1),s=o.slice(0,r).map(function(n){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(n)?n:(0,l["default"])(n))+": "+a(t[n],e)+";"}).join("\n  "+i);return o.length>=r&&(s+="\n  "+i+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+i+s+"\n"+i+"}":"{\n  "+i+s+"\n"+i+"}"}if(!(t.length>0))return"Array";var u=function(){if(e>n)return{v:"[...]"};var o=a(t[0],e);return t.every(function(t){return a(t,e)===o})?{v:o.trim()+"[]"}:{v:"["+t.slice(0,r).map(function(t){return a(t,e)}).join(", ")+(t.length>=r?", ...":"")+"]"}}();return"object"===("undefined"==typeof u?"undefined":(0,h["default"])(u))?u.v:void 0}function i(t,e){var n=4,r=15;if(void 0===e&&(e=0),e+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return"undefined"==typeof t?"undefined":(0,h["default"])(t);if(!Array.isArray(t)){var o=(0,p["default"])(t);if(!o.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(e>n)return"{...}";var a="  ".repeat(e-1),s=o.slice(0,r).map(function(n){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(n)?n:(0,l["default"])(n))+": "+i(t[n],e)+";"}).join("\n  "+a);return o.length>=r&&(s+="\n  "+a+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+a+s+"\n"+a+"}":"{\n  "+a+s+"\n"+a+"}"}if(!(t.length>0))return"Array";var u=function(){if(e>n)return{v:"[...]"};var o=i(t[0],e);return t.every(function(t){return i(t,e)===o})?{v:o.trim()+"[]"}:{v:"["+t.slice(0,r).map(function(t){return i(t,e)}).join(", ")+(t.length>=r?", ...":"")+"]"}}();return"object"===("undefined"==typeof u?"undefined":(0,h["default"])(u))?u.v:void 0}e.__esModule=!0,e["default"]=void 0;var s,u,c,f=n(5),l=r(f),d=n(4),p=r(d),y=n(8),h=r(y),g=n(9),v=r(g),m=n(7),b=r(m),w=n(6),E=r(w),x=n(1),_=r(x),I=n(3),O=r(I),T=n(2),j=r(T),A=n(19),k=r(A),M=(s=(0,A.recoverFromNotFound)(),u=(0,A.recoverFromNotFound)({httpStatusCodes:[404,403]}),c=function(t){function e(){return(0,_["default"])(this,e),(0,O["default"])(this,t.apply(this,arguments))}return(0,j["default"])(e,t),e.prototype.create=function(){function t(t){return e.apply(this,arguments)}var e=(0,E["default"])(b["default"].mark(function n(t){var e,r,o,a,i,s,u,c=t.name,f=t.avatarFile,l=t.replayHistory,d=void 0===l||l,p=t.memberIds,y=void 0===p?[]:p,h=t.organizationId;return b["default"].wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e={},r={name:c,replay_history:d,members:y.join(",")},o={},f&&(o.avatar=f),h&&(e["TT-X-Organization-Key"]=h),t.next=7,this.httpClient.post("/group",{headers:e,data:r,files:o});case 7:return a=t.sent,i=a.getHeader("TT-X-Group-Token"),s=a.getHeader("TT-X-Group-Avatar"),u={id:i,avatarUrl:s,name:c,memberIds:y,organizationId:h},t.abrupt("return",u);case 12:case"end":return t.stop()}},n,this)}));return t}(),e.prototype.update=function(){function t(t,n){return e.apply(this,arguments)}var e=(0,E["default"])(b["default"].mark(function n(t,e){var r,o,a,i,s=e.name,u=void 0===s?void 0:s,c=e.avatarFile,f=void 0===c?void 0:c,l=e.replayHistory,d=void 0===l?void 0:l,p=e.memberIds;return b["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r={},o={},"undefined"!=typeof u&&(r.name=u),"undefined"!=typeof p&&(r.members=p.join(",")),"undefined"!=typeof d&&(r.replay_history=d),f&&(o.avatar=f),e.next=8,this.httpClient.post("/group/:id",{urlParams:{id:t},data:r,files:o});case 8:return a=e.sent,i=a.getHeader("TT-X-Group-Avatar"),e.abrupt("return",{id:t,avatarUrl:i});case 11:case"end":return e.stop()}},n,this)}));return t}(),e.prototype.find=function(){function t(t){return e.apply(this,arguments)}var e=(0,E["default"])(b["default"].mark(function n(t){var e;return b["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof t){n.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));case 2:if("string"==typeof t){n.next=4;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));case 4:return n.next=6,this.httpClient.get("/group/:id",{urlParams:{id:t}});case 6:return e=n.sent,n.abrupt("return",e.data);case 8:case"end":return n.stop()}},n,this)}));return t}(),e.prototype.destroy=function(){function t(t){return e.apply(this,arguments)}var e=(0,E["default"])(b["default"].mark(function n(t){return b["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"==typeof t){e.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));case 2:if("string"==typeof t){e.next=4;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));case 4:return e.next=6,this.httpClient.del("/group/:id",{urlParams:{id:t}});case 6:return e.abrupt("return",!0);case 7:case"end":return e.stop()}},n,this)}));return t}(),e.prototype.addMembers=function(){function t(t,n){return e.apply(this,arguments)}var e=(0,E["default"])(b["default"].mark(function n(t,e){return b["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof t){n.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));case 2:if(Array.isArray(e)&&e.every(function(t){return"string"==typeof t})){n.next=4;break}throw new TypeError('Value of argument "memberIds" violates contract.\n\nExpected:\nstring[]\n\nGot:\n'+i(e));case 4:if("string"==typeof t){n.next=6;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));case 6:if(Array.isArray(e)&&e.every(function(t){return"string"==typeof t})){n.next=8;break}throw new TypeError('Value of argument "memberIds" violates contract.\n\nExpected:\nstring[]\n\nGot:\n'+a(e));case 8:return n.next=10,this.httpClient.post("/group/:id/members",{urlParams:{id:t},data:{members:e}});case 10:case"end":return n.stop()}},n,this)}));return t}(),e.prototype.removeMembers=function(){function t(t,n){return e.apply(this,arguments)}var e=(0,E["default"])(b["default"].mark(function n(t,e){return b["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof t){n.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));case 2:if(Array.isArray(e)&&e.every(function(t){return"string"==typeof t})){n.next=4;break}throw new TypeError('Value of argument "memberIds" violates contract.\n\nExpected:\nstring[]\n\nGot:\n'+i(e));case 4:if("string"==typeof t){n.next=6;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));case 6:if(Array.isArray(e)&&e.every(function(t){return"string"==typeof t})){n.next=8;break}throw new TypeError('Value of argument "memberIds" violates contract.\n\nExpected:\nstring[]\n\nGot:\n'+a(e));case 8:return n.next=10,this.httpClient.post("/group/:id/members/remove",{urlParams:{id:t},data:{members:e}});case 10:case"end":return n.stop()}},n,this)}));return t}(),e}(k["default"]),o(c.prototype,"find",[s],(0,v["default"])(c.prototype,"find"),c.prototype),o(c.prototype,"destroy",[u],(0,v["default"])(c.prototype,"destroy"),c.prototype),c);e["default"]=M,t.exports=e["default"]},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){var n=4,r=15;if(void 0===e&&(e=0),e+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return"undefined"==typeof t?"undefined":(0,c["default"])(t);if(!Array.isArray(t)){var a=(0,s["default"])(t);if(!a.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(e>n)return"{...}";var i="  ".repeat(e-1),u=a.slice(0,r).map(function(n){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(n)?n:(0,p["default"])(n))+": "+o(t[n],e)+";"}).join("\n  "+i);return a.length>=r&&(u+="\n  "+i+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+i+u+"\n"+i+"}":"{\n  "+i+u+"\n"+i+"}"}if(!(t.length>0))return"Array";var f=function(){if(e>n)return{v:"[...]"};var a=o(t[0],e);return t.every(function(t){return o(t,e)===a})?{v:a.trim()+"[]"}:{v:"["+t.slice(0,r).map(function(t){return o(t,e)}).join(", ")+(t.length>=r?", ...":"")+"]"}}();return"object"===("undefined"==typeof f?"undefined":(0,c["default"])(f))?f.v:void 0}function a(t,e){var n=4,r=15;if(void 0===e&&(e=0),e+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return"undefined"==typeof t?"undefined":(0,c["default"])(t);if(!Array.isArray(t)){var o=(0,s["default"])(t);if(!o.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";
if(e>n)return"{...}";var i="  ".repeat(e-1),u=o.slice(0,r).map(function(n){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(n)?n:(0,p["default"])(n))+": "+a(t[n],e)+";"}).join("\n  "+i);return o.length>=r&&(u+="\n  "+i+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+i+u+"\n"+i+"}":"{\n  "+i+u+"\n"+i+"}"}if(!(t.length>0))return"Array";var f=function(){if(e>n)return{v:"[...]"};var o=a(t[0],e);return t.every(function(t){return a(t,e)===o})?{v:o.trim()+"[]"}:{v:"["+t.slice(0,r).map(function(t){return a(t,e)}).join(", ")+(t.length>=r?", ...":"")+"]"}}();return"object"===("undefined"==typeof f?"undefined":(0,c["default"])(f))?f.v:void 0}e.__esModule=!0,e["default"]=void 0;var i=n(4),s=r(i),u=n(8),c=r(u),f=n(7),l=r(f),d=n(5),p=r(d),y=n(11),h=r(y),g=n(6),v=r(g),m=n(1),b=r(m),w=n(3),E=r(w),x=n(2),_=r(x),I=n(19),O=r(I),T=function(t){function e(){return(0,b["default"])(this,e),(0,E["default"])(this,t.apply(this,arguments))}return(0,_["default"])(e,t),e.prototype.send=function(){function t(t){return e.apply(this,arguments)}var e=(0,v["default"])(l["default"].mark(function n(t){var e,r,i,s,u=t.counterPartyId,c=t.body,f=t.senderOrganizationId,d=t.recipientOrganizationId,y=t.attachment,g=t.metadata,v=t.priority,m=t.ttl,b=t.deleteOnRead,w=t.localId,E=arguments;return l["default"].wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!(null==E[0]||"string"!=typeof E[0].counterPartyId||"string"!=typeof E[0].body||"string"!=typeof E[0].senderOrganizationId||"string"!=typeof E[0].recipientOrganizationId||!(null==E[0].attachment||E[0].attachment instanceof Object||null==E[0].attachment||"string"==typeof E[0].attachment)||!(null==E[0].metadata||E[0].metadata instanceof Object)||null!=E[0].priority&&"number"!=typeof E[0].priority||null!=E[0].ttl&&"number"!=typeof E[0].ttl||null!=E[0].deleteOnRead&&"boolean"!=typeof E[0].deleteOnRead||"string"!=typeof E[0].localId)){t.next=2;break}throw new TypeError("Value of argument 0 violates contract.\n\nExpected:\n{\n  counterPartyId: string;\n  body: string;\n  senderOrganizationId: string;\n  recipientOrganizationId: string;\n  attachment: ?Object | ?string;\n  metadata: ?Object;\n  priority: ?number;\n  ttl: ?number;\n  deleteOnRead: ?bool;\n  localId: string;\n}\n\nGot:\n"+a(E[0]));case 2:if(!(null==E[0]||"string"!=typeof E[0].counterPartyId||"string"!=typeof E[0].body||"string"!=typeof E[0].senderOrganizationId||"string"!=typeof E[0].recipientOrganizationId||!(null==E[0].attachment||E[0].attachment instanceof Object||null==E[0].attachment||"string"==typeof E[0].attachment)||!(null==E[0].metadata||E[0].metadata instanceof Object)||null!=E[0].priority&&"number"!=typeof E[0].priority||null!=E[0].ttl&&"number"!=typeof E[0].ttl||null!=E[0].deleteOnRead&&"boolean"!=typeof E[0].deleteOnRead||"string"!=typeof E[0].localId)){t.next=4;break}throw new TypeError("Value of argument 0 violates contract.\n\nExpected:\n{\n  counterPartyId: string;\n  body: string;\n  senderOrganizationId: string;\n  recipientOrganizationId: string;\n  attachment: ?Object | ?string;\n  metadata: ?Object;\n  priority: ?number;\n  ttl: ?number;\n  deleteOnRead: ?bool;\n  localId: string;\n}\n\nGot:\n"+o(E[0]));case 4:return d||(d=f),e={recipient:u,body:c},r={},g&&(e.data=g.map(function(t){return(0,h["default"])({},t,{payload:(0,p["default"])(t.payload)})})),f&&(e.sender_organization=f),d&&(e.recipient_organization=d),"undefined"!=typeof v&&(e.priority=v),y&&(r.attachment=y),m&&(e.ttl=m),b&&(e.dor=b),t.next=16,this.httpClient.post("/message",{data:e,files:r,requestId:w,timeout:!y||6e4});case 16:return i=t.sent,s={serverId:i.getHeader("TT-X-Message-Id"),ttl:+i.getHeader("TT-X-Msg-Ttl")},t.abrupt("return",s);case 19:case"end":return t.stop()}},n,this)}));return t}(),e.prototype.destroy=function(){function t(t){return e.apply(this,arguments)}var e=(0,v["default"])(l["default"].mark(function n(t){return l["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"==typeof t){e.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));case 2:if("string"==typeof t){e.next=4;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+o(t));case 4:return e.prev=4,e.next=7,this.httpClient.del("/message/:id",{urlParams:{id:t}});case 7:return e.abrupt("return",!0);case 10:return e.prev=10,e.t0=e["catch"](4),e.abrupt("return",!1);case 13:case"end":return e.stop()}},n,this,[[4,10]])}));return t}(),e.prototype.startTyping=function(){function t(t){return e.apply(this,arguments)}var e=(0,v["default"])(l["default"].mark(function n(t){return l["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"==typeof t){e.next=2;break}throw new TypeError('Value of argument "recipientId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));case 2:if("string"==typeof t){e.next=4;break}throw new TypeError('Value of argument "recipientId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+o(t));case 4:return e.next=6,this.httpClient.post("/message/typing",{data:{recipient:t}});case 6:case"end":return e.stop()}},n,this)}));return t}(),e.prototype.stopTyping=function(){function t(t){return e.apply(this,arguments)}var e=(0,v["default"])(l["default"].mark(function n(t){return l["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"==typeof t){e.next=2;break}throw new TypeError('Value of argument "recipientId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));case 2:if("string"==typeof t){e.next=4;break}throw new TypeError('Value of argument "recipientId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+o(t));case 4:return e.next=6,this.httpClient.del("/message/typing/:recipientId",{urlParams:{recipientId:t}});case 6:case"end":return e.stop()}},n,this)}));return t}(),e.prototype.forward=function(){function t(t,n,r){return e.apply(this,arguments)}var e=(0,v["default"])(l["default"].mark(function n(t,e,r){var i,s,u,c=r.senderOrganizationId,f=r.recipientOrganizationId,d=r.priority,p=r.localId,y=arguments;return l["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof t){n.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));case 2:if("string"==typeof e){n.next=4;break}throw new TypeError('Value of argument "counterPartyId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));case 4:if(!(null==y[2]||null!=y[2].senderOrganizationId&&"string"!=typeof y[2].senderOrganizationId||null!=y[2].recipientOrganizationId&&"string"!=typeof y[2].recipientOrganizationId||null!=y[2].priority&&"number"!=typeof y[2].priority||"string"!=typeof y[2].localId)){n.next=6;break}throw new TypeError("Value of argument 2 violates contract.\n\nExpected:\n{\n  senderOrganizationId: ?string;\n  recipientOrganizationId: ?string;\n  priority: ?number;\n  localId: string;\n}\n\nGot:\n"+a(y[2]));case 6:if("string"==typeof t){n.next=8;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+o(t));case 8:if("string"==typeof e){n.next=10;break}throw new TypeError('Value of argument "counterPartyId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+o(e));case 10:if(!(null==y[2]||null!=y[2].senderOrganizationId&&"string"!=typeof y[2].senderOrganizationId||null!=y[2].recipientOrganizationId&&"string"!=typeof y[2].recipientOrganizationId||null!=y[2].priority&&"number"!=typeof y[2].priority||"string"!=typeof y[2].localId)){n.next=12;break}throw new TypeError("Value of argument 2 violates contract.\n\nExpected:\n{\n  senderOrganizationId: ?string;\n  recipientOrganizationId: ?string;\n  priority: ?number;\n  localId: string;\n}\n\nGot:\n"+o(y[2]));case 12:return f||(f=c),i={recipient:e},c&&(i.sender_organization=c),f&&(i.recipient_organization=f),"undefined"!=typeof d&&(i.priority=d),n.next=19,this.httpClient.post("/message/:id/forward",{urlParams:{id:t},data:i,requestId:p});case 19:return s=n.sent,u={serverId:s.getHeader("TT-X-Message-Id")},n.abrupt("return",u);case 22:case"end":return n.stop()}},n,this)}));return t}(),e}(O["default"]);e["default"]=T,t.exports=e["default"]},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){var n=4,r=15;if(void 0===e&&(e=0),e+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return"undefined"==typeof t?"undefined":(0,l["default"])(t);if(!Array.isArray(t)){var a=(0,c["default"])(t);if(!a.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(e>n)return"{...}";var i="  ".repeat(e-1),u=a.slice(0,r).map(function(n){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(n)?n:(0,s["default"])(n))+": "+o(t[n],e)+";"}).join("\n  "+i);return a.length>=r&&(u+="\n  "+i+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+i+u+"\n"+i+"}":"{\n  "+i+u+"\n"+i+"}"}if(!(t.length>0))return"Array";var f=function(){if(e>n)return{v:"[...]"};var a=o(t[0],e);return t.every(function(t){return o(t,e)===a})?{v:a.trim()+"[]"}:{v:"["+t.slice(0,r).map(function(t){return o(t,e)}).join(", ")+(t.length>=r?", ...":"")+"]"}}();return"object"===("undefined"==typeof f?"undefined":(0,l["default"])(f))?f.v:void 0}function a(t,e){var n=4,r=15;if(void 0===e&&(e=0),e+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return"undefined"==typeof t?"undefined":(0,l["default"])(t);if(!Array.isArray(t)){var o=(0,c["default"])(t);if(!o.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(e>n)return"{...}";var i="  ".repeat(e-1),u=o.slice(0,r).map(function(n){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(n)?n:(0,s["default"])(n))+": "+a(t[n],e)+";"}).join("\n  "+i);return o.length>=r&&(u+="\n  "+i+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+i+u+"\n"+i+"}":"{\n  "+i+u+"\n"+i+"}"}if(!(t.length>0))return"Array";var f=function(){if(e>n)return{v:"[...]"};var o=a(t[0],e);return t.every(function(t){return a(t,e)===o})?{v:o.trim()+"[]"}:{v:"["+t.slice(0,r).map(function(t){return a(t,e)}).join(", ")+(t.length>=r?", ...":"")+"]"}}();return"object"===("undefined"==typeof f?"undefined":(0,l["default"])(f))?f.v:void 0}e.__esModule=!0,e["default"]=void 0;var i=n(5),s=r(i),u=n(4),c=r(u),f=n(8),l=r(f),d=n(7),p=r(d),y=n(6),h=r(y),g=n(1),v=r(g),m=n(3),b=r(m),w=n(2),E=r(w),x=n(171),_=r(x),I=n(19),O=r(I),T=function(t){function e(){return(0,v["default"])(this,e),(0,b["default"])(this,t.apply(this,arguments))}return(0,E["default"])(e,t),e.prototype.update=function(){function t(t,n,r){return e.apply(this,arguments)}var e=(0,h["default"])(p["default"].mark(function n(t,e,r){return p["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof t){n.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));case 2:if(e instanceof Object){n.next=4;break}throw new TypeError('Value of argument "data" violates contract.\n\nExpected:\nObject\n\nGot:\n'+a(e));case 4:if("string"==typeof r){n.next=6;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(r));case 6:if("string"==typeof t){n.next=8;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+o(t));case 8:if(e instanceof Object){n.next=10;break}throw new TypeError('Value of argument "data" violates contract.\n\nExpected:\nObject\n\nGot:\n'+o(e));case 10:if("string"==typeof r){n.next=12;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+o(r));case 12:return n.next=14,this.httpClient.post("/metadata/:id",{urlParams:{id:t},data:e,headers:{"TT-X-Organization-Key":r}});case 14:case"end":return n.stop()}},n,this)}));return t}(),e.prototype.find=function(){function t(t,n){return e.apply(this,arguments)}var e=(0,h["default"])(p["default"].mark(function n(t,e){var r;return p["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof t){n.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));case 2:if("string"==typeof e){n.next=4;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));case 4:if("string"==typeof t){n.next=6;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+o(t));case 6:if("string"==typeof e){n.next=8;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+o(e));case 8:return n.next=10,this.httpClient.get("/metadata/:id",{urlParams:{id:t},headers:{"TT-X-Organization-Key":e}});case 10:return r=n.sent,n.abrupt("return",r.data);case 12:case"end":return n.stop()}},n,this)}));return t}(),e.prototype.findMulti=function(){function t(t,n){return e.apply(this,arguments)}var e=(0,h["default"])(p["default"].mark(function n(t,e){var r,i;return p["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(Array.isArray(t)&&t.every(function(t){return"string"==typeof t})){n.next=2;break}throw new TypeError('Value of argument "ids" violates contract.\n\nExpected:\nstring[]\n\nGot:\n'+a(t));case 2:if("string"==typeof e){n.next=4;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));case 4:if(Array.isArray(t)&&t.every(function(t){return"string"==typeof t})){n.next=6;break}throw new TypeError('Value of argument "ids" violates contract.\n\nExpected:\nstring[]\n\nGot:\n'+o(t));case 6:if("string"==typeof e){n.next=8;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+o(e));case 8:return n.next=10,this.httpClient.post("/metadata_bulk",{data:{entities:t},headers:{"TT-X-Organization-Key":e}});case 10:return r=n.sent,i=(0,_["default"])(t,r.data),n.abrupt("return",i);case 13:case"end":return n.stop()}},n,this)}));return t}(),e}(O["default"]);e["default"]=T,t.exports=e["default"]},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function o(t,e,n,r,o){var a={};return Object.keys(r).forEach(function(t){a[t]=r[t]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=n.slice().reverse().reduce(function(n,r){return r(t,e,n)||n},a),o&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(o):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(t,e,a),a=null),a}function a(t,e){var n=4,r=15;if(void 0===e&&(e=0),e+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return"undefined"==typeof t?"undefined":(0,b["default"])(t);if(!Array.isArray(t)){var o=(0,v["default"])(t);if(!o.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(e>n)return"{...}";var i="  ".repeat(e-1),s=o.slice(0,r).map(function(n){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(n)?n:(0,h["default"])(n))+": "+a(t[n],e)+";"}).join("\n  "+i);return o.length>=r&&(s+="\n  "+i+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+i+s+"\n"+i+"}":"{\n  "+i+s+"\n"+i+"}"}if(!(t.length>0))return"Array";var u=function(){if(e>n)return{v:"[...]"};var o=a(t[0],e);return t.every(function(t){return a(t,e)===o})?{v:o.trim()+"[]"}:{v:"["+t.slice(0,r).map(function(t){return a(t,e)}).join(", ")+(t.length>=r?", ...":"")+"]"}}();return"object"===("undefined"==typeof u?"undefined":(0,b["default"])(u))?u.v:void 0}function i(t,e){var n=4,r=15;if(void 0===e&&(e=0),e+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return"undefined"==typeof t?"undefined":(0,b["default"])(t);if(!Array.isArray(t)){var o=(0,v["default"])(t);if(!o.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(e>n)return"{...}";var a="  ".repeat(e-1),s=o.slice(0,r).map(function(n){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(n)?n:(0,h["default"])(n))+": "+i(t[n],e)+";"}).join("\n  "+a);return o.length>=r&&(s+="\n  "+a+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+a+s+"\n"+a+"}":"{\n  "+a+s+"\n"+a+"}"}if(!(t.length>0))return"Array";var u=function(){if(e>n)return{v:"[...]"};var o=i(t[0],e);return t.every(function(t){return i(t,e)===o})?{v:o.trim()+"[]"}:{v:"["+t.slice(0,r).map(function(t){return i(t,e)}).join(", ")+(t.length>=r?", ...":"")+"]"}}();return"object"===("undefined"==typeof u?"undefined":(0,b["default"])(u))?u.v:void 0}e.__esModule=!0,e["default"]=void 0;var s,u,c,f,l,d,p,y=n(5),h=r(y),g=n(4),v=r(g),m=n(8),b=r(m),w=n(9),E=r(w),x=n(7),_=r(x),I=n(6),O=r(I),T=n(1),j=r(T),A=n(3),k=r(A),M=n(2),G=r(M),V=n(19),z=r(V),C=(s=(0,V.recoverFromNotFound)(),u=(0,V.recoverFromNotFound)(),c=(0,V.recoverFromNotFound)(),f=(0,V.recoverFromNotFound)(),l=(0,V.recoverFromNotFound)(),d=(0,V.recoverFromNotFound)(),p=function(t){function e(){return(0,j["default"])(this,e),(0,k["default"])(this,t.apply(this,arguments))}return(0,G["default"])(e,t),e.prototype.findAll=function(){function t(){return e.apply(this,arguments)}var e=(0,O["default"])(_["default"].mark(function n(){var t;return _["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.httpClient.get("/mute");case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}},n,this)}));return t}(),e.prototype.unmuteAll=function(){function t(){return e.apply(this,arguments)}var e=(0,O["default"])(_["default"].mark(function n(){return _["default"].wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.httpClient.del("/mute");case 2:case"end":return t.stop()}},n,this)}));return t}(),e.prototype.muteUser=function(){function t(t,n,r,o){return e.apply(this,arguments)}var e=(0,O["default"])(_["default"].mark(function n(t,e,r){var o=arguments.length<=3||void 0===arguments[3]?{}:arguments[3],s=o.recipientOrganizationId,u=void 0===s?r:s;return _["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof t){n.next=2;break}throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));case 2:if("number"==typeof e){n.next=4;break}throw new TypeError('Value of argument "durationInMinutes" violates contract.\n\nExpected:\nnumber\n\nGot:\n'+i(e));case 4:if("string"==typeof r){n.next=6;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(r));case 6:if("string"==typeof t){n.next=8;break}throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));case 8:if("number"==typeof e){n.next=10;break}throw new TypeError('Value of argument "durationInMinutes" violates contract.\n\nExpected:\nnumber\n\nGot:\n'+a(e));case 10:if("string"==typeof r){n.next=12;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(r));case 12:return n.next=14,this.httpClient.post("/mute/p2p",{data:{sender_token:t,sender_organization:r,receiver_organization:u,duration:e.toString()}});case 14:case"end":return n.stop()}},n,this)}));return t}(),e.prototype.unmuteUser=function(){function t(t,n,r){return e.apply(this,arguments)}var e=(0,O["default"])(_["default"].mark(function n(t,e){var r=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],o=r.recipientOrganizationId,s=void 0===o?e:o;return _["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof t){n.next=2;break}throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));case 2:if("string"==typeof e){n.next=4;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));case 4:if("string"==typeof t){n.next=6;break}throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));case 6:if("string"==typeof e){n.next=8;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));case 8:return n.next=10,this.httpClient.del("/mute/p2p",{headers:{"TT-X-Sender-Token":t,"TT-X-Sender-Organization":e,"TT-X-Receiver-Organization":s}});case 10:case"end":return n.stop()}},n,this)}));return t}(),e.prototype.muteGroup=function(){function t(t,n,r){return e.apply(this,arguments)}var e=(0,O["default"])(_["default"].mark(function n(t,e,r){return _["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof t){n.next=2;break}throw new TypeError('Value of argument "groupId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));case 2:if("number"==typeof e){n.next=4;break}throw new TypeError('Value of argument "durationInMinutes" violates contract.\n\nExpected:\nnumber\n\nGot:\n'+i(e));case 4:if("string"==typeof r){n.next=6;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(r));case 6:if("string"==typeof t){n.next=8;break}throw new TypeError('Value of argument "groupId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));case 8:if("number"==typeof e){n.next=10;break}throw new TypeError('Value of argument "durationInMinutes" violates contract.\n\nExpected:\nnumber\n\nGot:\n'+a(e));case 10:if("string"==typeof r){n.next=12;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(r));case 12:return n.next=14,this.httpClient.post("/mute/group/:groupId",{urlParams:{groupId:t},data:{duration:e.toString(),receiver_organization:r}});case 14:case"end":return n.stop()}},n,this)}));return t}(),e.prototype.unmuteGroup=function(){function t(t,n){return e.apply(this,arguments)}var e=(0,O["default"])(_["default"].mark(function n(t,e){return _["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof t){n.next=2;break}throw new TypeError('Value of argument "groupId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));case 2:if("string"==typeof e){n.next=4;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));case 4:if("string"==typeof t){n.next=6;break}throw new TypeError('Value of argument "groupId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));case 6:if("string"==typeof e){n.next=8;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));case 8:return n.next=10,this.httpClient.del("/mute/group/:groupId",{urlParams:{groupId:t},headers:{"TT-X-Receiver-Organization":e}});case 10:case"end":return n.stop()}},n,this)}));return t}(),e.prototype.muteOrganization=function(){function t(t,n){return e.apply(this,arguments)}var e=(0,O["default"])(_["default"].mark(function n(t,e){return _["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof t){n.next=2;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));case 2:if("number"==typeof e){n.next=4;break}throw new TypeError('Value of argument "durationInMinutes" violates contract.\n\nExpected:\nnumber\n\nGot:\n'+i(e));case 4:if("string"==typeof t){n.next=6;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));case 6:if("number"==typeof e){n.next=8;break}throw new TypeError('Value of argument "durationInMinutes" violates contract.\n\nExpected:\nnumber\n\nGot:\n'+a(e));case 8:return n.next=10,this.httpClient.post("/mute/organization/:organizationId",{urlParams:{organizationId:t},data:{duration:e.toString(),receiver_organization:t}});case 10:case"end":return n.stop()}},n,this)}));return t}(),e.prototype.unmuteOrganization=function(){function t(t){return e.apply(this,arguments)}var e=(0,O["default"])(_["default"].mark(function n(t){return _["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"==typeof t){e.next=2;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));case 2:if("string"==typeof t){e.next=4;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));case 4:return e.next=6,this.httpClient.del("/mute/organization/:organizationId",{urlParams:{organizationId:t},headers:{"TT-X-Receiver-Organization":t}});case 6:case"end":return e.stop()}},n,this)}));return t}(),e}(z["default"]),o(p.prototype,"muteUser",[s],(0,E["default"])(p.prototype,"muteUser"),p.prototype),o(p.prototype,"unmuteUser",[u],(0,E["default"])(p.prototype,"unmuteUser"),p.prototype),o(p.prototype,"muteGroup",[c],(0,E["default"])(p.prototype,"muteGroup"),p.prototype),o(p.prototype,"unmuteGroup",[f],(0,E["default"])(p.prototype,"unmuteGroup"),p.prototype),o(p.prototype,"muteOrganization",[l],(0,E["default"])(p.prototype,"muteOrganization"),p.prototype),o(p.prototype,"unmuteOrganization",[d],(0,E["default"])(p.prototype,"unmuteOrganization"),p.prototype),p);e["default"]=C,t.exports=e["default"]},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function o(t,e,n,r,o){var a={};return Object.keys(r).forEach(function(t){a[t]=r[t]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=n.slice().reverse().reduce(function(n,r){return r(t,e,n)||n},a),o&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(o):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(t,e,a),a=null),a}function a(t,e){var n=4,r=15;if(void 0===e&&(e=0),e+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return"undefined"==typeof t?"undefined":(0,h["default"])(t);if(!Array.isArray(t)){var o=(0,p["default"])(t);if(!o.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(e>n)return"{...}";var i="  ".repeat(e-1),s=o.slice(0,r).map(function(n){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(n)?n:(0,l["default"])(n))+": "+a(t[n],e)+";"}).join("\n  "+i);return o.length>=r&&(s+="\n  "+i+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+i+s+"\n"+i+"}":"{\n  "+i+s+"\n"+i+"}"}if(!(t.length>0))return"Array";var u=function(){if(e>n)return{v:"[...]"};var o=a(t[0],e);return t.every(function(t){return a(t,e)===o})?{v:o.trim()+"[]"}:{v:"["+t.slice(0,r).map(function(t){return a(t,e)}).join(", ")+(t.length>=r?", ...":"")+"]"}}();return"object"===("undefined"==typeof u?"undefined":(0,h["default"])(u))?u.v:void 0}function i(t,e){var n=4,r=15;if(void 0===e&&(e=0),e+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return"undefined"==typeof t?"undefined":(0,h["default"])(t);if(!Array.isArray(t)){var o=(0,p["default"])(t);if(!o.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(e>n)return"{...}";var a="  ".repeat(e-1),s=o.slice(0,r).map(function(n){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(n)?n:(0,l["default"])(n))+": "+i(t[n],e)+";"}).join("\n  "+a);return o.length>=r&&(s+="\n  "+a+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+a+s+"\n"+a+"}":"{\n  "+a+s+"\n"+a+"}"}if(!(t.length>0))return"Array";var u=function(){if(e>n)return{v:"[...]"};var o=i(t[0],e);return t.every(function(t){return i(t,e)===o})?{v:o.trim()+"[]"}:{v:"["+t.slice(0,r).map(function(t){return i(t,e)}).join(", ")+(t.length>=r?", ...":"")+"]"}}();return"object"===("undefined"==typeof u?"undefined":(0,h["default"])(u))?u.v:void 0}e.__esModule=!0,e["default"]=void 0;var s,u,c,f=n(5),l=r(f),d=n(4),p=r(d),y=n(8),h=r(y),g=n(9),v=r(g),m=n(7),b=r(m),w=n(6),E=r(w),x=n(1),_=r(x),I=n(3),O=r(I),T=n(2),j=r(T),A=n(19),k=r(A),M=(s=(0,A.recoverFromNotFound)(),u=(0,A.recoverFromNotFound)(),c=function(t){function e(){return(0,_["default"])(this,e),(0,O["default"])(this,t.apply(this,arguments))}return(0,j["default"])(e,t),e.prototype.find=function(){function t(t,n){return e.apply(this,arguments)}var e=(0,E["default"])(b["default"].mark(function n(t,e){var r;return b["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof t){n.next=2;break}throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));case 2:if("string"==typeof e){n.next=4;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));case 4:if("string"==typeof t){n.next=6;break}throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));case 6:if("string"==typeof e){n.next=8;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));case 8:return n.next=10,this.httpClient.get("/user/:userId/organization/:id",{urlParams:{userId:t,id:e}});case 10:return r=n.sent,n.abrupt("return",r.data);case 12:case"end":return n.stop()}},n,this)}));return t}(),e.prototype.findAllOfUser=function(){function t(t){return e.apply(this,arguments)}var e=(0,E["default"])(b["default"].mark(function n(t){var e;return b["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof t){n.next=2;break}throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));case 2:if("string"==typeof t){n.next=4;break}throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));case 4:return n.next=6,this.httpClient.get("/user/:userId/organization",{urlParams:{userId:t}});case 6:return e=n.sent,n.abrupt("return",e.data);case 8:case"end":return n.stop()}},n,this)}));return t}(),e}(k["default"]),o(c.prototype,"find",[s],(0,v["default"])(c.prototype,"find"),c.prototype),o(c.prototype,"findAllOfUser",[u],(0,v["default"])(c.prototype,"findAllOfUser"),c.prototype),c);e["default"]=M,t.exports=e["default"]},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){var n=4,r=15;if(void 0===e&&(e=0),e+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return"undefined"==typeof t?"undefined":(0,l["default"])(t);if(!Array.isArray(t)){var a=(0,c["default"])(t);if(!a.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(e>n)return"{...}";var i="  ".repeat(e-1),u=a.slice(0,r).map(function(n){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(n)?n:(0,s["default"])(n))+": "+o(t[n],e)+";"}).join("\n  "+i);return a.length>=r&&(u+="\n  "+i+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+i+u+"\n"+i+"}":"{\n  "+i+u+"\n"+i+"}"}if(!(t.length>0))return"Array";var f=function(){if(e>n)return{v:"[...]"};var a=o(t[0],e);return t.every(function(t){return o(t,e)===a})?{v:a.trim()+"[]"}:{v:"["+t.slice(0,r).map(function(t){return o(t,e)}).join(", ")+(t.length>=r?", ...":"")+"]"}}();return"object"===("undefined"==typeof f?"undefined":(0,l["default"])(f))?f.v:void 0}function a(t,e){var n=4,r=15;if(void 0===e&&(e=0),e+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return"undefined"==typeof t?"undefined":(0,l["default"])(t);if(!Array.isArray(t)){var o=(0,c["default"])(t);if(!o.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(e>n)return"{...}";
var i="  ".repeat(e-1),u=o.slice(0,r).map(function(n){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(n)?n:(0,s["default"])(n))+": "+a(t[n],e)+";"}).join("\n  "+i);return o.length>=r&&(u+="\n  "+i+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+i+u+"\n"+i+"}":"{\n  "+i+u+"\n"+i+"}"}if(!(t.length>0))return"Array";var f=function(){if(e>n)return{v:"[...]"};var o=a(t[0],e);return t.every(function(t){return a(t,e)===o})?{v:o.trim()+"[]"}:{v:"["+t.slice(0,r).map(function(t){return a(t,e)}).join(", ")+(t.length>=r?", ...":"")+"]"}}();return"object"===("undefined"==typeof f?"undefined":(0,l["default"])(f))?f.v:void 0}e.__esModule=!0,e["default"]=void 0;var i=n(5),s=r(i),u=n(4),c=r(u),f=n(8),l=r(f),d=n(7),p=r(d),y=n(6),h=r(y),g=n(1),v=r(g),m=n(3),b=r(m),w=n(2),E=r(w),x=n(150),_=r(x),I=n(19),O=r(I),T=["user","distributionList"],j=function(t){function e(){return(0,v["default"])(this,e),(0,b["default"])(this,t.apply(this,arguments))}return(0,E["default"])(e,t),e.prototype.findAll=function(){function t(){return e.apply(this,arguments)}var e=(0,h["default"])(p["default"].mark(function n(){var t;return p["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.httpClient.get("/roster");case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}},n,this)}));return t}(),e.prototype.add=function(){function t(t,n,r){return e.apply(this,arguments)}var e=(0,h["default"])(p["default"].mark(function n(t,e,r){var i,s;return p["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof t){n.next=2;break}throw new TypeError('Value of argument "counterPartyType" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));case 2:if("string"==typeof e){n.next=4;break}throw new TypeError('Value of argument "counterPartyId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));case 4:if("string"==typeof r){n.next=6;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(r));case 6:if("string"==typeof t){n.next=8;break}throw new TypeError('Value of argument "counterPartyType" violates contract.\n\nExpected:\nstring\n\nGot:\n'+o(t));case 8:if("string"==typeof e){n.next=10;break}throw new TypeError('Value of argument "counterPartyId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+o(e));case 10:if("string"==typeof r){n.next=12;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+o(r));case 12:if((0,_["default"])(T,t)){n.next=14;break}return n.abrupt("return");case 14:return i={},r&&(i["TT-X-Organization-Key"]=r),s=this.__typeToNS(t),n.next=19,this.httpClient.post("/roster",{headers:i,data:{entity:e,type:s}});case 19:case"end":return n.stop()}},n,this)}));return t}(),e.prototype.remove=function(){function t(t,n,r){return e.apply(this,arguments)}var e=(0,h["default"])(p["default"].mark(function n(t,e,r){var i,s;return p["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof t){n.next=2;break}throw new TypeError('Value of argument "counterPartyType" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));case 2:if("string"==typeof e){n.next=4;break}throw new TypeError('Value of argument "counterPartyId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));case 4:if("string"==typeof r){n.next=6;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(r));case 6:if("string"==typeof t){n.next=8;break}throw new TypeError('Value of argument "counterPartyType" violates contract.\n\nExpected:\nstring\n\nGot:\n'+o(t));case 8:if("string"==typeof e){n.next=10;break}throw new TypeError('Value of argument "counterPartyId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+o(e));case 10:if("string"==typeof r){n.next=12;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+o(r));case 12:if((0,_["default"])(T,t)){n.next=14;break}return n.abrupt("return");case 14:return i={},r&&(i["TT-X-Organization-Key"]=r),s=this.__typeToNS(t),n.next=19,this.httpClient.del("/roster/:counterPartyId",{headers:i,urlParams:{counterPartyId:e},data:{type:s}});case 19:case"end":return n.stop()}},n,this)}));return t}(),e.prototype.__typeToNS=function(t){return A[t]},e}(O["default"]);e["default"]=j;var A={user:"tigertext:entity:account",distributionList:"tigertext:entity:list"};t.exports=e["default"]},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function o(t,e,n,r,o){var a={};return Object.keys(r).forEach(function(t){a[t]=r[t]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=n.slice().reverse().reduce(function(n,r){return r(t,e,n)||n},a),o&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(o):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(t,e,a),a=null),a}function a(t,e){var n=4,r=15;if(void 0===e&&(e=0),e+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return"undefined"==typeof t?"undefined":(0,y["default"])(t);if(!Array.isArray(t)){var o=(0,d["default"])(t);if(!o.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(e>n)return"{...}";var i="  ".repeat(e-1),s=o.slice(0,r).map(function(n){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(n)?n:(0,f["default"])(n))+": "+a(t[n],e)+";"}).join("\n  "+i);return o.length>=r&&(s+="\n  "+i+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+i+s+"\n"+i+"}":"{\n  "+i+s+"\n"+i+"}"}if(!(t.length>0))return"Array";var u=function(){if(e>n)return{v:"[...]"};var o=a(t[0],e);return t.every(function(t){return a(t,e)===o})?{v:o.trim()+"[]"}:{v:"["+t.slice(0,r).map(function(t){return a(t,e)}).join(", ")+(t.length>=r?", ...":"")+"]"}}();return"object"===("undefined"==typeof u?"undefined":(0,y["default"])(u))?u.v:void 0}function i(t,e){var n=4,r=15;if(void 0===e&&(e=0),e+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return"undefined"==typeof t?"undefined":(0,y["default"])(t);if(!Array.isArray(t)){var o=(0,d["default"])(t);if(!o.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(e>n)return"{...}";var a="  ".repeat(e-1),s=o.slice(0,r).map(function(n){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(n)?n:(0,f["default"])(n))+": "+i(t[n],e)+";"}).join("\n  "+a);return o.length>=r&&(s+="\n  "+a+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+a+s+"\n"+a+"}":"{\n  "+a+s+"\n"+a+"}"}if(!(t.length>0))return"Array";var u=function(){if(e>n)return{v:"[...]"};var o=i(t[0],e);return t.every(function(t){return i(t,e)===o})?{v:o.trim()+"[]"}:{v:"["+t.slice(0,r).map(function(t){return i(t,e)}).join(", ")+(t.length>=r?", ...":"")+"]"}}();return"object"===("undefined"==typeof u?"undefined":(0,y["default"])(u))?u.v:void 0}e.__esModule=!0,e["default"]=void 0;var s,u,c=n(5),f=r(c),l=n(4),d=r(l),p=n(8),y=r(p),h=n(9),g=r(h),v=n(11),m=r(v),b=n(7),w=r(b),E=n(6),x=r(E),_=n(1),I=r(_),O=n(3),T=r(O),j=n(2),A=r(j),k=n(19),M=r(k),G=n(59),V=r(G),z=n(40),C=r(z),S=(s=(0,k.recoverFromNotFound)(),u=function(t){function e(){return(0,I["default"])(this,e),(0,T["default"])(this,t.apply(this,arguments))}return(0,A["default"])(e,t),e.getSignInAuthHeader=function(t,e,n){if("string"!=typeof t)throw new TypeError('Value of argument "productKey" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));if("string"!=typeof e)throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));if("string"!=typeof n)throw new TypeError('Value of argument "password" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(n));if("string"!=typeof t)throw new TypeError('Value of argument "productKey" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));if("string"!=typeof e)throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));if("string"!=typeof n)throw new TypeError('Value of argument "password" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(n));var r=[t,e,n].join(":"),o=(0,C["default"])(r),s="XMPP-Simple "+o;return s},e.prototype.getSignInAuthHeader=function(){var t;return(t=this.constructor).getSignInAuthHeader.apply(t,arguments)},e.prototype.find=function(){function t(t,n){return e.apply(this,arguments)}var e=(0,x["default"])(w["default"].mark(function n(t){var e,r,o=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],s=o.organizationId;return w["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof t){n.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));case 2:if("string"==typeof t){n.next=4;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));case 4:return e=s?{"TT-X-Organization-Key":s}:null,n.next=7,this.httpClient.get("/user/:id",{urlParams:{id:t},headers:e});case 7:return r=n.sent,n.abrupt("return",r.data);case 9:case"end":return n.stop()}},n,this)}));return t}(),e.prototype.findMe=function(){function t(t){return e.apply(this,arguments)}var e=(0,x["default"])(w["default"].mark(function n(){var t,e,r=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],o=r.organizationId;return w["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t=o?{"TT-X-Organization-Key":o}:null,n.next=3,this.httpClient.get("/user",{headers:t});case 3:return e=n.sent,n.abrupt("return",e.data);case 5:case"end":return n.stop()}},n,this)}));return t}(),e.prototype.update=function(){function t(t,n){return e.apply(this,arguments)}var e=(0,x["default"])(w["default"].mark(function n(t,e){var r,o,s,u,c=e.firstName,f=void 0===c?void 0:c,l=e.lastName,d=void 0===l?void 0:l,p=e.displayName,y=void 0===p?void 0:p,h=e.status,g=void 0===h?void 0:h,v=e.dnd,b=void 0===v?void 0:v,E=e.dndText,x=void 0===E?void 0:E,_=e.avatarFile,I=void 0===_?void 0:_,O=e.removeAvatar,T=void 0===O?void 0:O;return w["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"==typeof t){e.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));case 2:if("string"==typeof t){e.next=4;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));case 4:return o={},T?o.avatar=null:I&&(o.avatar=I),s=(r={first_name:f,last_name:d,display_name:y,status:g,dnd:b,dnd_text:x},V["default"]).call(r,function(t,e){return"undefined"==typeof t}),e.next=9,this.httpClient.post("/user/:id/settings",{urlParams:{id:t},data:s,files:o});case 9:return u=e.sent,e.abrupt("return",(0,m["default"])({id:t},I&&I.preview?{avatarUrl:I.preview}:null));case 11:case"end":return e.stop()}},n,this)}));return t}(),e.prototype.updatePassword=function(){function t(t,n,r,o){return e.apply(this,arguments)}var e=(0,x["default"])(w["default"].mark(function n(t,e,r,o){var s,u;return w["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof t){n.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));case 2:if("string"==typeof e){n.next=4;break}throw new TypeError('Value of argument "currentPassword" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));case 4:if("string"==typeof r){n.next=6;break}throw new TypeError('Value of argument "newPassword" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(r));case 6:if("string"==typeof o){n.next=8;break}throw new TypeError('Value of argument "productKey" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(o));case 8:if("string"==typeof t){n.next=10;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));case 10:if("string"==typeof e){n.next=12;break}throw new TypeError('Value of argument "currentPassword" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));case 12:if("string"==typeof r){n.next=14;break}throw new TypeError('Value of argument "newPassword" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(r));case 14:if("string"==typeof o){n.next=16;break}throw new TypeError('Value of argument "productKey" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(o));case 16:return s={Authorization:this.getSignInAuthHeader(o,t,e)},n.next=19,this.httpClient.post("/user/:id/password",{urlParams:{id:t},headers:s,data:{password:r}});case 19:return u=n.sent,n.abrupt("return",u);case 21:case"end":return n.stop()}},n,this)}));return t}(),e}(M["default"]),o(u.prototype,"find",[s],(0,g["default"])(u.prototype,"find"),u.prototype),u);e["default"]=S,t.exports=e["default"]},function(t,e,n){"use strict";e.__esModule=!0;var r={Roster:n(80),Users:n(81),Groups:n(75),DistributionLists:n(74),Organizations:n(79),Messages:n(76),Metadata:n(77),Mute:n(78)};e["default"]=r,t.exports=e["default"]},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}e.__esModule=!0,e["default"]=void 0;var o,a,i=n(1),s=r(i),u=n(3),c=r(u),f=n(2),l=r(f),d=(a=o=function(t){function e(){(0,s["default"])(this,e);var n=(0,c["default"])(this,t.call(this,"No internet connection"));return n.code=e.CODE,n}return(0,l["default"])(e,t),e}(Error),o.CODE="connection-unavailable",a);e["default"]=d,t.exports=e["default"]},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}e.__esModule=!0,e["default"]=void 0;var o,a,i=n(1),s=r(i),u=n(3),c=r(u),f=n(2),l=r(f),d=(a=o=function(t){function e(n,r,o){(0,s["default"])(this,e);var a=(0,c["default"])(this,t.call(this,o));return a.code=e.CODE,a.resource=n,a.id=r,a}return(0,l["default"])(e,t),e}(Error),o.CODE="not-found",a);e["default"]=d,t.exports=e["default"]},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}e.__esModule=!0,e["default"]=void 0;var o,a,i=n(1),s=r(i),u=n(3),c=r(u),f=n(2),l=r(f),d=(a=o=function(t){function e(){(0,s["default"])(this,e);for(var n=arguments.length,r=Array(n),o=0;o<n;o++)r[o]=arguments[o];var a=(0,c["default"])(this,t.call.apply(t,[this].concat(r)));return a.code=e.CODE,a}return(0,l["default"])(e,t),e}(Error),o.CODE="not-signed-in",a);e["default"]=d,t.exports=e["default"]},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}e.__esModule=!0,e["default"]=void 0;var o,a,i=n(1),s=r(i),u=n(3),c=r(u),f=n(2),l=r(f),d=(a=o=function(t){function e(n,r,o){var a=arguments.length<=3||void 0===arguments[3]?"can't perform action "+o+" on "+(n.name||n)+" #"+r:arguments[3];(0,s["default"])(this,e);var i=(0,c["default"])(this,t.call(this,a));return i.code=e.CODE,i.resource=n,i.action=o,i.id=r,i}return(0,l["default"])(e,t),e}(Error),o.CODE="permission-denied",a);e["default"]=d,t.exports=e["default"]},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}e.__esModule=!0,e["default"]=void 0;var o,a,i=n(1),s=r(i),u=n(3),c=r(u),f=n(2),l=r(f),d=(a=o=function(t){function e(n){return(0,s["default"])(this,e),(0,c["default"])(this,t.call(this,"method"+(n?" "+n:"")+" not supported in target node"))}return(0,l["default"])(e,t),e.raise=function(t){throw new this(t)},e}(Error),o.CODE="target-not-supported",a);e["default"]=d,t.exports=e["default"]},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}e.__esModule=!0,e["default"]=void 0;var o,a,i=n(1),s=r(i),u=n(3),c=r(u),f=n(2),l=r(f),d=(a=o=function(t){function e(){(0,s["default"])(this,e);for(var n=arguments.length,r=Array(n),o=0;o<n;o++)r[o]=arguments[o];var a=(0,c["default"])(this,t.call.apply(t,[this].concat(r)));return a.code=e.CODE,a}return(0,l["default"])(e,t),e}(Error),o.CODE="wrong-credentials",a);e["default"]=d,t.exports=e["default"]},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}e.__esModule=!0;var o=n(33),a=r(o);e["default"]=function(t){var e=t.defineModel("conversation",{instanceEvents:!0,transientAttrs:["messages","timeline","lastMessage","unreadCount","unreadMessages","lastEventMessageSortNumber","_counterPartyAddedOnServer"],defaultValues:{lastEventMessageSortNumber:0,messages:[],timeline:[],unreadMessages:[],unreadCount:0},computed:{counterParty:{enumerable:!0,get:function(){return this.counterPartyType&&this.counterPartyId?t.store.get(this.counterPartyType,this.counterPartyId):null},set:function(t){if(t)switch(t.$entityType){case"user":case"group":case"distributionList":this.counterPartyId=t.id,this.counterPartyType=t.$entityType;break;default:throw new Error("unsupported counterPartyType '"+t.$entityType+"'")}else this.counterPartyId=null,this.counterPartyType=null}},lastMessageId:{enumerable:!0,get:function(){return(0,a["default"])(this.lastMessage,"id")}},muteSettings:{enumerable:!0,get:function(){return t.host.mute.getByConversationId(this.id)}},isMuted:{enumerable:!0,get:function(){return!!this.muteSettings}}},relations:{belongsTo:{organization:{type:"organization",foreignKey:"organizationId"}}}});return e};var i=n(37);r(i),t.exports=e["default"]},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}e.__esModule=!0,e["default"]=function(t,e){var n=t.defineModel("distributionList",{replaceKeys:{organizationKey:"organizationId",totalMembers:"memberCount",avatar:"avatarUrl",displayName:"name"},defaultValues:{memberCount:0},computed:{displayName:{configurable:!0,enumerable:!0,get:function(){return this.name},set:function(t){return this.name=t}}},relations:{belongsTo:{organization:{type:"organization",foreignKey:"organizationId"}}}});return(0,a["default"])(n,{finder:function(){var t;return(t=e.host.distributionLists).find.apply(t,arguments)},placeholderEntityDelayBeforeRefreshing:function(){return t.host.config.placeholderEntityDelayBeforeRefreshing},placeholderEntityAllowLoading:function(){return t.host.config.placeholderEntityAllowLoading},defaultPlaceholderAttrs:{name:"Loading Distribution List..."},defaultNotFoundAttrs:{name:"<Distribution List Not Found>"}}),n};var o=n(31),a=r(o);t.exports=e["default"]},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}e.__esModule=!0,e["default"]=void 0;var o=n(16),a=r(o),i=n(26),s=r(i),u=n(1),c=r(u),f=function(){function t(e,n,r,o){var i=this;(0,c["default"])(this,t),this.id=e,this.type=n,this.data=r,o&&!function(){var t=o._origData,e=(0,s["default"])(o,["_origData"]);Object.defineProperty(i,"_origData",{get:function(){return t}}),(0,a["default"])(i,e)}()}return t.is=function(t){return t instanceof this},t}();e["default"]=f,t.exports=e["default"]},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}e.__esModule=!0;var o=n(33),a=r(o);e["default"]=function(t,e){function n(t,n){n&&e.host.groups.ensureMembersWithIds(t,n,{onlyPlaceholder:!0})}var r=t.defineModel("group",{replaceKeys:{organizationKey:"organizationId",createdBy:"createdByUserId",members:"memberIds",avatar:"avatarUrl",displayName:"name",numMembers:"__memberCount",createdTime:"createdAt"},transientAttrs:["__memberCount"],defaultValues:{memberIds:[],memberCount:0,groupType:u.GroupType.GROUP},validate:function(){f["default"].notEmpty("groupType",this.groupType)},__extractGroupTypeFromAttrs:function(t){return t.type||t.xmlns,t.isPublic?u.GroupType.ROOM:null},parseAttrs:function(t){var e=this.__extractGroupTypeFromAttrs(t);return e&&(t.groupType=e),"createdAt"in t&&(t.createdAt=new Date(t.createdAt)),t},beforeCreateInstance:function(t){n(t.id,t.memberIds)},computed:{memberCount:{enumerable:!0,get:function(){return this.memberIds&&this.memberIds.length||this.__memberCount||0}},metadata:{enumerable:!0,get:function(){var e=t.store.get("metadata",this.id+":"+this.organizationId);return e?e.data:null}},members:{enumerable:!0,get:function(){return this.memberIds?this.memberIds.map(function(e){return t.store.get("user",e)}):[]}},conversation:{enumerable:!0,get:function(){return e.host.conversations.get("group",this.id,this.organizationId)}},conversationId:{enumerable:!0,get:function(){return(0,a["default"])(e.host.conversations.get("group",this.id,this.organizationId),"id")}},displayName:{configurable:!0,enumerable:!0,get:function(){return this.name},set:function(t){return this.name=t}}},relations:{belongsTo:{organization:{type:"organization",foreignKey:"organizationId"},createdByUser:{type:"user",foreignKey:"createdByUserId"}}}});return(0,s["default"])(r,{finder:function(){var t;return(t=e.host.groups).find.apply(t,arguments)},placeholderEntityDelayBeforeRefreshing:function(){return t.host.config.placeholderEntityDelayBeforeRefreshing},placeholderEntityAllowLoading:function(){return t.host.config.placeholderEntityAllowLoading},defaultPlaceholderAttrs:{displayName:"Loading group..."},defaultNotFoundAttrs:{displayName:"<Group Not Found>"},shouldEnsure:function(t,n,r){var o=r.groupMembersOnlyPlaceholder;return t.members.some(function(t){return e.host.models.User.shouldEnsure(t,o)})}}),r};var i=n(31),s=r(i),u=n(23),c=n(25),f=r(c);t.exports=e["default"]},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}e.__esModule=!0,e["default"]=function(t){var e=t.defineModel("message",{replaceKeys:{messageId:"id",clientId:"id",senderToken:"senderId",sender:"senderId",recipientToken:"recipientId",recipient:"recipientId",senderOrganization:"senderOrganizationId",recipientOrganization:"recipientOrganizationId",groupToken:"groupId",originalSender:"originalSenderId",originalTimestamp:"originalForwardedMessageCreatedAt",status:"recipientStatus",data:"metadata",dor:"deleteOnRead",createdTime:"createdAt"},transientAttrs:["groupMembersChange"],defaultValues:{recipientStatus:o.MessageRecipientStatus.NEW,senderStatus:o.MessageRecipientStatus.NEW,sortNumber:0,messageType:o.MessageType.USER_SENT},fields:{id:{type:"string"},senderStatus:{type:"enum","enum":o.MessageSenderStatus,require:!0},recipientStatus:{type:"enum","enum":o.MessageRecipientStatus,require:!0},direction:{type:"enum","enum":o.MessageDirection,require:!0},priority:{type:"enum","enum":o.MessagePriority},counterPartyId:{type:"string",require:!0},counterPartyType:{type:"enum",values:["user","group","distributionList"],require:!0},createdAt:{type:Date,require:!0}},parseAttrs:function(t){if(t.recipientStatus&&(t.recipientStatus=o.MessageRecipientStatus.resolve(t.recipientStatus)),"attachmentName"in t){var e=t.attachmentName;delete t.attachmentName,Array.isArray(t.attachments)&&t.attachments.length>0&&e&&(t.attachments[0].name=e)}if(Array.isArray(t.attachments)&&t.attachments.forEach(function(t,e){return t.id=""+(e+1)}),"priority"in t&&(t.priority=o.MessagePriority.resolve(t.priority)),"createdAt"in t&&"string"==typeof t.createdAt&&(t.createdAt=new Date(t.createdAt)),"ttl"in t&&t.createdAt){var n=(0,i["default"])(t.createdAt).add(t.ttl,"minute").toDate().getTime();t.expiresAt=n}return t},relations:{belongsTo:{sender:{type:"user",foreignKey:"senderId"},recipient:{type:"user",foreignKey:"recipientId"},originalSender:{type:"user",foreignKey:"originalSenderId"},senderOrganization:{type:"organization",foreignKey:"senderOrganizationId"},recipientOrganization:{type:"organization",foreignKey:"recipientOrganizationId"},group:{type:"group",foreignKey:"groupId"},distributionList:{type:"distributionList",foreignKey:"distributionListId"},conversation:{type:"conversation",foreignKey:"conversationId"}},hasMany:{statusesPerRecipient:{type:"messageStatusPerRecipient",foreignKey:"messageId"}}},computed:{counterParty:{enumerable:!0,get:function(){return this.counterPartyType&&this.counterPartyId?t.store.get(this.counterPartyType,this.counterPartyId):null},set:function(t){if(t){switch(t.$entityType){case"user":this.recipientId=t.id;break;case"group":this.groupId=t.id;break;case"distributionList":this.distributionListId=t.id;break;default:throw new Error("unsupported counterPartyType '"+t.$entityType+"'")}this.counterPartyId=t.id,this.counterPartyType=t.$entityType}else this.counterPartyId=null,this.counterPartyType=null}}}});return e};var o=n(23),a=n(47),i=r(a);t.exports=e["default"]},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}e.__esModule=!0,e["default"]=function(t){var e=t.defineModel("messageStatusPerRecipient",{replaceKeys:{accountId:"userId",timestamp:"createdAt"},defaultValues:{status:a["default"].NEW},fields:{userId:{type:String,require:!0},messageId:{type:String,require:!0},recipientStatus:{type:"enum","enum":a["default"],require:!0},createdAt:{type:Date,require:!0}},parseAttrs:function(t){return t.status&&(t.status=a["default"].resolve(t.status)),t},relations:{belongsTo:{message:{type:"message",foreignKey:"messageId"},user:{type:"user",foreignKey:"userId"}}}});return e};var o=n(37),a=r(o);t.exports=e["default"]},function(t,e){"use strict";e.__esModule=!0,e["default"]=function(t,e){var n=t.defineModel("metadata",{fields:{entityType:{type:"string",required:!0},entityId:{type:"string",required:!0},organizationId:{type:"string",required:!0}},relations:{belongsTo:{organization:{type:"organization",foreignKey:"organizationId"}}},parseAttrs:function(t,e){return t.data=e.data,t}});return n},t.exports=e["default"]},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}e.__esModule=!0,e["default"]=function(t,e){var n,r=t.defineModel("organization",(n={instanceEvents:!0,replaceKeys:{members:"memberCount",dor:"deleteOnRead"},defaultValues:{settings:{}},fields:{},transientAttrs:["conversations","unreadCount"]},n.defaultValues={conversations:[]},n.parseAttrs=function(t){if(t.settings){var e;t.settings=(e=(e=t.settings,c["default"]).call(e,function(t){return s["default"].camelizeKey(t.name)}),d["default"]).call(e,function(t){isFinite(t.value)&&(t.value=+t.value),"true"===t.value&&(t.value=!0),"false"===t.value&&(t.value=!1)})}return t},n.methods={getSettingValue:function(t){return this.settings&&t in this.settings?this.settings[t].value:null},getSettingEntry:function(t){return this.settings&&t in this.settings?this.settings[t]:null}},n));return(0,a["default"])(r,{finder:function(){var t;return(t=e.host.organizations).find.apply(t,arguments)},placeholderEntityDelayBeforeRefreshing:function(){return t.host.config.placeholderEntityDelayBeforeRefreshing},placeholderEntityAllowLoading:function(){return t.host.config.placeholderEntityAllowLoading},defaultPlaceholderAttrs:{name:"Loading Organization..."},defaultNotFoundAttrs:{displayName:"<Organization Not Found>"}}),r};var o=n(31),a=r(o),i=n(32),s=r(i),u=n(56),c=r(u),f=n(58),l=(r(f),n(137)),d=r(l);t.exports=e["default"]},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}e.__esModule=!0,e["default"]=void 0;var o=n(1),a=r(o),i=function(){function t(e,n){(0,a["default"])(this,t),this.id="searchResult:"+n+":"+e.id,this.entityType=e.$entityType,this.entityId=e.id,this.entity=e,this.organizationId=n}return t.is=function(t){return t instanceof this},t}();e["default"]=i,t.exports=e["default"]},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}e.__esModule=!0;var o=n(11),a=r(o),i=n(34),s=r(i),u=n(29),c=r(u);e["default"]=function(t,e){var n=t.defineModel("user",{transientAttrs:[],replaceKeys:{avatar:"avatarUrl",organizationToken:"organizationId",organizationKey:"organizationId",timeToLive:"messagesTTL"},defaultValues:{profileByOrganizationId:{}},parseAttrs:function(t){var e=t.organizationId;if(e){delete t.organizationId;var n=(0,a["default"])({},(0,c["default"])(t,w),{organizationId:e});(0,s["default"])(n)||(t.profileByOrganizationId||(t.profileByOrganizationId={}),t.profileByOrganizationId[e]=n)}return t},beforeInject:function(t,e){e&&t.profileByOrganizationId&&(t.profileByOrganizationId=(0,a["default"])({},e.profileByOrganizationId,t.profileByOrganizationId))},computed:{metadataByOrganizationId:{enumerable:!0,get:function(){var e;return(e=(e=(e=t.store.getAll("metadata"),h["default"]).call(e,{entityId:this.id}),v["default"]).call(e,"organizationId"),b["default"]).call(e,"data")}},presence:{enumerable:!0,get:function(){return t.host.presence.get(this.id)||p["default"].UNKNOWN}}}});return(0,l["default"])(n,{finder:function(){var t;return(t=e.host.users).find.apply(t,arguments)},placeholderEntityDelayBeforeRefreshing:function(){return t.host.config.placeholderEntityDelayBeforeRefreshing},placeholderEntityAllowLoading:function(){return t.host.config.placeholderEntityAllowLoading},defaultPlaceholderAttrs:{displayName:"Loading..."},defaultNotFoundAttrs:{displayName:"<User Not Found>"}}),n};var f=n(31),l=r(f),d=n(49),p=r(d),y=n(28),h=r(y),g=n(56),v=r(g),m=n(58),b=r(m),w=["title","department"];t.exports=e["default"]},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}e.__esModule=!0;var o=n(20),a=r(o),i=new a["default"](["GROUP","ROOM"]);e["default"]=i,t.exports=e["default"]},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}e.__esModule=!0;var o=n(20),a=r(o),i=new a["default"](["INCOMING","OUTGOING"]);e["default"]=i,t.exports=e["default"]},function(t,e,n){"use strict";e.__esModule=!0;var r=n(20),o=new r.ServerValueEnum({LOW:{serverValue:-1},NORMAL:{serverValue:0},HIGH:{serverValue:1}},{defaultValue:"NORMAL"});e["default"]=o,t.exports=e["default"]},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}e.__esModule=!0;var o=n(20),a=r(o),i=new a["default"](["SENDING","SENT","FAILED","RETRYING","NEW","NA"]);e["default"]=i,t.exports=e["default"]},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}e.__esModule=!0;var o=n(20),a=r(o),i=new a["default"](["USER_SENT","GROUP_MEMBERSHIP_CHANGE"]);e["default"]=i,t.exports=e["default"]},function(t,e,n){"use strict";e.__esModule=!0;var r={User:n(98),Group:n(92),DistributionList:n(90),Organization:n(96),Message:n(93),MessageStatusPerRecipient:n(94),Conversation:n(89),Metadata:n(95)};e["default"]=r,t.exports=e["default"]},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function o(t,e,n,r,o){var a={};return Object.keys(r).forEach(function(t){a[t]=r[t]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=n.slice().reverse().reduce(function(n,r){return r(t,e,n)||n},a),o&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(o):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(t,e,a),a=null),a}function a(t,e){var n=4,r=15;if(void 0===e&&(e=0),e+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return"undefined"==typeof t?"undefined":(0,E["default"])(t);if(!Array.isArray(t)){var o=(0,b["default"])(t);if(!o.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(e>n)return"{...}";var i="  ".repeat(e-1),s=o.slice(0,r).map(function(n){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(n)?n:(0,v["default"])(n))+": "+a(t[n],e)+";"}).join("\n  "+i);return o.length>=r&&(s+="\n  "+i+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+i+s+"\n"+i+"}":"{\n  "+i+s+"\n"+i+"}"}if(!(t.length>0))return"Array";var u=function(){if(e>n)return{v:"[...]"};var o=a(t[0],e);return t.every(function(t){return a(t,e)===o})?{v:o.trim()+"[]"}:{v:"["+t.slice(0,r).map(function(t){return a(t,e)}).join(", ")+(t.length>=r?", ...":"")+"]"}}();return"object"===("undefined"==typeof u?"undefined":(0,E["default"])(u))?u.v:void 0}function i(t,e){var n=4,r=15;if(void 0===e&&(e=0),e+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return"undefined"==typeof t?"undefined":(0,E["default"])(t);if(!Array.isArray(t)){var o=(0,b["default"])(t);if(!o.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";
if(e>n)return"{...}";var a="  ".repeat(e-1),s=o.slice(0,r).map(function(n){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(n)?n:(0,v["default"])(n))+": "+i(t[n],e)+";"}).join("\n  "+a);return o.length>=r&&(s+="\n  "+a+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+a+s+"\n"+a+"}":"{\n  "+a+s+"\n"+a+"}"}if(!(t.length>0))return"Array";var u=function(){if(e>n)return{v:"[...]"};var o=i(t[0],e);return t.every(function(t){return i(t,e)===o})?{v:o.trim()+"[]"}:{v:"["+t.slice(0,r).map(function(t){return i(t,e)}).join(", ")+(t.length>=r?", ...":"")+"]"}}();return"object"===("undefined"==typeof u?"undefined":(0,E["default"])(u))?u.v:void 0}e.__esModule=!0,e["default"]=void 0;var s,u,c,f,l,d,p,y,h,g=n(5),v=r(g),m=n(4),b=r(m),w=n(8),E=r(w),x=n(9),_=r(x),I=n(17),O=r(I),T=n(26),j=r(T),A=n(7),k=r(A),M=n(6),G=r(M),V=n(1),z=r(V),C=n(3),S=r(C),P=n(2),N=r(P),R=n(22),U=r(R),q=n(156),F=r(q),$=n(44),L=r($),D=n(29),B=r(D),K=n(63),Z=r(K),W=n(18),H=r(W),X=n(46),Q=r(X),Y=n(10),J=r(Y),tt=n(14),et=n(55),nt=r(et),rt=n(70),ot=r(rt),at=n(21),it=r(at),st=n(12),ut=n(23),ct=n(134),ft=r(ct),lt=n(25),dt=r(lt),pt=n(24),yt=r(pt),ht=n(43),gt=r(ht),vt=n(28),mt=r(vt),bt=n(42),wt=r(bt),Et=n(61),xt=r(Et),_t=n(15),It="tigertext:entity:account",Ot=new nt["default"].MD5,Tt=(s={},s.ADD="added",s.REMOVE="removed",s.LEAVE="left",s.JOIN="joined",s),jt=(u={},u.ADD="to",u.REMOVE="from",u),At=(c={},c.GROUP="group",c.ROOM="room",c),kt=(f=(0,tt.decorator)(),l=(0,tt.decorator)(),d=(0,tt.decorator)(),p=(0,tt.decorator)(),(0,st.classWithPrivateMethods)((h=function(t){function e(){(0,z["default"])(this,e);for(var n=arguments.length,r=Array(n),o=0;o<n;o++)r[o]=arguments[o];var a=(0,S["default"])(this,t.call.apply(t,[this].concat(r)));return a._throtelled__flushConversationsToReload=a.config.conversationReloadDelay?a._throtelled__flushConversationsToReload=(0,Q["default"])(a.__flushConversationsToReload,a.config.conversationReloadDelay,{leading:!1}):a.__flushConversationsToReload,a}return(0,N["default"])(e,t),e.prototype.mounted=function(){this._fetched=!1,this.host.on("message:sending",this._onMessageSending),this.host.on("message:sent",this._onMessageSent),this.host.models.Message.on("afterInject",this._onMessageChange),this.host.models.Message.on("afterEject",this._onMessageChange),this.host.models.Group.on("afterEject",this._onGroupDelete),this.__queuedConversationsToReload=[]},e.prototype.dispose=function(){this._fetched=!1,this.host.removeListener("message:sending",this._onMessageSending),this.host.removeListener("message:sent",this._onMessageSent),this.host.models.Message.off("afterInject",this._onMessageChange),this.host.models.Message.off("afterEject",this._onMessageChange),this.host.models.Group.off("afterEject",this._onGroupDelete),this.__queuedConversationsToReload=null,this._throtelled__flushConversationsToReload.cancel&&this._throtelled__flushConversationsToReload.cancel()},e.prototype.findAll=function(){function t(t){return e.apply(this,arguments)}var e=(0,G["default"])(k["default"].mark(function n(){var t,e,r,o=this,a=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];return k["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(a=(0,H["default"])(a,{includeMutes:!0}),!this._fetched){n.next=3;break}return n.abrupt("return",this.getAll());case 3:return n.next=5,this.host.api.roster.findAll();case 5:if(t=n.sent,e=t.slice(),t.forEach(function(t,n){t.type===It&&(e[n]={counterParty:o.host.injectModel(t),organizationId:t.organization_key})}),t.forEach(function(t,n){t.type!==It&&(e[n]={counterParty:o.host.injectModel(t),organizationId:t.organization_key})}),r=e.filter(Boolean).map(function(t){var e=t.counterParty,n=t.organizationId;delete e.$placeholder;var r=o.ensureConversation(e.$entityType,e.id,n,{ensureEntities:{organization:"full"}});return r._counterPartyAddedOnServer=!0,r}),!a.includeMutes){n.next=13;break}return n.next=13,this.host.mute.findAll();case 13:return this._fetched=!0,n.abrupt("return",r);case 15:case"end":return n.stop()}},n,this)}));return t}(),e.prototype.find=function(){function t(t,n){return e.apply(this,arguments)}var e=(0,G["default"])(k["default"].mark(function n(t){var e,r=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return k["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof t){n.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));case 2:if("string"==typeof t){n.next=4;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));case 4:if(r=(0,Z["default"])(r,{ensureEntities:{counterParty:"full",organization:"full",messageCounterParties:"full",groupMembers:"full",touchOnRelatedEntityLoad:!1}}),e=this.getById(t),!e){n.next=10;break}return n.next=9,this.__ensureEntities(e,r.ensureEntities);case 9:return n.abrupt("return",e);case 10:return n.next=12,this.findAll();case 12:if(e=this.getById(t)){n.next=15;break}throw new errors.NotFoundError(this.host.models.Conversation.name,t);case 15:return n.next=17,this.__ensureEntities(e,r.ensureEntities);case 17:return n.abrupt("return",e);case 18:case"end":return n.stop()}},n,this)}));return t}(),e.prototype.refetch=function(){function t(){return e.apply(this,arguments)}var e=(0,G["default"])(k["default"].mark(function n(){return k["default"].wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this._fetched=!1,t.abrupt("return",this.findAll());case 2:case"end":return t.stop()}},n,this)}));return t}(),e.prototype.markAllMessagesAsRead=function(){function t(t){return e.apply(this,arguments)}var e=(0,G["default"])(k["default"].mark(function n(t){var e;return k["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof t||t instanceof Object){n.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(t));case 2:if("string"==typeof t||t instanceof Object){n.next=4;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(t));case 4:if(t=this._resolveModelId(t),e=this.getById(t)){n.next=8;break}return n.abrupt("return");case 8:return n.abrupt("return",this.host.messages.markAsRead(e.unreadMessages));case 9:case"end":return n.stop()}},n,this)}));return t}(),e.prototype.add=function(){function t(t,n,r){return e.apply(this,arguments)}var e=(0,G["default"])(k["default"].mark(function n(t,e,r){var o;return k["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof t){n.next=2;break}throw new TypeError('Value of argument "counterPartyType" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));case 2:if("string"==typeof e){n.next=4;break}throw new TypeError('Value of argument "counterPartyId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));case 4:if("string"==typeof r){n.next=6;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(r));case 6:if("string"==typeof t){n.next=8;break}throw new TypeError('Value of argument "counterPartyType" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));case 8:if("string"==typeof e){n.next=10;break}throw new TypeError('Value of argument "counterPartyId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));case 10:if("string"==typeof r){n.next=12;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(r));case 12:return o=this.ensureConversation(t,e,r),n.prev=13,n.next=16,this.host.api.roster.add(t,e,r);case 16:n.next=21;break;case 18:n.prev=18,n.t0=n["catch"](13),this.logger.warn("can't add "+e+" "+t,n.t0);case 21:o._counterPartyAddedOnServer=!0;case 22:case"end":return n.stop()}},n,this,[[13,18]])}));return t}(),e.prototype.remove=function(){function t(t,n,r){return e.apply(this,arguments)}var e=(0,G["default"])(k["default"].mark(function n(t,e,r){return k["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof t){n.next=2;break}throw new TypeError('Value of argument "counterPartyType" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));case 2:if("string"==typeof e){n.next=4;break}throw new TypeError('Value of argument "counterPartyId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));case 4:if("string"==typeof r){n.next=6;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(r));case 6:if("string"==typeof t){n.next=8;break}throw new TypeError('Value of argument "counterPartyType" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));case 8:if("string"==typeof e){n.next=10;break}throw new TypeError('Value of argument "counterPartyId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));case 10:if("string"==typeof r){n.next=12;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(r));case 12:return this.ejectConversation(t,e,r),n.prev=13,n.next=16,this.host.api.roster.remove(t,e,r);case 16:n.next=21;break;case 18:n.prev=18,n.t0=n["catch"](13),this.logger.warn("can't remove "+e+" "+t);case 21:case"end":return n.stop()}},n,this,[[13,18]])}));return t}(),e.prototype.ensureConversation=function(t,e,n){var r=arguments.length<=3||void 0===arguments[3]?{}:arguments[3];if("string"!=typeof t)throw new TypeError('Value of argument "counterPartyType" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));if("string"!=typeof e)throw new TypeError('Value of argument "counterPartyId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));if("string"!=typeof n)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(n));if("string"!=typeof t)throw new TypeError('Value of argument "counterPartyType" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));if("string"!=typeof e)throw new TypeError('Value of argument "counterPartyId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));if("string"!=typeof n)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(n));r=(0,Z["default"])(r,{ensureEntities:{counterParty:!1,organization:!1,messageCounterParties:!1,groupMembers:!1,touchOnRelatedEntityLoad:!0}});var o=this.getConversationKey(t,e,n),s=this.get(t,e,n);return s?(this.__ensureEntities(s,r.ensureEntities),s):(s=this.host.models.Conversation.createInstance({id:o,counterPartyType:t,counterPartyId:e,organizationId:n,_origIndex:this.host.models.Conversation.getAll().length}),this.__ensureEntities(s,r.ensureEntities),this.host.models.Conversation.inject(s),this.__notifyOrganizationChange(s.organizationId),s)},e.prototype.ejectConversation=function(t,e,n){if("string"!=typeof t)throw new TypeError('Value of argument "counterPartyType" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));if("string"!=typeof e)throw new TypeError('Value of argument "counterPartyId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));if("string"!=typeof n)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(n));if("string"!=typeof t)throw new TypeError('Value of argument "counterPartyType" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));if("string"!=typeof e)throw new TypeError('Value of argument "counterPartyId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));if("string"!=typeof n)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(n));var r=this.get(t,e,n);return r&&(this.host.models.Conversation.eject(r),this.__notifyOrganizationChange(r.organizationId)),r},e.prototype.reactToMessageEvent=function(t){if(!(t instanceof Object))throw new TypeError('Value of argument "event" violates contract.\n\nExpected:\nObject\n\nGot:\n'+i(t));if(!(t instanceof Object))throw new TypeError('Value of argument "event" violates contract.\n\nExpected:\nObject\n\nGot:\n'+a(t));var e=this.host.currentUserId,n=this.host.models.Message.parseAttrs(t.data);n.messageType=ut.MessageType.USER_SENT,n.direction=n.senderId==e?ut.MessageDirection.OUTGOING:ut.MessageDirection.INCOMING,n.groupId?(n.counterPartyType="group",n.counterPartyId=n.groupId):n.recipientId&&(n.counterPartyType="user",n.counterPartyId=n.senderId==e?n.recipientId:n.senderId),n.direction==ut.MessageDirection.OUTGOING?n.senderStatus=ut.MessageSenderStatus.SENT:n.senderStatus=ut.MessageSenderStatus.NA;var r=this.host.conversations.ensureConversation(n.counterPartyType,n.counterPartyId,n.recipientOrganizationId,{ensureEntities:{counterParty:"placeholder",groupMembers:"placeholder",organization:"full"}});n.conversationId=r.id;var o=this.host.models.Message.createInstance(n),s=o.senderId==e?o.recipientId:o.senderId;s&&this.__ensureMessageCounterParty(r,s,{messageCounterParties:this.host.currentlyServingOfflineMessages?"placeholder":"full",touchOnRelatedEntityLoad:!0}),this.host.models.Message.inject(o),this.emit("message",o),this.__addConversationCounterPartyToServerRosterIfShould(r),this.__queueReload(r),r.emit("message",o),this.__notifyOrganizationChange(r.organizationId),o.senderId!=e&&o.recipientStatus!=ut.MessageRecipientStatus.READ&&o.recipientStatus!=ut.MessageRecipientStatus.DELIVERED&&this.host.messages.markAsReceived(o)},e.prototype.reactToFriendsEvent=function(t){var e=t.data.friend,n=e.action,r=e.organization_id,o=(0,j["default"])(e,["action","organization_id"]),a=r,i=this.host.modelByTypeNS(o.xmlns);if(!i)return void this.logger.error("Class "+o.xmlns+" not found");switch(n){case"add":"group"==i.name&&(o.organizationId=a);var s=this.host.injectModel(o);this.__addedByCounterParty(s,a);break;case"del":this.__removedByCounterParty(i.name,o.token,a);break;default:this.logger.error("friends action not implemented",n,t.data)}},e.prototype._onMessageSending=function(t){if(!(t instanceof Object))throw new TypeError('Value of argument "message" violates contract.\n\nExpected:\nObject\n\nGot:\n'+i(t));if(!(t instanceof Object))throw new TypeError('Value of argument "message" violates contract.\n\nExpected:\nObject\n\nGot:\n'+a(t));var e=this.ensureConversation(t.counterPartyType,t.counterPartyId,t.senderOrganizationId,{ensureEntities:{counterParty:"full",organization:"full",messageCounterParties:"full",groupMembers:"full",touchOnRelatedEntityLoad:!0}});this.__addConversationCounterPartyToServerRosterIfShould(e),this.__reloadConversation(e),this.__notifyOrganizationChange(e.organizationId)},e.prototype._onMessageSent=function(t){if(!(t instanceof Object))throw new TypeError('Value of argument "message" violates contract.\n\nExpected:\nObject\n\nGot:\n'+i(t));if(!(t instanceof Object))throw new TypeError('Value of argument "message" violates contract.\n\nExpected:\nObject\n\nGot:\n'+a(t));var e=this.ensureConversation(t.counterPartyType,t.counterPartyId,t.senderOrganizationId);this.__reloadConversation(e),e.emit("message",t)},e.prototype._onMessageChange=function(t,e){e.conversation&&this.__queueReload(e.conversation)},e.prototype._onGroupDelete=function(t,e){this.ejectConversation("group",e.id,e.organizationId)},e.prototype.__queueReload=function(t){!this.__queuedConversationsToReload.includes(t)&&this.__queuedConversationsToReload.push(t),this._throtelled__flushConversationsToReload()},e.prototype.__flushConversationsToReload=function(){var t=this;this.__queuedConversationsToReload.forEach(function(e){return t.__reloadConversation(e)}),this.__queuedConversationsToReload.length=0},e.prototype.__reloadConversation=function(t){var e,n=(0,B["default"])(t,["messages","timeline","lastMessage","unreadMessages","unreadCount","lastEventMessageSortNumber"]),r={},o=(e=(e=this.host.models.Message.getAll(),mt["default"]).call(e,{conversationId:t.id}),wt["default"]).call(e,["sortNumber"],["asc"]),a=(0,L["default"])(o,{messageType:ut.MessageType.USER_SENT});r.timeline=o,r.messages=a,r.lastMessage=(0,F["default"])(a),r.unreadMessages=a.filter(function(t){return t.direction===ut.MessageDirection.INCOMING&&(t.recipientStatus===ut.MessageRecipientStatus.NEW||t.recipientStatus===ut.MessageRecipientStatus.DELIVERED)}),r.unreadCount=r.unreadMessages.length,r.lastEventMessageSortNumber=r.lastMessage&&r.lastMessage.sortNumber||0;var i=!1;(0,U["default"])(n,function(e,n){(0,ot["default"])(e,r[n])||(t[n]=r[n],i=!0)}),i&&(this.host.models.Conversation.inject(t),t.emit("change"),this.emit("change",t))},e.prototype.__notifyOrganizationChange=function(t){var e=this.host.models.Organization.get(t);e&&e.emit("change")},e.prototype.__addConversationCounterPartyToServerRosterIfShould=function(t){if(!(t instanceof Object))throw new TypeError('Value of argument "conversation" violates contract.\n\nExpected:\nObject\n\nGot:\n'+i(t));if(!(t instanceof Object))throw new TypeError('Value of argument "conversation" violates contract.\n\nExpected:\nObject\n\nGot:\n'+a(t));t&&(t._counterPartyAddedOnServer||this.add(t.counterPartyType,t.counterPartyId,t.organizationId))},e.prototype.addMembershipChangeLog=function(t){var e=void 0;if(t.actorId===this.host.currentUserId&&"LEAVE"===t.action){if(e=this.get("group",t.group.id,t.group.organizationId),!e)return}else e=this.ensureConversation("group",t.group.id,t.group.organizationId);this.host.models.Message.inject({id:t.id,conversationId:e.id,groupId:t.groupId,sortNumber:t.sortNumber,messageType:ut.MessageType.GROUP_MEMBERSHIP_CHANGE,senderId:t.actorId,recipient:this.host.currentUser,direction:ut.MessageDirection.INCOMING,groupMembersChange:{action:t.action,members:t.members,memberIds:t.memberIds},body:this.__generateGroupMembershipChangeBody(t),createdAt:t.createdAt}),this.__reloadConversation(e)},e.prototype.__generateGroupMembershipChangeBody=function(t){var e=Tt[t.action],n=jt[t.action]||"",r=null;return"ADD"!==t.action&&"REMOVE"!==t.action||(r=(0,ft["default"])(t.members.filter(Boolean).map(function(t){return t.displayName}))),[t.actor.displayName,e,r,n,"this",At[t.group.groupType]].filter(Boolean).join(" ")},e.prototype.getMessageConversationKey=function(t){if(!(t instanceof Object))throw new TypeError('Value of argument "message" violates contract.\n\nExpected:\nObject\n\nGot:\n'+i(t));if(!(t instanceof Object))throw new TypeError('Value of argument "message" violates contract.\n\nExpected:\nObject\n\nGot:\n'+a(t));if(t.groupId)return this.conversationHashForListEnityId(t.groupId);if(t.distributionListId)return this.conversationHashForListEnityId(t.distributionListId);var e=t.senderId==this.host.currentUserId?t.recipientId:t.senderId;return this.conversationHashForUserMessage(e,t.senderOrganizationId,t.recipientOrganizationId)},e.prototype.getConversationKey=function(t,e,n){var r=arguments.length<=3||void 0===arguments[3]?n:arguments[3];if("string"!=typeof t)throw new TypeError('Value of argument "counterPartyType" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));if("string"!=typeof e)throw new TypeError('Value of argument "counterPartyId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));if(null!=n&&"string"!=typeof n)throw new TypeError('Value of argument "senderOrganizationId" violates contract.\n\nExpected:\n?string\n\nGot:\n'+i(n));if(null!=r&&"string"!=typeof r)throw new TypeError('Value of argument "recipientOrganizationId" violates contract.\n\nExpected:\n?string\n\nGot:\n'+i(r));if("string"!=typeof t)throw new TypeError('Value of argument "counterPartyType" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));if("string"!=typeof e)throw new TypeError('Value of argument "counterPartyId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));if(null!=n&&"string"!=typeof n)throw new TypeError('Value of argument "senderOrganizationId" violates contract.\n\nExpected:\n?string\n\nGot:\n'+a(n));if(null!=r&&"string"!=typeof r)throw new TypeError('Value of argument "recipientOrganizationId" violates contract.\n\nExpected:\n?string\n\nGot:\n'+a(r));switch(t){case"user":return this.conversationHashForUserMessage(e,n,r);case"group":case"distributionList":return this.conversationHashForListEnityId(e);default:throw new Error("type "+t+" not supported in conversation")}},e.prototype.conversationHashForUserMessage=function(t,e){var n=arguments.length<=2||void 0===arguments[2]?e:arguments[2];if("string"!=typeof t)throw new TypeError('Value of argument "counterPartyId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));if("string"!=typeof e)throw new TypeError('Value of argument "senderOrganizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));if(null!=n&&"string"!=typeof n)throw new TypeError('Value of argument "recipientOrganizationId" violates contract.\n\nExpected:\n?string\n\nGot:\n'+i(n));if("string"!=typeof t)throw new TypeError('Value of argument "counterPartyId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));if("string"!=typeof e)throw new TypeError('Value of argument "senderOrganizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));if(null!=n&&"string"!=typeof n)throw new TypeError('Value of argument "recipientOrganizationId" violates contract.\n\nExpected:\n?string\n\nGot:\n'+a(n));var r=[t,e,n].join(":");return Ot.b64(r)},e.prototype.conversationHashForListEnityId=function(t){if("string"!=typeof t)throw new TypeError('Value of argument "entityId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));if("string"!=typeof t)throw new TypeError('Value of argument "entityId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));return Ot.b64(t)},e.prototype.conversationHashForGroupId=function(){return this.conversationHashForListEnityId.apply(this,arguments)},e.prototype.conversationHashForDistributionListId=function(){return this.conversationHashForListEnityId.apply(this,arguments)},e.prototype.looksLikeConversationId=function(t){if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));return/^[a-zA-Z0-9\/+=]{24}$/.test(t)},e.prototype.findConversationWithUser=function(){function t(t,n){return e.apply(this,arguments)}var e=(0,G["default"])(k["default"].mark(function n(t,e){return k["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof t){n.next=2;break}throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));case 2:if("string"==typeof e){n.next=4;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));case 4:if("string"==typeof t){n.next=6;break}throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));case 6:if("string"==typeof e){n.next=8;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));case 8:return n.abrupt("return",this.get(this.host.models.User.name,t,e));case 9:case"end":return n.stop()}},n,this)}));return t}(),e.prototype.findConversationWithGroup=function(){function t(t,n){return e.apply(this,arguments)}var e=(0,G["default"])(k["default"].mark(function n(t,e){return k["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof t){n.next=2;break}throw new TypeError('Value of argument "groupId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));case 2:if("string"==typeof e){n.next=4;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));case 4:if("string"==typeof t){n.next=6;break}throw new TypeError('Value of argument "groupId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));case 6:if("string"==typeof e){n.next=8;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));case 8:return n.abrupt("return",this.get(this.host.models.Group.name,t,e));case 9:case"end":return n.stop()}},n,this)}));return t}(),e.prototype.findAllGroupConversationsWithMembers=function(){function t(t,n){return e.apply(this,arguments)}var e=(0,G["default"])(k["default"].mark(function n(t,e){var r,o=this;return k["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof t||Array.isArray(t)&&t.every(function(t){return"string"==typeof t})||Array.isArray(t)&&t.every(function(t){return t instanceof Object})){n.next=2;break}throw new TypeError('Value of argument "memberIds" violates contract.\n\nExpected:\nstring | string[] | Object[]\n\nGot:\n'+i(t));case 2:if("string"==typeof e){n.next=4;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));case 4:if("string"==typeof t||Array.isArray(t)&&t.every(function(t){return"string"==typeof t})||Array.isArray(t)&&t.every(function(t){return t instanceof Object})){n.next=6;break}throw new TypeError('Value of argument "memberIds" violates contract.\n\nExpected:\nstring | string[] | Object[]\n\nGot:\n'+a(t));case 6:if("string"==typeof e){n.next=8;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));case 8:return t=(0,_t.arrayWrap)(t).map(this._resolveModelId.bind(this)),n.next=11,this.host.groups.findAllWithSpecificMembers(t,e);case 11:return r=n.sent,n.abrupt("return",r.map(function(t){return o.get(o.host.models.Group.name,t.id,e)}));case 13:case"end":return n.stop()}},n,this)}));return t}(),e.prototype.getWithUser=function(t,e){var n=arguments.length<=2||void 0===arguments[2]?{createIfNotFound:!1}:arguments[2],r=n.createIfNotFound,o=void 0!==r&&r;if(!("string"==typeof t||t instanceof Object))throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(t));if(!("string"==typeof e||e instanceof Object))throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(e));if(!("string"==typeof t||t instanceof Object))throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(t));if(!("string"==typeof e||e instanceof Object))throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(e));t=this._resolveModelId(t),e=this._resolveModelId(e);var s=this.conversationHashForUserMessage(t,e),u=this.getById(s);return!u&&o&&(u=this.ensureConversation("user",t,e)),u||null},e.prototype.getWithListEntity=function(t,e){var n=arguments.length<=2||void 0===arguments[2]?{createIfNotFound:!1}:arguments[2],r=n.createIfNotFound,o=void 0!==r&&r,s=n.organizationId;if("string"!=typeof t)throw new TypeError('Value of argument "entityType" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));if(!("string"==typeof e||e instanceof Object))throw new TypeError('Value of argument "entityId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(e));if("string"!=typeof t)throw new TypeError('Value of argument "entityType" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));if(!("string"==typeof e||e instanceof Object))throw new TypeError('Value of argument "entityId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(e));e=this._resolveModelId(e);var u=this.conversationHashForListEnityId(e),c=this.getById(u);if(!c&&o){var f=this._resolveEntity(e,t);f?s=f.organizationId:dt["default"].notEmpty("organizationId",s,"required when using createIfNotFound"),c=this.ensureConversation(t,e,s)}return c||null},e.prototype.getWithGroup=function(t){return this.getWithListEntity("group",t)},e.prototype.getWithDistributionList=function(t){return this.getWithListEntity("distributionList",t)},e.prototype.get=function(t,e,n){if("string"!=typeof t)throw new TypeError('Value of argument "counterPartyType" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));if("string"!=typeof e)throw new TypeError('Value of argument "counterPartyId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));if("string"!=typeof n)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(n));if("string"!=typeof t)throw new TypeError('Value of argument "counterPartyType" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));if("string"!=typeof e)throw new TypeError('Value of argument "counterPartyId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));if("string"!=typeof n)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(n));var r=this.getConversationKey(t,e,n),o=this.host.models.Conversation.get(r);return o||null},e.prototype.getAll=function(){return this.host.models.Conversation.getAll()},e.prototype.getById=function(t){if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));return this.host.models.Conversation.get(t)},e.prototype.getMultiById=function(t){if(!Array.isArray(t)||!t.every(function(t){return"string"==typeof t}))throw new TypeError('Value of argument "ids" violates contract.\n\nExpected:\nArray<string>\n\nGot:\n'+i(t));if(!Array.isArray(t)||!t.every(function(t){return"string"==typeof t}))throw new TypeError('Value of argument "ids" violates contract.\n\nExpected:\nArray<string>\n\nGot:\n'+a(t));return this.host.models.Conversation.getMulti(t)},e.prototype.__addedByCounterParty=function(t,e){if(!(t instanceof Object))throw new TypeError('Value of argument "counterParty" violates contract.\n\nExpected:\nObject\n\nGot:\n'+i(t));if("string"!=typeof e)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));if(!(t instanceof Object))throw new TypeError('Value of argument "counterParty" violates contract.\n\nExpected:\nObject\n\nGot:\n'+a(t));if("string"!=typeof e)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));this.ensureConversation(t.$entityType,t.id,e)},e.prototype.__removedByCounterParty=function(t,e,n){if("string"!=typeof t)throw new TypeError('Value of argument "entityType" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));if("string"!=typeof e)throw new TypeError('Value of argument "entityId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));if("string"!=typeof n)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(n));if("string"!=typeof t)throw new TypeError('Value of argument "entityType" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));if("string"!=typeof e)throw new TypeError('Value of argument "entityId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));if("string"!=typeof n)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(n));this.ejectConversation(t,e,n)},e.prototype.__ensureEntities=function(t){var e=this,n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];if(!(t instanceof Object))throw new TypeError('Value of argument "conversation" violates contract.\n\nExpected:\nObject\n\nGot:\n'+i(t));if(!(t instanceof Object))throw new TypeError('Value of argument "conversation" violates contract.\n\nExpected:\nObject\n\nGot:\n'+a(t));var r=[];return n.organization&&r.push(this.__ensureOrganization(t,n)),n.counterParty&&r.push(this.__ensureCounterParty(t,n)),n.messageCounterParties&&r.push(this.__ensureAllMessagesCounterParties(t,n)),r=r.filter(Boolean),r.length>0?O["default"].all(r).then(function(){n.onLoad&&n.onLoad(),e.__touch(t)})["catch"](function(t){return console.error(t)}):O["default"].resolve()},e.prototype.__ensureOrganization=function(t){var e=this,n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];if(!(t instanceof Object))throw new TypeError('Value of argument "conversation" violates contract.\n\nExpected:\nObject\n\nGot:\n'+i(t));
if(!(t instanceof Object))throw new TypeError('Value of argument "conversation" violates contract.\n\nExpected:\nObject\n\nGot:\n'+a(t));return this.host.models.Organization.shouldEnsure(t.organization,"full"!==n.organization)?new O["default"](function(r,o){e.host.models.Organization.ensureEntity(t.organizationId,{onlyPlaceholder:"placeholder"===n.organization,onMissing:function(){e.logger.info("org "+t.organizationId+" not found, created placeholder org"),t.$loadingOrganization=!0},onLoad:function(){e.logger.info("org "+t.organizationId+" loaded"),t.$loadingOrganization=!1,n.touchOnRelatedEntityLoad&&e.__touch(t)},onFinish:r})}):null},e.prototype.__ensureCounterParty=function(t){var e=this,n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];if(!(t instanceof Object))throw new TypeError('Value of argument "conversation" violates contract.\n\nExpected:\nObject\n\nGot:\n'+i(t));if(!(t instanceof Object))throw new TypeError('Value of argument "conversation" violates contract.\n\nExpected:\nObject\n\nGot:\n'+a(t));var r=this.host.modelsByEntityType[t.counterPartyType];return r.shouldEnsure(t.counterParty,"full"!==n.counterParty,{groupMembersOnlyPlaceholder:"full"!==n.groupMembers})?new O["default"](function(o,a){var i={};switch(t.counterPartyType){case"user":break;case"group":case"distributionList":i.organizationId=t.organizationId;break;default:throw new Error("unsupported counterPartyType",t.counterPartyType)}var s=function(t){if("placeholder"!==n.counterParty&&"group"===r.name&&n.groupMembers)return e.host.groups.ensureMembers(t,{onlyPlaceholder:"placeholder"===n.groupMembers})};r.ensureEntity(t.counterPartyId,{attrs:i,onlyPlaceholder:"placeholder"===n.counterParty,onMissing:function(){e.logger.info("entry "+t.counterPartyId+" not found, created placeholder on org "+t.organizationId),t.$loadingCounterParty=!0},onLoad:function(){t.$loadingCounterParty=!1,n.touchOnRelatedEntityLoad&&e.__touch(t)},onFinish:function(){var t=(0,G["default"])(k["default"].mark(function n(t){return k["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=t,!e.t0){e.next=4;break}return e.next=4,s(t);case 4:o();case 5:case"end":return e.stop()}},n,e)}));return function(e){return t.apply(this,arguments)}}()})}):null},e.prototype.__ensureAllMessagesCounterParties=function(t){var e,n=this,r=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];if(!(t instanceof Object))throw new TypeError('Value of argument "conversation" violates contract.\n\nExpected:\nObject\n\nGot:\n'+i(t));if(!(t instanceof Object))throw new TypeError('Value of argument "conversation" violates contract.\n\nExpected:\nObject\n\nGot:\n'+a(t));var o=(e=(e=(e=t.messages,yt["default"]).call(e,"senderId"),gt["default"]).call(e),xt["default"]).call(e,this.host.currentUserId,t.counterPartyId);return O["default"].all(o.map(function(e){return n.__ensureMessageCounterParty(t,e,r)}))},e.prototype.__ensureMessageCounterParty=function(t,e){var n=this,r=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];if(!(t instanceof Object))throw new TypeError('Value of argument "conversation" violates contract.\n\nExpected:\nObject\n\nGot:\n'+i(t));if("string"!=typeof e)throw new TypeError('Value of argument "messageOtherUserId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));if(!(t instanceof Object))throw new TypeError('Value of argument "conversation" violates contract.\n\nExpected:\nObject\n\nGot:\n'+a(t));if("string"!=typeof e)throw new TypeError('Value of argument "messageOtherUserId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));var o=this.host.models.User.get(e);return this.host.models.User.shouldEnsure(o,"full"!==r.messageCounterParties)?new O["default"](function(o,a){n.host.models.User.ensureEntity(e,{onlyPlaceholder:"placeholder"===r.messageCounterParties,onMissing:function(){n.logger.info("entry "+t.counterPartyId+" not found, created placeholder on org "+t.organizationId)},onLoad:function(){r.touchOnRelatedEntityLoad&&n.__touch(t)},onFinish:o})}):null},e.prototype.__touch=function(t){this.host.models.Conversation.touch(t)},e}(J["default"]),o(h.prototype,"findAll",[f],(0,_["default"])(h.prototype,"findAll"),h.prototype),o(h.prototype,"find",[l],(0,_["default"])(h.prototype,"find"),h.prototype),o(h.prototype,"add",[d],(0,_["default"])(h.prototype,"add"),h.prototype),o(h.prototype,"remove",[p],(0,_["default"])(h.prototype,"remove"),h.prototype),o(h.prototype,"_onMessageSending",[st.privateMethod,it["default"]],(0,_["default"])(h.prototype,"_onMessageSending"),h.prototype),o(h.prototype,"_onMessageSent",[st.privateMethod,it["default"]],(0,_["default"])(h.prototype,"_onMessageSent"),h.prototype),o(h.prototype,"_onMessageChange",[st.privateMethod,it["default"]],(0,_["default"])(h.prototype,"_onMessageChange"),h.prototype),o(h.prototype,"_onGroupDelete",[st.privateMethod,it["default"]],(0,_["default"])(h.prototype,"_onGroupDelete"),h.prototype),o(h.prototype,"__queueReload",[st.privateMethod],(0,_["default"])(h.prototype,"__queueReload"),h.prototype),o(h.prototype,"__flushConversationsToReload",[st.privateMethod,it["default"]],(0,_["default"])(h.prototype,"__flushConversationsToReload"),h.prototype),o(h.prototype,"__reloadConversation",[st.privateMethod],(0,_["default"])(h.prototype,"__reloadConversation"),h.prototype),o(h.prototype,"__notifyOrganizationChange",[st.privateMethod],(0,_["default"])(h.prototype,"__notifyOrganizationChange"),h.prototype),o(h.prototype,"__addConversationCounterPartyToServerRosterIfShould",[st.privateMethod],(0,_["default"])(h.prototype,"__addConversationCounterPartyToServerRosterIfShould"),h.prototype),o(h.prototype,"__generateGroupMembershipChangeBody",[st.privateMethod],(0,_["default"])(h.prototype,"__generateGroupMembershipChangeBody"),h.prototype),o(h.prototype,"__addedByCounterParty",[st.privateMethod],(0,_["default"])(h.prototype,"__addedByCounterParty"),h.prototype),o(h.prototype,"__removedByCounterParty",[st.privateMethod],(0,_["default"])(h.prototype,"__removedByCounterParty"),h.prototype),o(h.prototype,"__ensureEntities",[st.privateMethod],(0,_["default"])(h.prototype,"__ensureEntities"),h.prototype),o(h.prototype,"__ensureOrganization",[st.privateMethod],(0,_["default"])(h.prototype,"__ensureOrganization"),h.prototype),o(h.prototype,"__ensureCounterParty",[st.privateMethod],(0,_["default"])(h.prototype,"__ensureCounterParty"),h.prototype),o(h.prototype,"__ensureAllMessagesCounterParties",[st.privateMethod],(0,_["default"])(h.prototype,"__ensureAllMessagesCounterParties"),h.prototype),o(h.prototype,"__ensureMessageCounterParty",[st.privateMethod],(0,_["default"])(h.prototype,"__ensureMessageCounterParty"),h.prototype),o(h.prototype,"__touch",[st.privateMethod],(0,_["default"])(h.prototype,"__touch"),h.prototype),y=h))||y);e["default"]=kt,t.exports=e["default"]},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function o(t,e,n,r,o){var a={};return Object.keys(r).forEach(function(t){a[t]=r[t]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=n.slice().reverse().reduce(function(n,r){return r(t,e,n)||n},a),o&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(o):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(t,e,a),a=null),a}function a(t,e){var n=4,r=15;if(void 0===e&&(e=0),e+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return"undefined"==typeof t?"undefined":(0,g["default"])(t);if(!Array.isArray(t)){var o=(0,y["default"])(t);if(!o.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(e>n)return"{...}";var i="  ".repeat(e-1),s=o.slice(0,r).map(function(n){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(n)?n:(0,d["default"])(n))+": "+a(t[n],e)+";"}).join("\n  "+i);return o.length>=r&&(s+="\n  "+i+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+i+s+"\n"+i+"}":"{\n  "+i+s+"\n"+i+"}"}if(!(t.length>0))return"Array";var u=function(){if(e>n)return{v:"[...]"};var o=a(t[0],e);return t.every(function(t){return a(t,e)===o})?{v:o.trim()+"[]"}:{v:"["+t.slice(0,r).map(function(t){return a(t,e)}).join(", ")+(t.length>=r?", ...":"")+"]"}}();return"object"===("undefined"==typeof u?"undefined":(0,g["default"])(u))?u.v:void 0}function i(t,e){var n=4,r=15;if(void 0===e&&(e=0),e+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return"undefined"==typeof t?"undefined":(0,g["default"])(t);if(!Array.isArray(t)){var o=(0,y["default"])(t);if(!o.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(e>n)return"{...}";var a="  ".repeat(e-1),s=o.slice(0,r).map(function(n){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(n)?n:(0,d["default"])(n))+": "+i(t[n],e)+";"}).join("\n  "+a);return o.length>=r&&(s+="\n  "+a+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+a+s+"\n"+a+"}":"{\n  "+a+s+"\n"+a+"}"}if(!(t.length>0))return"Array";var u=function(){if(e>n)return{v:"[...]"};var o=i(t[0],e);return t.every(function(t){return i(t,e)===o})?{v:o.trim()+"[]"}:{v:"["+t.slice(0,r).map(function(t){return i(t,e)}).join(", ")+(t.length>=r?", ...":"")+"]"}}();return"object"===("undefined"==typeof u?"undefined":(0,g["default"])(u))?u.v:void 0}e.__esModule=!0,e["default"]=void 0;var s,u,c,f,l=n(5),d=r(l),p=n(4),y=r(p),h=n(8),g=r(h),v=n(9),m=r(v),b=n(7),w=r(b),E=n(6),x=r(E),_=n(1),I=r(_),O=n(3),T=r(O),j=n(2),A=r(j),k=n(18),M=r(k),G=n(10),V=r(G),z=n(13),C=r(z),S=n(14),P=n(12),N=(s=(0,S.decorator)(),u=(0,S.decorator)(),(0,P.classWithPrivateMethods)((f=function(t){function e(){return(0,I["default"])(this,e),(0,T["default"])(this,t.apply(this,arguments))}return(0,A["default"])(e,t),e.prototype.mounted=function(){this._fetched=!1},e.prototype.dispose=function(){this._fetched=!1},e.prototype.find=function(){function t(t,n){return e.apply(this,arguments)}var e=(0,x["default"])(w["default"].mark(function n(t){var e,r,o=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return w["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof t){n.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));case 2:if("string"==typeof t){n.next=4;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));case 4:if(o=(0,M["default"])(o,{ignoreNotFound:!1,bypassCache:!1,includeMembers:!1,includeMetadata:!1}),this.host.requireUser(),e=null,o.bypassCache){n.next=11;break}if(e=this.host.models.DistributionList.get(t),!e){n.next=11;break}return n.abrupt("return",e);case 11:return n.next=13,this.host.api.distributionLists.find(t);case 13:if(r=n.sent,!r){n.next=19;break}e=this.host.models.DistributionList.inject(r),delete e.$placeholder,n.next=21;break;case 19:if(o.ignoreNotFound){n.next=21;break}throw new C["default"].NotFoundError(this.host.models.DistributionList.name,t);case 21:return n.abrupt("return",e);case 22:case"end":return n.stop()}},n,this)}));return t}(),e.prototype.findAll=function(){function t(){return e.apply(this,arguments)}var e=(0,x["default"])(w["default"].mark(function n(){var t,e,r;return w["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!this._fetched){n.next=2;break}return n.abrupt("return",this.getAll());case 2:if(t=this.host.models.Organization.getAll(),0!=t.length){n.next=7;break}return n.next=6,this.host.organizations.findAll();case 6:t=n.sent;case 7:return n.next=9,this.host.search.query({types:["distributionList"],organizationIds:t.map(function(t){return t.id}),query:{displayName:""}});case 9:return e=n.sent,r=e.map(function(t){return t.entity}),this._fetched=!0,n.abrupt("return",r);case 13:case"end":return n.stop()}},n,this)}));return t}(),e.prototype.getAll=function(){return this.host.models.DistributionList.getAll()},e.prototype.getById=function(t){if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));return this.host.models.DistributionList.get(t)},e.prototype.getMultiById=function(t){if(!Array.isArray(t)||!t.every(function(t){return"string"==typeof t}))throw new TypeError('Value of argument "ids" violates contract.\n\nExpected:\nArray<string>\n\nGot:\n'+i(t));if(!Array.isArray(t)||!t.every(function(t){return"string"==typeof t}))throw new TypeError('Value of argument "ids" violates contract.\n\nExpected:\nArray<string>\n\nGot:\n'+a(t));return this.host.models.DistributionList.getMulti(t)},e}(V["default"]),o(f.prototype,"find",[s],(0,m["default"])(f.prototype,"find"),f.prototype),o(f.prototype,"findAll",[u],(0,m["default"])(f.prototype,"findAll"),f.prototype),c=f))||c);e["default"]=N,t.exports=e["default"]},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}e.__esModule=!0,e["default"]=void 0;var o=n(26),a=r(o),i=n(1),s=r(i),u=n(3),c=r(u),f=n(2),l=r(f),d=n(22),p=r(d),y=n(10),h=r(y),g=n(173),v=function(t){function e(n,r){var o;(0,s["default"])(this,e);var i=(0,c["default"])(this,t.call(this,n,r));i.EVENTS=(o={},o.client_advisory=function(t){switch(t.data.advisory.name){case"replay_start":this.host.reactToAdvisoryEvent("replayStart",{replayMessageCount:t.data.advisory.replay_message_count});break;case"replay_stop":this.host.reactToAdvisoryEvent("replayStop")}},o["message|group_message"]=function(t){this.host.conversations.reactToMessageEvent(t)},o["message:status|group:message:status"]=function(t){this.host.messages.reactToMessageStatusEvent(t)},o.friends=function(t){this.host.conversations.reactToFriendsEvent(t)},o.presence=function(t){this.host.presence.reactToPresenceEvent(t)},o.bang=function(t){this.host.groups.reactToBangEvent(t)},o.update=function(t){var e=t.data,n=e.type,r=(0,a["default"])(e,["type"]);this.host.injectModel(r,n)},o["account:settings"]=function(t){var e=this;t.data.services.forEach(function(n){switch(n.xmlns){case"tigertext:iq:update:account":var r=n.account||t.data.token;e.host.users.refresh(r);break;case"tigertext:iq:update:org_settings":e.host.organizations.refreshAll();break;default:e.logger.warn("unhandled account:settings service type "+n.xmlns)}})},o["message:is_typing"]=function(t){this.host.typingStatus.reactToIsTypingEvent(t)},o["push:credentials"]=function(t){},o.remote_wipe=function(t){this.host.wipe()},o.validated=function(t){this.logger.warn("validated not implemented")},o["msg:metadata_update"]=function(t){this.logger.warn("msg:metadata_update not implemented")},o.conversation_mute=function(t){this.host.mute.reactToMuteEvent(t)},o.reconnect=function(t){this.host.events.reconnect()},o["push:credentials"]=g.noop,o["sse:heartbeat"]=g.noop,o);var u=[];return(0,p["default"])(i.EVENTS,function(t,e){e.includes("|")&&(u.push(e),e.split("|").forEach(function(e){return i.EVENTS[e]=t}))}),u.forEach(function(t){return delete i.EVENTS[t]}),i}return(0,l["default"])(e,t),e.prototype.emit=function(t){this.EVENTS[t.type]?this.EVENTS[t.type].call(this,t):this.logger.error("unhandled event: "+t.type,t.data)},e}(h["default"]);e["default"]=v,t.exports=e["default"]},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function o(t,e,n,r){n&&(0,f["default"])(t,e,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}function a(t,e,n,r,o){var a={};return Object.keys(r).forEach(function(t){a[t]=r[t]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=n.slice().reverse().reduce(function(n,r){return r(t,e,n)||n},a),o&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(o):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(t,e,a),a=null),a}e.__esModule=!0,e["default"]=void 0;var i,s,u,c=n(127),f=r(c),l=n(9),d=r(l),p=n(7),y=r(p),h=n(6),g=r(h),v=n(4),m=r(v),b=n(17),w=r(b),E=n(1),x=r(E),_=n(3),I=r(_),O=n(2),T=r(O),j=n(66),A=r(j),k=n(46),M=r(k),G=n(10),V=r(G),z=n(12),C=n(50),S=n(140),P=r(S),N=n(57),R=r(N),U=n(24),q=r(U),F=n(136),$=r(F),L=n(15),D=n(36),B=r(D),K=["00000000-0000-0000-0000-000000000001"],Z={isTyping:"is-typing",multiOrg:"multi-org",noOfflineMessages:"no-offline-messages",autoDeliver:"auto-deliver",hidden:"hidden",closeAfterMessages:"close-after-messages"},W=(0,z.classWithPrivateMethods)((s=function(t){function e(n,r){(0,x["default"])(this,e);var a=(0,I["default"])(this,t.call(this,n,r));return o(a,"onNetworkStatusChanged",u,a),a._throtelled_flushQueuedAcks=(0,M["default"])(a._flushQueuedAcks.bind(a),a.config.flushAckInterval,{leading:!1}),a._connectionRetryCount=0,a}return(0,T["default"])(e,t),e.prototype.mounted=function(){this._queuedAcks=[],this.config.autoAckSuccessfullyHandledEvents||(this._processedEventIds=[])},e.prototype.dispose=function(){this._queuedAcks=null,this._processedEventIds=null,this._throtelled_flushQueuedAcks.cancel&&this._throtelled_flushQueuedAcks.cancel(),this._cancelScheduledConnectionRetry()},e.prototype.connect=function(){var t,e=this;if(this.host.requireUser(),this.eventSource)return void this.logger.warn("already connected");if(this.logger.info("connecting events. networkStatus=",this.host.httpClient.networkStatus),this.host.httpClient.networkStatus===B["default"].OFFLINE)return this._scheduleConnectRetry();var n=(t=(t=(t=(t=this.config.events,P["default"]).call(t,A["default"]),R["default"]).call(t),q["default"]).call(t,function(t){return Z[t]}),$["default"]).call(t).join(",");return this._watchNetworkConnection(),new w["default"](function(t,r){var o=void 0;e.eventSource=e.httpClient.createEventSource("/events",{headers:{"TT-X-Features":n},onOpen:function(){e.logger.info("open"),e._connectionRetryCount=0,e._cancelScheduledConnectionRetry(),o=!0,t()},onMessage:e._onEvent.bind(e),onError:function(t){o||r(t),e._onError(t)},onClose:function(){e.logger.info("close",err)}})})},e.prototype.disconnect=function(){this._cancelScheduledConnectionRetry(),this._unwatchNetworkConnection(),this.eventSource&&this.eventSource.close(),this.eventSource=null},e.prototype.reconnect=function(){this.eventSource&&this.disconnect(),this.connect()},e.prototype._onEvent=function(t){var e=this,n=t.data;if(n.includes("\n"))return void n.split("\n").forEach(function(t){return e._onEvent({data:t})});var r=n;try{n=JSON.parse(r)}catch(o){throw this.logger.error("error parsing ",r),o}var a=n.event_id;if(this.config.autoAckSuccessfullyHandledEvents||!this._processedEventIds.includes(a)||K.includes(a)){var i=(0,m["default"])(n.event)[0],s=i.replace("tigertext:iq:",""),u=n.event[i];this.logger.debug("incoming",s,u);var c=new C.Event(a,s,u,{_origData:r});try{this.host.eventRouter.emit(c),this.emit("event",c),this.config.autoAckSuccessfullyHandledEvents?this.__queueAck(a):this._processedEventIds.push(a)}catch(o){throw this.logger.error("error in event "+s,o,o.stack,{data:u}),o}}},e.prototype._onError=function(t){this.logger.info("error",t,t.message||"",t.status||""),this.disconnect(),this.config.eventsAutoReconnect&&this._scheduleConnectRetry()},e.prototype.__queueAck=function(t){var e;t=(0,L.arrayWrap)(t),(e=this._queuedAcks).push.apply(e,t),t.length>=this.config.flushAckMaxEvents?(this.logger.log("reached "+this.config.flushAckMaxEvents+" -- flushing"),this._flushQueuedAcks()):this._throtelled_flushQueuedAcks()},e.prototype._flushQueuedAcks=function(){this._queuedAcks.length>0&&(this.ack(this._queuedAcks),this._queuedAcks.length=0)},e.prototype._scheduleConnectRetry=function(){var t=this;this._connectionRetryCount++,this._cancelScheduledConnectionRetry(),this.logger.info("scheduleConnectRetry",this._connectionRetryCount),this._scheduleConnectRetryTimeout=setTimeout(function(){t.connect()},this.config.eventsAutoReconnectDelay)},e.prototype._cancelScheduledConnectionRetry=function(){this._scheduleConnectRetryTimeout&&clearTimeout(this._scheduleConnectRetryTimeout)},e.prototype._watchNetworkConnection=function(){this._watchingNetworkConnection||(this._watchingNetworkConnection=!0,this.host.on("networkStatus:change",this.onNetworkStatusChanged))},e.prototype._unwatchNetworkConnection=function(){this._watchingNetworkConnection&&(this.host.off("networkStatus:change",this.onNetworkStatusChanged),this._watchingNetworkConnection=!1)},e.prototype.ack=function(){function t(t){return e.apply(this,arguments)}var e=(0,g["default"])(y["default"].mark(function n(t){return y["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.host.requireUser(),t=(0,L.arrayWrap)(t),this.logger.log("ack",t),e.prev=3,e.next=6,this.httpClient.post("/events/ack",{data:{events:t}});case 6:e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](3),this.logger.warn("some events not acked",t);case 11:case"end":return e.stop()}},n,this,[[3,8]])}));return t}(),e}(V["default"]),a(s.prototype,"_onEvent",[z.privateMethod],(0,d["default"])(s.prototype,"_onEvent"),s.prototype),a(s.prototype,"_onError",[z.privateMethod],(0,d["default"])(s.prototype,"_onError"),s.prototype),a(s.prototype,"__queueAck",[z.privateMethod],(0,d["default"])(s.prototype,"__queueAck"),s.prototype),a(s.prototype,"_flushQueuedAcks",[z.privateMethod],(0,d["default"])(s.prototype,"_flushQueuedAcks"),s.prototype),a(s.prototype,"_scheduleConnectRetry",[z.privateMethod],(0,d["default"])(s.prototype,"_scheduleConnectRetry"),s.prototype),a(s.prototype,"_cancelScheduledConnectionRetry",[z.privateMethod],(0,d["default"])(s.prototype,"_cancelScheduledConnectionRetry"),s.prototype),a(s.prototype,"_watchNetworkConnection",[z.privateMethod],(0,d["default"])(s.prototype,"_watchNetworkConnection"),s.prototype),a(s.prototype,"_unwatchNetworkConnection",[z.privateMethod],(0,d["default"])(s.prototype,"_unwatchNetworkConnection"),s.prototype),u=a(s.prototype,"onNetworkStatusChanged",[z.privateMethod],{enumerable:!0,initializer:function(){var t=this;return function(e){var n=e.networkStatus;n!==B["default"].OFFLINE&&n!==B["default"].UNREACHABLE||(t.disconnect(),t._scheduleConnectRetry())}}}),i=s))||i;e["default"]=W,t.exports=e["default"]},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function o(t,e,n,r,o){var a={};return Object.keys(r).forEach(function(t){a[t]=r[t]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=n.slice().reverse().reduce(function(n,r){return r(t,e,n)||n},a),o&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(o):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(t,e,a),a=null),a}function a(t,e){var n=4,r=15;if(void 0===e&&(e=0),e+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return"undefined"==typeof t?"undefined":(0,m["default"])(t);if(!Array.isArray(t)){var o=(0,g["default"])(t);if(!o.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(e>n)return"{...}";var i="  ".repeat(e-1),s=o.slice(0,r).map(function(n){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(n)?n:(0,y["default"])(n))+": "+a(t[n],e)+";"}).join("\n  "+i);return o.length>=r&&(s+="\n  "+i+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+i+s+"\n"+i+"}":"{\n  "+i+s+"\n"+i+"}"}if(!(t.length>0))return"Array";var u=function(){if(e>n)return{v:"[...]"};var o=a(t[0],e);return t.every(function(t){return a(t,e)===o})?{v:o.trim()+"[]"}:{v:"["+t.slice(0,r).map(function(t){return a(t,e)}).join(", ")+(t.length>=r?", ...":"")+"]"}}();return"object"===("undefined"==typeof u?"undefined":(0,m["default"])(u))?u.v:void 0}function i(t,e){var n=4,r=15;if(void 0===e&&(e=0),e+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return"undefined"==typeof t?"undefined":(0,m["default"])(t);if(!Array.isArray(t)){var o=(0,g["default"])(t);if(!o.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(e>n)return"{...}";var a="  ".repeat(e-1),s=o.slice(0,r).map(function(n){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(n)?n:(0,y["default"])(n))+": "+i(t[n],e)+";"}).join("\n  "+a);return o.length>=r&&(s+="\n  "+a+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+a+s+"\n"+a+"}":"{\n  "+a+s+"\n"+a+"}"}if(!(t.length>0))return"Array";var u=function(){if(e>n)return{v:"[...]"};var o=i(t[0],e);return t.every(function(t){return i(t,e)===o})?{v:o.trim()+"[]"}:{v:"["+t.slice(0,r).map(function(t){return i(t,e)}).join(", ")+(t.length>=r?", ...":"")+"]"}}();return"object"===("undefined"==typeof u?"undefined":(0,m["default"])(u))?u.v:void 0}e.__esModule=!0,e["default"]=void 0;var s,u,c,f,l,d,p=n(5),y=r(p),h=n(4),g=r(h),v=n(8),m=r(v),b=n(9),w=r(b),E=n(17),x=r(E),_=n(11),I=r(_),O=n(7),T=r(O),j=n(6),A=r(j),k=n(1),M=r(k),G=n(3),V=r(G),z=n(2),C=r(z),S=n(170),P=r(S),N=n(44),R=r(N),U=n(169),q=r(U),F=n(18),$=r(F),L=n(10),D=r(L),B=n(13),K=r(B),Z=n(14),W=n(12),H=n(24),X=r(H),Q=n(41),Y=r(Q),J=n(43),tt=r(J),et=n(15),nt=(s=(0,Z.decorator)(),u=(0,Z.decorator)(),c=(0,Z.decorator)(),f=(0,Z.decorator)(),(0,W.classWithPrivateMethods)((d=function(t){function e(){return(0,M["default"])(this,e),(0,V["default"])(this,t.apply(this,arguments))}return(0,C["default"])(e,t),e.prototype.mounted=function(){this._fetched=!1},e.prototype.dispose=function(){this._fetched=!1},e.prototype.create=function(){function t(t){return e.apply(this,arguments)}var e=(0,A["default"])(T["default"].mark(function n(t){var e,r,o=t.organizationId,a=t.name,i=t.avatarFile,s=t.replayHistory,u=void 0===s||s,c=t.memberIds,f=void 0===c?[]:c,l=t.metadata;return T["default"].wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.host.requireUser(),o){t.next=3;break}throw new K["default"].ValidationError("organizationId","required");case 3:return f=f.map(this._resolveModelId.bind(this)),f.includes(this.host.currentUserId)||f.unshift(this.host.currentUserId),t.next=7,this.host.api.groups.create({name:a,avatarFile:i,replayHistory:u,memberIds:f,organizationId:o});case 7:if(e=t.sent,r=this.host.models.Group.inject(e),!l){t.next=12;break}return t.next=12,this.host.metadata.update(r.id,l,o);case 12:return t.abrupt("return",r);case 13:case"end":return t.stop()}},n,this)}));return t}(),e.prototype.update=function(){function t(t,n){return e.apply(this,arguments)}var e=(0,A["default"])(T["default"].mark(function n(t,e){var r,o,s,u=e.name,c=e.avatarFile,f=e.replayHistory,l=e.memberIds,d=e.metadata;return T["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"==typeof t||t instanceof Object){e.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(t));case 2:if("string"==typeof t||t instanceof Object){e.next=4;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(t));case 4:return this.host.requireUser(),t=this._resolveModelId(t),r={},"undefined"!=typeof u&&(r.name=u),"undefined"!=typeof f&&(r.replayHistory=f),"undefined"!=typeof l&&(r.memberIds=l),e.next=12,this.host.api.groups.update(t,{name:u,avatarFile:c,replayHistory:f,memberIds:l});case 12:if(o=e.sent,"undefined"!=typeof o.avatarUrl&&(r.avatarUrl=o.avatarUrl),s=this.host.models.Group.inject((0,I["default"])({id:t},r)),!d){e.next=18;break}return e.next=18,this.host.metadata.update(t,d,s.organizationId);case 18:return e.abrupt("return",s);case 19:case"end":return e.stop()}},n,this)}));return t}(),e.prototype.find=function(){function t(t,n){return e.apply(this,arguments)}var e=(0,A["default"])(T["default"].mark(function n(t){var e,r,o=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return T["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof t){n.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));case 2:if("string"==typeof t){n.next=4;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));case 4:if(o=(0,$["default"])(o,{ignoreNotFound:!1,bypassCache:!1,includeMembers:!1,includeMetadata:!1}),this.host.requireUser(),e=null,o.bypassCache){n.next=13;break}if(e=this.host.models.Group.get(t),!e||e.$placeholder){n.next=13;break}return n.next=12,this.__ensureEntitiesLoaded(e.id,o);case 12:return n.abrupt("return",e);case 13:return n.next=15,this.host.api.groups.find(t);case 15:if(r=n.sent,!r){n.next=21;break}e=this.host.models.Group.inject(r),delete e.$placeholder,n.next=23;break;case 21:if(o.ignoreNotFound){n.next=23;break}throw new K["default"].NotFoundError(this.host.models.Group.name,t);case 23:if(!e){n.next=26;break}return n.next=26,this.__ensureEntitiesLoaded(e.id,o);case 26:return n.abrupt("return",e);case 27:case"end":return n.stop()}},n,this)}));return t}(),e.prototype.__ensureEntitiesLoaded=function(){function t(t,n){return e.apply(this,arguments)}var e=(0,A["default"])(T["default"].mark(function n(t,e){var r,o;return T["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof t){n.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));case 2:if("string"==typeof t){n.next=4;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));case 4:return r=this.host.models.Group.get(t),o=[],e.includeMetadata&&o.push(this.host.metadata.find(t,r.organizationId)),e.includeMembers&&o.push(this.ensureMembers(r)),n.next=10,x["default"].all(o);case 10:this.host.models.Group.touch(t);case 11:case"end":return n.stop()}},n,this)}));return t}(),e.prototype.findAll=function(){function t(t){return e.apply(this,arguments)}var e=(0,A["default"])(T["default"].mark(function n(){var t,e,r,o,a,i,s,u=this,c=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],f=c.includeMembers,l=void 0!==f&&f,d=c.includeMetadata,p=void 0!==d&&d;return T["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!this._fetched){n.next=2;break}return n.abrupt("return",this.getAll());case 2:if(t=this.host.models.Organization.getAll(),0!=t.length){n.next=7;break}return n.next=6,this.host.organizations.findAll();case 6:t=n.sent;case 7:return n.next=9,this.host.search.query({types:["group"],organizationIds:t.map(function(t){return t.id}),query:{displayName:""},includeMetadata:p});case 9:if(e=n.sent,r=e.map(function(t){return t.entity}),!l){n.next=19;break}if(i=[],s=(o=(o=X["default"].call(r,"memberIds"),Y["default"]).call(o),tt["default"]).call(o),(a=i).push.apply(a,s.map(function(t){return u.host.users.find(t,{ignoreNotFound:!0})})),i=i.filter(Boolean),!(i.length>0)){n.next=19;break}return n.next=19,x["default"].all(i);case 19:return this._fetched=!0,n.abrupt("return",r);case 21:case"end":return n.stop()}},n,this)}));return t}(),e.prototype.findAllWithSpecificMembers=function(){function t(t,n){return e.apply(this,arguments)}var e=(0,A["default"])(T["default"].mark(function n(t,e){var r;return T["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof t||Array.isArray(t)&&t.every(function(t){return"string"==typeof t})||Array.isArray(t)&&t.every(function(t){return t instanceof Object})){n.next=2;break}throw new TypeError('Value of argument "memberIds" violates contract.\n\nExpected:\nstring | string[] | Object[]\n\nGot:\n'+i(t));case 2:if("string"==typeof e||e instanceof Object){n.next=4;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(e));case 4:if("string"==typeof t||Array.isArray(t)&&t.every(function(t){return"string"==typeof t})||Array.isArray(t)&&t.every(function(t){return t instanceof Object;
})){n.next=6;break}throw new TypeError('Value of argument "memberIds" violates contract.\n\nExpected:\nstring | string[] | Object[]\n\nGot:\n'+a(t));case 6:if("string"==typeof e||e instanceof Object){n.next=8;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(e));case 8:if(e=this._resolveModelId(e),t=(0,et.arrayWrap)(t).map(this._resolveModelId.bind(this)),!t.includes(this.host.currentUserId)&&t.push(this.host.currentUserId),r=this.__findAllLocalWithSpecificMembers(t,e),0!==r.length){n.next=16;break}return n.next=15,this.findAll();case 15:r=this.__findAllLocalWithSpecificMembers(t,e);case 16:return n.abrupt("return",r);case 17:case"end":return n.stop()}},n,this)}));return t}(),e.prototype.ensureMembers=function(){function t(t,n){return e.apply(this,arguments)}var e=(0,A["default"])(T["default"].mark(function n(t){var e=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return T["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(t instanceof Object){n.next=2;break}throw new TypeError('Value of argument "group" violates contract.\n\nExpected:\nObject\n\nGot:\n'+i(t));case 2:if(t instanceof Object){n.next=4;break}throw new TypeError('Value of argument "group" violates contract.\n\nExpected:\nObject\n\nGot:\n'+a(t));case 4:return n.abrupt("return",this.ensureMembersWithIds(t.id,t.memberIds,e));case 5:case"end":return n.stop()}},n,this)}));return t}(),e.prototype.ensureMembersWithIds=function(){function t(t,n,r){return e.apply(this,arguments)}var e=(0,A["default"])(T["default"].mark(function n(t,e){var r=this,o=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];return T["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof t){n.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));case 2:if(Array.isArray(e)&&e.every(function(t){return"string"==typeof t})){n.next=4;break}throw new TypeError('Value of argument "memberIds" violates contract.\n\nExpected:\nstring[]\n\nGot:\n'+i(e));case 4:if("string"==typeof t){n.next=6;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));case 6:if(Array.isArray(e)&&e.every(function(t){return"string"==typeof t})){n.next=8;break}throw new TypeError('Value of argument "memberIds" violates contract.\n\nExpected:\nstring[]\n\nGot:\n'+a(e));case 8:if(this.host.requireUser(),e=(0,q["default"])(e,this.host.currentUserId),0!==e.length){n.next=12;break}return n.abrupt("return");case 12:return o=(0,$["default"])(o,{onlyPlaceholder:!1}),n.next=15,x["default"].all(e.map(function(t){return r.__ensureMember(t,o)}).filter(Boolean));case 15:this.host.models.Group.touch(t);case 16:case"end":return n.stop()}},n,this)}));return t}(),e.prototype.__ensureMember=function(t,e){var n=this;if("string"!=typeof t)throw new TypeError('Value of argument "memberId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));if("string"!=typeof t)throw new TypeError('Value of argument "memberId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));return this.host.models.User.shouldEnsure(t,e.onlyPlaceholder)?new x["default"](function(r,o){n.host.models.User.ensureEntity(t,(0,I["default"])({},e,{onFinish:r}))}):null},e.prototype.getAll=function(){return this.host.models.Group.getAll()},e.prototype.getById=function(t){if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));return this.host.models.Group.get(t)},e.prototype.getMultiById=function(t){if(!Array.isArray(t)||!t.every(function(t){return"string"==typeof t}))throw new TypeError('Value of argument "ids" violates contract.\n\nExpected:\nArray<string>\n\nGot:\n'+i(t));if(!Array.isArray(t)||!t.every(function(t){return"string"==typeof t}))throw new TypeError('Value of argument "ids" violates contract.\n\nExpected:\nArray<string>\n\nGot:\n'+a(t));return this.host.models.Group.getMulti(t)},e.prototype.__findAllLocalWithSpecificMembers=function(t,e){if(!Array.isArray(t)||!t.every(function(t){return"string"==typeof t}))throw new TypeError('Value of argument "memberIds" violates contract.\n\nExpected:\nstring[]\n\nGot:\n'+i(t));if("string"!=typeof e)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));if(!Array.isArray(t)||!t.every(function(t){return"string"==typeof t}))throw new TypeError('Value of argument "memberIds" violates contract.\n\nExpected:\nstring[]\n\nGot:\n'+a(t));if("string"!=typeof e)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));var n=this.host.models.Group.getAll(),r=(0,R["default"])(n,function(n){return n.organizationId==e&&0==(0,P["default"])(n.memberIds,t).length});return r},e.prototype.destroy=function(){function t(t){return e.apply(this,arguments)}var e=(0,A["default"])(T["default"].mark(function n(t){var e;return T["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof t||t instanceof Object){n.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(t));case 2:if("string"==typeof t||t instanceof Object){n.next=4;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(t));case 4:return this.host.requireUser(),t=this._resolveModelId(t),n.next=8,this.host.api.groups.destroy(t);case 8:if(e=n.sent){n.next=11;break}throw new K["default"].NotFoundError(this.host.models.Group.name,t);case 11:return this.host.models.Group.eject(t),n.abrupt("return",null);case 13:case"end":return n.stop()}},n,this)}));return t}(),e.prototype.findAllMemberIds=function(){function t(t){return e.apply(this,arguments)}var e=(0,A["default"])(T["default"].mark(function n(t){var e;return T["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof t||t instanceof Object){n.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(t));case 2:if("string"==typeof t||t instanceof Object){n.next=4;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(t));case 4:return this.host.requireUser(),t=this._resolveModelId(t),n.next=8,this.httpClient.get("/group/:id/members",{urlParams:{id:t}});case 8:return e=n.sent,n.abrupt("return",e.data);case 10:case"end":return n.stop()}},n,this)}));return t}(),e.prototype.addMembers=function(){function t(t,n){return e.apply(this,arguments)}var e=(0,A["default"])(T["default"].mark(function n(t,e){return T["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof t||t instanceof Object){n.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(t));case 2:if("string"==typeof e||Array.isArray(e)&&e.every(function(t){return"string"==typeof t})||Array.isArray(e)&&e.every(function(t){return t instanceof Object})){n.next=4;break}throw new TypeError('Value of argument "memberIds" violates contract.\n\nExpected:\nstring | string[] | Object[]\n\nGot:\n'+i(e));case 4:if("string"==typeof t||t instanceof Object){n.next=6;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(t));case 6:if("string"==typeof e||Array.isArray(e)&&e.every(function(t){return"string"==typeof t})||Array.isArray(e)&&e.every(function(t){return t instanceof Object})){n.next=8;break}throw new TypeError('Value of argument "memberIds" violates contract.\n\nExpected:\nstring | string[] | Object[]\n\nGot:\n'+a(e));case 8:return this.host.requireUser(),t=this._resolveModelId(t),e=(0,et.arrayWrap)(e).map(this._resolveModelId.bind(this)),n.next=13,this.host.api.groups.addMembers(t,e);case 13:case"end":return n.stop()}},n,this)}));return t}(),e.prototype.removeMembers=function(){function t(t,n){return e.apply(this,arguments)}var e=(0,A["default"])(T["default"].mark(function n(t,e){return T["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof t||t instanceof Object){n.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(t));case 2:if("string"==typeof e||Array.isArray(e)&&e.every(function(t){return"string"==typeof t})||Array.isArray(e)&&e.every(function(t){return t instanceof Object})){n.next=4;break}throw new TypeError('Value of argument "memberIds" violates contract.\n\nExpected:\nstring | string[] | Object[]\n\nGot:\n'+i(e));case 4:if("string"==typeof t||t instanceof Object){n.next=6;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(t));case 6:if("string"==typeof e||Array.isArray(e)&&e.every(function(t){return"string"==typeof t})||Array.isArray(e)&&e.every(function(t){return t instanceof Object})){n.next=8;break}throw new TypeError('Value of argument "memberIds" violates contract.\n\nExpected:\nstring | string[] | Object[]\n\nGot:\n'+a(e));case 8:return this.host.requireUser(),t=this._resolveModelId(t),e=(0,et.arrayWrap)(e).map(this._resolveModelId.bind(this)),n.next=13,this.host.api.groups.removeMembers(t,e);case 13:e.includes(this.host.currentUserId)&&this.host.models.Group.eject(t);case 14:case"end":return n.stop()}},n,this)}));return t}(),e.prototype.addMember=function(){function t(t,n){return e.apply(this,arguments)}var e=(0,A["default"])(T["default"].mark(function n(t,e){return T["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof t||t instanceof Object){n.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(t));case 2:if("string"==typeof e||e instanceof Object){n.next=4;break}throw new TypeError('Value of argument "memberId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(e));case 4:if("string"==typeof t||t instanceof Object){n.next=6;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(t));case 6:if("string"==typeof e||e instanceof Object){n.next=8;break}throw new TypeError('Value of argument "memberId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(e));case 8:return n.abrupt("return",this.addMembers(t,[e]));case 9:case"end":return n.stop()}},n,this)}));return t}(),e.prototype.removeMember=function(){function t(t,n){return e.apply(this,arguments)}var e=(0,A["default"])(T["default"].mark(function n(t,e){return T["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof t||t instanceof Object){n.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(t));case 2:if("string"==typeof e||e instanceof Object){n.next=4;break}throw new TypeError('Value of argument "memberId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(e));case 4:if("string"==typeof t||t instanceof Object){n.next=6;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(t));case 6:if("string"==typeof e||e instanceof Object){n.next=8;break}throw new TypeError('Value of argument "memberId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(e));case 8:return n.abrupt("return",this.removeMembers(t,[e]));case 9:case"end":return n.stop()}},n,this)}));return t}(),e.prototype.join=function(){function t(t){return e.apply(this,arguments)}var e=(0,A["default"])(T["default"].mark(function n(t){return T["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"==typeof t||t instanceof Object){e.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(t));case 2:if("string"==typeof t||t instanceof Object){e.next=4;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(t));case 4:return e.abrupt("return",this.addMembers(t,[this.host.currentUserId]));case 5:case"end":return e.stop()}},n,this)}));return t}(),e.prototype.leave=function(){function t(t){return e.apply(this,arguments)}var e=(0,A["default"])(T["default"].mark(function n(t){var e;return T["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof t||t instanceof Object){n.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(t));case 2:if("string"==typeof t||t instanceof Object){n.next=4;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(t));case 4:if(t=this._resolveModelId(t),e=this.getById(t)){n.next=8;break}return n.abrupt("return");case 8:return n.next=10,this.host.conversations.remove("group",t,e.organizationId);case 10:return n.next=12,this.removeMember(t,this.host.currentUserId);case 12:case"end":return n.stop()}},n,this)}));return t}(),e.prototype.reactToBangEvent=function(t){switch(t.data.event){case"added":this.__addedToGroup(t);break;case"removed":this.__removedFromGroup(t)}},e.prototype.__addedToGroup=function(t){var e=t.data.caller_entity,n=t.data.subject_entity,r=t.data.target_entity;if(e&&e.token&&r&&r.token&&n&&n.token){var o=this.host.injectModel(e),a=this.host.injectModel(n),i=this.host.models.Group.get(r.token);if(i){var s=a.id===o.id?"JOIN":"ADD",u={id:t.id,sortNumber:+t.data.sort_number,createdAt:new Date(t.data.created_on),action:s,actor:o,actorId:o.id,group:i,groupId:i.id,members:[a],memberIds:[a.id]};this.host.conversations.addMembershipChangeLog(u),i.memberIds.includes(a.id)||(this.host.models.Group.touch(i),this.emit("membership:change",u))}}},e.prototype.__removedFromGroup=function(t){var e=t.data.caller_entity,n=t.data.subject_entity,r=t.data.target_entity;if(e&&e.token&&r&&r.token&&n&&n.token){var o=this.host.injectModel(e),a=this.host.models.Group.get(r.token);if(a&&a.memberIds){var i=this.host.injectModel(n),s=i.id===o.id?"LEAVE":"REMOVE",u={id:t.id,sortNumber:+t.data.sort_number,createdAt:new Date(t.data.created_on),action:s,actor:o,actorId:o.id,group:a,groupId:a.id,members:[i],memberIds:[i.id]};this.host.conversations.addMembershipChangeLog(u),a.memberIds.includes(i.id)&&this.emit("membership:change",u)}}},e}(D["default"]),o(d.prototype,"find",[s],(0,w["default"])(d.prototype,"find"),d.prototype),o(d.prototype,"__ensureEntitiesLoaded",[u],(0,w["default"])(d.prototype,"__ensureEntitiesLoaded"),d.prototype),o(d.prototype,"findAll",[c],(0,w["default"])(d.prototype,"findAll"),d.prototype),o(d.prototype,"findAllWithSpecificMembers",[f],(0,w["default"])(d.prototype,"findAllWithSpecificMembers"),d.prototype),o(d.prototype,"__findAllLocalWithSpecificMembers",[W.privateMethod],(0,w["default"])(d.prototype,"__findAllLocalWithSpecificMembers"),d.prototype),o(d.prototype,"__addedToGroup",[W.privateMethod],(0,w["default"])(d.prototype,"__addedToGroup"),d.prototype),o(d.prototype,"__removedFromGroup",[W.privateMethod],(0,w["default"])(d.prototype,"__removedFromGroup"),d.prototype),l=d))||l);e["default"]=nt,t.exports=e["default"]},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function o(t,e,n,r,o){var a={};return Object.keys(r).forEach(function(t){a[t]=r[t]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=n.slice().reverse().reduce(function(n,r){return r(t,e,n)||n},a),o&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(o):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(t,e,a),a=null),a}function a(t,e){var n=4,r=15;if(void 0===e&&(e=0),e+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return"undefined"==typeof t?"undefined":(0,x["default"])(t);if(!Array.isArray(t)){var o=(0,m["default"])(t);if(!o.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(e>n)return"{...}";var i="  ".repeat(e-1),s=o.slice(0,r).map(function(n){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(n)?n:(0,g["default"])(n))+": "+a(t[n],e)+";"}).join("\n  "+i);return o.length>=r&&(s+="\n  "+i+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+i+s+"\n"+i+"}":"{\n  "+i+s+"\n"+i+"}"}if(!(t.length>0))return"Array";var u=function(){if(e>n)return{v:"[...]"};var o=a(t[0],e);return t.every(function(t){return a(t,e)===o})?{v:o.trim()+"[]"}:{v:"["+t.slice(0,r).map(function(t){return a(t,e)}).join(", ")+(t.length>=r?", ...":"")+"]"}}();return"object"===("undefined"==typeof u?"undefined":(0,x["default"])(u))?u.v:void 0}function i(t,e){var n=4,r=15;if(void 0===e&&(e=0),e+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return"undefined"==typeof t?"undefined":(0,x["default"])(t);if(!Array.isArray(t)){var o=(0,m["default"])(t);if(!o.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(e>n)return"{...}";var a="  ".repeat(e-1),s=o.slice(0,r).map(function(n){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(n)?n:(0,g["default"])(n))+": "+i(t[n],e)+";"}).join("\n  "+a);return o.length>=r&&(s+="\n  "+a+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+a+s+"\n"+a+"}":"{\n  "+a+s+"\n"+a+"}"}if(!(t.length>0))return"Array";var u=function(){if(e>n)return{v:"[...]"};var o=i(t[0],e);return t.every(function(t){return i(t,e)===o})?{v:o.trim()+"[]"}:{v:"["+t.slice(0,r).map(function(t){return i(t,e)}).join(", ")+(t.length>=r?", ...":"")+"]"}}();return"object"===("undefined"==typeof u?"undefined":(0,x["default"])(u))?u.v:void 0}e.__esModule=!0,e["default"]=void 0;var s,u,c,f,l,d,p,y,h=n(5),g=r(h),v=n(4),m=r(v),b=n(9),w=r(b),E=n(8),x=r(E),_=n(17),I=r(_),O=n(16),T=r(O),j=n(26),A=r(j),k=n(38),M=r(k),G=n(39),V=r(G),z=n(7),C=r(z),S=n(11),P=r(S),N=n(6),R=r(N),U=n(1),q=r(U),F=n(3),$=r(F),L=n(2),D=r(L),B=n(64),K=r(B),Z=n(167),W=r(Z),H=n(67),X=r(H),Q=n(65),Y=r(Q),J=n(29),tt=r(J),et=n(33),nt=r(et),rt=n(34),ot=r(rt),at=n(149),it=r(at),st=n(145),ut=r(st),ct=n(45),ft=r(ct),lt=n(46),dt=r(lt),pt=n(10),yt=r(pt),ht=n(47),gt=r(ht),vt=n(14),mt=n(12),bt=n(68),wt=r(bt),Et=n(23),xt=n(25),_t=r(xt),It=n(13),Ot=r(It),Tt=n(21),jt=r(Tt),At=n(42),kt=r(At),Mt=n(139),Gt=r(Mt),Vt=n(138),zt=r(Vt),Ct=n(24),St=r(Ct),Pt=n(43),Nt=r(Pt),Rt=n(28),Ut=r(Rt),qt=n(15),Ft=["user","group","distributionList"],$t=(s=(0,vt.decorator)(),u=(0,vt.decorator)(),c=(0,vt.decorator)({memoize:!0}),f=(0,vt.decorator)({memoize:!0}),l=(0,vt.decorator)(),d=(0,vt.decorator)(),(0,mt.classWithPrivateMethods)((y=function(t){function e(){(0,q["default"])(this,e);for(var n=arguments.length,r=Array(n),o=0;o<n;o++)r[o]=arguments[o];var a=(0,$["default"])(this,t.call.apply(t,[this].concat(r)));return a._throtelled_flushQueueMessageStatuses=a.config.flushSetMessageStatusInterval?(0,dt["default"])(a.__flushQueueMessageStatuses,a.config.flushSetMessageStatusInterval,{leading:!1}):a.__flushQueueMessageStatuses,a}return(0,D["default"])(e,t),e.prototype.mounted=function(){this._queuedMessageStatuses={deliveredIds:[],readIds:[]},this.host.on("tick",this.deleteExpiredMessages)},e.prototype.dispose=function(){this._queuedMessageStatuses=null,this.downloadAttachmentBlobAndURL&&vt.decorator.clear(this.downloadAttachmentBlobAndURL),this.downloadAttachmentUrl&&vt.decorator.clear(this.downloadAttachmentUrl),this._throtelled_flushQueueMessageStatuses.cancel&&this._throtelled_flushQueueMessageStatuses.cancel(),this.host.off("tick",this.deleteExpiredMessages)},e.prototype.send=function(){function t(t,n,r){return e.apply(this,arguments)}var e=(0,R["default"])(C["default"].mark(function n(t,e){var r,o,s,u=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];return C["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof t||Array.isArray(t)&&t.every(function(t){return"string"==typeof t})||t instanceof Object||Array.isArray(t)&&t.every(function(t){return t instanceof Object})){n.next=2;break}throw new TypeError('Value of argument "entityId" violates contract.\n\nExpected:\nstring | string[] | Object | Object[]\n\nGot:\n'+i(t));case 2:if("string"==typeof e){n.next=4;break}throw new TypeError('Value of argument "body" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));case 4:if(null==u||u instanceof Object){n.next=6;break}throw new TypeError('Value of argument "options" violates contract.\n\nExpected:\n?Object\n\nGot:\n'+i(u));case 6:if("string"==typeof t||Array.isArray(t)&&t.every(function(t){return"string"==typeof t})||t instanceof Object||Array.isArray(t)&&t.every(function(t){return t instanceof Object})){n.next=8;break}throw new TypeError('Value of argument "entityId" violates contract.\n\nExpected:\nstring | string[] | Object | Object[]\n\nGot:\n'+a(t));case 8:if("string"==typeof e){n.next=10;break}throw new TypeError('Value of argument "body" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));case 10:if(null==u||u instanceof Object){n.next=12;break}throw new TypeError('Value of argument "options" violates contract.\n\nExpected:\n?Object\n\nGot:\n'+a(u));case 12:if(!Array.isArray(t)){n.next=14;break}return n.abrupt("return",this.__sendToGroupOfUsers(t,e,u));case 14:return n.next=16,this.__resolveCounterPartyEntityAndOrganizationId(t,!1);case 16:if(r=n.sent,o=r.counterParty,s=r.organizationId,s&&(u=(0,P["default"])({},(0,ft["default"])(u,"organizationId","senderOrganizationId","recipientOrganizationId"),{organizationId:s})),!o){n.next=24;break}return n.abrupt("return",this.__sendToKnownCounterParty(o.$entityType,o.serverId,e,u));case 24:return n.abrupt("return",this.__sendToUnknownCounterParty(t,e,u));case 25:case"end":return n.stop()}},n,this)}));return t}(),e.prototype.__resolveCounterPartyEntityAndOrganizationId=function(){function t(t,n){return e.apply(this,arguments)}var e=(0,R["default"])(C["default"].mark(function n(t){var e,r,o,s=!(arguments.length<=1||void 0===arguments[1])&&arguments[1];return C["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof t||t instanceof Object){n.next=2;break}throw new TypeError('Value of argument "entityId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(t));case 2:if("boolean"==typeof s){n.next=4;break}throw new TypeError('Value of argument "fallbackRemote" violates contract.\n\nExpected:\nbool\n\nGot:\n'+i(s));case 4:if("string"==typeof t||t instanceof Object){n.next=6;break}throw new TypeError('Value of argument "entityId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(t));case 6:if("boolean"==typeof s){n.next=8;break}throw new TypeError('Value of argument "fallbackRemote" violates contract.\n\nExpected:\nbool\n\nGot:\n'+a(s));case 8:if(e=this._resolveEntity(t,[].concat(Ft,["conversation"])),r=null,e){n.next=16;break}if(!this.host.conversations.looksLikeConversationId(t)){n.next=16;break}return n.next=14,this.host.conversations.find(t);case 14:o=n.sent,o&&(e=o.counterParty,r=o.organizationId);case 16:if(e||!s){n.next=20;break}return n.next=19,this.__resolveRemoteCounterPartyEntity(t);case 19:e=n.sent;case 20:return e&&(e.organizationId&&(r=e.organizationId),"conversation"===e.$entityType&&(e=e.counterParty)),n.abrupt("return",{counterParty:e,organizationId:r});case 22:case"end":return n.stop()}},n,this)}));return t}(),e.prototype.__resolveRemoteCounterPartyEntity=function(){function t(t){return e.apply(this,arguments)}var e=(0,R["default"])(C["default"].mark(function n(t){var e,r,o,s,u,c,f,l=this;return C["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof t){n.next=2;break}throw new TypeError('Value of argument "entityId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));case 2:if("string"==typeof t){n.next=4;break}throw new TypeError('Value of argument "entityId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));case 4:if(e=null,r=(0,ut["default"])([(0,R["default"])(C["default"].mark(function d(){return C["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",l.host.users.find(t));case 1:case"end":return e.stop()}},d,l)})),(0,R["default"])(C["default"].mark(function p(){return C["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",l.host.groups.find(t));case 1:case"end":return e.stop()}},p,l)})),(0,R["default"])(C["default"].mark(function y(){return C["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",l.host.distributionLists.find(t));case 1:case"end":return e.stop()}},y,l)}))]),r&&("function"==typeof r[V["default"]]||Array.isArray(r))){n.next=8;break}throw new TypeError("Expected resolvers to be iterable, got "+a(r));case 8:if(r&&("function"==typeof r[V["default"]]||Array.isArray(r))){n.next=10;break}throw new TypeError("Expected resolvers to be iterable, got "+i(r));case 10:o=r,s=Array.isArray(o),u=0,o=s?o:(0,M["default"])(o);case 11:if(!s){n.next=17;break}if(!(u>=o.length)){n.next=14;break}return n.abrupt("break",36);case 14:c=o[u++],n.next=21;break;case 17:if(u=o.next(),!u.done){n.next=20;break}return n.abrupt("break",36);case 20:c=u.value;case 21:return f=c,n.prev=22,n.next=25,f();case 25:if(e=n.sent,!e){n.next=28;break}return n.abrupt("break",36);case 28:n.next=34;break;case 30:if(n.prev=30,n.t0=n["catch"](22),n.t0.code===Ot["default"].NotFoundError.CODE){n.next=34;break}throw n.t0;case 34:n.next=11;break;case 36:return n.abrupt("return",e);case 37:case"end":return n.stop()}},n,this,[[22,30]])}));return t}(),e.prototype.__sendToKnownCounterParty=function(){function t(t,n,r,o){return e.apply(this,arguments)}var e=(0,R["default"])(C["default"].mark(function n(t,e,r,o){var s,u,c,f,l=o.organizationId,d=o.senderOrganizationId,p=void 0===d?l:d,y=o.recipientOrganizationId,h=void 0===y?p:y,g=(0,A["default"])(o,["organizationId","senderOrganizationId","recipientOrganizationId"]),v=arguments;return C["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof t){n.next=2;break}throw new TypeError('Value of argument "counterPartyType" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));case 2:if("string"==typeof e){n.next=4;break}throw new TypeError('Value of argument "counterPartyId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));case 4:if("string"==typeof r){n.next=6;break}throw new TypeError('Value of argument "body" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(r));case 6:if(!(null==v[3]||null!=v[3].organizationId&&"string"!=typeof v[3].organizationId||null!=v[3].senderOrganizationId&&"string"!=typeof v[3].senderOrganizationId||null!=v[3].recipientOrganizationId&&"string"!=typeof v[3].recipientOrganizationId)&&(null==v[3].options||v[3].options instanceof Object)){n.next=8;break}throw new TypeError("Value of argument 3 violates contract.\n\nExpected:\n{\n  organizationId: ?string;\n  senderOrganizationId: ?string;\n  recipientOrganizationId: ?string;\n  options: ?Object;\n}\n\nGot:\n"+i(v[3]));case 8:if("string"==typeof t){n.next=10;break}throw new TypeError('Value of argument "counterPartyType" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));case 10:if("string"==typeof e){n.next=12;break}throw new TypeError('Value of argument "counterPartyId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));case 12:if("string"==typeof r){n.next=14;break}throw new TypeError('Value of argument "body" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(r));case 14:if(!(null==v[3]||null!=v[3].organizationId&&"string"!=typeof v[3].organizationId||null!=v[3].senderOrganizationId&&"string"!=typeof v[3].senderOrganizationId||null!=v[3].recipientOrganizationId&&"string"!=typeof v[3].recipientOrganizationId)&&(null==v[3].options||v[3].options instanceof Object)){n.next=16;break}throw new TypeError("Value of argument 3 violates contract.\n\nExpected:\n{\n  organizationId: ?string;\n  senderOrganizationId: ?string;\n  recipientOrganizationId: ?string;\n  options: ?Object;\n}\n\nGot:\n"+a(v[3]));case 16:this.host.requireUser(),_t["default"].oneOf("counterPartyType",t,["user","group","distributionList"]),_t["default"].notEmpty("counterPartyId",e),s=this.__getNextSortNumber(),p=this.__ensureOrganization(p),h=h||p,g=this.__normalizeSendOptions(g,p),u=this.host.conversations.ensureConversation(t,e,p),c=this.host.models.Message.createInstance({id:wt["default"].v4(),conversationId:u.id,messageType:Et.MessageType.USER_SENT,counterPartyId:e,counterPartyType:t,body:r,senderOrganizationId:p,recipientOrganizationId:h,sortNumber:s,createdAt:new Date,senderId:this.host.currentUserId,direction:Et.MessageDirection.OUTGOING,senderStatus:Et.MessageSenderStatus.SENDING,$synced:!1,serverId:null,metadata:g.metadata,priority:g.priority,deleteOnRead:g.deleteOnRead,ttl:g.ttl}),g.attachmentFiles&&this.__setLocalMessageAttachments(c,g.attachmentFiles),n.t0=t,n.next="group"===n.t0?29:"user"===n.t0?32:"distributionList"===n.t0?35:38;break;case 29:return c.groupId=e,c.recipientStatus=Et.MessageRecipientStatus.NA,n.abrupt("break",38);case 32:return c.recipientId=e,c.recipientStatus=Et.MessageRecipientStatus.NEW,n.abrupt("break",38);case 35:return c.distributionListId=e,c.recipientStatus=Et.MessageRecipientStatus.NA,n.abrupt("break",38);case 38:return this.host.models.Message.inject(c),this.host.emit("message:sending",c),n.prev=40,n.next=43,this.host.api.messages.send({localId:c.id,counterPartyId:e,body:r,senderOrganizationId:p,recipientOrganizationId:h,attachment:(0,it["default"])(g.attachmentFiles),priority:"undefined"!=typeof g.priority?Et.MessagePriority.toServer(g.priority):void 0,metadata:g.metadata,ttl:g.ttl,deleteOnRead:g.deleteOnRead});case 43:f=n.sent,(0,T["default"])(c,{serverId:f.serverId,ttl:f.ttl,senderStatus:Et.MessageSenderStatus.SENT,$synced:!0}),n.next=50;break;case 47:n.prev=47,n.t1=n["catch"](40),c.senderStatus=Et.MessageSenderStatus.FAILED;case 50:return this.host.models.Message.inject(c),this.host.emit("message:sent",c),n.abrupt("return",c);case 53:case"end":return n.stop()}},n,this,[[40,47]])}));return t}(),e.prototype.__sendToUnknownCounterParty=function(){function t(t,n,r){return e.apply(this,arguments)}var e=(0,R["default"])(C["default"].mark(function n(t,e){var r,o,s,u,c,f,l=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],d=l.organizationId,p=l.senderOrganizationId,y=void 0===p?d:p,h=l.recipientOrganizationId,g=void 0===h?y:h,v=(0,A["default"])(l,["organizationId","senderOrganizationId","recipientOrganizationId"]);return C["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof t||t instanceof Object){n.next=2;break}throw new TypeError('Value of argument "counterPartyId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(t));case 2:if("string"==typeof e){n.next=4;break}throw new TypeError('Value of argument "body" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));case 4:if("string"==typeof t||t instanceof Object){n.next=6;break}throw new TypeError('Value of argument "counterPartyId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(t));case 6:if("string"==typeof e){n.next=8;break}throw new TypeError('Value of argument "body" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));case 8:return r=wt["default"].v4(),o=this.__getNextSortNumber(),y=this.__ensureOrganization(y),g=g||y,v=this.__normalizeSendOptions(v,y),n.next=15,this.host.api.messages.send({localId:r,counterPartyId:t,body:e,senderOrganizationId:y,recipientOrganizationId:g,attachment:(0,it["default"])(v.attachmentFiles),priority:"undefined"!=typeof v.priority?Et.MessagePriority.toServer(v.priority):void 0,metadata:v.metadata,ttl:v.ttl,deleteOnRead:v.deleteOnRead});case 15:return s=n.sent,n.next=18,this.__resolveRemoteCounterPartyEntity(t);
case 18:return u=n.sent,c=this.host.conversations.ensureConversation(u.$entityType,u.serverId,y,{ensureEntities:{counterParty:"full",groupMembers:"full"}}),f=this.host.models.Message.inject({id:s.serverId,serverId:s.serverId,$synced:!0,conversationId:c.id,counterParty:u,messageType:Et.MessageType.USER_SENT,body:e,senderOrganizationId:y,recipientOrganizationId:g,sortNumber:o,createdAt:new Date,senderId:this.host.currentUserId,direction:Et.MessageDirection.OUTGOING,senderStatus:Et.MessageSenderStatus.SENT,recipientStatus:Et.MessageRecipientStatus.NEW,metadata:v.metadata,priority:v.priority,ttl:s.ttl,deleteOnRead:v.deleteOnRead}),v.attachmentFiles&&this.__setLocalMessageAttachments(f,v.attachmentFiles),this.host.emit("message:sending",f),this.host.emit("message:sent",f),n.abrupt("return",f);case 25:case"end":return n.stop()}},n,this)}));return t}(),e.prototype.__normalizeSendOptions=function(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],e=t.metadata,n=t.attachmentFiles,r=t.attachmentFile,o=t.priority,s=t.ttl,u=t.deleteOnRead,c=arguments[1];if("string"!=typeof c)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(c));if("string"!=typeof c)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(c));return e&&(e=this.__normalizeMetadata(e)),n=this.__validateAttachments(n||r),"undefined"==typeof s&&(s=this.host.organizations.getSettingValue(c,"ttl")||-1),{metadata:e,attachmentFiles:n,priority:o,ttl:s,deleteOnRead:u}},e.prototype.__ensureOrganization=function(t){if(null!=t&&"string"!=typeof t)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\n?string\n\nGot:\n'+i(t));if(null!=t&&"string"!=typeof t)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\n?string\n\nGot:\n'+a(t));return t?t:this.host.config.defaultOrganizationId?this.host.config.defaultOrganizationId:void _t["default"].raise("organizationId","required","Message is sent in the context of an organization. Provide `organizationId` or set a default one with client.setDefaultOrganization(...)")},e.prototype.__validateAttachments=function(t){return t=(0,qt.arrayWrap)(t),!(0,ot["default"])(t)&&t.length>1&&_t["default"].raise("attachmentFiles","invalid","currently only a single attachment is supported"),t},e.prototype.__normalizeMetadata=function(t){return t?(0,qt.arrayWrap)(t).map(function(t){return(0,P["default"])({mimetype:"application/json"},t)}):null},e.prototype.__getNextSortNumber=function(){var t,e=(t=(t=this.host.models.Message.getAll(),kt["default"]).call(t,["sortNumber"],["desc"]),Gt["default"]).call(t),n=e?e.sortNumber:0,r=n+1e-6;return r},e.prototype.__setLocalMessageAttachments=function(t,e){if(!(t instanceof Object))throw new TypeError('Value of argument "message" violates contract.\n\nExpected:\nObject\n\nGot:\n'+i(t));if(!Array.isArray(e)||!e.every(function(t){return"string"==typeof t||t instanceof Object}))throw new TypeError('Value of argument "attachmentFiles" violates contract.\n\nExpected:\nArray<string | Object>\n\nGot:\n'+i(e));if(!(t instanceof Object))throw new TypeError('Value of argument "message" violates contract.\n\nExpected:\nObject\n\nGot:\n'+a(t));if(!Array.isArray(e)||!e.every(function(t){return"string"==typeof t||t instanceof Object}))throw new TypeError('Value of argument "attachmentFiles" violates contract.\n\nExpected:\nArray<string | Object>\n\nGot:\n'+a(e));t.attachments=e.map(this.__generateAttachmentDescriptor.bind(this))},e.prototype.__generateAttachmentDescriptor=function(t){if(!("string"==typeof t||t instanceof Object))throw new TypeError('Value of argument "attachment" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(t));if(!("string"==typeof t||t instanceof Object))throw new TypeError('Value of argument "attachment" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(t));var e="local:"+wt["default"].v4();"string"==typeof t||t instanceof Buffer||_t["default"].raise("attachment","invalid","attachment (string or Buffer) is invalid");var r=void 0,o=void 0,s=void 0,u=n(54),c=n(69),f=n(172),l=n(53);if("string"==typeof t)r=u.statSync(t).size,o=f.lookup(t),s=c.basename(t);else{var d=l(t);if(d){var p=d.ext,y=d.mime;s="attachment."+p,o=y}r=t.byteLength}var h={id:e,localPath:"string"==typeof t?t:null,localFile:t instanceof Buffer?t:null,name:s,size:r,contentType:o,isLocal:!0};return h},e.prototype.__loadLocalFilePathWithFileReader=function(t){return new I["default"](function(e,n){var r=new FileReader;r.addEventListener("load",function(){e(r.result)},!1),r.addEventListener("error",function(t){n(t)},!1),r.readAsDataURL(t)})},e.prototype.sendToUser=function(t){if(!("string"==typeof t||t instanceof Object))throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(t));if(!("string"==typeof t||t instanceof Object))throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(t));for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return this.send.apply(this,[t].concat(n))},e.prototype.sendToGroup=function(t){if(!("string"==typeof t||t instanceof Object))throw new TypeError('Value of argument "groupId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(t));if(!("string"==typeof t||t instanceof Object))throw new TypeError('Value of argument "groupId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(t));for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return this.send.apply(this,[t].concat(n))},e.prototype.sendToConversation=function(t){if(!("string"==typeof t||t instanceof Object))throw new TypeError('Value of argument "conversationId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(t));if(!("string"==typeof t||t instanceof Object))throw new TypeError('Value of argument "conversationId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(t));for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return this.send.apply(this,[t].concat(n))},e.prototype.sendToDistributionList=function(t){if(!("string"==typeof t||t instanceof Object))throw new TypeError('Value of argument "distributionListId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(t));if(!("string"==typeof t||t instanceof Object))throw new TypeError('Value of argument "distributionListId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(t));for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return this.send.apply(this,[t].concat(n))},e.prototype.sendToNewGroup=function(t){if(!(Array.isArray(t)&&t.every(function(t){return"string"==typeof t})||Array.isArray(t)&&t.every(function(t){return t instanceof Object})))throw new TypeError('Value of argument "userIds" violates contract.\n\nExpected:\nstring[] | Object[]\n\nGot:\n'+i(t));if(!(Array.isArray(t)&&t.every(function(t){return"string"==typeof t})||Array.isArray(t)&&t.every(function(t){return t instanceof Object})))throw new TypeError('Value of argument "userIds" violates contract.\n\nExpected:\nstring[] | Object[]\n\nGot:\n'+a(t));for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return this.send.apply(this,[t].concat(n))},e.prototype.__sendToGroupOfUsers=function(){function t(t,n,r){return e.apply(this,arguments)}var e=(0,R["default"])(C["default"].mark(function n(t,e){var r,o=this,s=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],u=s.organizationId,c=s.preferExistingGroup,f=void 0!==c&&c,l=s.groupName,d=s.groupMetadata,p=(0,A["default"])(s,["organizationId","preferExistingGroup","groupName","groupMetadata"]);return C["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(Array.isArray(t)&&t.every(function(t){return"string"==typeof t})||Array.isArray(t)&&t.every(function(t){return t instanceof Object})){n.next=2;break}throw new TypeError('Value of argument "userIds" violates contract.\n\nExpected:\nstring[] | Object[]\n\nGot:\n'+i(t));case 2:if("string"==typeof e){n.next=4;break}throw new TypeError('Value of argument "body" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));case 4:if(Array.isArray(t)&&t.every(function(t){return"string"==typeof t})||Array.isArray(t)&&t.every(function(t){return t instanceof Object})){n.next=6;break}throw new TypeError('Value of argument "userIds" violates contract.\n\nExpected:\nstring[] | Object[]\n\nGot:\n'+a(t));case 6:if("string"==typeof e){n.next=8;break}throw new TypeError('Value of argument "body" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));case 8:if(t=t.map(function(t){return o._resolveModelIdWithTypes(t,"user")}),0==t.length&&_t["default"].raise("userIds","required"),r=void 0,!f){n.next=15;break}throw new Error("not implemented");case 15:return n.next=17,this.__prepareGroupForUsers(u,t,l,{groupMetadata:d});case 17:r=n.sent;case 18:return n.abrupt("return",this.sendToGroup(r,e,(0,P["default"])({organizationId:u},p)));case 19:case"end":return n.stop()}},n,this)}));return t}(),e.prototype.__prepareGroupForUsers=function(){function t(t,n,r,o){return e.apply(this,arguments)}var e=(0,R["default"])(C["default"].mark(function n(t,e,r){var o,a,i=this,s=arguments.length<=3||void 0===arguments[3]?{}:arguments[3],u=s.groupMetadata;return C["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return o=[this.host.currentUser].concat(e.map(function(t){return i.host.models.User.get(t)}).filter(Boolean)),r||(r=o.map(function(t){return t.displayName}).filter(Boolean).join(", ")||"Group"),n.next=4,this.host.groups.create({organizationId:t,name:r,replayHistory:!0,memberIds:e,metadata:u});case 4:return a=n.sent,n.abrupt("return",a);case 6:case"end":return n.stop()}},n,this)}));return t}(),e.prototype.onMessageRecalled=function(t){if(!("string"==typeof t||t instanceof Object))throw new TypeError('Value of argument "messageServerId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(t));if(!("string"==typeof t||t instanceof Object))throw new TypeError('Value of argument "messageServerId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(t));this.host.requireUser();var e=this._getMessageByServerId(t);e&&this._deleteLocalMessage(e)},e.prototype._deleteLocalMessage=function(t){if(!(t instanceof Object))throw new TypeError('Value of argument "message" violates contract.\n\nExpected:\nObject\n\nGot:\n'+i(t));if(!(t instanceof Object))throw new TypeError('Value of argument "message" violates contract.\n\nExpected:\nObject\n\nGot:\n'+a(t));this.host.models.Message.eject(t)},e.prototype.recall=function(){function t(t){return e.apply(this,arguments)}var e=(0,R["default"])(C["default"].mark(function n(t){var e,r;return C["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof t||t instanceof Object||Array.isArray(t)&&t.every(function(t){return"string"==typeof t})||Array.isArray(t)&&t.every(function(t){return t instanceof Object})){n.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object | string[] | Object[]\n\nGot:\n'+i(t));case 2:if("string"==typeof t||t instanceof Object||Array.isArray(t)&&t.every(function(t){return"string"==typeof t})||Array.isArray(t)&&t.every(function(t){return t instanceof Object})){n.next=4;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object | string[] | Object[]\n\nGot:\n'+a(t));case 4:return this.host.requireUser(),e=(0,qt.arrayWrap)(t),r=e.map(this.__recallSingle.bind(this)),n.next=9,I["default"].all(r);case 9:case"end":return n.stop()}},n,this)}));return t}(),e.prototype.__recallSingle=function(){function t(t){return e.apply(this,arguments)}var e=(0,R["default"])(C["default"].mark(function n(t){var e;return C["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof t||t instanceof Object){n.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(t));case 2:if("string"==typeof t||t instanceof Object){n.next=4;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(t));case 4:if(e=this._resolveMessage(t),!e){n.next=17;break}if(e.senderId==this.host.currentUserId){n.next=8;break}throw new Ot["default"].PermissionDeniedError(e,e.serverId,"recall");case 8:if(e.$synced!==!1){n.next=12;break}this._deleteLocalMessage(e),n.next=15;break;case 12:return n.next=14,this.host.api.messages.destroy(e.serverId);case 14:this._deleteLocalMessage(e);case 15:n.next=19;break;case 17:return n.next=19,this.host.api.messages.destroy(t);case 19:case"end":return n.stop()}},n,this)}));return t}(),e.prototype.retrySend=function(){function t(t){return e.apply(this,arguments)}var e=(0,R["default"])(C["default"].mark(function n(t){var e,r;return C["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof t||t instanceof Object){n.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(t));case 2:if("string"==typeof t||t instanceof Object){n.next=4;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(t));case 4:if(this.host.requireUser(),e=this._resolveMessage(t)){n.next=8;break}throw new Ot["default"].NotFoundError(this.host.models.Message.name,t);case 8:return e.senderId===this.host.currentUserId&&e.senderStatus===Et.MessageSenderStatus.FAILED||_t["default"].raise("message","invalid","Message to retry must be in a FAILED senderStatus and sent from current user"),n.prev=9,e.senderStatus=Et.MessageSenderStatus.RETRYING,this.host.models.Message.inject(e),n.next=14,this.host.api.messages.send({localId:e.id,counterPartyId:e.counterPartyId,body:e.body,senderOrganizationId:e.senderOrganizationId,recipientOrganizationId:e.recipientOrganizationId,attachment:(0,nt["default"])(e.attachments,"0.localFile"),priority:e.priority,metadata:e.metadata,ttl:e.ttl,deleteOnRead:e.deleteOnRead});case 14:r=n.sent,(0,T["default"])(e,{sortNumber:this.__getNextSortNumber(),serverId:r.serverId,ttl:r.ttl,senderStatus:Et.MessageSenderStatus.SENT,$synced:!0}),this.host.models.Message.inject(e),n.next=23;break;case 19:n.prev=19,n.t0=n["catch"](9),e.senderStatus=Et.MessageSenderStatus.FAILED,this.host.models.Message.inject(e);case 23:case"end":return n.stop()}},n,this,[[9,19]])}));return t}(),e.prototype.forward=function(){function t(t,n,r){return e.apply(this,arguments)}var e=(0,R["default"])(C["default"].mark(function n(t,e){var r,o,s,u,c,f,l,d=this,p=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],y=p.organizationId,h=p.senderOrganizationId,g=void 0===h?y:h,v=p.recipientOrganizationId,m=void 0===v?g:v,b=p.priority,w=p.retrieveMessage,E=void 0!==w&&w,x=(p.preferExistingGroup,p.groupName),_=p.groupMetadata;return C["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof t||t instanceof Object){n.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(t));case 2:if("string"==typeof e||e instanceof Object||Array.isArray(e)&&e.every(function(t){return"string"==typeof t})||Array.isArray(e)&&e.every(function(t){return t instanceof Object})){n.next=4;break}throw new TypeError('Value of argument "entityId" violates contract.\n\nExpected:\nstring | Object | string[] | Object[]\n\nGot:\n'+i(e));case 4:if("string"==typeof t||t instanceof Object){n.next=6;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(t));case 6:if("string"==typeof e||e instanceof Object||Array.isArray(e)&&e.every(function(t){return"string"==typeof t})||Array.isArray(e)&&e.every(function(t){return t instanceof Object})){n.next=8;break}throw new TypeError('Value of argument "entityId" violates contract.\n\nExpected:\nstring | Object | string[] | Object[]\n\nGot:\n'+a(e));case 8:if(this.host.requireUser(),r=this._resolveMessage(t),!Array.isArray(e)){n.next=16;break}return o=e.map(function(t){return d._resolveModelIdWithTypes(t,"user")}),n.next=14,this.__prepareGroupForUsers(y,o,x,{groupMetadata:_});case 14:s=n.sent,e=s.id;case 16:if(r){n.next=18;break}throw new Ot["default"].NotFoundError(this.host.models.Message.name,t);case 18:return n.next=20,this.__resolveCounterPartyEntityAndOrganizationId(e,!0);case 20:return u=n.sent,c=u.counterParty,f=u.organizationId,f&&(g=m=f),c&&(e=c.serverId),_t["default"].notEmpty("entityId",e,"entityId not found"),n.next=28,this.host.api.messages.forward(r.serverId,e,{localId:wt["default"].v4(),senderOrganizationId:g,recipientOrganizationId:m,priority:"undefined"!=typeof b?Et.MessagePriority.toServer(b):void 0});case 28:if(l=n.sent,!E){n.next=31;break}return n.abrupt("return",this.find(l.serverId));case 31:return n.abrupt("return",null);case 32:case"end":return n.stop()}},n,this)}));return t}(),e.prototype.reactToMessageStatusEvent=function(t){if(!(t instanceof Object))throw new TypeError('Value of argument "event" violates contract.\n\nExpected:\nObject\n\nGot:\n'+i(t));if(!(t instanceof Object))throw new TypeError('Value of argument "event" violates contract.\n\nExpected:\nObject\n\nGot:\n'+a(t));var e=t.data.client_id,n=t.data.is_recalled;n?this.onMessageRecalled(e):this.__setMessageStatusPerRecipientFromServerData(e,(0,tt["default"])(t.data,["status","account_id","timestamp"]))&&this.__touchMessage(e)},e.prototype.__setMessageStatusPerRecipientFromServerData=function(t,e){if("string"!=typeof t)throw new TypeError('Value of argument "messageServerId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));if(!(e instanceof Object))throw new TypeError('Value of argument "data" violates contract.\n\nExpected:\nObject\n\nGot:\n'+i(e));if("string"!=typeof t)throw new TypeError('Value of argument "messageServerId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));if(!(e instanceof Object))throw new TypeError('Value of argument "data" violates contract.\n\nExpected:\nObject\n\nGot:\n'+a(e));var n=Et.MessageRecipientStatus.resolve(e.status),r=e.account_id,o=e.timestamp;return this.setRecipientMessageStatus(t,r,n,o)},e.prototype.setRecipientMessageStatus=function(t,e,n,r){if(!("string"==typeof t||t instanceof Object))throw new TypeError('Value of argument "messageServerId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(t));if("string"!=typeof e)throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));if("string"!=typeof n)throw new TypeError('Value of argument "recipientStatus" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(n));if(!(null==r||"string"==typeof r||null==r||r instanceof Date))throw new TypeError('Value of argument "createdAt" violates contract.\n\nExpected:\n?string | ?Date\n\nGot:\n'+i(r));if(!("string"==typeof t||t instanceof Object))throw new TypeError('Value of argument "messageServerId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(t));if("string"!=typeof e)throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));if("string"!=typeof n)throw new TypeError('Value of argument "recipientStatus" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(n));if(!(null==r||"string"==typeof r||null==r||r instanceof Date))throw new TypeError('Value of argument "createdAt" violates contract.\n\nExpected:\n?string | ?Date\n\nGot:\n'+a(r));var o=this._getMessageByServerId(t);if(o){n=Et.MessageRecipientStatus.resolve(n),this._setSingleUserMessageRecipientMessageStatus(o,n);var s=(0,Y["default"])(o.statusesPerRecipient,{userId:e});if(!s||this.__canChangeRecipientStatus(s.status,n)){var u=o.id+":"+e;return this.host.models.MessageStatusPerRecipient.inject({id:u,messageId:o.id,userId:e,status:n,createdAt:r})}}},e.prototype.__touchMessage=function(t){if(!("string"==typeof t||t instanceof Object))throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(t));if(!("string"==typeof t||t instanceof Object))throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(t));var e=this._resolveMessage(t);this.host.models.Message.touch(e)},e.prototype._resolveMessage=function(t){if(!("string"==typeof t||t instanceof Object))throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(t));if(!("string"==typeof t||t instanceof Object))throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(t));return this.host.models.Message.is(t)?t:this.host.models.Message.get(t)||this._getMessageByServerId(t)},e.prototype._getMessageByServerId=function(t){var e;if(!("string"==typeof t||t instanceof Object))throw new TypeError('Value of argument "serverId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(t));if(!("string"==typeof t||t instanceof Object))throw new TypeError('Value of argument "serverId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(t));return this.host.models.Message.is(t)?t:(e=this.host.models.Message.getAll(),zt["default"]).call(e,{serverId:t})},e.prototype._setSingleUserMessageRecipientMessageStatus=function(t,e){if(!(t instanceof Object))throw new TypeError('Value of argument "message" violates contract.\n\nExpected:\nObject\n\nGot:\n'+i(t));if("string"!=typeof e)throw new TypeError('Value of argument "recipientStatus" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));if(!(t instanceof Object))throw new TypeError('Value of argument "message" violates contract.\n\nExpected:\nObject\n\nGot:\n'+a(t));if("string"!=typeof e)throw new TypeError('Value of argument "recipientStatus" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));this.__canChangeRecipientStatus(t.recipientStatus,e)&&this.host.models.Message.inject({id:t.id,recipientStatus:e})},e.prototype.__canChangeRecipientStatus=function(t,e){if("string"!=typeof t)throw new TypeError('Value of argument "fromStatus" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));if("string"!=typeof e)throw new TypeError('Value of argument "toStatus" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));if("string"!=typeof t)throw new TypeError('Value of argument "fromStatus" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));if("string"!=typeof e)throw new TypeError('Value of argument "toStatus" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));return t!==e&&(t!==Et.MessageRecipientStatus.READ||e!=Et.MessageRecipientStatus.DELIVERED)},e.prototype.find=function(){function t(t){return e.apply(this,arguments)}var e=(0,R["default"])(C["default"].mark(function n(t){var e,r,o,s,u;return C["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof t){n.next=2;break}throw new TypeError('Value of argument "serverId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));case 2:if("string"==typeof t){n.next=4;break}throw new TypeError('Value of argument "serverId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));case 4:return this.host.requireUser(),n.next=7,this.httpClient.get("/message/:id",{urlParams:{id:t}});case 7:return e=n.sent,r=e.data,o=e.data.recipient_token,n.next=12,this.__lookupCounterParty(o);case 12:if(s=n.sent,!s){n.next=17;break}r.counterParty=s,n.next=18;break;case 17:return n.abrupt("return",null);case 18:return u=this.host.models.Message.inject(r),n.next=21,this.findStatusesPerRecipient(u);case 21:return n.abrupt("return",u);case 22:case"end":return n.stop()}},n,this)}));return t}(),e.prototype.getById=function(t){if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));return this.host.models.Message.get(t)},e.prototype.getMultiById=function(t){if(!Array.isArray(t)||!t.every(function(t){return"string"==typeof t}))throw new TypeError('Value of argument "ids" violates contract.\n\nExpected:\nArray<string>\n\nGot:\n'+i(t));if(!Array.isArray(t)||!t.every(function(t){return"string"==typeof t}))throw new TypeError('Value of argument "ids" violates contract.\n\nExpected:\nArray<string>\n\nGot:\n'+a(t));return this.host.models.Message.getMulti(t)},e.prototype.__lookupCounterParty=function(){function t(t){return e.apply(this,arguments)}var e=(0,R["default"])(C["default"].mark(function n(t){var e,r,o,s,u,c,f,l,d,p,y,h,g,v,m,b;return C["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof t){n.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));case 2:if("string"==typeof t){n.next=4;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));case 4:if(r=[{model:this.host.models.User,finder:(e=this.host.users).find.bind(e)},{model:this.host.models.Group,finder:(e=this.host.groups).find.bind(e)}],r&&("function"==typeof r[V["default"]]||Array.isArray(r))){n.next=7;break}throw new TypeError("Expected counterPartyTypesAndFinders to be iterable, got "+a(r));case 7:if(r&&("function"==typeof r[V["default"]]||Array.isArray(r))){n.next=9;break}throw new TypeError("Expected counterPartyTypesAndFinders to be iterable, got "+i(r));case 9:o=r,s=Array.isArray(o),u=0,o=s?o:(0,M["default"])(o);case 10:if(!s){n.next=16;break}if(!(u>=o.length)){n.next=13;break}return n.abrupt("break",27);case 13:c=o[u++],n.next=20;break;case 16:if(u=o.next(),!u.done){n.next=19;break}return n.abrupt("break",27);case 19:c=u.value;case 20:if(f=c,l=f.model,d=l.get(t),!d){n.next=25;break}return n.abrupt("return",d);case 25:n.next=10;break;case 27:if(r&&("function"==typeof r[V["default"]]||Array.isArray(r))){n.next=29;break}throw new TypeError("Expected counterPartyTypesAndFinders to be iterable, got "+a(r));case 29:if(r&&("function"==typeof r[V["default"]]||Array.isArray(r))){n.next=31;break}throw new TypeError("Expected counterPartyTypesAndFinders to be iterable, got "+i(r));case 31:p=r,y=Array.isArray(p),h=0,p=y?p:(0,M["default"])(p);case 32:if(!y){n.next=38;break}if(!(h>=p.length)){n.next=35;break}return n.abrupt("break",58);case 35:g=p[h++],n.next=42;break;case 38:if(h=p.next(),!h.done){n.next=41;break}return n.abrupt("break",58);case 41:g=h.value;case 42:return v=g,m=v.finder,n.prev=44,n.next=47,m(t);case 47:if(b=n.sent,!b){n.next=50;break}return n.abrupt("return",b);case 50:n.next=56;break;case 52:if(n.prev=52,n.t0=n["catch"](44),n.t0.code==Ot["default"].NotFoundError.CODE){n.next=56;break}throw n.t0;case 56:n.next=32;break;case 58:return n.abrupt("return",null);case 59:case"end":return n.stop()}},n,this,[[44,52]])}));return t}(),e.prototype.downloadAttachmentUrl=function(t,e){if(!("string"==typeof t||t instanceof Object))throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(t));if("string"!=typeof e&&"number"!=typeof e)throw new TypeError('Value of argument "attachmentId" violates contract.\n\nExpected:\nstring | number\n\nGot:\n'+i(e));if(!("string"==typeof t||t instanceof Object))throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(t));if("string"!=typeof e&&"number"!=typeof e)throw new TypeError('Value of argument "attachmentId" violates contract.\n\nExpected:\nstring | number\n\nGot:\n'+a(e));throw new Error("method not supported in target node")},e.prototype.downloadAttachmentBlobAndURL=function(){function t(t,n){return e.apply(this,arguments)}var e=(0,R["default"])(C["default"].mark(function n(t,e){var r;return C["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof t||t instanceof Object){n.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(t));case 2:if("string"==typeof e||"number"==typeof e){n.next=4;break}throw new TypeError('Value of argument "attachmentId" violates contract.\n\nExpected:\nstring | number\n\nGot:\n'+i(e));case 4:if("string"==typeof t||t instanceof Object){n.next=6;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(t));case 6:if("string"==typeof e||"number"==typeof e){n.next=8;break}throw new TypeError('Value of argument "attachmentId" violates contract.\n\nExpected:\nstring | number\n\nGot:\n'+a(e));case 8:n.next=18;break;case 15:return n.abrupt("return",this.httpClient.downloadFileBlobAndURL("/message/"+r.serverId+"/attachment/"+e));case 18:throw new Error("method not supported in target node");case 19:case"end":return n.stop()}},n,this)}));return t}(),e.prototype.downloadAttachmentToFile=function(){function t(t,n,r){return e.apply(this,arguments)}var e=(0,R["default"])(C["default"].mark(function n(t,e,r){var o;return C["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof t||t instanceof Object){n.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(t));case 2:if("string"==typeof e||"number"==typeof e){n.next=4;break}throw new TypeError('Value of argument "attachmentId" violates contract.\n\nExpected:\nstring | number\n\nGot:\n'+i(e));case 4:if("string"==typeof r){n.next=6;break}throw new TypeError('Value of argument "dest" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(r));case 6:if("string"==typeof t||t instanceof Object){n.next=8;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(t));case 8:if("string"==typeof e||"number"==typeof e){n.next=10;break}throw new TypeError('Value of argument "attachmentId" violates contract.\n\nExpected:\nstring | number\n\nGot:\n'+a(e));case 10:if("string"==typeof r){n.next=12;break}throw new TypeError('Value of argument "dest" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(r));case 12:return o=this._resolveMessage(t),e=e.toString(),n.abrupt("return",this.httpClient.downloadToFile("/message/"+o.serverId+"/attachment/"+e,r));case 18:throw new Error("method not supported in target node");case 19:case"end":return n.stop()}},n,this)}));return t}(),e.prototype.destroy=function(){function t(t){return e.apply(this,arguments)}var e=(0,R["default"])(C["default"].mark(function n(t){return C["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"==typeof t){e.next=2;break}throw new TypeError('Value of argument "serverId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));case 2:if("string"==typeof t){e.next=4;break}throw new TypeError('Value of argument "serverId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));case 4:return this.host.requireUser(),e.next=7,this.httpClient["delete"]("/message/:id",{urlParams:{id:t}});case 7:return e.abrupt("return",null);case 8:case"end":return e.stop()}},n,this)}));return t}(),e.prototype.getMessageCount=function(){return this.host.models.Message.getAll().length},e.prototype.getTotalUnreadCount=function(){return(0,X["default"])(this.host.models.Conversation.getAll(),"unreadCount")},e.prototype.markAsRead=function(){function t(t,n){return e.apply(this,arguments)}var e=(0,R["default"])(C["default"].mark(function n(t){var e,r=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],o=r.queue,s=void 0===o?this.host.currentlyServingOfflineMessages:o;return C["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof t||t instanceof Object||Array.isArray(t)&&t.every(function(t){return"string"==typeof t||t instanceof Object})){n.next=2;break}throw new TypeError('Value of argument "ids" violates contract.\n\nExpected:\nstring | Object | Array<string | Object>\n\nGot:\n'+i(t));case 2:if("string"==typeof t||t instanceof Object||Array.isArray(t)&&t.every(function(t){return"string"==typeof t||t instanceof Object;
})){n.next=4;break}throw new TypeError('Value of argument "ids" violates contract.\n\nExpected:\nstring | Object | Array<string | Object>\n\nGot:\n'+a(t));case 4:if(t=(e=(e=(e=t,qt.arrayWrapBound).call(e),St["default"]).call(e,this._resolveModelId.bind(this)),Nt["default"]).call(e),0!==t.length){n.next=7;break}return n.abrupt("return");case 7:if(!s){n.next=11;break}return n.abrupt("return",this.__queueMessageStatuses({readIds:t}));case 11:return n.abrupt("return",this.__setMessagesStatus({readIds:t}));case 12:case"end":return n.stop()}},n,this)}));return t}(),e.prototype.markAsDelivered=function(){function t(t,n){return e.apply(this,arguments)}var e=(0,R["default"])(C["default"].mark(function n(t){var e,r=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],o=r.queue,s=void 0===o?this.host.currentlyServingOfflineMessages:o;return C["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof t||t instanceof Object||Array.isArray(t)&&t.every(function(t){return"string"==typeof t||t instanceof Object})){n.next=2;break}throw new TypeError('Value of argument "ids" violates contract.\n\nExpected:\nstring | Object | Array<string | Object>\n\nGot:\n'+i(t));case 2:if("string"==typeof t||t instanceof Object||Array.isArray(t)&&t.every(function(t){return"string"==typeof t||t instanceof Object})){n.next=4;break}throw new TypeError('Value of argument "ids" violates contract.\n\nExpected:\nstring | Object | Array<string | Object>\n\nGot:\n'+a(t));case 4:if(t=(e=(e=(e=t,qt.arrayWrapBound).call(e),St["default"]).call(e,this._resolveModelId.bind(this)),Nt["default"]).call(e),0!==t.length){n.next=7;break}return n.abrupt("return");case 7:if(!s){n.next=11;break}return n.abrupt("return",this.__queueMessageStatuses({deliveredIds:t}));case 11:return n.abrupt("return",this.__setMessagesStatus({deliveredIds:t}));case 12:case"end":return n.stop()}},n,this)}));return t}(),e.prototype.markAsReceived=function(){function t(t){return e.apply(this,arguments)}var e=(0,R["default"])(C["default"].mark(function n(){var t=arguments;return C["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.markAsDelivered.apply(this,t));case 1:case"end":return e.stop()}},n,this)}));return t}(),e.prototype.__queueMessageStatuses=function(){function t(t){return e.apply(this,arguments)}var e=(0,R["default"])(C["default"].mark(function n(t){var e,r=t.deliveredIds,o=t.readIds,s=arguments;return C["default"].wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(null!=s[0]&&(null==s[0].deliveredIds||Array.isArray(s[0].deliveredIds)&&s[0].deliveredIds.every(function(t){return"string"==typeof t}))&&(null==s[0].readIds||Array.isArray(s[0].readIds)&&s[0].readIds.every(function(t){return"string"==typeof t}))){t.next=2;break}throw new TypeError("Value of argument 0 violates contract.\n\nExpected:\n{\n  deliveredIds: ?Array<string>;\n  readIds: ?Array<string>;\n}\n\nGot:\n"+i(s[0]));case 2:if(null!=s[0]&&(null==s[0].deliveredIds||Array.isArray(s[0].deliveredIds)&&s[0].deliveredIds.every(function(t){return"string"==typeof t}))&&(null==s[0].readIds||Array.isArray(s[0].readIds)&&s[0].readIds.every(function(t){return"string"==typeof t}))){t.next=4;break}throw new TypeError("Value of argument 0 violates contract.\n\nExpected:\n{\n  deliveredIds: ?Array<string>;\n  readIds: ?Array<string>;\n}\n\nGot:\n"+a(s[0]));case 4:if(r&&(this._queuedMessageStatuses.deliveredIds=(0,W["default"])(this._queuedMessageStatuses.deliveredIds,r)),o&&(this._queuedMessageStatuses.readIds=(0,W["default"])(this._queuedMessageStatuses.readIds,o)),e=this._queuedMessageStatuses.deliveredIds.length+this._queuedMessageStatuses.readIds.length,!(e>=this.config.flushMessageMaxCount)){t.next=12;break}return this.logger.log("reached "+this.config.flushMessageMaxCount+" -- flushing"),t.abrupt("return",this.__flushQueueMessageStatuses());case 12:this._throtelled_flushQueueMessageStatuses();case 13:case"end":return t.stop()}},n,this)}));return t}(),e.prototype.__flushQueueMessageStatuses=function(){var t=this._queuedMessageStatuses.deliveredIds.length+this._queuedMessageStatuses.readIds.length;t>0&&(this.__setMessagesStatus(this._queuedMessageStatuses),this._queuedMessageStatuses.deliveredIds=[],this._queuedMessageStatuses.readIds=[])},e.prototype.__setMessagesStatus=function(){function t(t){return e.apply(this,arguments)}var e=(0,R["default"])(C["default"].mark(function n(t){var e,r,o,a,i=this,s=t.deliveredIds,u=void 0===s?[]:s,c=t.readIds,f=void 0===c?[]:c;return C["default"].wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.host.requireUser(),u=(e=(e=u,St["default"]).call(e,this._resolveModelId.bind(this)),Nt["default"]).call(e),f=(e=(e=f,St["default"]).call(e,this._resolveModelId.bind(this)),Nt["default"]).call(e),r=u.map(this._resolveMessage).filter(Boolean),o=f.map(this._resolveMessage).filter(Boolean),f=(0,K["default"])(f,(e=Ut["default"].call(o,function(t){return t.recipientStatus===Et.MessageRecipientStatus.READ}),St["default"]).call(e,"id")),u=(0,K["default"])(u,f,(e=Ut["default"].call(r,function(t){return t.recipientStatus===Et.MessageRecipientStatus.DELIVERED||t.recipientStatus===Et.MessageRecipientStatus.READ}),St["default"]).call(e,"id")),a={},u.length&&(a.delivered=u),f.length&&(a.read=f,o.forEach(function(t){return i.host.models.Message.inject({id:t.id,recipientStatus:Et.MessageRecipientStatus.READ,recipientStatusMarkingAsRead:!0})})),!(0,ot["default"])(a.delivered)||!(0,ot["default"])(a.read)){t.next=12;break}return t.abrupt("return",!1);case 12:return t.next=14,this.httpClient.post("/message/status",{data:a});case 14:f.length&&(a.read=f,o.forEach(function(t){return i.host.models.Message.inject({id:t.id,recipientStatus:Et.MessageRecipientStatus.READ,recipientStatusMarkingAsRead:!1})}),this.__checkForDeleteOnReadMessages(o)),u.length&&r.forEach(function(t){return i.host.models.Message.inject({id:t.id,recipientStatus:Et.MessageRecipientStatus.DELIVERED})});case 16:case"end":return t.stop()}},n,this)}));return t}(),e.prototype.__checkForDeleteOnReadMessages=function(t){var e=this;if(!Array.isArray(t)||!t.every(function(t){return t instanceof Object}))throw new TypeError('Value of argument "messages" violates contract.\n\nExpected:\nObject[]\n\nGot:\n'+i(t));if(!Array.isArray(t)||!t.every(function(t){return t instanceof Object}))throw new TypeError('Value of argument "messages" violates contract.\n\nExpected:\nObject[]\n\nGot:\n'+a(t));Ut["default"].call(t,{deleteOnRead:!0}).forEach(function(t){return e.setMessageTTLInMinutes(t,1)})},e.prototype.setMessageTTLInMinutes=function(t,e){if(!("string"==typeof t||t instanceof Object))throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(t));if("number"!=typeof e)throw new TypeError('Value of argument "ttl" violates contract.\n\nExpected:\nnumber\n\nGot:\n'+i(e));if(!("string"==typeof t||t instanceof Object))throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(t));if("number"!=typeof e)throw new TypeError('Value of argument "ttl" violates contract.\n\nExpected:\nnumber\n\nGot:\n'+a(e));var n=this._resolveMessage(t);if(n){var r=(0,gt["default"])().add(1,"minute").toDate().getTime();this.host.models.Message.inject({id:n.id,ttl:e,expiresAt:r})}},e.prototype.deleteExpiredMessages=function(){var t=this,e=arguments.length<=0||void 0===arguments[0]?Date.now():arguments[0];e.getTime&&(e=e.getTime()),this.host.models.Message.getAll().filter(function(t){return t.expiresAt&&t.expiresAt<e}).forEach(function(e){return t.host.models.Message.eject(e)})},e.prototype.findStatusesPerRecipient=function(){function t(t){return e.apply(this,arguments)}var e=(0,R["default"])(C["default"].mark(function n(t){var e,r,o,s,u=this;return C["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof t||t instanceof Object){n.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(t));case 2:if("string"==typeof t||t instanceof Object){n.next=4;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(t));case 4:if(this.host.requireUser(),e=this._resolveMessage(t)){n.next=8;break}return n.abrupt("return",null);case 8:return n.next=10,this.httpClient.get("/message/:id/status",{urlParams:{id:e.serverId}});case 10:if(r=n.sent,o=r.data,!o.is_recalled){n.next=15;break}return this.onMessageRecalled(e.serverId),n.abrupt("return");case 15:return s=o.statuses.map(function(t){return u.__setMessageStatusPerRecipientFromServerData(e.serverId,t)}).some(function(t){return t}),s&&this.__touchMessage(e),n.abrupt("return",e.statusesPerRecipient);case 18:case"end":return n.stop()}},n,this)}));return t}(),e}(yt["default"]),o(y.prototype,"__resolveCounterPartyEntityAndOrganizationId",[mt.privateMethod],(0,w["default"])(y.prototype,"__resolveCounterPartyEntityAndOrganizationId"),y.prototype),o(y.prototype,"__resolveRemoteCounterPartyEntity",[mt.privateMethod],(0,w["default"])(y.prototype,"__resolveRemoteCounterPartyEntity"),y.prototype),o(y.prototype,"__sendToKnownCounterParty",[mt.privateMethod],(0,w["default"])(y.prototype,"__sendToKnownCounterParty"),y.prototype),o(y.prototype,"__sendToUnknownCounterParty",[mt.privateMethod],(0,w["default"])(y.prototype,"__sendToUnknownCounterParty"),y.prototype),o(y.prototype,"__normalizeSendOptions",[mt.privateMethod],(0,w["default"])(y.prototype,"__normalizeSendOptions"),y.prototype),o(y.prototype,"__ensureOrganization",[mt.privateMethod],(0,w["default"])(y.prototype,"__ensureOrganization"),y.prototype),o(y.prototype,"__validateAttachments",[mt.privateMethod],(0,w["default"])(y.prototype,"__validateAttachments"),y.prototype),o(y.prototype,"__normalizeMetadata",[mt.privateMethod],(0,w["default"])(y.prototype,"__normalizeMetadata"),y.prototype),o(y.prototype,"__getNextSortNumber",[mt.privateMethod],(0,w["default"])(y.prototype,"__getNextSortNumber"),y.prototype),o(y.prototype,"__setLocalMessageAttachments",[mt.privateMethod],(0,w["default"])(y.prototype,"__setLocalMessageAttachments"),y.prototype),o(y.prototype,"__generateAttachmentDescriptor",[mt.privateMethod],(0,w["default"])(y.prototype,"__generateAttachmentDescriptor"),y.prototype),o(y.prototype,"__loadLocalFilePathWithFileReader",[mt.privateMethod],(0,w["default"])(y.prototype,"__loadLocalFilePathWithFileReader"),y.prototype),o(y.prototype,"__prepareGroupForUsers",[mt.privateMethod,s],(0,w["default"])(y.prototype,"__prepareGroupForUsers"),y.prototype),o(y.prototype,"_deleteLocalMessage",[mt.privateMethod],(0,w["default"])(y.prototype,"_deleteLocalMessage"),y.prototype),o(y.prototype,"__recallSingle",[mt.privateMethod],(0,w["default"])(y.prototype,"__recallSingle"),y.prototype),o(y.prototype,"__setMessageStatusPerRecipientFromServerData",[mt.privateMethod],(0,w["default"])(y.prototype,"__setMessageStatusPerRecipientFromServerData"),y.prototype),o(y.prototype,"__touchMessage",[mt.privateMethod],(0,w["default"])(y.prototype,"__touchMessage"),y.prototype),o(y.prototype,"_resolveMessage",[mt.privateMethod,jt["default"]],(0,w["default"])(y.prototype,"_resolveMessage"),y.prototype),o(y.prototype,"_getMessageByServerId",[mt.privateMethod],(0,w["default"])(y.prototype,"_getMessageByServerId"),y.prototype),o(y.prototype,"_setSingleUserMessageRecipientMessageStatus",[mt.privateMethod],(0,w["default"])(y.prototype,"_setSingleUserMessageRecipientMessageStatus"),y.prototype),o(y.prototype,"__canChangeRecipientStatus",[mt.privateMethod],(0,w["default"])(y.prototype,"__canChangeRecipientStatus"),y.prototype),o(y.prototype,"find",[u],(0,w["default"])(y.prototype,"find"),y.prototype),o(y.prototype,"__lookupCounterParty",[mt.privateMethod],(0,w["default"])(y.prototype,"__lookupCounterParty"),y.prototype),o(y.prototype,"downloadAttachmentUrl",[c],(0,w["default"])(y.prototype,"downloadAttachmentUrl"),y.prototype),o(y.prototype,"downloadAttachmentBlobAndURL",[f],(0,w["default"])(y.prototype,"downloadAttachmentBlobAndURL"),y.prototype),o(y.prototype,"destroy",[l],(0,w["default"])(y.prototype,"destroy"),y.prototype),o(y.prototype,"__queueMessageStatuses",[mt.privateMethod],(0,w["default"])(y.prototype,"__queueMessageStatuses"),y.prototype),o(y.prototype,"__flushQueueMessageStatuses",[mt.privateMethod,jt["default"]],(0,w["default"])(y.prototype,"__flushQueueMessageStatuses"),y.prototype),o(y.prototype,"__setMessagesStatus",[mt.privateMethod],(0,w["default"])(y.prototype,"__setMessagesStatus"),y.prototype),o(y.prototype,"__checkForDeleteOnReadMessages",[mt.privateMethod],(0,w["default"])(y.prototype,"__checkForDeleteOnReadMessages"),y.prototype),o(y.prototype,"deleteExpiredMessages",[jt["default"]],(0,w["default"])(y.prototype,"deleteExpiredMessages"),y.prototype),o(y.prototype,"findStatusesPerRecipient",[d],(0,w["default"])(y.prototype,"findStatusesPerRecipient"),y.prototype),p=y))||p);e["default"]=$t,t.exports=e["default"]},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function o(t,e,n,r,o){var a={};return Object.keys(r).forEach(function(t){a[t]=r[t]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=n.slice().reverse().reduce(function(n,r){return r(t,e,n)||n},a),o&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(o):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(t,e,a),a=null),a}function a(t,e){var n=4,r=15;if(void 0===e&&(e=0),e+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return"undefined"==typeof t?"undefined":(0,g["default"])(t);if(!Array.isArray(t)){var o=(0,V["default"])(t);if(!o.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(e>n)return"{...}";var i="  ".repeat(e-1),s=o.slice(0,r).map(function(n){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(n)?n:(0,y["default"])(n))+": "+a(t[n],e)+";"}).join("\n  "+i);return o.length>=r&&(s+="\n  "+i+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+i+s+"\n"+i+"}":"{\n  "+i+s+"\n"+i+"}"}if(!(t.length>0))return"Array";var u=function(){if(e>n)return{v:"[...]"};var o=a(t[0],e);return t.every(function(t){return a(t,e)===o})?{v:o.trim()+"[]"}:{v:"["+t.slice(0,r).map(function(t){return a(t,e)}).join(", ")+(t.length>=r?", ...":"")+"]"}}();return"object"===("undefined"==typeof u?"undefined":(0,g["default"])(u))?u.v:void 0}function i(t,e){var n=4,r=15;if(void 0===e&&(e=0),e+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return"undefined"==typeof t?"undefined":(0,g["default"])(t);if(!Array.isArray(t)){var o=(0,V["default"])(t);if(!o.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(e>n)return"{...}";var a="  ".repeat(e-1),s=o.slice(0,r).map(function(n){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(n)?n:(0,y["default"])(n))+": "+i(t[n],e)+";"}).join("\n  "+a);return o.length>=r&&(s+="\n  "+a+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+a+s+"\n"+a+"}":"{\n  "+a+s+"\n"+a+"}"}if(!(t.length>0))return"Array";var u=function(){if(e>n)return{v:"[...]"};var o=i(t[0],e);return t.every(function(t){return i(t,e)===o})?{v:o.trim()+"[]"}:{v:"["+t.slice(0,r).map(function(t){return i(t,e)}).join(", ")+(t.length>=r?", ...":"")+"]"}}();return"object"===("undefined"==typeof u?"undefined":(0,g["default"])(u))?u.v:void 0}e.__esModule=!0,e["default"]=void 0;var s,u,c,f,l,d,p=n(5),y=r(p),h=n(8),g=r(h),v=n(9),m=r(v),b=n(38),w=r(b),E=n(39),x=r(E),_=n(128),I=r(_),O=n(17),T=r(O),j=n(16),A=r(j),k=n(7),M=r(k),G=n(4),V=r(G),z=n(6),C=r(z),S=n(1),P=r(S),N=n(3),R=r(N),U=n(2),q=r(U),F=n(143),$=r(F),L=n(144),D=r(L),B=n(168),K=r(B),Z=n(10),W=r(Z),H=n(13),X=r(H),Q=n(14),Y=n(12),J=n(15),tt=(s=(0,Q.decorator)(),u=(0,Q.decorator)(),(0,Y.classWithPrivateMethods)((d=l=function(t){function e(){return(0,P["default"])(this,e),(0,R["default"])(this,t.apply(this,arguments))}return(0,q["default"])(e,t),e.prototype.fullUpdate=function(){function t(t,n,r){return e.apply(this,arguments)}var e=(0,C["default"])(M["default"].mark(function n(t,e,r){return M["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof t||t instanceof Object){n.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(t));case 2:if(e instanceof Object){n.next=4;break}throw new TypeError('Value of argument "entireData" violates contract.\n\nExpected:\nObject\n\nGot:\n'+i(e));case 4:if("string"==typeof r){n.next=6;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(r));case 6:if("string"==typeof t||t instanceof Object){n.next=8;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(t));case 8:if(e instanceof Object){n.next=10;break}throw new TypeError('Value of argument "entireData" violates contract.\n\nExpected:\nObject\n\nGot:\n'+a(e));case 10:if("string"==typeof r){n.next=12;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(r));case 12:if(r){n.next=14;break}throw new X["default"].ValidationError("organizationId","required");case 14:if(!(this.host.config.maxMetadataKeyCount>0&&(0,V["default"])(e).length>this.host.config.maxMetadataKeyCount)){n.next=16;break}throw new X["default"].ValidationError("entireData","invalid","Total number of metadata keys is "+(0,V["default"])(e)+" and should not exceed "+this.host.config.maxMetadataKeyCount);case 16:return this.host.requireUser(),t=this._resolveModelId(t),n.prev=18,n.next=21,this.host.api.metadata.update(t,e,r);case 21:return this.__injectMetadata(t,r,e),n.abrupt("return",e);case 25:if(n.prev=25,n.t0=n["catch"](18),!n.t0.response||404!=n.t0.response.status){n.next=31;break}throw new X["default"].NotFoundError("metadata",t);case 31:throw n.t0;case 32:case"end":return n.stop()}},n,this,[[18,25]])}));return t}(),e.prototype.update=function(){function t(t,n,r){return e.apply(this,arguments)}var e=(0,C["default"])(M["default"].mark(function n(t,e,r){var o,s;return M["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof t||t instanceof Object){n.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(t));case 2:if(e instanceof Object){n.next=4;break}throw new TypeError('Value of argument "partialData" violates contract.\n\nExpected:\nObject\n\nGot:\n'+i(e));case 4:if("string"==typeof r){n.next=6;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(r));case 6:if("string"==typeof t||t instanceof Object){n.next=8;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(t));case 8:if(e instanceof Object){n.next=10;break}throw new TypeError('Value of argument "partialData" violates contract.\n\nExpected:\nObject\n\nGot:\n'+a(e));case 10:if("string"==typeof r){n.next=12;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(r));case 12:if(r){n.next=14;break}throw new X["default"].ValidationError("organizationId","required");case 14:return n.next=16,this.find(t,r);case 16:return o=n.sent,s=(0,A["default"])({},o,e),n.abrupt("return",this.fullUpdate(t,s,r));case 19:case"end":return n.stop()}},n,this)}));return t}(),e.prototype.find=function(){function t(t,n){return e.apply(this,arguments)}var e=(0,C["default"])(M["default"].mark(function n(t,e){var r;return M["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof t||t instanceof Object){n.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(t));case 2:if("string"==typeof e){n.next=4;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));case 4:if("string"==typeof t||t instanceof Object){n.next=6;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(t));case 6:if("string"==typeof e){n.next=8;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));case 8:if(e){n.next=10;break}throw new X["default"].ValidationError("organizationId","required");case 10:return this.host.requireUser(),t=this._resolveModelId(t),n.prev=12,n.next=15,this.host.api.metadata.find(t,e);case 15:return r=n.sent,this.__injectMetadata(t,e,r),n.abrupt("return",r);case 20:if(n.prev=20,n.t0=n["catch"](12),!n.t0.response||404!=n.t0.response.status){n.next=26;break}throw new X["default"].NotFoundError("metadata",t);case 26:throw n.t0;case 27:case"end":return n.stop()}},n,this,[[12,20]])}));return t}(),e.prototype.findMulti=function(){function t(t,n){return e.apply(this,arguments)}var e=(0,C["default"])(M["default"].mark(function n(t,e){var r,o,s,u,c=this;return M["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(Array.isArray(t)&&t.every(function(t){return"string"==typeof t||t instanceof Object})){n.next=2;break}throw new TypeError('Value of argument "ids" violates contract.\n\nExpected:\nArray<string | Object>\n\nGot:\n'+i(t));case 2:if("string"==typeof e){n.next=4;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));case 4:if(Array.isArray(t)&&t.every(function(t){return"string"==typeof t||t instanceof Object})){n.next=6;break}throw new TypeError('Value of argument "ids" violates contract.\n\nExpected:\nArray<string | Object>\n\nGot:\n'+a(t));case 6:if("string"==typeof e){n.next=8;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));case 8:if(e){n.next=10;break}throw new X["default"].ValidationError("organizationId","required");case 10:return this.host.requireUser(),t=(0,K["default"])((0,J.arrayWrap)(t).map(this._resolveModelId.bind(this))),r=(0,D["default"])(t,20),o=r.map(function(t){return c.__findMultiPaged(t,e)}),n.next=16,T["default"].all(o);case 16:return s=n.sent,u=$["default"].apply(void 0,[{}].concat(s)),n.abrupt("return",u);case 19:case"end":return n.stop()}},n,this)}));return t}(),e.prototype.__findMultiPaged=function(){function t(t,n){return e.apply(this,arguments)}var e=(0,C["default"])(M["default"].mark(function n(t,e){var r,o,s,u,c,f,l,d,p,y,h,g,v,m;return M["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(Array.isArray(t)&&t.every(function(t){return"string"==typeof t})){n.next=2;break}throw new TypeError('Value of argument "ids" violates contract.\n\nExpected:\nstring[]\n\nGot:\n'+i(t));case 2:if("string"==typeof e){n.next=4;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));case 4:if(Array.isArray(t)&&t.every(function(t){return"string"==typeof t})){n.next=6;break}throw new TypeError('Value of argument "ids" violates contract.\n\nExpected:\nstring[]\n\nGot:\n'+a(t));case 6:if("string"==typeof e){n.next=8;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));case 8:return n.prev=8,n.next=11,this.host.api.metadata.findMulti(t,e);case 11:if(r=n.sent,c=(0,I["default"])(r),c&&("function"==typeof c[x["default"]]||Array.isArray(c))){n.next=15;break}throw new TypeError("Expected _Object$entries to be iterable, got "+a(c));case 15:if(c&&("function"==typeof c[x["default"]]||Array.isArray(c))){n.next=17;break}throw new TypeError("Expected _Object$entries to be iterable, got "+i(c));case 17:o=c,s=Array.isArray(o),u=0,o=s?o:(0,w["default"])(o);case 18:if(!s){n.next=24;break}if(!(u>=o.length)){n.next=21;break}return n.abrupt("break",34);case 21:f=o[u++],n.next=28;break;case 24:if(u=o.next(),!u.done){n.next=27;break}return n.abrupt("break",34);case 27:f=u.value;case 28:l=f,d=l[0],p=l[1],p&&this.__injectMetadata(d,e,p);case 32:n.next=18;break;case 34:return n.abrupt("return",r);case 37:if(n.prev=37,n.t0=n["catch"](8),!n.t0.response||404!=n.t0.response.status){n.next=72;break}if(y={},t&&("function"==typeof t[x["default"]]||Array.isArray(t))){n.next=43;break}throw new TypeError("Expected ids to be iterable, got "+a(t));case 43:if(t&&("function"==typeof t[x["default"]]||Array.isArray(t))){n.next=45;break}throw new TypeError("Expected ids to be iterable, got "+i(t));case 45:h=t,g=Array.isArray(h),v=0,h=g?h:(0,w["default"])(h);case 46:if(!g){n.next=52;break}if(!(v>=h.length)){n.next=49;break}return n.abrupt("break",69);case 49:m=h[v++],n.next=56;break;case 52:if(v=h.next(),!v.done){n.next=55;break}return n.abrupt("break",69);case 55:m=v.value;case 56:return d=m,n.prev=57,n.next=60,this.find(d,e);case 60:y[d]=n.sent,n.next=67;break;case 63:if(n.prev=63,n.t1=n["catch"](57),n.t1.code==X["default"].NotFoundError.CODE){n.next=67;break}throw n.t1;case 67:n.next=46;break;case 69:return n.abrupt("return",y);case 72:throw n.t0;case 73:case"end":return n.stop()}},n,this,[[8,37],[57,63]])}));return t}(),e.prototype.__injectMetadata=function(t,e,n){if("string"!=typeof t)throw new TypeError('Value of argument "entityId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));if("string"!=typeof e)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));if(!(n instanceof Object))throw new TypeError('Value of argument "data" violates contract.\n\nExpected:\nObject\n\nGot:\n'+i(n));if("string"!=typeof t)throw new TypeError('Value of argument "entityId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));if("string"!=typeof e)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));if(!(n instanceof Object))throw new TypeError('Value of argument "data" violates contract.\n\nExpected:\nObject\n\nGot:\n'+a(n));var r=t+":"+e;this.host.models.Metadata.inject({id:r,data:n,entityId:t,organizationId:e})},e}(W["default"]),l.METADTA_TYPES=["user","group"],f=d,o(f.prototype,"find",[s],(0,m["default"])(f.prototype,"find"),f.prototype),o(f.prototype,"findMulti",[u],(0,m["default"])(f.prototype,"findMulti"),f.prototype),o(f.prototype,"__findMultiPaged",[Y.privateMethod],(0,m["default"])(f.prototype,"__findMultiPaged"),f.prototype),o(f.prototype,"__injectMetadata",[Y.privateMethod],(0,m["default"])(f.prototype,"__injectMetadata"),f.prototype),c=f))||c);e["default"]=tt,t.exports=e["default"]},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function o(t,e,n,r,o){var a={};return Object.keys(r).forEach(function(t){a[t]=r[t]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=n.slice().reverse().reduce(function(n,r){return r(t,e,n)||n},a),o&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(o):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(t,e,a),a=null),a}function a(t,e){var n=4,r=15;if(void 0===e&&(e=0),e+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return"undefined"==typeof t?"undefined":(0,p["default"])(t);if(!Array.isArray(t)){var o=(0,j["default"])(t);if(!o.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(e>n)return"{...}";var i="  ".repeat(e-1),s=o.slice(0,r).map(function(n){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(n)?n:(0,l["default"])(n))+": "+a(t[n],e)+";"}).join("\n  "+i);return o.length>=r&&(s+="\n  "+i+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+i+s+"\n"+i+"}":"{\n  "+i+s+"\n"+i+"}"}if(!(t.length>0))return"Array";var u=function(){if(e>n)return{v:"[...]"};var o=a(t[0],e);return t.every(function(t){return a(t,e)===o})?{v:o.trim()+"[]"}:{v:"["+t.slice(0,r).map(function(t){return a(t,e)}).join(", ")+(t.length>=r?", ...":"")+"]"}}();return"object"===("undefined"==typeof u?"undefined":(0,p["default"])(u))?u.v:void 0}function i(t,e){var n=4,r=15;if(void 0===e&&(e=0),e+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return"undefined"==typeof t?"undefined":(0,p["default"])(t);if(!Array.isArray(t)){var o=(0,j["default"])(t);if(!o.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(e>n)return"{...}";var a="  ".repeat(e-1),s=o.slice(0,r).map(function(n){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(n)?n:(0,l["default"])(n))+": "+i(t[n],e)+";"}).join("\n  "+a);return o.length>=r&&(s+="\n  "+a+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+a+s+"\n"+a+"}":"{\n  "+a+s+"\n"+a+"}"}if(!(t.length>0))return"Array";var u=function(){if(e>n)return{v:"[...]"};var o=i(t[0],e);return t.every(function(t){return i(t,e)===o})?{v:o.trim()+"[]"}:{v:"["+t.slice(0,r).map(function(t){return i(t,e)}).join(", ")+(t.length>=r?", ...":"")+"]"}}();return"object"===("undefined"==typeof u?"undefined":(0,p["default"])(u))?u.v:void 0}e.__esModule=!0,e["default"]=void 0;var s,u,c,f=n(5),l=r(f),d=n(8),p=r(d),y=n(9),h=r(y),g=n(7),v=r(g),m=n(6),b=r(m),w=n(1),E=r(w),x=n(3),_=r(x),I=n(2),O=r(I),T=n(4),j=r(T),A=n(130),k=r(A),M=n(30),G=r(M),V=n(10),z=r(V),C=n(141),S=r(C),P=n(12),N=n(14),R=n(25),U=r(R),q=n(21),F=r(q),$=n(47),L=r($),D={account:"user",group:"group"},B=new k["default"]((0,j["default"])(D)),K=(0,G["default"])(D).concat(["conversation"]),Z=525600,W=(s=(0,N.decorator)(),(0,P.classWithPrivateMethods)((c=function(t){function e(){return(0,E["default"])(this,e),(0,_["default"])(this,t.apply(this,arguments))}return(0,O["default"])(e,t),e.prototype.mounted=function(){this._muteEntriesByConversationId={},this._fetched=!1},e.prototype.dispose=function(){this._muteEntriesByConversationId=null,this._fetched=!1},e.prototype.findAll=function(){function t(){return e.apply(this,arguments)}var e=(0,b["default"])(v["default"].mark(function n(){var t,e;return v["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(this._fetched){n.next=6;break}return n.next=3,this.host.api.mute.findAll();case 3:e=n.sent,(t=e.filter(function(t){return B.has(t.sender_type)}).map(this._parseMuteEntry),S["default"]).call(t,this._isExpired).forEach(this._addEntry),this._fetched=!0;case 6:return n.abrupt("return",(0,G["default"])(this._muteEntriesByConversationId));case 7:case"end":return n.stop()}},n,this)}));return t}(),e.prototype._parseMuteEntry=function(t){var e=+t.mute_duration,n=new Date(1e3*+t.mute_start).getTime(),r=(0,L["default"])(n).add(e,"minute").toDate().getTime(),o=D[t.sender_type],a=t.caller_organization||t.organization_id,i=t.sender_token,s=this.host.conversations.getConversationKey(o,i,a);return{conversationId:s,durationInMinutes:e,startedAt:n,expiresAt:r,organizationId:a,entityId:i,entityType:o}},e.prototype._isExpired=function(t){if(!(t instanceof Object))throw new TypeError('Value of argument "entry" violates contract.\n\nExpected:\nObject\n\nGot:\n'+i(t));if(!(t instanceof Object))throw new TypeError('Value of argument "entry" violates contract.\n\nExpected:\nObject\n\nGot:\n'+a(t));return t.expiresAt<Date.now()},e.prototype._addEntry=function(t){var e=t.conversationId,n=t.entityType,r=t.entityId,o=t.organizationId,a=t.durationInMinutes,i=t.startedAt;e=e||this.host.conversations.getConversationKey(n,r,o),i=i||Date.now();var s=(0,L["default"])(i).add(a,"minute").toDate().getTime(),u={conversationId:e,durationInMinutes:a,startedAt:i,expiresAt:s,organizationId:o,entityId:r,entityType:n};return this.host.models.Conversation.touch(e),this._muteEntriesByConversationId[e]=u,u},e.prototype._removeEntry=function(t){
var e=t.conversationId,n=t.entityType,r=t.entityId,o=t.organizationId;e=e||this.host.conversations.getConversationKey(n,r,o),delete this._muteEntriesByConversationId[e],this.host.models.Conversation.touch(e)},e.prototype._removeAllEntries=function(){var t=this;(0,G["default"])(this._muteEntriesByConversationId).forEach(function(e){return t._removeEntry(e)})},e.prototype.getByConversationId=function(t){if("string"!=typeof t)throw new TypeError('Value of argument "conversationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));if("string"!=typeof t)throw new TypeError('Value of argument "conversationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));var e=this._muteEntriesByConversationId[t];return e?this._isExpired(e)?(delete this._muteEntriesByConversationId[t],null):e:null},e.prototype.unmuteAll=function(){function t(){return e.apply(this,arguments)}var e=(0,b["default"])(v["default"].mark(function n(){return v["default"].wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.host.api.mute.unmuteAll();case 2:this._removeAllEntries();case 3:case"end":return t.stop()}},n,this)}));return t}(),e.prototype.mute=function(){function t(t,n,r){return e.apply(this,arguments)}var e=(0,b["default"])(v["default"].mark(function n(t,e,r){var o;return v["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof t||t instanceof Object){n.next=2;break}throw new TypeError('Value of argument "entityId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(t));case 2:if("number"==typeof e){n.next=4;break}throw new TypeError('Value of argument "durationInMinutes" violates contract.\n\nExpected:\nnumber\n\nGot:\n'+i(e));case 4:if(null==r||"string"==typeof r){n.next=6;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\n?string\n\nGot:\n'+i(r));case 6:if("string"==typeof t||t instanceof Object){n.next=8;break}throw new TypeError('Value of argument "entityId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(t));case 8:if("number"==typeof e){n.next=10;break}throw new TypeError('Value of argument "durationInMinutes" violates contract.\n\nExpected:\nnumber\n\nGot:\n'+a(e));case 10:if(null==r||"string"==typeof r){n.next=12;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\n?string\n\nGot:\n'+a(r));case 12:if(o=this._resolveEntity(t,K)){n.next=15;break}throw new Error("entity "+t+" not found");case 15:n.t0=o.$entityType,n.next="conversation"===n.t0?18:"user"===n.t0?19:"group"===n.t0?21:"organization"===n.t0?22:23;break;case 18:return n.abrupt("return",this.mute(o.counterParty,e,o.organizationId));case 19:return U["default"].notEmpty("organizationId",r),n.abrupt("return",this.muteUser(o,e,r));case 21:return n.abrupt("return",this.muteGroup(o,e));case 22:return n.abrupt("return",this.muteOrganization(o,e));case 23:case"end":return n.stop()}},n,this)}));return t}(),e.prototype.unmute=function(){function t(t,n){return e.apply(this,arguments)}var e=(0,b["default"])(v["default"].mark(function n(t,e){var r;return v["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof t||t instanceof Object){n.next=2;break}throw new TypeError('Value of argument "entityId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(t));case 2:if(null==e||"string"==typeof e){n.next=4;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\n?string\n\nGot:\n'+i(e));case 4:if("string"==typeof t||t instanceof Object){n.next=6;break}throw new TypeError('Value of argument "entityId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(t));case 6:if(null==e||"string"==typeof e){n.next=8;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\n?string\n\nGot:\n'+a(e));case 8:if(r=this._resolveEntity(t,K)){n.next=11;break}throw new Error("entity "+t+" not found");case 11:n.t0=r.$entityType,n.next="conversation"===n.t0?14:"user"===n.t0?15:"group"===n.t0?17:"organization"===n.t0?18:19;break;case 14:return n.abrupt("return",this.unmute(r.counterParty,r.organizationId));case 15:return U["default"].notEmpty("organizationId",e),n.abrupt("return",this.unmuteUser(r,e));case 17:return n.abrupt("return",this.unmuteGroup(r));case 18:return n.abrupt("return",this.unmuteOrganization(r));case 19:case"end":return n.stop()}},n,this)}));return t}(),e.prototype.muteUser=function(){function t(t,n,r){return e.apply(this,arguments)}var e=(0,b["default"])(v["default"].mark(function n(t,e,r){return v["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof t||t instanceof Object){n.next=2;break}throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(t));case 2:if("number"==typeof e){n.next=4;break}throw new TypeError('Value of argument "durationInMinutes" violates contract.\n\nExpected:\nnumber\n\nGot:\n'+i(e));case 4:if("string"==typeof r||r instanceof Object){n.next=6;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(r));case 6:if("string"==typeof t||t instanceof Object){n.next=8;break}throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(t));case 8:if("number"==typeof e){n.next=10;break}throw new TypeError('Value of argument "durationInMinutes" violates contract.\n\nExpected:\nnumber\n\nGot:\n'+a(e));case 10:if("string"==typeof r||r instanceof Object){n.next=12;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(r));case 12:return this.__validateDurationInMinutes(e),t=this._resolveModelIdWithTypes(t,"user"),r=this._resolveModelId(r),n.next=17,this.host.api.mute.muteUser(t,e,r,{recipientOrganizationId:r});case 17:this._addEntry({entityType:"user",entityId:t,organizationId:r,durationInMinutes:e});case 18:case"end":return n.stop()}},n,this)}));return t}(),e.prototype.unmuteUser=function(){function t(t,n){return e.apply(this,arguments)}var e=(0,b["default"])(v["default"].mark(function n(t,e){return v["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof t||t instanceof Object){n.next=2;break}throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(t));case 2:if("string"==typeof e||e instanceof Object){n.next=4;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(e));case 4:if("string"==typeof t||t instanceof Object){n.next=6;break}throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(t));case 6:if("string"==typeof e||e instanceof Object){n.next=8;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(e));case 8:return t=this._resolveModelIdWithTypes(t,"user"),e=this._resolveModelId(e),n.next=12,this.host.api.mute.unmuteUser(t,e,{recipientOrganizationId:e});case 12:this._removeEntry({entityType:"user",entityId:t,organizationId:e});case 13:case"end":return n.stop()}},n,this)}));return t}(),e.prototype.muteGroup=function(){function t(t,n,r){return e.apply(this,arguments)}var e=(0,b["default"])(v["default"].mark(function n(t,e,r){var o;return v["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof t||t instanceof Object){n.next=2;break}throw new TypeError('Value of argument "groupId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(t));case 2:if("number"==typeof e){n.next=4;break}throw new TypeError('Value of argument "durationInMinutes" violates contract.\n\nExpected:\nnumber\n\nGot:\n'+i(e));case 4:if(null==r||"string"==typeof r||null==r||r instanceof Object){n.next=6;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\n?string | ?Object\n\nGot:\n'+i(r));case 6:if("string"==typeof t||t instanceof Object){n.next=8;break}throw new TypeError('Value of argument "groupId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(t));case 8:if("number"==typeof e){n.next=10;break}throw new TypeError('Value of argument "durationInMinutes" violates contract.\n\nExpected:\nnumber\n\nGot:\n'+a(e));case 10:if(null==r||"string"==typeof r||null==r||r instanceof Object){n.next=12;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\n?string | ?Object\n\nGot:\n'+a(r));case 12:return this.__validateDurationInMinutes(e),o=this._resolveEntity(t,"group"),o?(t=o.id,r=o.organizationId):r=this._resolveModelId(r),U["default"].notEmpty("organizationId",r),n.next=18,this.host.api.mute.muteGroup(t,e,r);case 18:this._addEntry({entityType:"group",entityId:t,organizationId:r,durationInMinutes:e});case 19:case"end":return n.stop()}},n,this)}));return t}(),e.prototype.unmuteGroup=function(){function t(t,n){return e.apply(this,arguments)}var e=(0,b["default"])(v["default"].mark(function n(t,e){var r;return v["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof t||t instanceof Object){n.next=2;break}throw new TypeError('Value of argument "groupId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(t));case 2:if(null==e||"string"==typeof e||null==e||e instanceof Object){n.next=4;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\n?string | ?Object\n\nGot:\n'+i(e));case 4:if("string"==typeof t||t instanceof Object){n.next=6;break}throw new TypeError('Value of argument "groupId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(t));case 6:if(null==e||"string"==typeof e||null==e||e instanceof Object){n.next=8;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\n?string | ?Object\n\nGot:\n'+a(e));case 8:return r=this._resolveEntity(t,"group"),r?(t=r.id,e=r.organizationId):(U["default"].notEmpty("organizationId",e),e=this._resolveModelId(e)),n.next=12,this.host.api.mute.unmuteGroup(t,e);case 12:this._removeEntry({entityType:"group",entityId:t,organizationId:e});case 13:case"end":return n.stop()}},n,this)}));return t}(),e.prototype.reactToMuteEvent=function(t){if(t.data.token==this.host.currentUser.id){var e=t.data.action;if("clear"===e)return void this._removeAllEntries();var n=this._parseMuteEntry(t.data);switch(e){case"add":this._muteEntriesByConversationId[n.conversationId]=n;break;case"del":delete this._muteEntriesByConversationId[n.conversationId]}}},e.prototype.__validateDurationInMinutes=function(t){if("number"!=typeof t)throw new TypeError('Value of argument "durationInMinutes" violates contract.\n\nExpected:\nnumber\n\nGot:\n'+i(t));if("number"!=typeof t)throw new TypeError('Value of argument "durationInMinutes" violates contract.\n\nExpected:\nnumber\n\nGot:\n'+a(t));(t<0||t>Z||t%1!==0)&&U["default"].raise("durationInMinutes","invalid","should be a positive integer from 1 to "+Z+" (1 year)")},e}(z["default"]),o(c.prototype,"findAll",[s],(0,h["default"])(c.prototype,"findAll"),c.prototype),o(c.prototype,"_parseMuteEntry",[P.privateMethod,F["default"]],(0,h["default"])(c.prototype,"_parseMuteEntry"),c.prototype),o(c.prototype,"_addEntry",[P.privateMethod,F["default"]],(0,h["default"])(c.prototype,"_addEntry"),c.prototype),o(c.prototype,"_removeEntry",[P.privateMethod,F["default"]],(0,h["default"])(c.prototype,"_removeEntry"),c.prototype),o(c.prototype,"_removeAllEntries",[P.privateMethod],(0,h["default"])(c.prototype,"_removeAllEntries"),c.prototype),o(c.prototype,"__validateDurationInMinutes",[P.privateMethod],(0,h["default"])(c.prototype,"__validateDurationInMinutes"),c.prototype),u=c))||u);e["default"]=W,t.exports=e["default"]},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function o(t,e,n,r,o){var a={};return Object.keys(r).forEach(function(t){a[t]=r[t]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=n.slice().reverse().reduce(function(n,r){return r(t,e,n)||n},a),o&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(o):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(t,e,a),a=null),a}function a(t,e){var n=4,r=15;if(void 0===e&&(e=0),e+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return"undefined"==typeof t?"undefined":(0,g["default"])(t);if(!Array.isArray(t)){var o=(0,y["default"])(t);if(!o.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(e>n)return"{...}";var i="  ".repeat(e-1),s=o.slice(0,r).map(function(n){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(n)?n:(0,d["default"])(n))+": "+a(t[n],e)+";"}).join("\n  "+i);return o.length>=r&&(s+="\n  "+i+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+i+s+"\n"+i+"}":"{\n  "+i+s+"\n"+i+"}"}if(!(t.length>0))return"Array";var u=function(){if(e>n)return{v:"[...]"};var o=a(t[0],e);return t.every(function(t){return a(t,e)===o})?{v:o.trim()+"[]"}:{v:"["+t.slice(0,r).map(function(t){return a(t,e)}).join(", ")+(t.length>=r?", ...":"")+"]"}}();return"object"===("undefined"==typeof u?"undefined":(0,g["default"])(u))?u.v:void 0}function i(t,e){var n=4,r=15;if(void 0===e&&(e=0),e+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return"undefined"==typeof t?"undefined":(0,g["default"])(t);if(!Array.isArray(t)){var o=(0,y["default"])(t);if(!o.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(e>n)return"{...}";var a="  ".repeat(e-1),s=o.slice(0,r).map(function(n){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(n)?n:(0,d["default"])(n))+": "+i(t[n],e)+";"}).join("\n  "+a);return o.length>=r&&(s+="\n  "+a+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+a+s+"\n"+a+"}":"{\n  "+a+s+"\n"+a+"}"}if(!(t.length>0))return"Array";var u=function(){if(e>n)return{v:"[...]"};var o=i(t[0],e);return t.every(function(t){return i(t,e)===o})?{v:o.trim()+"[]"}:{v:"["+t.slice(0,r).map(function(t){return i(t,e)}).join(", ")+(t.length>=r?", ...":"")+"]"}}();return"object"===("undefined"==typeof u?"undefined":(0,g["default"])(u))?u.v:void 0}e.__esModule=!0,e["default"]=void 0;var s,u,c,f,l=n(5),d=r(l),p=n(4),y=r(p),h=n(8),g=r(h),v=n(9),m=r(v),b=n(11),w=r(b),E=n(7),x=r(E),_=n(6),I=r(_),O=n(1),T=r(O),j=n(3),A=r(j),k=n(2),M=r(k),G=n(22),V=r(G),z=n(67),C=r(z),S=n(29),P=r(S),N=n(18),R=r(N),U=n(166),q=r(U),F=n(44),$=r(F),L=n(10),D=r(L),B=n(14),K=n(13),Z=r(K),W=n(28),H=r(W),X=n(42),Q=r(X),Y=n(32),J=r(Y),tt=n(70),et=r(tt),nt=n(21),rt=r(nt),ot=n(12),at=(s=(0,B.decorator)({memoize:!0}),u=(0,B.decorator)(),(0,ot.classWithPrivateMethods)((f=function(t){function e(){return(0,T["default"])(this,e),(0,A["default"])(this,t.apply(this,arguments))}return(0,M["default"])(e,t),e.prototype.mounted=function(){this.host.models.Conversation.on("afterInject",this._onConversationChange),this.host.models.Conversation.on("afterEject",this._onConversationChange)},e.prototype.dispose=function(){this.host.models.Conversation.off("afterInject",this._onConversationChange),this.host.models.Conversation.off("afterEject",this._onConversationChange),B.decorator.clear(this.findAll)},e.prototype.create=function(){function t(t){return e.apply(this,arguments)}var e=(0,I["default"])(x["default"].mark(function n(){var t=this,e=arguments.length<=0||void 0===arguments[0]?{name:void 0,ttl:void 0,deleteOnRead:void 0,allowPublicGroups:void 0,pinLock:void 0,settingsRestricted:void 0,autologoutTime:void 0,lifecycleCallback:void 0,groupLifespan:void 0,welcomeEmailSettings:void 0}:arguments[0];return x["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return this.host.requireUser(),n.abrupt("return",this.httpClient.post("/organization",{data:e}).then(function(n){var r=n.getHeader("TT-X-Organization-Key"),o=t.host.models.Organization.inject({id:r,name:e.name});return o}));case 2:case"end":return n.stop()}},n,this)}));return t}(),e.prototype.update=function(){function t(t){return e.apply(this,arguments)}var e=(0,I["default"])(x["default"].mark(function n(){var t,e=this,r=arguments.length<=0||void 0===arguments[0]?{id:void 0,name:void 0,ttl:void 0,deleteOnRead:void 0,allowPublicGroups:void 0,pinLock:void 0,settingsRestricted:void 0,autologoutTime:void 0,lifecycleCallback:void 0,groupLifespan:void 0,welcomeEmailSettings:void 0,welcomeEmailLogo:void 0,autoSendWelcomeEmail:void 0}:arguments[0];return x["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return this.host.requireUser(),t=J["default"].underscoreObject({name:r.name,ttl:r.ttl,deleteOnRead:r.deleteOnRead,allowPublicGroups:r.allowPublicGroups,pinLock:r.pinLock,settingsRestricted:r.settingsRestricted,autologoutTime:r.autologoutTime,lifecycleCallback:r.lifecycleCallback,groupLifespan:r.groupLifespan,welcomeEmailSettings:r.welcomeEmailSettings,welcomeEmailLogo:r.welcomeEmailLogo,autoSendWelcomeEmail:r.autoSendWelcomeEmail}),n.abrupt("return",this.httpClient.post("/organization/:id",{urlParams:{id:r.id},data:t}).then(function(n){var o=e.host.models.Organization.inject((0,w["default"])({id:r.id},t));return o}));case 3:case"end":return n.stop()}},n,this)}));return t}(),e.prototype.findAll=function(){function t(t){return e.apply(this,arguments)}var e=(0,I["default"])(x["default"].mark(function n(){var t,e=this,r=arguments.length<=0||void 0===arguments[0]?{onlyApproved:!1}:arguments[0];return x["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return this.host.requireUser(),n.next=3,this._findAll();case 3:return t=n.sent,r.onlyApproved&&(t=(0,$["default"])(t,{pending:!1})),t=(0,q["default"])(t,function(t){return t.name.toLowerCase()}),t.forEach(function(t){return e.__reloadConversations(t)}),n.abrupt("return",t);case 8:case"end":return n.stop()}},n,this)}));return t}(),e.prototype.refreshAll=function(){function t(){return e.apply(this,arguments)}var e=(0,I["default"])(x["default"].mark(function n(){return x["default"].wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._findAll();case 2:case"end":return t.stop()}},n,this)}));return t}(),e.prototype._findAll=function(){function t(){return e.apply(this,arguments)}var e=(0,I["default"])(x["default"].mark(function n(){var t,e=this;return x["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.host.api.organizations.findAllOfUser(this.host.currentUserId);case 2:return t=n.sent,t=t.map(function(t){return e.host.models.Organization.inject(t)}),n.abrupt("return",t);case 5:case"end":return n.stop()}},n,this)}));return t}(),e.prototype.find=function(){function t(t,n){return e.apply(this,arguments)}var e=(0,I["default"])(x["default"].mark(function n(t){var e,r,o=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return x["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof t){n.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));case 2:if("string"==typeof t){n.next=4;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));case 4:if(o=(0,R["default"])(o,{ignoreNotFound:!1,bypassCache:!1}),this.host.requireUser(),e=void 0,o.bypassCache){n.next=11;break}if(e=this.host.models.Organization.get(t),!e||e.$placeholder){n.next=11;break}return n.abrupt("return",e);case 11:return n.next=13,this.host.api.organizations.find(this.host.currentUserId,t);case 13:if(r=n.sent,!r){n.next=19;break}e=this.host.models.Organization.inject(r),this.__reloadConversations(e),n.next=21;break;case 19:if(o.ignoreNotFound){n.next=21;break}throw new Z["default"].NotFoundError(this.host.models.Organization.name,t);case 21:return n.abrupt("return",e);case 22:case"end":return n.stop()}},n,this)}));return t}(),e.prototype.getSettingValue=function(t,e){if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));if("string"!=typeof e)throw new TypeError('Value of argument "key" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));if("string"!=typeof e)throw new TypeError('Value of argument "key" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));t=this._resolveModelId(t);var n=this.getById(t);return n?n.getSettingValue(e):null},e.prototype.getById=function(t){if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));return this.host.models.Organization.get(t)},e.prototype.getMultiById=function(t){if(!Array.isArray(t)||!t.every(function(t){return"string"==typeof t}))throw new TypeError('Value of argument "ids" violates contract.\n\nExpected:\nArray<string>\n\nGot:\n'+i(t));if(!Array.isArray(t)||!t.every(function(t){return"string"==typeof t}))throw new TypeError('Value of argument "ids" violates contract.\n\nExpected:\nArray<string>\n\nGot:\n'+a(t));return this.host.models.Organization.getMulti(t)},e.prototype._onConversationChange=function(t,e){this.__reloadConversations(e.organization)},e.prototype.__reloadConversations=function(t){var e;if(t){var n=(0,P["default"])(t,["conversations","unreadCount"]),r=(e=(e=this.host.models.Conversation.getAll(),H["default"]).call(e,{organizationId:t.id}),Q["default"]).call(e,["lastEventMessageSortNumber","_origIndex"],["desc","asc"]),o=(0,C["default"])(r,"unreadCount"),a={conversations:r,unreadCount:o},i=!1;(0,V["default"])(n,function(e,n){(0,et["default"])(e,a[n])||(t[n]=a[n],i=!0)}),i&&this.host.models.Organization.inject(t)}},e}(D["default"]),o(f.prototype,"findAll",[s],(0,m["default"])(f.prototype,"findAll"),f.prototype),o(f.prototype,"refreshAll",[B.decorator],(0,m["default"])(f.prototype,"refreshAll"),f.prototype),o(f.prototype,"_findAll",[ot.privateMethod],(0,m["default"])(f.prototype,"_findAll"),f.prototype),o(f.prototype,"find",[u],(0,m["default"])(f.prototype,"find"),f.prototype),o(f.prototype,"_onConversationChange",[ot.privateMethod,rt["default"]],(0,m["default"])(f.prototype,"_onConversationChange"),f.prototype),o(f.prototype,"__reloadConversations",[ot.privateMethod],(0,m["default"])(f.prototype,"__reloadConversations"),f.prototype),c=f))||c);e["default"]=at,t.exports=e["default"]},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}e.__esModule=!0,e["default"]=void 0;var o,a=n(1),i=r(a),s=n(3),u=r(s),c=n(2),f=r(c),l=n(10),d=r(l),p=n(23),y=n(12),h=n(21),g=(r(h),(0,y.classWithPrivateMethods)(o=function(t){function e(n,r){return(0,i["default"])(this,e),(0,u["default"])(this,t.call(this,n,r))}return(0,f["default"])(e,t),e.prototype.mounted=function(){this._data={}},e.prototype.dispose=function(){this._data=null},e.prototype.reactToPresenceEvent=function(t){this.set(t.data.from,p.PresenceStatus.resolve(t.data.type))},e.prototype.set=function(t,e){var n=this._data[t]!==e;if(n){var r=this.host.models.User.get(t);this._data[t]=e,this.emit("change",{userId:t,presence:e,user:r})}},e.prototype.get=function(t){return t==this.host.currentUserId?p.PresenceStatus.AVAILABLE:this._data[t]||null},e}(d["default"]))||o);e["default"]=g,t.exports=e["default"]},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function o(t,e,n,r,o){var a={};return Object.keys(r).forEach(function(t){a[t]=r[t]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=n.slice().reverse().reduce(function(n,r){return r(t,e,n)||n},a),o&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(o):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(t,e,a),a=null),a}e.__esModule=!0,e["default"]=void 0;var a,i,s=n(9),u=r(s),c=n(7),f=r(c),l=n(17),d=r(l),p=n(4),y=r(p),h=n(6),g=r(h),v=n(1),m=r(v),b=n(3),w=r(b),E=n(2),x=r(E),_=n(22),I=r(_),O=n(157),T=r(O),j=n(154),A=r(j),k=n(148),M=r(k),G=n(35),V=r(G),z=n(64),C=r(z),S=n(30),P=r(S),N=n(10),R=r(N),U=n(14),q=n(13),F=r(q),$=n(32),L=r($),D=n(50),B=n(15),K={user:"account",distributionList:"distribution_list",group:"group",organization:"organization",room:"public_group"},Z=(0,P["default"])(K),W=(a=(0,U.decorator)(),i=function(t){function e(){return(0,m["default"])(this,e),(0,w["default"])(this,t.apply(this,arguments))}return(0,x["default"])(e,t),e.prototype.query=function(){function t(t){return e.apply(this,arguments)}var e=(0,g["default"])(f["default"].mark(function n(t){var e,r,o,a,i,s,u=this,c=t.types,l=void 0===c?[]:c,p=t.query,h=void 0===p?{}:p,g=t.continuation,v=void 0===g?null:g,m=t.includeDisabled,b=void 0!==m&&m,w=t.excludeIds,E=void 0===w?[]:w,x=t.excludeSelf,_=void 0!==x&&x,O=t.resultsFormat,j=void 0===O?"entities":O,k=t.organizationId,G=void 0===k?null:k,z=t.organizationIds,S=void 0===z?[]:z,P=t.sort,N=void 0===P?[]:P,R=t.includeMetadata,U=void 0!==R&&R;return f["default"].wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(0!=l.length){t.next=2;break}throw new F["default"].ValidationError("types","required","no types specified");case 2:if(l=l.map(function(t){return K[t]}),e=(0,C["default"])(l,Z),!(e.length>0)){t.next=6;break}throw new F["default"].ValidationError("types","invalid","invalid types: "+e.join(", "));case 6:if(G&&(S=[G]),0!=S.length){t.next=9;break}throw new F["default"].ValidationError("organizationIds","invalid","search must be done in a context of an organization");case 9:return"ids"===j&&(j="tokens"),r={type:l,include_disabled:b,directory:S,results_format:j},v&&(r.continuation=v),N&&N.length&&(r.sort=N),E=(0,B.arrayWrap)(E),h&&(0,y["default"])(h).length>0&&(r.bool={must:L["default"].underscoreObject(h)}),t.next=17,this.httpClient.post("/search",{data:r});case 17:if(o=t.sent,a=o.data.results,i=this.host.currentUser.id,s=(0,V["default"])(a,function(t,e){var n=e.type,r=e.entity,o=e.organization_id;if(0!=(0,y["default"])(r).length){"tigertext:entity:account"===n&&(0,B.replaceKey)(r,"status","account_status");var a=u.host.injectModel(r,n);if(!(E.length&&E.includes(a.id)||_&&a.id===i)){if(!a)return void u.logger.warn("no entity for ",e);var s=new D.SearchResult(a,o);t.push(s)}}},[]),!U){t.next=23;break}return t.delegateYield(f["default"].mark(function n(){var t,e,r;return f["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(t=(0,M["default"])(s,"organizationId"),e=(0,A["default"])(s,"entityId"),r=(0,V["default"])(t,function(t,n,r){t.push(u.host.metadata.findMulti((0,T["default"])(n,"entityId"),r).then(function(t){(0,I["default"])(t,function(t,n){return e[n].metadata=t})}))},[]),!(r.length>0)){n.next=6;break}return n.next=6,d["default"].all(r);case 6:case"end":return n.stop()}},n,u)})(),"t0",23);case 23:return t.abrupt("return",s);case 24:case"end":return t.stop()}},n,this)}));return t}(),e}(R["default"]),o(i.prototype,"query",[a],(0,u["default"])(i.prototype,"query"),i.prototype),i);e["default"]=W,t.exports=e["default"]},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function o(t,e,n,r,o){var a={};return Object.keys(r).forEach(function(t){a[t]=r[t]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=n.slice().reverse().reduce(function(n,r){return r(t,e,n)||n},a),o&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(o):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(t,e,a),a=null),a}function a(t,e){var n=4,r=15;if(void 0===e&&(e=0),e+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return"undefined"==typeof t?"undefined":(0,y["default"])(t);if(!Array.isArray(t)){var o=(0,d["default"])(t);if(!o.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(e>n)return"{...}";var i="  ".repeat(e-1),s=o.slice(0,r).map(function(n){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(n)?n:(0,f["default"])(n))+": "+a(t[n],e)+";"}).join("\n  "+i);return o.length>=r&&(s+="\n  "+i+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+i+s+"\n"+i+"}":"{\n  "+i+s+"\n"+i+"}"}if(!(t.length>0))return"Array";var u=function(){if(e>n)return{v:"[...]"};var o=a(t[0],e);return t.every(function(t){return a(t,e)===o})?{v:o.trim()+"[]"}:{v:"["+t.slice(0,r).map(function(t){return a(t,e)}).join(", ")+(t.length>=r?", ...":"")+"]"}}();return"object"===("undefined"==typeof u?"undefined":(0,y["default"])(u))?u.v:void 0}function i(t,e){var n=4,r=15;if(void 0===e&&(e=0),e+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return"undefined"==typeof t?"undefined":(0,y["default"])(t);if(!Array.isArray(t)){var o=(0,d["default"])(t);if(!o.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(e>n)return"{...}";var a="  ".repeat(e-1),s=o.slice(0,r).map(function(n){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(n)?n:(0,f["default"])(n))+": "+i(t[n],e)+";"}).join("\n  "+a);return o.length>=r&&(s+="\n  "+a+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+a+s+"\n"+a+"}":"{\n  "+a+s+"\n"+a+"}"}if(!(t.length>0))return"Array";var u=function(){if(e>n)return{v:"[...]"};var o=i(t[0],e);return t.every(function(t){return i(t,e)===o})?{v:o.trim()+"[]"}:{v:"["+t.slice(0,r).map(function(t){return i(t,e)}).join(", ")+(t.length>=r?", ...":"")+"]"}}();return"object"===("undefined"==typeof u?"undefined":(0,y["default"])(u))?u.v:void 0}e.__esModule=!0,e["default"]=void 0;var s,u,c=n(5),f=r(c),l=n(4),d=r(l),p=n(8),y=r(p),h=n(9),g=r(h),v=n(11),m=r(v),b=n(7),w=r(b),E=n(6),x=r(E),_=n(1),I=r(_),O=n(3),T=r(O),j=n(2),A=r(j),k=n(30),M=r(k),G=n(10),V=r(G),z=n(60),C=r(z),S=n(41),P=r(S),N=n(24),R=r(N),U=n(21),q=r(U),F=n(12),$="global",L=(0,F.classWithPrivateMethods)((u=function(t){function e(){return(0,I["default"])(this,e),(0,T["default"])(this,t.apply(this,arguments))}return(0,A["default"])(e,t),e.prototype.mounted=function(){this._typers={},this._currentUserTyping={},this.host.on("message:sending",this._onMessageSending)},e.prototype.dispose=function(){var t;(t=(t=(t=(t=this._typers,C["default"]).call(t),R["default"]).call(t,M["default"]),P["default"]).call(t),R["default"]).call(t,"timer").forEach(function(t){return clearTimeout(t)}),(t=(t=this._currentUserTyping,C["default"]).call(t),R["default"]).call(t,"timer").forEach(function(t){return clearTimeout(t)}),this._typers=null,this.host.removeListener("message:sending",this._onMessageSending)},e.prototype.reactToIsTypingEvent=function(t){if(!(t instanceof Object))throw new TypeError('Value of argument "event" violates contract.\n\nExpected:\nObject\n\nGot:\n'+i(t));if(!(t instanceof Object))throw new TypeError('Value of argument "event" violates contract.\n\nExpected:\nObject\n\nGot:\n'+a(t));this.host.requireUser();var e=t.data.sender_token;if(e!==this.host.currentUserId){var n=t.data.group_token,r=n||$,o="typing"===t.data.status;this.host.models.User.ensureEntity(e,{onlyPlaceholder:!1}),this._setTypingStatusOfUser(r,e,o)}},e.prototype.startTyping=function(){function t(t,n){return e.apply(this,arguments)}var e=(0,x["default"])(w["default"].mark(function n(t){var e=arguments.length<=1||void 0===arguments[1]||arguments[1];return w["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof t||t instanceof Object){n.next=2;break}throw new TypeError('Value of argument "counterPartyId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(t));
case 2:if("string"==typeof t||t instanceof Object){n.next=4;break}throw new TypeError('Value of argument "counterPartyId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(t));case 4:return t=this._resolveModelId(t),this.host.requireUser(),n.next=8,this.host.api.messages.startTyping(t);case 8:t in this._currentUserTyping&&clearTimeout(this._currentUserTyping[t].timer),this._currentUserTyping[t]={},e&&(this._currentUserTyping[t].timer=this._createClearTimerForCurrentUser(t,"number"==typeof e?e:void 0));case 11:case"end":return n.stop()}},n,this)}));return t}(),e.prototype.stopTyping=function(){function t(t){return e.apply(this,arguments)}var e=(0,x["default"])(w["default"].mark(function n(t){return w["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"==typeof t||t instanceof Object){e.next=2;break}throw new TypeError('Value of argument "counterPartyId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(t));case 2:if("string"==typeof t||t instanceof Object){e.next=4;break}throw new TypeError('Value of argument "counterPartyId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(t));case 4:return t=this._resolveModelId(t),this.host.requireUser(),t in this._currentUserTyping&&(clearTimeout(this._currentUserTyping[t].timer),delete this._currentUserTyping[t]),e.next=9,this.host.api.messages.stopTyping(t);case 9:case"end":return e.stop()}},n,this)}));return t}(),e.prototype._setTypingStatusOfUser=function(t,e,n){var r=!(arguments.length<=3||void 0===arguments[3])&&arguments[3];if("string"!=typeof t)throw new TypeError('Value of argument "contextId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));if("string"!=typeof e)throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));if("boolean"!=typeof n)throw new TypeError('Value of argument "isTyping" violates contract.\n\nExpected:\nbool\n\nGot:\n'+i(n));if("string"!=typeof t)throw new TypeError('Value of argument "contextId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));if("string"!=typeof e)throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));if("boolean"!=typeof n)throw new TypeError('Value of argument "isTyping" violates contract.\n\nExpected:\nbool\n\nGot:\n'+a(n));if(n){this._typers[t]||(this._typers[t]={});var o=e in this._typers[t];if(o&&clearTimeout(this._typers[t][e].timer),this._typers[t][e]={timer:this._createClearTimerForOtherUser(t,e)},o)return}else{if(!this._typers[t]||!this._typers[t][e])return;clearTimeout(this._typers[t][e].timer),delete this._typers[t][e]}var s=(0,m["default"])({userId:e},t!==$?{groupId:t}:null,{isTyping:n,timedOut:r});this.emit("change",s)},e.prototype._createClearTimerForOtherUser=function(t,e){var n=this;if("string"!=typeof t)throw new TypeError('Value of argument "contextId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));if("string"!=typeof e)throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));if("string"!=typeof t)throw new TypeError('Value of argument "contextId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));if("string"!=typeof e)throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));return setTimeout(function(){n.logger.info("auto stop typing for other typer",t,e),n._setTypingStatusOfUser(t,e,!1,!0)},this.host.config.clearTypingStatusTimeout)},e.prototype._createClearTimerForCurrentUser=function(t,e){var n=this;if("string"!=typeof t)throw new TypeError('Value of argument "counterPartyId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));if(null!=e&&"number"!=typeof e)throw new TypeError('Value of argument "timeout" violates contract.\n\nExpected:\n?number\n\nGot:\n'+i(e));if("string"!=typeof t)throw new TypeError('Value of argument "counterPartyId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));if(null!=e&&"number"!=typeof e)throw new TypeError('Value of argument "timeout" violates contract.\n\nExpected:\n?number\n\nGot:\n'+a(e));return setTimeout(function(){n.logger.info("auto stop typing for current user",t),n.stopTyping(t)},"number"==typeof e?e:this.host.config.clearTypingStatusTimeout)},e.prototype.isUserTyping=function(t){if(!(t instanceof Object||"string"==typeof t))throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nObject | string\n\nGot:\n'+i(t));if(!(t instanceof Object||"string"==typeof t))throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nObject | string\n\nGot:\n'+a(t));return t=this._resolveModelId(t),this._isUserTypingInContext($,t)},e.prototype.isCurrentUserTyping=function(t){if(!(t instanceof Object||"string"==typeof t))throw new TypeError('Value of argument "counterPartyId" violates contract.\n\nExpected:\nObject | string\n\nGot:\n'+i(t));if(!(t instanceof Object||"string"==typeof t))throw new TypeError('Value of argument "counterPartyId" violates contract.\n\nExpected:\nObject | string\n\nGot:\n'+a(t));return t=this._resolveModelId(t),t in this._currentUserTyping},e.prototype.isUserTypingInGroup=function(t,e){if(!(t instanceof Object||"string"==typeof t))throw new TypeError('Value of argument "groupId" violates contract.\n\nExpected:\nObject | string\n\nGot:\n'+i(t));if(!(e instanceof Object||"string"==typeof e))throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nObject | string\n\nGot:\n'+i(e));if(!(t instanceof Object||"string"==typeof t))throw new TypeError('Value of argument "groupId" violates contract.\n\nExpected:\nObject | string\n\nGot:\n'+a(t));if(!(e instanceof Object||"string"==typeof e))throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nObject | string\n\nGot:\n'+a(e));return e=this._resolveModelId(e),t=this._resolveModelId(t),this._isUserTypingInContext(t,e)},e.prototype._isUserTypingInContext=function(t,e){if("string"!=typeof t)throw new TypeError('Value of argument "contextId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));if("string"!=typeof e)throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));if("string"!=typeof t)throw new TypeError('Value of argument "contextId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));if("string"!=typeof e)throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));return!!this._typers[t]&&e in this._typers[t]},e.prototype._onMessageSending=function(t){this.stopTyping(t.counterPartyId)},e}(V["default"]),o(u.prototype,"_setTypingStatusOfUser",[F.privateMethod],(0,g["default"])(u.prototype,"_setTypingStatusOfUser"),u.prototype),o(u.prototype,"_createClearTimerForOtherUser",[F.privateMethod],(0,g["default"])(u.prototype,"_createClearTimerForOtherUser"),u.prototype),o(u.prototype,"_createClearTimerForCurrentUser",[F.privateMethod],(0,g["default"])(u.prototype,"_createClearTimerForCurrentUser"),u.prototype),o(u.prototype,"_isUserTypingInContext",[F.privateMethod],(0,g["default"])(u.prototype,"_isUserTypingInContext"),u.prototype),o(u.prototype,"_onMessageSending",[F.privateMethod,q["default"]],(0,g["default"])(u.prototype,"_onMessageSending"),u.prototype),s=u))||s;e["default"]=L,t.exports=e["default"]},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function o(t,e,n,r,o){var a={};return Object.keys(r).forEach(function(t){a[t]=r[t]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=n.slice().reverse().reduce(function(n,r){return r(t,e,n)||n},a),o&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(o):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(t,e,a),a=null),a}function a(t,e){var n=4,r=15;if(void 0===e&&(e=0),e+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return"undefined"==typeof t?"undefined":(0,m["default"])(t);if(!Array.isArray(t)){var o=(0,g["default"])(t);if(!o.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(e>n)return"{...}";var i="  ".repeat(e-1),s=o.slice(0,r).map(function(n){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(n)?n:(0,y["default"])(n))+": "+a(t[n],e)+";"}).join("\n  "+i);return o.length>=r&&(s+="\n  "+i+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+i+s+"\n"+i+"}":"{\n  "+i+s+"\n"+i+"}"}if(!(t.length>0))return"Array";var u=function(){if(e>n)return{v:"[...]"};var o=a(t[0],e);return t.every(function(t){return a(t,e)===o})?{v:o.trim()+"[]"}:{v:"["+t.slice(0,r).map(function(t){return a(t,e)}).join(", ")+(t.length>=r?", ...":"")+"]"}}();return"object"===("undefined"==typeof u?"undefined":(0,m["default"])(u))?u.v:void 0}function i(t,e){var n=4,r=15;if(void 0===e&&(e=0),e+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return"undefined"==typeof t?"undefined":(0,m["default"])(t);if(!Array.isArray(t)){var o=(0,g["default"])(t);if(!o.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(e>n)return"{...}";var a="  ".repeat(e-1),s=o.slice(0,r).map(function(n){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(n)?n:(0,y["default"])(n))+": "+i(t[n],e)+";"}).join("\n  "+a);return o.length>=r&&(s+="\n  "+a+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+a+s+"\n"+a+"}":"{\n  "+a+s+"\n"+a+"}"}if(!(t.length>0))return"Array";var u=function(){if(e>n)return{v:"[...]"};var o=i(t[0],e);return t.every(function(t){return i(t,e)===o})?{v:o.trim()+"[]"}:{v:"["+t.slice(0,r).map(function(t){return i(t,e)}).join(", ")+(t.length>=r?", ...":"")+"]"}}();return"object"===("undefined"==typeof u?"undefined":(0,m["default"])(u))?u.v:void 0}e.__esModule=!0,e["default"]=void 0;var s,u,c,f,l,d,p=n(5),y=r(p),h=n(4),g=r(h),v=n(8),m=r(v),b=n(9),w=r(b),E=n(11),x=r(E),_=n(17),I=r(_),O=n(7),T=r(O),j=n(6),A=r(j),k=n(1),M=r(k),G=n(3),V=r(G),z=n(2),C=r(z),S=n(45),P=r(S),N=n(18),R=r(N),U=n(40),q=r(U),F=n(55),$=r(F),L=n(10),D=r(L),B=n(13),K=r(B),Z=n(14),W=n(12),H=n(59),X=r(H),Q=new $["default"].MD5,Y=(s=(0,Z.decorator)(),u=(0,Z.decorator)(),c=(0,Z.decorator)(),f=(0,Z.decorator)(),(0,W.classWithPrivateMethods)((d=function(t){function e(){return(0,M["default"])(this,e),(0,V["default"])(this,t.apply(this,arguments))}return(0,C["default"])(e,t),e.prototype.signIn=function(){function t(t,n,r){return e.apply(this,arguments)}var e=(0,A["default"])(T["default"].mark(function n(t,e){var r,o,s,u,c,f=arguments.length<=2||void 0===arguments[2]?{udid:void 0}:arguments[2];return T["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof t){n.next=2;break}throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));case 2:if("string"==typeof e){n.next=4;break}throw new TypeError('Value of argument "password" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));case 4:if("string"==typeof t){n.next=6;break}throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));case 6:if("string"==typeof e){n.next=8;break}throw new TypeError('Value of argument "password" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));case 8:return r={Authorization:this.getSignInAuthHeader(t,e)},o={user_id:t,password:e,push_routing:this.config.pushAgent,version:this.config.version,device_id:f.udid,metadata:{tt_product_version:"tigerconnect_"+this.config.version,user_agent:global.navigator&&global.navigator.userAgent}},n.next=12,this.httpClient.post("/login",{headers:r,data:o});case 12:return s=n.sent,u=this.host.models.User.inject(s.data.user),c=s.data.auth,n.abrupt("return",{user:u,auth:c});case 16:case"end":return n.stop()}},n,this)}));return t}(),e.prototype.getSignInAuthHeader=function(t,e){if("string"!=typeof t)throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));if("string"!=typeof e)throw new TypeError('Value of argument "password" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));if("string"!=typeof t)throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));if("string"!=typeof e)throw new TypeError('Value of argument "password" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));return this.host.api.users.getSignInAuthHeader(this.config.productKey,t,e)},e.prototype.signUp=function(){function t(t){return e.apply(this,arguments)}var e=(0,A["default"])(T["default"].mark(function n(){var t,e,r,o,a,i,s,u,c,f,l,d,p,y,h,g=arguments.length<=0||void 0===arguments[0]?{udid:void 0,email:void 0,password:void 0,countryCode:void 0,version:void 0}:arguments[0];return T["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t=this.config.signUpHashKey,e=this.config.signUpHashSalt,r=g.udid,o=[t,e,r].join(":"),a=Q.hex(o),i=[a.substr(0,2),a.substr(a.length-2)].join(""),s=[this.config.productKey,t,e,r,i].join(":"),u=(0,q["default"])(s),c="XMPP-Anonymous "+u,f={Authorization:c},l={primary_email:g.email,unique_id:g.email,password:g.password,push_routing:this.config.pushAgent,product:this.config.productKey,country_code:g.countryCode,device_id:g.udid,version:this.config.version},n.next=13,this.httpClient.post("/signup",{headers:f,data:l});case 13:return d=n.sent,p=this.host.models.User.inject(d.data.user),y=d.data.auth,h={user:p,auth:y},this.host.emit("signUp",h),n.abrupt("return",h);case 19:case"end":return n.stop()}},n,this)}));return t}(),e.prototype.signOut=function(){function t(){return e.apply(this,arguments)}var e=(0,A["default"])(T["default"].mark(function n(){return T["default"].wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.httpClient.post("/logout"));case 1:case"end":return t.stop()}},n,this)}));return t}(),e.prototype.findMe=function(){function t(t){return e.apply(this,arguments)}var e=(0,A["default"])(T["default"].mark(function n(){var t,e,r=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];return T["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return this.host.requireUser(),n.next=3,this.host.api.users.findMe();case 3:if(t=n.sent,!t){n.next=9;break}return e=this.host.models.User.inject(t),n.abrupt("return",e);case 9:if(r.ignoreNotFound){n.next=11;break}throw new K["default"].NotFoundError(this.host.models.User.name,"me");case 11:case"end":return n.stop()}},n,this)}));return t}(),e.prototype.findMyProfilesForAllOrganizations=function(){function t(t){return e.apply(this,arguments)}var e=(0,A["default"])(T["default"].mark(function n(){var t;return arguments.length<=0||void 0===arguments[0]?{}:arguments[0],T["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.host.organizations.findAll();case 2:return e.t0=function(t){return t.id},t=e.sent.map(e.t0),e.abrupt("return",this.findProfileForOrganizations(this.host.currentUserId,t));case 5:case"end":return e.stop()}},n,this)}));return t}(),e.prototype.find=function(){function t(t,n){return e.apply(this,arguments)}var e=(0,A["default"])(T["default"].mark(function n(t){var e,r,o=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return T["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof t){n.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));case 2:if("string"==typeof t){n.next=4;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));case 4:if(o=(0,R["default"])(o,{ignoreNotFound:!1,bypassCache:!1}),this.host.requireUser(),e=null,o.bypassCache){n.next=11;break}if(e=this.host.models.User.get(t),!e||e.$placeholder){n.next=11;break}return n.abrupt("return",e);case 11:return n.next=13,this.host.api.users.find(t);case 13:if(r=n.sent,!r){n.next=19;break}e=this.host.models.User.inject(r),delete e.$placeholder,n.next=21;break;case 19:if(o.ignoreNotFound){n.next=21;break}throw new K["default"].NotFoundError(this.host.models.User.name,t);case 21:return n.abrupt("return",e);case 22:case"end":return n.stop()}},n,this)}));return t}(),e.prototype.findProfileForOrganizations=function(){function t(t,n,r){return e.apply(this,arguments)}var e=(0,A["default"])(T["default"].mark(function n(t,e){var r,o=this,s=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];return T["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof t){n.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));case 2:if(Array.isArray(e)&&e.every(function(t){return"string"==typeof t})||Array.isArray(e)&&e.every(function(t){return t instanceof Object})){n.next=4;break}throw new TypeError('Value of argument "organizationIds" violates contract.\n\nExpected:\nstring[] | Object[]\n\nGot:\n'+i(e));case 4:if("string"==typeof t){n.next=6;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));case 6:if(Array.isArray(e)&&e.every(function(t){return"string"==typeof t})||Array.isArray(e)&&e.every(function(t){return t instanceof Object})){n.next=8;break}throw new TypeError('Value of argument "organizationIds" violates contract.\n\nExpected:\nstring[] | Object[]\n\nGot:\n'+a(e));case 8:return s=(0,R["default"])(s,{ignoreNotFound:!1,bypassCache:!1}),n.prev=9,n.next=12,I["default"].all(e.map(function(e){return o.findProfileForOrganization(t,e,s)}));case 12:n.next=16;break;case 14:n.prev=14,n.t0=n["catch"](9);case 16:if(r=this.host.models.User.get(t),r||s.ignoreNotFound){n.next=19;break}throw new K["default"].NotFoundError(this.host.models.User.name,t);case 19:return n.abrupt("return",r.profileByOrganizationId);case 20:case"end":return n.stop()}},n,this,[[9,14]])}));return t}(),e.prototype.findProfileForOrganization=function(){function t(t,n,r){return e.apply(this,arguments)}var e=(0,A["default"])(T["default"].mark(function n(t,e){var r,o,s=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];return T["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("string"==typeof t){n.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));case 2:if("string"==typeof e||e instanceof Object){n.next=4;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(e));case 4:if("string"==typeof t){n.next=6;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));case 6:if("string"==typeof e||e instanceof Object){n.next=8;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(e));case 8:return this.host.requireUser(),s=(0,R["default"])(s,{ignoreNotFound:!0,bypassCache:!1}),e=this._resolveModelId(e),n.next=13,this.find(t,s);case 13:if(r=n.sent,!r||r.$placeholder||!r.profileByOrganizationId||!r.profileByOrganizationId[e]){n.next=16;break}return n.abrupt("return",r.profileByOrganizationId[e]);case 16:return n.next=18,this.host.api.users.find(t,{organizationId:e});case 18:if(o=n.sent,!o){n.next=23;break}this.host.models.User.inject(o),n.next=25;break;case 23:if(s.ignoreNotFound){n.next=25;break}throw new K["default"].NotFoundError(this.host.models.User.name,t);case 25:if(r.profileByOrganizationId[e]||s.ignoreNotFound){n.next=27;break}throw new K["default"].NotFoundError(this.host.models.User.name+".profileByOrganizationId",t+"/"+e);case 27:return n.abrupt("return",r.profileByOrganizationId[e]);case 28:case"end":return n.stop()}},n,this)}));return t}(),e.prototype.refresh=function(){function t(t){return e.apply(this,arguments)}var e=(0,A["default"])(T["default"].mark(function n(t){return T["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.find(t,{ignoreNotFound:!0,bypassCache:!0});case 2:case"end":return e.stop()}},n,this)}));return t}(),e.prototype.update=function(){function t(t){return e.apply(this,arguments)}var e=(0,A["default"])(T["default"].mark(function n(t){var e,r,o,s,u,c=t.firstName,f=t.lastName,l=t.displayName,d=t.status,p=t.dnd,y=t.dndText,h=t.avatarFile,g=t.removeAvatar,v=arguments;return T["default"].wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!(null==v[0]||null!=v[0].firstName&&"string"!=typeof v[0].firstName||null!=v[0].lastName&&"string"!=typeof v[0].lastName||null!=v[0].displayName&&"string"!=typeof v[0].displayName||null!=v[0].status&&"string"!=typeof v[0].status||null!=v[0].dnd&&"boolean"!=typeof v[0].dnd||null!=v[0].dndText&&"string"!=typeof v[0].dndText||!(null==v[0].avatarFile||v[0].avatarFile instanceof Object)||null!=v[0].removeAvatar&&"boolean"!=typeof v[0].removeAvatar)){t.next=2;break}throw new TypeError("Value of argument 0 violates contract.\n\nExpected:\n{\n  firstName: ?string;\n  lastName: ?string;\n  displayName: ?string;\n  status: ?string;\n  dnd: ?bool;\n  dndText: ?string;\n  avatarFile: ?Object;\n  removeAvatar: ?bool;\n}\n\nGot:\n"+i(v[0]));case 2:if(!(null==v[0]||null!=v[0].firstName&&"string"!=typeof v[0].firstName||null!=v[0].lastName&&"string"!=typeof v[0].lastName||null!=v[0].displayName&&"string"!=typeof v[0].displayName||null!=v[0].status&&"string"!=typeof v[0].status||null!=v[0].dnd&&"boolean"!=typeof v[0].dnd||null!=v[0].dndText&&"string"!=typeof v[0].dndText||!(null==v[0].avatarFile||v[0].avatarFile instanceof Object)||null!=v[0].removeAvatar&&"boolean"!=typeof v[0].removeAvatar)){t.next=4;break}throw new TypeError("Value of argument 0 violates contract.\n\nExpected:\n{\n  firstName: ?string;\n  lastName: ?string;\n  displayName: ?string;\n  status: ?string;\n  dnd: ?bool;\n  dndText: ?string;\n  avatarFile: ?Object;\n  removeAvatar: ?bool;\n}\n\nGot:\n"+a(v[0]));case 4:return this.host.requireUser(),r=(e={firstName:c,lastName:f,displayName:l,status:d,dnd:p,dndText:y,avatarFile:h,removeAvatar:g},X["default"]).call(e,function(t,e){return"undefined"==typeof t}),t.next=8,this.host.api.users.update(this.host.currentUserId,r);case 8:return o=t.sent,s=(0,P["default"])(r,"removeAvatar","avatarFile"),g?s.avatarUrl=null:"undefined"!=typeof o.avatarUrl&&(s.avatarUrl=o.avatarUrl),u=this.host.models.User.inject((0,x["default"])({id:this.host.currentUserId},s)),t.abrupt("return",u);case 13:case"end":return t.stop()}},n,this)}));return t}(),e.prototype.updatePassword=function(t,e){if("string"!=typeof t)throw new TypeError('Value of argument "currentPassword" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));if("string"!=typeof e)throw new TypeError('Value of argument "newPassword" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));if("string"!=typeof t)throw new TypeError('Value of argument "currentPassword" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));if("string"!=typeof e)throw new TypeError('Value of argument "newPassword" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(e));return this.host.requireUser(),this.host.api.users.updatePassword(this.host.currentUserId,t,e,this.config.productKey)},e.prototype.getById=function(t){if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));return this.host.models.User.get(t)},e.prototype.getMultiById=function(t){if(!Array.isArray(t)||!t.every(function(t){return"string"==typeof t}))throw new TypeError('Value of argument "ids" violates contract.\n\nExpected:\nArray<string>\n\nGot:\n'+i(t));if(!Array.isArray(t)||!t.every(function(t){return"string"==typeof t}))throw new TypeError('Value of argument "ids" violates contract.\n\nExpected:\nArray<string>\n\nGot:\n'+a(t));return this.host.models.User.getMulti(t)},e}(D["default"]),o(d.prototype,"findMe",[s],(0,w["default"])(d.prototype,"findMe"),d.prototype),o(d.prototype,"findMyProfilesForAllOrganizations",[u],(0,w["default"])(d.prototype,"findMyProfilesForAllOrganizations"),d.prototype),o(d.prototype,"find",[c],(0,w["default"])(d.prototype,"find"),d.prototype),o(d.prototype,"refresh",[f],(0,w["default"])(d.prototype,"refresh"),d.prototype),l=d))||l);e["default"]=Y,t.exports=e["default"]},function(t,e,n){"use strict";e.__esModule=!0;var r={Users:n(117),EventRouter:n(107),Events:n(108),Messages:n(110),Groups:n(109),DistributionLists:n(106),Organizations:n(113),Conversations:n(105),Presence:n(114),Metadata:n(111),Search:n(115),TypingStatus:n(116),Mute:n(112)};e["default"]=r,t.exports=e["default"]},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){var n=4,r=15;if(void 0===e&&(e=0),e+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return"undefined"==typeof t?"undefined":(0,c["default"])(t);if(!Array.isArray(t)){var a=(0,v["default"])(t);if(!a.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(e>n)return"{...}";var i="  ".repeat(e-1),u=a.slice(0,r).map(function(n){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(n)?n:(0,s["default"])(n))+": "+o(t[n],e)+";"}).join("\n  "+i);return a.length>=r&&(u+="\n  "+i+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+i+u+"\n"+i+"}":"{\n  "+i+u+"\n"+i+"}"}if(!(t.length>0))return"Array";var f=function(){if(e>n)return{v:"[...]"};var a=o(t[0],e);return t.every(function(t){return o(t,e)===a})?{v:a.trim()+"[]"}:{v:"["+t.slice(0,r).map(function(t){return o(t,e)}).join(", ")+(t.length>=r?", ...":"")+"]"}}();return"object"===("undefined"==typeof f?"undefined":(0,c["default"])(f))?f.v:void 0}function a(t,e){var n=4,r=15;if(void 0===e&&(e=0),e+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return"undefined"==typeof t?"undefined":(0,c["default"])(t);if(!Array.isArray(t)){var o=(0,v["default"])(t);if(!o.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(e>n)return"{...}";var i="  ".repeat(e-1),u=o.slice(0,r).map(function(n){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(n)?n:(0,s["default"])(n))+": "+a(t[n],e)+";"}).join("\n  "+i);return o.length>=r&&(u+="\n  "+i+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+i+u+"\n"+i+"}":"{\n  "+i+u+"\n"+i+"}"}if(!(t.length>0))return"Array";var f=function(){if(e>n)return{v:"[...]"};var o=a(t[0],e);return t.every(function(t){return a(t,e)===o})?{v:o.trim()+"[]"}:{v:"["+t.slice(0,r).map(function(t){return a(t,e)}).join(", ")+(t.length>=r?", ...":"")+"]"}}();return"object"===("undefined"==typeof f?"undefined":(0,c["default"])(f))?f.v:void 0}e.__esModule=!0,e["default"]=void 0;var i=n(5),s=r(i),u=n(8),c=r(u),f=n(7),l=r(f),d=n(6),p=r(d),y=n(11),h=r(y),g=n(4),v=r(g),m=n(126),b=r(m),w=n(16),E=r(w),x=n(1),_=r(x),I=n(30),O=r(I),T=n(22),j=r(T),A=n(34),k=r(A),M=n(45),G=r(M),V=n(29),z=r(V),C=n(162),S=r(C),P=n(146),N=r(P),R=n(163),U=r(R),q=n(18),F=r(q),$=n(155),L=r($),D=n(147),B=r(D),K=n(35),Z=r(K),W=n(63),H=r(W),X=n(66),Q=r(X),Y=n(57),J=r(Y),tt=n(61),et=r(tt),nt=n(24),rt=r(nt),ot=n(142),at=r(ot),it=n(60),st=r(it),ut=n(41),ct=r(ut),ft=n(28),lt=r(ft),dt=(n(15),n(27)),pt=r(dt),yt=n(121),ht=r(yt);pt["default"].prototype.off=pt["default"].prototype.removeListener;var gt={idAttribute:"id",parseAttrs:Q["default"],relations:{belongsTo:{},hasMany:{}},defaultValues:null,computed:{},methods:{}},vt=function(){function t(e,n){var r,o=this,a=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];(0,_["default"])(this,t),this.options=(0,H["default"])({},a,gt),this.idAttribute=this.options.idAttribute,this.name=n,this.store=e,this.entitiesById={},this.entitiesList=[],this.transientAttrsStore={},this.options.relations&&this.__initRelations(),this.__initTransientAttrs(),(0,E["default"])(this.options.computed,{$entityType:{enumerable:!0,get:function(){return n}},$entityClass:{enumerable:!1,get:function(){return o}}}),this.options.computed=(0,Z["default"])(this.options.computed,function(t,e,n){"function"==typeof e?t[n]={get:e,enumerable:!1}:t[n]=e},{}),this._computedKeys=(r=(r=this.options.computed,J["default"]).call(r),et["default"]).call(r,"$entityType","$entityClass","$$transientAttrs"),this._writablePropertyKeys=(r=(r=(r=this.options.computed,at["default"]).call(r),lt["default"]).call(r,function(t){return t[1].set}),rt["default"]).call(r,B["default"]),this._relationKeys=(r=(r=(r=this.options.relations,st["default"]).call(r),rt["default"]).call(r,L["default"]),ct["default"]).call(r)}return t.create=function(t,e,n){return new this(t,e,n)},t.prototype.__initRelations=function(){var t=this,e=(0,Z["default"])(this.options.relations.belongsTo,function(e,n,r){e[r]={get:function(){return t.store.get(n.type,this[n.foreignKey])},set:function(e){this[n.foreignKey]=t.store.resolveId(n.type,e)}}},{});(0,E["default"])(this.options.computed,e);var n=(0,Z["default"])(this.options.relations.hasMany,function(e,n,r){e[r]={get:function(){var e=this;if(this.$$transientAttrs.relations||(this.$$transientAttrs.relations={},this.$$transientAttrs.relationsCreated={}),this.$$transientAttrs.relations[r])return this.$$transientAttrs.relations[r];var o=t.store.getAll(n.type).filter(function(r){return r[n.foreignKey]==e[t.options.idAttribute]});return this.$$transientAttrs.relations[r]=o,this.$$transientAttrs.relationsCreated[r]=!0,o},set:function(t){}}},{});(0,E["default"])(this.options.computed,n)},t.prototype.__initTransientAttrs=function(){var t=this,e=this,n={$$transientAttrs:{enumerable:!1,get:function(){var t=this[e.options.idAttribute];return e.transientAttrsStore[t]||(e.transientAttrsStore[t]={})}}},r={};this.options.transientAttrs&&this.options.transientAttrs.forEach(function(e){t.options.defaultValues&&e in t.options.defaultValues&&(r[e]=(0,ht["default"])(t.options.defaultValues[e]),delete t.options.defaultValues[e]),n[e]={get:function(){return e in this.$$transientAttrs?this.$$transientAttrs[e]:e in r?this.$$transientAttrs[e]=r[e]:void 0},set:function(t){this.$$transientAttrs[e]=t}}}),(0,E["default"])(this.options.computed,n)},t.prototype.createInstance=function(t){var e=arguments.length<=1||void 0===arguments[1]||arguments[1],n=this;e&&(t=this.parseAttrs(t));var r=this[n.options.idAttribute];if(this.entitiesById[r])throw new Error("called createInstance on an existing instance");this.options.defaultValues&&(0,F["default"])(t,(0,ht["default"])(this.options.defaultValues));var o={};return this._writablePropertyKeys.forEach(function(e){e in t&&(o[e]=t[e],delete t[e])}),(0,b["default"])(t,this.options.computed),(0,E["default"])(t,o),this.options.instanceEvents&&(0,E["default"])(t,pt["default"].prototype),(0,E["default"])(t,this.options.methods),(0,E["default"])(t,{toPlainObject:function(t){var e=this,r={};n._computedKeys.forEach(function(t){return r[t]=e[t]});var o=(0,E["default"])({},this,r);return delete o.toPlainObject,delete o.setMaxListeners,delete o.emit,delete o.addListener,delete o.on,delete o.once,delete o.removeListener,delete o.removeAllListeners,delete o.listeners,delete o.listenerCount,delete o.off,delete o.toPlainObject,delete o._events,delete o._maxListeners,o}}),this.options.beforeCreateInstance&&this.options.beforeCreateInstance(t),t},t.prototype.inject=function(t){var e=void 0,n=!0,r=this.is(t);if(r){if(e=t,this.entitiesById[this.resolveId(e)])return this.options.beforeInject&&this.options.beforeInject(e),this.emit("beforeInject",this,e),this.options.afterInject&&this.options.afterInject(e),this.emit("afterInject",this,e),e;n=!1}n&&(t=this.parseAttrs(t));var o=void 0,a=this.resolveId(t);if(!this.isValidId(a))throw new Error("'"+this.options.idAttribute+"' is required");return e=this.entitiesById[a],
e?(this.options.beforeInject&&this.options.beforeInject(t,e),this.emit("beforeInject",this,t),(0,E["default"])(e,t)):(o=!0,e=r?t:this.createInstance(t,!1),this.options.beforeInject&&this.options.beforeInject(e),this.emit("beforeInject",this,e),this.entitiesById[a]=e,this.entitiesList.push(e)),this.__addToHasManyRelationships(e),this.options.afterInject&&this.options.afterInject(e),this.emit("afterInject",this,e),o&&(this.options.afterCreate&&this.options.afterCreate(e),this.emit("afterCreate",this,e)),e},t.prototype.eject=function(t){t=this.resolveId(t);var e=this.entitiesById[t];e&&(this.__removeFromHasManyRelationships(e),delete this.entitiesById[t],(0,U["default"])(this.entitiesList,e),t in this.transientAttrsStore&&delete this.transientAttrsStore[t],this.emit("afterEject",this,e))},t.prototype.touch=function(t){var e;t=this.resolveId(t);var n=this.entitiesById[t];n&&this.inject((e={},e[this.options.idAttribute]=t,e))},t.prototype.__addToHasManyRelationships=function(t){this.__updateRelationsIfNeeded(t,"add")},t.prototype.__removeFromHasManyRelationships=function(t){this.__updateRelationsIfNeeded(t,"remove")},t.prototype.__updateRelationsIfNeeded=function(t,e){var n=this,r=this.store.getParentRelationshipsOfModel(this.name);r&&r.forEach(function(r){var o=n.store.get(r.parent,t[r.foreignKey]);o&&o.$$transientAttrs.relationsCreated&&o.$$transientAttrs.relationsCreated[r.relationKey]&&("add"==e?o[r.relationKey].includes(t)||o[r.relationKey].push(t):"remove"==e&&(0,U["default"])(o[r.relationKey],t))})},t.prototype.ejectAll=function(){var t=this;(0,N["default"])(this.entitiesList,function(e){return t.eject(e)})},t.prototype.parseAttrs=function(t){var e=this,n=(0,S["default"])(t,function(t){return e.store.isEntity(t)||e.store.isEntityArray(t)}),r=(0,z["default"])(t,this.options.transientAttrs),o=(0,G["default"])(t,(0,v["default"])(n),this.options.transientAttrs),a=this.options.parseAttrs((0,ht["default"])(o)),i=(0,h["default"])({},a,n,r);return i},t.prototype.get=function(t){return this.entitiesById[t]||null},t.prototype.getAll=function(){return this.entitiesList},t.prototype.getMulti=function(t){return t.map(this.get.bind(this))},t.prototype.resolveId=function(t){return this.isValidId(t)?t:t[this.options.idAttribute]},t.prototype.isValidId=function(t){return"string"==typeof t||"number"==typeof t},t.prototype.is=function(t){return t&&t.$entityClass==this},t.prototype.find=function(){function t(t){return e.apply(this,arguments)}var e=(0,p["default"])(l["default"].mark(function n(t){return l["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"==typeof t){e.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+a(t));case 2:if("string"==typeof t){e.next=4;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+o(t));case 4:throw new"not implemented find";case 5:case"end":return e.stop()}},n,this)}));return t}(),t.prototype.refresh=function(){function t(t){return e.apply(this,arguments)}var e=(0,p["default"])(l["default"].mark(function n(t){return l["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"==typeof t||t instanceof Object){e.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+a(t));case 2:if("string"==typeof t||t instanceof Object){e.next=4;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+o(t));case 4:throw t=this.resolveId(t),new"not implemented refresh";case 6:case"end":return e.stop()}},n,this)}));return t}(),t}();(0,E["default"])(vt.prototype,pt["default"].prototype);var mt=function(){function t(){var e=this,n=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];(0,_["default"])(this,t),this.options=n,this.models={},this.__relationsOfHasManyByContainedItem={},["inject","get","getAll","filter","resolveId","is","find","refresh"].forEach(function(t){e[t]=function(n){for(var r,o=arguments.length,a=Array(o>1?o-1:0),i=1;i<o;i++)a[i-1]=arguments[i];return(r=e.models[n])[t].apply(r,a)}})}return t.prototype.defineModel=function(t){var e=this,n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];if(this.models[t])throw new Error(t+" already defined");n=(0,h["default"])({},this.options,n),this.models[t]=vt.create(this,t,n);var r=this.models[t].options.relations.hasMany;return(0,k["default"])(r)||(0,j["default"])(r,function(n,r){e.__relationsOfHasManyByContainedItem[n.type]||(e.__relationsOfHasManyByContainedItem[n.type]=[]),e.__relationsOfHasManyByContainedItem[n.type].push((0,h["default"])({},n,{relationKey:r,parent:t}))}),this.models[t]},t.prototype.getParentRelationshipsOfModel=function(t){return this.__relationsOfHasManyByContainedItem[t]},t.prototype.isEntity=function(t){return t&&t.$entityClass&&t.$entityClass.constructor===vt},t.prototype.isEntityArray=function(t){return t&&Array.isArray(t)&&t.some(this.isEntity)},t.prototype.clear=function(){(0,O["default"])(this.models).forEach(function(t){return t.ejectAll()})},t}();e["default"]=mt,t.exports=e["default"]},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}e.__esModule=!0,e["default"]=void 0;var o=n(11),a=r(o),i=n(26),s=r(i),u=n(1),c=r(u),f=n(18),l=r(f),d=n(22),p=r(d),y=n(15),h=n(119),g=r(h),v=n(104),m=r(v),b=n(32),w=r(b),E=function(){function t(e){var n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],r=n.logger,o=(0,s["default"])(n,["logger"]);(0,c["default"])(this,t),this.host=e,this.options=o,this.logger=r,this.store=new g["default"]((0,a["default"])({},o,{host:e,logger:r})),this.store.host=e}return t.prototype.defineModels=function(){var t=this,e={},n=(0,a["default"])({},this.options,{host:this.host,logger:this.logger});(0,p["default"])(m["default"],function(r,o){e[o]=r(t,n)}),this.models=e},t.prototype.defineModel=function(t){var e=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];e.replaceKeys=e.replaceKeys||{},(0,l["default"])(e.replaceKeys,{token:"id"});var n=(this.store,this.store.defineModel(t,(0,a["default"])({},e,{beforeCreateInstance:function(t){!t[n.idAttribute]||"serverId"in t||(t.serverId=t[n.idAttribute]),e.beforeCreateInstance&&e.beforeCreateInstance(t)},beforeInject:function(t,n){!n||"serverId"in t||(t.serverId=n.serverId),e.beforeInject&&e.beforeInject(t,n)},afterInject:function(t){var n=Date.now();t.$lastModified==n&&(n+=1e-5),t.$lastModified=n,e.afterInject&&e.afterInject(t)},parseAttrs:function(t){var n=w["default"].camelizeObject(t);return(0,p["default"])(e.replaceKeys,function(t,e){(0,y.replaceKey)(n,e,t)}),e.parseAttrs&&(n=e.parseAttrs(n,t)),n}})));return n},t.prototype.clear=function(){this.store.clear()},t}();e["default"]=E,t.exports=e["default"]},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}e.__esModule=!0;var o=n(5),a=r(o),i=function(t){return JSON.parse((0,a["default"])(t))};e["default"]=i,t.exports=e["default"]},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}e.__esModule=!0;var o=n(123),a=r(o),i=a["default"].version;i=i.replace("-dev",""),e["default"]=i,t.exports=e["default"]},function(t,e){t.exports={name:"tigerconnect","private":!0,version:"0.1.13-dev",description:"JS (web and node) SDK for TigerText",homepage:"",repository:"tigerconnect/js-sdk",author:{name:"Elad Ossadon",email:"elad@tigertext.com",url:""},main:"lib/index.js",keywords:["tigertext"],scripts:{test:"NODE_TARGET=node mocha","watch:test":"npm test -- -w","build:clean":"rimraf lib dist","build:js":"babel -d lib/ src/","build:webpack":"webpack","build:webpack:node":"webpack --target node",build:"npm run build:clean && parallelshell 'npm run build:js' 'npm run build:webpack'","build:node":"npm run build:webpack:node","watch:js":"npm run build:js -- -w","watch:webpack":"webpack --watch",watch:"npm run build:clean && parallelshell 'npm run watch:js' 'npm run watch:webpack'","debug:test":"iron-node node_modules/mocha/bin/_mocha",postinstall:"npm run build"},dependencies:{"autobind-decorator":"^1.3.3","babel-polyfill":"~6.9.1","babel-runtime":"~6.9.2",btoa:"^1.1.2",bunyan:"^1.8.1","class-private-method-decorator":"^2.1.2",eventsource:"^0.2.1","file-type":"^3.8.0","humanize-list":"^1.0.1",invariant:"^2.2.1",jshashes:"^1.0.5",lodash:"^4.13.1","lodash-bound":"^1.1.1",mime:"^1.3.4",moment:"^2.14.1","node-noop":"^1.0.0","node-uuid":"^1.4.7",request:"^2.73.0","reuse-promise":"^1.1.0",shallowequal:"^0.2.2",superagent:"^2.1.0","superagent-prefix":"0.0.2","superagent-retry":"git+https://git@github.com/elado/superagent-retry.git#74c9a6c9ee0ee6c11aafdb10aa8eb5ea0d284cd4"},devDependencies:{"assets-webpack-plugin":"^3.4.0","babel-cli":"~6.11.4","babel-core":"~6.11.4","babel-loader":"^6.2.4","babel-plugin-add-module-exports":"^0.2.1","babel-plugin-conditional-compilation":"0.0.1","babel-plugin-flow-comments":"^6.3.19","babel-plugin-import-asserts":"^2.1.0","babel-plugin-lodash":"^3.2.6","babel-plugin-macros":"^1.0.15","babel-plugin-syntax-flow":"^6.8.0","babel-plugin-transform-class-properties":"~6.10.2","babel-plugin-transform-decorators-legacy":"^1.3.4","babel-plugin-transform-es2015-classes":"^6.9.0","babel-plugin-transform-flow-strip-types":"^6.8.0","babel-plugin-transform-runtime":"~6.9.0","babel-plugin-typecheck":"^3.9.0","babel-preset-es2015":"^6.9.0","babel-preset-es2015-loose":"^7.0.0","babel-preset-stage-0":"^6.5.0",chai:"^3.5.0",decache:"^4.0.0","dom-storage":"^2.0.2",expect:"^1.20.2","expect.js":"^0.3.1",gulp:"^3.9.1","gulp-debug":"^2.1.2","gulp-exec":"^2.1.2","gulp-file":"^0.3.0","gulp-load-plugins":"^1.2.4","gulp-uglify":"^1.5.4","gulp-util":"^3.0.7","json-loader":"^0.5.4","lodash-webpack-plugin":"^0.9.2",mocha:"^2.5.3","mocha-babel":"^3.0.3","mocha-clean":"^1.0.0",nock:"^8.0.0",parallelshell:"^2.0.0","performance-now":"^0.2.0","require-dir":"^0.3.0",rimraf:"^2.5.4",sinon:"^1.17.4",sleep:"^3.0.1","strip-loader":"^0.1.2",timekeeper:"0.1.1",tmatch:"^2.0.1",watch:"^0.19.1",webpack:"^1.13.1","webpack-node-externals":"^1.3.0",yargs:"^4.8.1"},license:{type:"Commercial",url:"http://www.tigertext.com/developer-terms-of-use/"}}},function(t,e,n){function r(t){return n(o(t))}function o(t){return a[t]||function(){throw new Error("Cannot find module '"+t+"'.")}()}var a={"./node":51,"./node.js":51,"./web":52,"./web.js":52};r.keys=function(){return Object.keys(a)},r.resolve=o,t.exports=r,r.id=124},function(t,e){t.exports=require("babel-polyfill")},function(t,e){t.exports=require("babel-runtime/core-js/object/define-properties")},function(t,e){t.exports=require("babel-runtime/core-js/object/define-property")},function(t,e){t.exports=require("babel-runtime/core-js/object/entries")},function(t,e){t.exports=require("babel-runtime/core-js/object/freeze")},function(t,e){t.exports=require("babel-runtime/core-js/set")},function(t,e){t.exports=require("babel-runtime/helpers/createClass")},function(t,e){t.exports=require("eventsource")},function(t,e){t.exports=require("http")},function(t,e){t.exports=require("humanize-list")},function(t,e){t.exports=require("invariant")},function(t,e){t.exports=require("lodash-bound/compact")},function(t,e){t.exports=require("lodash-bound/each")},function(t,e){t.exports=require("lodash-bound/find")},function(t,e){t.exports=require("lodash-bound/first")},function(t,e){t.exports=require("lodash-bound/pickBy")},function(t,e){t.exports=require("lodash-bound/reject")},function(t,e){t.exports=require("lodash-bound/toPairs")},function(t,e){t.exports=require("lodash/assign")},function(t,e){t.exports=require("lodash/chunk")},function(t,e){t.exports=require("lodash/compact")},function(t,e){t.exports=require("lodash/eachRight")},function(t,e){t.exports=require("lodash/first")},function(t,e){t.exports=require("lodash/groupBy")},function(t,e){t.exports=require("lodash/head")},function(t,e){t.exports=require("lodash/includes")},function(t,e){t.exports=require("lodash/invert")},function(t,e){t.exports=require("lodash/isArray")},function(t,e){t.exports=require("lodash/isObject")},function(t,e){t.exports=require("lodash/keyBy")},function(t,e){t.exports=require("lodash/keys")},function(t,e){t.exports=require("lodash/last")},function(t,e){t.exports=require("lodash/map")},function(t,e){t.exports=require("lodash/mapKeys")},function(t,e){t.exports=require("lodash/memoize")},function(t,e){t.exports=require("lodash/noop")},function(t,e){t.exports=require("lodash/orderBy")},function(t,e){t.exports=require("lodash/pickBy")},function(t,e){t.exports=require("lodash/pull")},function(t,e){t.exports=require("lodash/reduce")},function(t,e){t.exports=require("lodash/snakeCase")},function(t,e){t.exports=require("lodash/sortBy")},function(t,e){t.exports=require("lodash/union")},function(t,e){t.exports=require("lodash/uniq")},function(t,e){t.exports=require("lodash/without")},function(t,e){t.exports=require("lodash/xor")},function(t,e){t.exports=require("lodash/zipObject")},function(t,e){t.exports=require("mime")},function(t,e){t.exports=require("node-noop")},function(t,e){t.exports=require("request")},function(t,e){t.exports=require("superagent")},function(t,e){t.exports=require("superagent-prefix")},function(t,e){t.exports=require("superagent-retry")}]);